[0m15:25:39.399096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753a4e0cbaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753a4b7eef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753a4b91bda0>]}


============================== 15:25:39.402411 | 84a5108f-17f6-47c4-be1d-ef33396cd0fa ==============================
[0m15:25:39.402411 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:25:39.403163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:25:39.414035 [info ] [MainThread]: dbt version: 1.9.1
[0m15:25:39.414624 [info ] [MainThread]: python version: 3.12.1
[0m15:25:39.415159 [info ] [MainThread]: python path: /workspaces/pyspark_practice-/venv/bin/python
[0m15:25:39.415690 [info ] [MainThread]: os info: Linux-6.5.0-1025-azure-x86_64-with-glibc2.31
[0m15:25:39.473415 [info ] [MainThread]: Using profiles dir at /home/codespace/.dbt
[0m15:25:39.474111 [info ] [MainThread]: Using profiles.yml file at /home/codespace/.dbt/profiles.yml
[0m15:25:39.474673 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/pyspark_practice-/nexabrands_dbt/dbt_project.yml
[0m15:25:39.475355 [info ] [MainThread]: adapter type: postgres
[0m15:25:39.475850 [info ] [MainThread]: adapter version: 1.9.0
[0m15:25:39.605483 [info ] [MainThread]: Configuration:
[0m15:25:39.606195 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:25:39.606738 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:25:39.607251 [info ] [MainThread]: Required dependencies:
[0m15:25:39.607788 [debug] [MainThread]: Executing "git --help"
[0m15:25:39.610899 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:25:39.611548 [debug] [MainThread]: STDERR: "b''"
[0m15:25:39.612070 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:25:39.612819 [info ] [MainThread]: Connection:
[0m15:25:39.613418 [info ] [MainThread]:   host: 172.19.0.2
[0m15:25:39.613917 [info ] [MainThread]:   port: 5432
[0m15:25:39.614440 [info ] [MainThread]:   user: Ajay
[0m15:25:39.614940 [info ] [MainThread]:   database: raw
[0m15:25:39.615436 [info ] [MainThread]:   schema: raw
[0m15:25:39.615935 [info ] [MainThread]:   connect_timeout: 10
[0m15:25:39.616436 [info ] [MainThread]:   role: None
[0m15:25:39.616942 [info ] [MainThread]:   search_path: None
[0m15:25:39.617524 [info ] [MainThread]:   keepalives_idle: 0
[0m15:25:39.618038 [info ] [MainThread]:   sslmode: None
[0m15:25:39.618699 [info ] [MainThread]:   sslcert: None
[0m15:25:39.619431 [info ] [MainThread]:   sslkey: None
[0m15:25:39.619978 [info ] [MainThread]:   sslrootcert: None
[0m15:25:39.620471 [info ] [MainThread]:   application_name: dbt
[0m15:25:39.620972 [info ] [MainThread]:   retries: 1
[0m15:25:39.621626 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:25:39.721605 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:25:39.745343 [debug] [MainThread]: Using postgres connection "debug"
[0m15:25:39.746051 [debug] [MainThread]: On debug: select 1 as id
[0m15:25:39.746727 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:39.755028 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "172.19.0.2", port 5432 failed: FATAL:  password authentication failed for user "Ajay"

[0m15:25:39.761926 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m15:25:39.762781 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m15:25:39.763549 [debug] [MainThread]: On debug: No close available on handle
[0m15:25:39.764249 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:25:39.764978 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:25:39.765684 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "172.19.0.2", port 5432 failed: FATAL:  password authentication failed for user "Ajay"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:25:39.767251 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.42595097, "process_in_blocks": "0", "process_kernel_time": 0.275884, "process_mem_max_rss": "103172", "process_out_blocks": "16", "process_user_time": 1.627717}
[0m15:25:39.768132 [debug] [MainThread]: Command `dbt debug` failed at 15:25:39.767958 after 0.43 seconds
[0m15:25:39.769124 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:25:39.769959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753a4ab1ac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753a4be5fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x753a4be5d670>]}
[0m15:25:39.770920 [debug] [MainThread]: Flushing usage events
[0m15:25:40.536889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:32:48.129385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1faeb36090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1faf4186e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1faf3003b0>]}


============================== 15:32:48.132804 | 18c1cea0-7e0b-44ac-881c-9394cc2f82dc ==============================
[0m15:32:48.132804 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:32:48.134283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:32:48.145766 [info ] [MainThread]: dbt version: 1.9.1
[0m15:32:48.146430 [info ] [MainThread]: python version: 3.12.1
[0m15:32:48.147010 [info ] [MainThread]: python path: /workspaces/pyspark_practice-/venv/bin/python
[0m15:32:48.147584 [info ] [MainThread]: os info: Linux-6.5.0-1025-azure-x86_64-with-glibc2.31
[0m15:32:48.206919 [info ] [MainThread]: Using profiles dir at /home/codespace/.dbt
[0m15:32:48.207645 [info ] [MainThread]: Using profiles.yml file at /home/codespace/.dbt/profiles.yml
[0m15:32:48.208249 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/pyspark_practice-/nexabrands_dbt/dbt_project.yml
[0m15:32:48.209391 [info ] [MainThread]: adapter type: postgres
[0m15:32:48.210189 [info ] [MainThread]: adapter version: 1.9.0
[0m15:32:48.312591 [info ] [MainThread]: Configuration:
[0m15:32:48.313316 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:32:48.313922 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:32:48.314524 [info ] [MainThread]: Required dependencies:
[0m15:32:48.315130 [debug] [MainThread]: Executing "git --help"
[0m15:32:48.317858 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:32:48.318644 [debug] [MainThread]: STDERR: "b''"
[0m15:32:48.319162 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:32:48.320091 [info ] [MainThread]: Connection:
[0m15:32:48.320834 [info ] [MainThread]:   host: 172.19.0.2
[0m15:32:48.321554 [info ] [MainThread]:   port: 5432
[0m15:32:48.322461 [info ] [MainThread]:   user: Ajay
[0m15:32:48.323045 [info ] [MainThread]:   database: raw
[0m15:32:48.323603 [info ] [MainThread]:   schema: raw
[0m15:32:48.324159 [info ] [MainThread]:   connect_timeout: 10
[0m15:32:48.324806 [info ] [MainThread]:   role: None
[0m15:32:48.325368 [info ] [MainThread]:   search_path: None
[0m15:32:48.325993 [info ] [MainThread]:   keepalives_idle: 0
[0m15:32:48.326691 [info ] [MainThread]:   sslmode: None
[0m15:32:48.327519 [info ] [MainThread]:   sslcert: None
[0m15:32:48.328901 [info ] [MainThread]:   sslkey: None
[0m15:32:48.329678 [info ] [MainThread]:   sslrootcert: None
[0m15:32:48.330460 [info ] [MainThread]:   application_name: dbt
[0m15:32:48.331198 [info ] [MainThread]:   retries: 1
[0m15:32:48.332475 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:32:48.474003 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:32:48.498626 [debug] [MainThread]: Using postgres connection "debug"
[0m15:32:48.499268 [debug] [MainThread]: On debug: select 1 as id
[0m15:32:48.499838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:32:48.504956 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "172.19.0.2", port 5432 failed: FATAL:  password authentication failed for user "Ajay"

[0m15:32:48.509767 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m15:32:48.510915 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m15:32:48.511762 [debug] [MainThread]: On debug: No close available on handle
[0m15:32:48.512851 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:32:48.514228 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:32:48.514882 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "172.19.0.2", port 5432 failed: FATAL:  password authentication failed for user "Ajay"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:32:48.516193 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.44377628, "process_in_blocks": "16", "process_kernel_time": 0.208085, "process_mem_max_rss": "103180", "process_out_blocks": "16", "process_user_time": 1.696094}
[0m15:32:48.516854 [debug] [MainThread]: Command `dbt debug` failed at 15:32:48.516685 after 0.44 seconds
[0m15:32:48.517354 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:32:48.517931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1faeac4bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1faecf5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1faecf7f20>]}
[0m15:32:48.518814 [debug] [MainThread]: Flushing usage events
[0m15:32:49.308538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:50.730212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d79c414df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d79c3d2bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d79c4172ea0>]}


============================== 15:33:50.736376 | b526ba14-a71b-4b6b-b34d-bf20a3fa52cd ==============================
[0m15:33:50.736376 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:33:50.737855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:33:50.751250 [info ] [MainThread]: dbt version: 1.9.1
[0m15:33:50.752041 [info ] [MainThread]: python version: 3.12.1
[0m15:33:50.752743 [info ] [MainThread]: python path: /workspaces/pyspark_practice-/venv/bin/python
[0m15:33:50.753397 [info ] [MainThread]: os info: Linux-6.5.0-1025-azure-x86_64-with-glibc2.31
[0m15:33:50.843467 [info ] [MainThread]: Using profiles dir at /home/codespace/.dbt
[0m15:33:50.844596 [info ] [MainThread]: Using profiles.yml file at /home/codespace/.dbt/profiles.yml
[0m15:33:50.845566 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/pyspark_practice-/nexabrands_dbt/dbt_project.yml
[0m15:33:50.846710 [info ] [MainThread]: adapter type: postgres
[0m15:33:50.847613 [info ] [MainThread]: adapter version: 1.9.0
[0m15:33:51.012983 [info ] [MainThread]: Configuration:
[0m15:33:51.013877 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:33:51.014626 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:33:51.015210 [info ] [MainThread]: Required dependencies:
[0m15:33:51.015848 [debug] [MainThread]: Executing "git --help"
[0m15:33:51.018656 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:33:51.019390 [debug] [MainThread]: STDERR: "b''"
[0m15:33:51.019933 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:33:51.020716 [info ] [MainThread]: Connection:
[0m15:33:51.021493 [info ] [MainThread]:   host: 172.19.0.2
[0m15:33:51.023048 [info ] [MainThread]:   port: 5432
[0m15:33:51.023847 [info ] [MainThread]:   user: root
[0m15:33:51.024617 [info ] [MainThread]:   database: raw
[0m15:33:51.025401 [info ] [MainThread]:   schema: raw
[0m15:33:51.026216 [info ] [MainThread]:   connect_timeout: 10
[0m15:33:51.027002 [info ] [MainThread]:   role: None
[0m15:33:51.028511 [info ] [MainThread]:   search_path: None
[0m15:33:51.029322 [info ] [MainThread]:   keepalives_idle: 0
[0m15:33:51.030110 [info ] [MainThread]:   sslmode: None
[0m15:33:51.030897 [info ] [MainThread]:   sslcert: None
[0m15:33:51.031702 [info ] [MainThread]:   sslkey: None
[0m15:33:51.032484 [info ] [MainThread]:   sslrootcert: None
[0m15:33:51.033876 [info ] [MainThread]:   application_name: dbt
[0m15:33:51.034703 [info ] [MainThread]:   retries: 1
[0m15:33:51.035681 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:33:51.145307 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:33:51.172079 [debug] [MainThread]: Using postgres connection "debug"
[0m15:33:51.172810 [debug] [MainThread]: On debug: select 1 as id
[0m15:33:51.173344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:51.210541 [debug] [MainThread]: SQL status: SELECT 1 in 0.037 seconds
[0m15:33:51.212073 [debug] [MainThread]: On debug: Close
[0m15:33:51.212739 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:33:51.213561 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:33:51.215190 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5672489, "process_in_blocks": "0", "process_kernel_time": 0.30471, "process_mem_max_rss": "103180", "process_out_blocks": "16", "process_user_time": 1.749117}
[0m15:33:51.216042 [debug] [MainThread]: Command `dbt debug` succeeded at 15:33:51.215919 after 0.57 seconds
[0m15:33:51.216584 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:33:51.217149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d79c27b4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d79c3b78bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d79c3ba7c80>]}
[0m15:33:51.217766 [debug] [MainThread]: Flushing usage events
[0m15:33:52.008858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:53:45.290197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d98d5eeff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d98e1bede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d98d1bd9d0>]}


============================== 15:53:45.295944 | a94d4fd3-7a09-49a2-b96a-6fc5a867761c ==============================
[0m15:53:45.295944 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:53:45.297172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:53:45.318483 [info ] [MainThread]: dbt version: 1.9.1
[0m15:53:45.319571 [info ] [MainThread]: python version: 3.12.1
[0m15:53:45.320508 [info ] [MainThread]: python path: /workspaces/pyspark_practice-/venv/bin/python
[0m15:53:45.321445 [info ] [MainThread]: os info: Linux-6.5.0-1025-azure-x86_64-with-glibc2.31
[0m15:53:45.468044 [info ] [MainThread]: Using profiles dir at /home/codespace/.dbt
[0m15:53:45.468885 [info ] [MainThread]: Using profiles.yml file at /home/codespace/.dbt/profiles.yml
[0m15:53:45.469501 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/pyspark_practice-/nexabrands_dbt/dbt_project.yml
[0m15:53:45.470368 [info ] [MainThread]: adapter type: postgres
[0m15:53:45.470975 [info ] [MainThread]: adapter version: 1.9.0
[0m15:53:45.582906 [info ] [MainThread]: Configuration:
[0m15:53:45.583631 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:53:45.584234 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:53:45.584792 [info ] [MainThread]: Required dependencies:
[0m15:53:45.585368 [debug] [MainThread]: Executing "git --help"
[0m15:53:45.587990 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:53:45.588540 [debug] [MainThread]: STDERR: "b''"
[0m15:53:45.589042 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:53:45.589723 [info ] [MainThread]: Connection:
[0m15:53:45.590456 [info ] [MainThread]:   host: 172.19.0.2
[0m15:53:45.591425 [info ] [MainThread]:   port: 5432
[0m15:53:45.592098 [info ] [MainThread]:   user: root
[0m15:53:45.592674 [info ] [MainThread]:   database: raw
[0m15:53:45.593212 [info ] [MainThread]:   schema: raw
[0m15:53:45.593757 [info ] [MainThread]:   connect_timeout: 10
[0m15:53:45.594331 [info ] [MainThread]:   role: None
[0m15:53:45.594955 [info ] [MainThread]:   search_path: None
[0m15:53:45.595565 [info ] [MainThread]:   keepalives_idle: 0
[0m15:53:45.596160 [info ] [MainThread]:   sslmode: None
[0m15:53:45.597282 [info ] [MainThread]:   sslcert: None
[0m15:53:45.598019 [info ] [MainThread]:   sslkey: None
[0m15:53:45.598641 [info ] [MainThread]:   sslrootcert: None
[0m15:53:45.599547 [info ] [MainThread]:   application_name: dbt
[0m15:53:45.600231 [info ] [MainThread]:   retries: 1
[0m15:53:45.601050 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:53:45.704918 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:53:45.732310 [debug] [MainThread]: Using postgres connection "debug"
[0m15:53:45.732970 [debug] [MainThread]: On debug: select 1 as id
[0m15:53:45.733525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:53:45.737806 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m15:53:45.739010 [debug] [MainThread]: On debug: Close
[0m15:53:45.739959 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:53:45.741028 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:53:45.742707 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5994833, "process_in_blocks": "0", "process_kernel_time": 0.241337, "process_mem_max_rss": "103060", "process_out_blocks": "24", "process_user_time": 1.798354}
[0m15:53:45.743331 [debug] [MainThread]: Command `dbt debug` succeeded at 15:53:45.743193 after 0.60 seconds
[0m15:53:45.743828 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:53:45.744389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d98d21c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d98d48a3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d98cfc34d0>]}
[0m15:53:45.744986 [debug] [MainThread]: Flushing usage events
[0m15:53:46.564916 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:53:52.166287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ca14ef290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ca04e59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ca07483b0>]}


============================== 15:53:52.169783 | bce34c9a-e035-4737-8cc2-c9a7da78299b ==============================
[0m15:53:52.169783 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:53:52.170755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:53:52.359932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bce34c9a-e035-4737-8cc2-c9a7da78299b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c9ff7e270>]}
[0m15:53:52.477216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bce34c9a-e035-4737-8cc2-c9a7da78299b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c9faeb0b0>]}
[0m15:53:52.479075 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:53:52.615485 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:53:52.616413 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:53:52.616993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bce34c9a-e035-4737-8cc2-c9a7da78299b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ca052fc20>]}
[0m15:53:53.745330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bce34c9a-e035-4737-8cc2-c9a7da78299b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c9f1c0290>]}
[0m15:53:53.802457 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:53:53.805288 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:53:53.820824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bce34c9a-e035-4737-8cc2-c9a7da78299b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c9dd0e990>]}
[0m15:53:53.821548 [info ] [MainThread]: Found 6 models, 431 macros
[0m15:53:53.822257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bce34c9a-e035-4737-8cc2-c9a7da78299b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c9e594530>]}
[0m15:53:53.824067 [info ] [MainThread]: 
[0m15:53:53.824735 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:53:53.825337 [info ] [MainThread]: 
[0m15:53:53.826190 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:53:53.827385 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:53:53.864813 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:53:53.865436 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:53:53.865969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:53.870367 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m15:53:53.871792 [debug] [ThreadPool]: On list_raw: Close
[0m15:53:53.877145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:53:53.883834 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:53:53.884410 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:53:53.884943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:53.889200 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:53:53.890460 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:53:53.891280 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:53:53.899549 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m15:53:53.902055 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:53:53.902985 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:53:53.909792 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:53.910389 [debug] [MainThread]: On master: BEGIN
[0m15:53:53.910908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:53:53.914018 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:53:53.915174 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:53.915792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:53:53.929352 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m15:53:53.930911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bce34c9a-e035-4737-8cc2-c9a7da78299b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c9ddb9460>]}
[0m15:53:53.931628 [debug] [MainThread]: On master: ROLLBACK
[0m15:53:53.932300 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:53.932858 [debug] [MainThread]: On master: BEGIN
[0m15:53:53.934269 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:53:53.934821 [debug] [MainThread]: On master: COMMIT
[0m15:53:53.935304 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:53.936029 [debug] [MainThread]: On master: COMMIT
[0m15:53:53.936618 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:53:53.937104 [debug] [MainThread]: On master: Close
[0m15:53:53.940495 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m15:53:53.941622 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m15:53:53.942792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m15:53:53.943439 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m15:53:53.951214 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:53:53.952327 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m15:53:53.988727 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:53:53.989822 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:53:53.990415 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m15:53:53.990954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:53.994968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:53:53.995573 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:53:53.996163 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
 SELECT
 *
 FROM
  raw.raw.customer_targets
)
SELECT
 customer_id,
 ontime_targets%,
 infull_target%,
 OTIF_target%
FROM
 customer_targets
  );
[0m15:53:54.000224 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 15:  ontime_targets%,
                         ^

[0m15:53:54.002052 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: ROLLBACK
[0m15:53:54.003222 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m15:53:54.022246 [debug] [Thread-1 (]: Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql
[0m15:53:54.026665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bce34c9a-e035-4737-8cc2-c9a7da78299b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740c9e5b4e00>]}
[0m15:53:54.029715 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.stg_customer_targets .................. [[31mERROR[0m in 0.08s]
[0m15:53:54.031073 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m15:53:54.035164 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.stg_customer_targets' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql.
[0m15:53:54.043273 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:54.044132 [debug] [MainThread]: On master: BEGIN
[0m15:53:54.044937 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:53:54.051528 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:53:54.052919 [debug] [MainThread]: On master: COMMIT
[0m15:53:54.053822 [debug] [MainThread]: Using postgres connection "master"
[0m15:53:54.054761 [debug] [MainThread]: On master: COMMIT
[0m15:53:54.055904 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:53:54.056483 [debug] [MainThread]: On master: Close
[0m15:53:54.057184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:54.057856 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m15:53:54.058579 [info ] [MainThread]: 
[0m15:53:54.059312 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m15:53:54.060386 [debug] [MainThread]: Command end result
[0m15:53:54.137534 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:53:54.139511 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:53:54.145539 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:53:54.146074 [info ] [MainThread]: 
[0m15:53:54.146840 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:53:54.147456 [info ] [MainThread]: 
[0m15:53:54.148132 [error] [MainThread]:   Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql
[0m15:53:54.148704 [info ] [MainThread]: 
[0m15:53:54.149329 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:53:54.150587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0410464, "process_in_blocks": "560", "process_kernel_time": 0.314632, "process_mem_max_rss": "116332", "process_out_blocks": "2576", "process_user_time": 3.032267}
[0m15:53:54.151253 [debug] [MainThread]: Command `dbt run` failed at 15:53:54.151134 after 2.04 seconds
[0m15:53:54.151869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ca14ef290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ca068f500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ca068fb90>]}
[0m15:53:54.152589 [debug] [MainThread]: Flushing usage events
[0m15:53:54.926009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:54:13.557109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1bf0186e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1bf1ab4320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1bf0185880>]}


============================== 15:54:13.560670 | 706538f5-a3c3-4b45-bff3-7113ba0ef5de ==============================
[0m15:54:13.560670 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:54:13.561505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:54:13.784368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '706538f5-a3c3-4b45-bff3-7113ba0ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1bf1968830>]}
[0m15:54:13.878779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '706538f5-a3c3-4b45-bff3-7113ba0ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1bf01e8680>]}
[0m15:54:13.879860 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:54:14.024782 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:54:14.101559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:54:14.102224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:54:14.127473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '706538f5-a3c3-4b45-bff3-7113ba0ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1bf05cfcb0>]}
[0m15:54:14.211640 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:54:14.214797 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:54:14.229287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '706538f5-a3c3-4b45-bff3-7113ba0ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1bee5c4980>]}
[0m15:54:14.229950 [info ] [MainThread]: Found 6 models, 431 macros
[0m15:54:14.230578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '706538f5-a3c3-4b45-bff3-7113ba0ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1bef5c6a20>]}
[0m15:54:14.232767 [info ] [MainThread]: 
[0m15:54:14.233341 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:54:14.233945 [info ] [MainThread]: 
[0m15:54:14.234877 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:54:14.236281 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:54:14.280156 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:54:14.280841 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:54:14.281418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:14.285746 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m15:54:14.287221 [debug] [ThreadPool]: On list_raw: Close
[0m15:54:14.295370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:54:14.301612 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:54:14.302229 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:54:14.302751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:14.306015 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:54:14.306910 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:54:14.307823 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:54:14.311731 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m15:54:14.314034 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:54:14.314734 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:54:14.321252 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:14.321831 [debug] [MainThread]: On master: BEGIN
[0m15:54:14.322338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:54:14.325644 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:54:14.326545 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:14.327587 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:54:14.338763 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:54:14.340212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '706538f5-a3c3-4b45-bff3-7113ba0ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1becd3c6e0>]}
[0m15:54:14.340853 [debug] [MainThread]: On master: ROLLBACK
[0m15:54:14.341454 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:14.341926 [debug] [MainThread]: On master: BEGIN
[0m15:54:14.342796 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:54:14.343519 [debug] [MainThread]: On master: COMMIT
[0m15:54:14.344233 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:14.344948 [debug] [MainThread]: On master: COMMIT
[0m15:54:14.345754 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:54:14.346316 [debug] [MainThread]: On master: Close
[0m15:54:14.349540 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m15:54:14.350448 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m15:54:14.351451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m15:54:14.352304 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m15:54:14.362035 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:54:14.362875 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m15:54:14.400677 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:54:14.401588 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:54:14.402205 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m15:54:14.402775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:14.406376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:54:14.407210 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:54:14.408077 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
 SELECT
 *
 FROM
  raw.raw.customer_targets
)
SELECT
 customer_id,
 ontime_targets%,
 infull_target%,
 OTIF_target%
FROM
 customer_targets
  );
[0m15:54:14.410143 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 15:  ontime_targets%,
                         ^

[0m15:54:14.411582 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: ROLLBACK
[0m15:54:14.415349 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m15:54:14.425956 [debug] [Thread-1 (]: Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql
[0m15:54:14.430447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '706538f5-a3c3-4b45-bff3-7113ba0ef5de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1bef5f7da0>]}
[0m15:54:14.432099 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.stg_customer_targets .................. [[31mERROR[0m in 0.08s]
[0m15:54:14.433740 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m15:54:14.435050 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.stg_customer_targets' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql.
[0m15:54:14.438848 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:14.439684 [debug] [MainThread]: On master: BEGIN
[0m15:54:14.440484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:54:14.445208 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:54:14.446764 [debug] [MainThread]: On master: COMMIT
[0m15:54:14.447582 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:14.448374 [debug] [MainThread]: On master: COMMIT
[0m15:54:14.449290 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:54:14.450100 [debug] [MainThread]: On master: Close
[0m15:54:14.452812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:14.453494 [debug] [MainThread]: Connection 'list_raw' was properly closed.
[0m15:54:14.454142 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m15:54:14.455234 [info ] [MainThread]: 
[0m15:54:14.456028 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m15:54:14.457303 [debug] [MainThread]: Command end result
[0m15:54:14.484089 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:54:14.486015 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:54:14.493254 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:54:14.493818 [info ] [MainThread]: 
[0m15:54:14.494528 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:54:14.495141 [info ] [MainThread]: 
[0m15:54:14.495803 [error] [MainThread]:   Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql
[0m15:54:14.496380 [info ] [MainThread]: 
[0m15:54:14.496983 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:54:14.498245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.99816287, "process_in_blocks": "8", "process_kernel_time": 0.335362, "process_mem_max_rss": "110640", "process_out_blocks": "1744", "process_user_time": 2.169991}
[0m15:54:14.499060 [debug] [MainThread]: Command `dbt run` failed at 15:54:14.498940 after 1.00 seconds
[0m15:54:14.499695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1befd517f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1bf19e9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1befbbf8c0>]}
[0m15:54:14.500735 [debug] [MainThread]: Flushing usage events
[0m15:54:15.300002 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:54:52.864814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb52ba7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb52d0c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb516ff530>]}


============================== 15:54:52.868241 | 143c9363-d19b-4d9b-b79b-e20212cb1516 ==============================
[0m15:54:52.868241 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:54:52.869187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:54:53.083689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '143c9363-d19b-4d9b-b79b-e20212cb1516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb519208c0>]}
[0m15:54:53.190078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '143c9363-d19b-4d9b-b79b-e20212cb1516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb513aecf0>]}
[0m15:54:53.191176 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:54:53.302862 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:54:53.385905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:54:53.386545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:54:53.413326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '143c9363-d19b-4d9b-b79b-e20212cb1516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb505dd040>]}
[0m15:54:53.475975 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:54:53.480318 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:54:53.494331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '143c9363-d19b-4d9b-b79b-e20212cb1516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb50dca060>]}
[0m15:54:53.495085 [info ] [MainThread]: Found 6 models, 431 macros
[0m15:54:53.495746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '143c9363-d19b-4d9b-b79b-e20212cb1516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb5011f7d0>]}
[0m15:54:53.497654 [info ] [MainThread]: 
[0m15:54:53.498327 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:54:53.498913 [info ] [MainThread]: 
[0m15:54:53.499709 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:54:53.501126 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:54:53.537570 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:54:53.538356 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:54:53.538944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:53.543286 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m15:54:53.544745 [debug] [ThreadPool]: On list_raw: Close
[0m15:54:53.550967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:54:53.557179 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:54:53.557741 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:54:53.558287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:53.561358 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:54:53.562241 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:54:53.563143 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:54:53.566580 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m15:54:53.568325 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:54:53.568921 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:54:53.576405 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:53.576987 [debug] [MainThread]: On master: BEGIN
[0m15:54:53.577465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:54:53.580761 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:54:53.581550 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:53.582524 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:54:53.593504 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:54:53.594952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '143c9363-d19b-4d9b-b79b-e20212cb1516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb50cf08f0>]}
[0m15:54:53.595882 [debug] [MainThread]: On master: ROLLBACK
[0m15:54:53.596808 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:53.597611 [debug] [MainThread]: On master: BEGIN
[0m15:54:53.598638 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:54:53.599429 [debug] [MainThread]: On master: COMMIT
[0m15:54:53.602116 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:53.602884 [debug] [MainThread]: On master: COMMIT
[0m15:54:53.603774 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:54:53.604608 [debug] [MainThread]: On master: Close
[0m15:54:53.612232 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m15:54:53.613240 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m15:54:53.614356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m15:54:53.615132 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m15:54:53.628875 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:54:53.630260 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m15:54:53.693302 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:54:53.694431 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:54:53.695074 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m15:54:53.695670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:53.699789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:54:53.700401 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:54:53.701053 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
 SELECT
 *
 FROM
  raw.raw.customer_targets
)
SELECT
 customer_id,
 ontime_targets%,
 infull_target%,
 OTIF_target%
FROM
 customer_targets
  );
[0m15:54:53.708980 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 15:  ontime_targets%,
                         ^

[0m15:54:53.711640 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: ROLLBACK
[0m15:54:53.713277 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m15:54:53.724182 [debug] [Thread-1 (]: Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql
[0m15:54:53.728711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '143c9363-d19b-4d9b-b79b-e20212cb1516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb505dcda0>]}
[0m15:54:53.731197 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.stg_customer_targets .................. [[31mERROR[0m in 0.11s]
[0m15:54:53.733179 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m15:54:53.734497 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.stg_customer_targets' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql.
[0m15:54:53.738028 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:53.738951 [debug] [MainThread]: On master: BEGIN
[0m15:54:53.739855 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:54:53.747148 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:54:53.748057 [debug] [MainThread]: On master: COMMIT
[0m15:54:53.749121 [debug] [MainThread]: Using postgres connection "master"
[0m15:54:53.750618 [debug] [MainThread]: On master: COMMIT
[0m15:54:53.751976 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:54:53.754698 [debug] [MainThread]: On master: Close
[0m15:54:53.755614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:53.756516 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m15:54:53.757293 [info ] [MainThread]: 
[0m15:54:53.758360 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m15:54:53.760210 [debug] [MainThread]: Command end result
[0m15:54:53.786795 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:54:53.788755 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:54:53.794853 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:54:53.795394 [info ] [MainThread]: 
[0m15:54:53.796106 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:54:53.796726 [info ] [MainThread]: 
[0m15:54:53.797407 [error] [MainThread]:   Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql
[0m15:54:53.797992 [info ] [MainThread]: 
[0m15:54:53.798651 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:54:53.799859 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.99215984, "process_in_blocks": "16", "process_kernel_time": 0.24804, "process_mem_max_rss": "111364", "process_out_blocks": "1752", "process_user_time": 2.112344}
[0m15:54:53.800513 [debug] [MainThread]: Command `dbt run` failed at 15:54:53.800399 after 0.99 seconds
[0m15:54:53.801148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb510c8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb510c9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb5463bb30>]}
[0m15:54:53.801810 [debug] [MainThread]: Flushing usage events
[0m15:54:54.581310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:05.719049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c9bbb4bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c9bbaa9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c9bb31a060>]}


============================== 15:55:05.722581 | e52ae58a-431a-4e60-9cf9-15fbdcbd0df2 ==============================
[0m15:55:05.722581 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:55:05.723383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:55:05.917047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e52ae58a-431a-4e60-9cf9-15fbdcbd0df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c9b9b80aa0>]}
[0m15:55:05.982617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e52ae58a-431a-4e60-9cf9-15fbdcbd0df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c9b9bcfb30>]}
[0m15:55:05.983619 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:55:06.143794 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:55:06.234455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:55:06.235293 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/src/stg_customer_targets.sql
[0m15:55:06.501432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e52ae58a-431a-4e60-9cf9-15fbdcbd0df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c9b7fff500>]}
[0m15:55:06.595058 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:55:06.598094 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:55:06.610329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e52ae58a-431a-4e60-9cf9-15fbdcbd0df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c9b7ff3800>]}
[0m15:55:06.610939 [info ] [MainThread]: Found 6 models, 431 macros
[0m15:55:06.611509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e52ae58a-431a-4e60-9cf9-15fbdcbd0df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c9b83f9400>]}
[0m15:55:06.613340 [info ] [MainThread]: 
[0m15:55:06.613903 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:55:06.614484 [info ] [MainThread]: 
[0m15:55:06.615256 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:06.616287 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:55:06.654304 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:55:06.654983 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:55:06.655524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:06.659994 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m15:55:06.661440 [debug] [ThreadPool]: On list_raw: Close
[0m15:55:06.666679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:55:06.672714 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:55:06.673203 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:55:06.673693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:06.676746 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:55:06.677932 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:55:06.678492 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:55:06.681059 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m15:55:06.682856 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:55:06.683942 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:55:06.690983 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:06.691561 [debug] [MainThread]: On master: BEGIN
[0m15:55:06.692022 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:06.695101 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:55:06.696038 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:06.697124 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:55:06.708406 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:55:06.709781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e52ae58a-431a-4e60-9cf9-15fbdcbd0df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c9b66ccf80>]}
[0m15:55:06.710478 [debug] [MainThread]: On master: ROLLBACK
[0m15:55:06.711127 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:06.711670 [debug] [MainThread]: On master: BEGIN
[0m15:55:06.712535 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:55:06.713553 [debug] [MainThread]: On master: COMMIT
[0m15:55:06.714638 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:06.715405 [debug] [MainThread]: On master: COMMIT
[0m15:55:06.716014 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:55:06.716487 [debug] [MainThread]: On master: Close
[0m15:55:06.719776 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m15:55:06.721117 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m15:55:06.722015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m15:55:06.722641 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m15:55:06.730595 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:55:06.731792 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m15:55:06.768373 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:55:06.769418 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:55:06.770028 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m15:55:06.770660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:06.774460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:55:06.775574 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:55:06.776725 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
 SELECT
 *
 FROM
  raw.raw.customer_targets
)
SELECT
 customer_id,
 ontime_targets%,
 infull_target%,
 OTIF_target%,
FROM
 customer_targets
  );
[0m15:55:06.778286 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 15:  ontime_targets%,
                         ^

[0m15:55:06.779617 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: ROLLBACK
[0m15:55:06.786521 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m15:55:06.803286 [debug] [Thread-1 (]: Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql
[0m15:55:06.814989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e52ae58a-431a-4e60-9cf9-15fbdcbd0df2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c9b6545790>]}
[0m15:55:06.816267 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.stg_customer_targets .................. [[31mERROR[0m in 0.08s]
[0m15:55:06.817970 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m15:55:06.819107 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.stg_customer_targets' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql.
[0m15:55:06.821513 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:06.822095 [debug] [MainThread]: On master: BEGIN
[0m15:55:06.822715 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:06.826997 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:55:06.827958 [debug] [MainThread]: On master: COMMIT
[0m15:55:06.828547 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:06.829040 [debug] [MainThread]: On master: COMMIT
[0m15:55:06.829693 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:55:06.830224 [debug] [MainThread]: On master: Close
[0m15:55:06.831031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:06.831802 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m15:55:06.832610 [info ] [MainThread]: 
[0m15:55:06.833504 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m15:55:06.834602 [debug] [MainThread]: Command end result
[0m15:55:06.864289 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:55:06.866129 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:55:06.872284 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:55:06.872791 [info ] [MainThread]: 
[0m15:55:06.873579 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:55:06.874308 [info ] [MainThread]: 
[0m15:55:06.875018 [error] [MainThread]:   Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql
[0m15:55:06.875630 [info ] [MainThread]: 
[0m15:55:06.876274 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:55:06.877558 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2151675, "process_in_blocks": "8", "process_kernel_time": 0.327757, "process_mem_max_rss": "116408", "process_out_blocks": "2584", "process_user_time": 2.317996}
[0m15:55:06.878207 [debug] [MainThread]: Command `dbt run` failed at 15:55:06.878028 after 1.22 seconds
[0m15:55:06.878946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c9ba852120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c9ba851850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c9b9b80da0>]}
[0m15:55:06.879516 [debug] [MainThread]: Flushing usage events
[0m15:55:07.632789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:55:26.444905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177cf6c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177b225be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177b5fade0>]}


============================== 15:55:26.448353 | 1c73320c-f3ac-4287-93f5-43a80517e800 ==============================
[0m15:55:26.448353 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:55:26.449288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:55:26.651531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c73320c-f3ac-4287-93f5-43a80517e800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177aeeaf30>]}
[0m15:55:26.715193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c73320c-f3ac-4287-93f5-43a80517e800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177b5fade0>]}
[0m15:55:26.716331 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:55:26.825672 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:55:26.902601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:55:26.903455 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/src/stg_customer_targets.sql
[0m15:55:27.151069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c73320c-f3ac-4287-93f5-43a80517e800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731779303320>]}
[0m15:55:27.207739 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:55:27.210682 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:55:27.223072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c73320c-f3ac-4287-93f5-43a80517e800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731778f2aa20>]}
[0m15:55:27.223718 [info ] [MainThread]: Found 6 models, 431 macros
[0m15:55:27.224398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c73320c-f3ac-4287-93f5-43a80517e800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731779302420>]}
[0m15:55:27.226264 [info ] [MainThread]: 
[0m15:55:27.226942 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:55:27.227547 [info ] [MainThread]: 
[0m15:55:27.228362 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:27.229827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:55:27.265526 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:55:27.266227 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:55:27.266872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:27.271312 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m15:55:27.272763 [debug] [ThreadPool]: On list_raw: Close
[0m15:55:27.278041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:55:27.284433 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:55:27.284936 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:55:27.285617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:27.289546 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:55:27.290124 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:55:27.290717 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:55:27.293371 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m15:55:27.295098 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:55:27.295752 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:55:27.304660 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:27.305221 [debug] [MainThread]: On master: BEGIN
[0m15:55:27.305687 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:27.308810 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:55:27.310177 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:27.311080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:55:27.322092 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:55:27.323452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c73320c-f3ac-4287-93f5-43a80517e800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731778f2baa0>]}
[0m15:55:27.324081 [debug] [MainThread]: On master: ROLLBACK
[0m15:55:27.324717 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:27.325192 [debug] [MainThread]: On master: BEGIN
[0m15:55:27.326089 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:55:27.327116 [debug] [MainThread]: On master: COMMIT
[0m15:55:27.327823 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:27.328334 [debug] [MainThread]: On master: COMMIT
[0m15:55:27.328966 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:55:27.329505 [debug] [MainThread]: On master: Close
[0m15:55:27.332032 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m15:55:27.333036 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m15:55:27.333874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m15:55:27.334573 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m15:55:27.343189 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:55:27.344098 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m15:55:27.381111 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:55:27.382225 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:55:27.382882 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m15:55:27.383462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:55:27.387227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:55:27.388197 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:55:27.389132 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
 SELECT
 *
 FROM
  raw.raw.customer_targets
)
SELECT
 customer_id,
 ontime_targets%,
 infull_target%,
 OTIF_target%
FROM
 customer_targets
  );
[0m15:55:27.390688 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 15:  ontime_targets%,
                         ^

[0m15:55:27.391639 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: ROLLBACK
[0m15:55:27.394558 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m15:55:27.414557 [debug] [Thread-1 (]: Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql
[0m15:55:27.418295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c73320c-f3ac-4287-93f5-43a80517e800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7317793019d0>]}
[0m15:55:27.421226 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.stg_customer_targets .................. [[31mERROR[0m in 0.08s]
[0m15:55:27.422635 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m15:55:27.423951 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.stg_customer_targets' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql.
[0m15:55:27.429371 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:27.430113 [debug] [MainThread]: On master: BEGIN
[0m15:55:27.430830 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:27.436630 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:55:27.437350 [debug] [MainThread]: On master: COMMIT
[0m15:55:27.438074 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:27.439504 [debug] [MainThread]: On master: COMMIT
[0m15:55:27.440461 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:55:27.441170 [debug] [MainThread]: On master: Close
[0m15:55:27.444409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:27.445044 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m15:55:27.446928 [info ] [MainThread]: 
[0m15:55:27.447689 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m15:55:27.448979 [debug] [MainThread]: Command end result
[0m15:55:27.494113 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:55:27.495987 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:55:27.502208 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:55:27.502885 [info ] [MainThread]: 
[0m15:55:27.503529 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:55:27.504130 [info ] [MainThread]: 
[0m15:55:27.504866 [error] [MainThread]:   Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql
[0m15:55:27.505408 [info ] [MainThread]: 
[0m15:55:27.506063 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:55:27.507350 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.121935, "process_in_blocks": "0", "process_kernel_time": 0.219842, "process_mem_max_rss": "115208", "process_out_blocks": "2592", "process_user_time": 2.284896}
[0m15:55:27.507975 [debug] [MainThread]: Command `dbt run` failed at 15:55:27.507810 after 1.12 seconds
[0m15:55:27.508624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177b022330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177b0edbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73177b968530>]}
[0m15:55:27.509281 [debug] [MainThread]: Flushing usage events
[0m15:55:28.266957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:56:02.731934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b935c73f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b935e4769c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b935ca9e600>]}


============================== 15:56:02.735518 | 305afb2e-512e-4b97-902a-9cb1a40ef8e3 ==============================
[0m15:56:02.735518 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:56:02.736355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:56:02.916757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '305afb2e-512e-4b97-902a-9cb1a40ef8e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b935c25eff0>]}
[0m15:56:02.981957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '305afb2e-512e-4b97-902a-9cb1a40ef8e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b935c33c800>]}
[0m15:56:02.983107 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:56:03.122414 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:56:03.203602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:56:03.204482 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/src/stg_customer_targets.sql
[0m15:56:03.473923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '305afb2e-512e-4b97-902a-9cb1a40ef8e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b935a7fef00>]}
[0m15:56:03.532089 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:56:03.535194 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:56:03.547657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '305afb2e-512e-4b97-902a-9cb1a40ef8e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b935a7f6a50>]}
[0m15:56:03.548313 [info ] [MainThread]: Found 6 models, 431 macros
[0m15:56:03.548956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '305afb2e-512e-4b97-902a-9cb1a40ef8e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b935abe0e60>]}
[0m15:56:03.550839 [info ] [MainThread]: 
[0m15:56:03.551476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:56:03.552051 [info ] [MainThread]: 
[0m15:56:03.552817 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:56:03.553971 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:56:03.590340 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:56:03.591005 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:56:03.591551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:03.596065 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m15:56:03.597494 [debug] [ThreadPool]: On list_raw: Close
[0m15:56:03.603011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:56:03.609150 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:56:03.609710 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:56:03.610253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:03.614444 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:56:03.615299 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:56:03.615838 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:56:03.618522 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.002 seconds
[0m15:56:03.620293 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:56:03.621222 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:56:03.627796 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:03.628309 [debug] [MainThread]: On master: BEGIN
[0m15:56:03.628803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:03.632067 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:56:03.633458 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:03.634587 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:56:03.645788 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:56:03.647350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '305afb2e-512e-4b97-902a-9cb1a40ef8e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9358ed1010>]}
[0m15:56:03.648016 [debug] [MainThread]: On master: ROLLBACK
[0m15:56:03.648645 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:03.649135 [debug] [MainThread]: On master: BEGIN
[0m15:56:03.649853 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:56:03.650591 [debug] [MainThread]: On master: COMMIT
[0m15:56:03.651309 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:03.652006 [debug] [MainThread]: On master: COMMIT
[0m15:56:03.652831 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:56:03.653541 [debug] [MainThread]: On master: Close
[0m15:56:03.657035 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m15:56:03.658051 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m15:56:03.658992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m15:56:03.659795 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m15:56:03.668141 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:56:03.668945 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m15:56:03.704686 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:56:03.705627 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:56:03.706238 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m15:56:03.706792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:03.710463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:56:03.711475 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:56:03.712565 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
 SELECT
 *
 FROM
  raw.raw.customer_targets
)
SELECT
 customer_id,
 ontime_targets%,
 infull_target%,
 otif_target%
FROM
 customer_targets
  );
[0m15:56:03.713767 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 15:  ontime_targets%,
                         ^

[0m15:56:03.714756 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: ROLLBACK
[0m15:56:03.728657 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m15:56:03.743375 [debug] [Thread-1 (]: Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql
[0m15:56:03.747977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '305afb2e-512e-4b97-902a-9cb1a40ef8e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9358d44170>]}
[0m15:56:03.749415 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.stg_customer_targets .................. [[31mERROR[0m in 0.09s]
[0m15:56:03.751438 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m15:56:03.752613 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.stg_customer_targets' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql.
[0m15:56:03.755778 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:03.756468 [debug] [MainThread]: On master: BEGIN
[0m15:56:03.757129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:56:03.765602 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:56:03.766428 [debug] [MainThread]: On master: COMMIT
[0m15:56:03.767201 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:03.767935 [debug] [MainThread]: On master: COMMIT
[0m15:56:03.768560 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:56:03.769124 [debug] [MainThread]: On master: Close
[0m15:56:03.769823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:03.770586 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m15:56:03.771267 [info ] [MainThread]: 
[0m15:56:03.772096 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m15:56:03.773198 [debug] [MainThread]: Command end result
[0m15:56:03.803207 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:56:03.805940 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:56:03.816002 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:56:03.816813 [info ] [MainThread]: 
[0m15:56:03.817894 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:56:03.818819 [info ] [MainThread]: 
[0m15:56:03.819794 [error] [MainThread]:   Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  syntax error at or near ","
  LINE 15:  ontime_targets%,
                           ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql
[0m15:56:03.820833 [info ] [MainThread]: 
[0m15:56:03.821704 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:56:03.823854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1488023, "process_in_blocks": "0", "process_kernel_time": 0.300202, "process_mem_max_rss": "116284", "process_out_blocks": "2584", "process_user_time": 2.330518}
[0m15:56:03.827056 [debug] [MainThread]: Command `dbt run` failed at 15:56:03.826885 after 1.15 seconds
[0m15:56:03.827911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b935c7e9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b935c7ea5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b935c46cc20>]}
[0m15:56:03.828775 [debug] [MainThread]: Flushing usage events
[0m15:56:04.600113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:07.822492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc043027fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc042d5c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc0439d5340>]}


============================== 15:57:07.826094 | 82a8605f-079b-4335-9915-c2c0b354c876 ==============================
[0m15:57:07.826094 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:57:07.827002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:08.001951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82a8605f-079b-4335-9915-c2c0b354c876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc042a55f40>]}
[0m15:57:08.065997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82a8605f-079b-4335-9915-c2c0b354c876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc043664fb0>]}
[0m15:57:08.067226 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:57:08.175751 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:57:08.254939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:08.255777 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/src/stg_customer_targets.sql
[0m15:57:08.533412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82a8605f-079b-4335-9915-c2c0b354c876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc040fff1a0>]}
[0m15:57:08.592369 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:57:08.595668 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:57:08.608795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82a8605f-079b-4335-9915-c2c0b354c876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc040ff74d0>]}
[0m15:57:08.609684 [info ] [MainThread]: Found 6 models, 431 macros
[0m15:57:08.610335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a8605f-079b-4335-9915-c2c0b354c876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc040b260c0>]}
[0m15:57:08.612544 [info ] [MainThread]: 
[0m15:57:08.613181 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:57:08.613769 [info ] [MainThread]: 
[0m15:57:08.614609 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:57:08.615792 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:57:08.651149 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:57:08.651749 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:57:08.652290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:08.656625 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m15:57:08.658011 [debug] [ThreadPool]: On list_raw: Close
[0m15:57:08.663430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:57:08.669354 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:57:08.669923 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:57:08.670492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:08.674329 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:57:08.675116 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:57:08.676441 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:57:08.680451 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m15:57:08.683947 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:57:08.684804 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:57:08.697020 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:08.697881 [debug] [MainThread]: On master: BEGIN
[0m15:57:08.698718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:08.703966 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:57:08.704832 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:08.705891 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:57:08.728559 [debug] [MainThread]: SQL status: SELECT 0 in 0.021 seconds
[0m15:57:08.731687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82a8605f-079b-4335-9915-c2c0b354c876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc03f6b8500>]}
[0m15:57:08.732619 [debug] [MainThread]: On master: ROLLBACK
[0m15:57:08.733286 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:08.733846 [debug] [MainThread]: On master: BEGIN
[0m15:57:08.735319 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:57:08.735904 [debug] [MainThread]: On master: COMMIT
[0m15:57:08.736465 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:08.737003 [debug] [MainThread]: On master: COMMIT
[0m15:57:08.737657 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:57:08.738242 [debug] [MainThread]: On master: Close
[0m15:57:08.742424 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m15:57:08.743357 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m15:57:08.744063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m15:57:08.744618 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m15:57:08.752405 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:57:08.753182 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m15:57:08.789211 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:57:08.790204 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:57:08.790793 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m15:57:08.791355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:08.795528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:57:08.796096 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:57:08.796685 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_targets%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m15:57:08.804960 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "ontime_targets%" does not exist
LINE 14:     "ontime_targets%" as ontime_target,
             ^
HINT:  Perhaps you meant to reference the column "customer_targets.ontime_target%".

[0m15:57:08.807681 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: ROLLBACK
[0m15:57:08.820792 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m15:57:08.826441 [debug] [Thread-1 (]: Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  column "ontime_targets%" does not exist
  LINE 14:     "ontime_targets%" as ontime_target,
               ^
  HINT:  Perhaps you meant to reference the column "customer_targets.ontime_target%".
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql
[0m15:57:08.828611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82a8605f-079b-4335-9915-c2c0b354c876', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc03f540860>]}
[0m15:57:08.829486 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.stg_customer_targets .................. [[31mERROR[0m in 0.08s]
[0m15:57:08.830444 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m15:57:08.831226 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.stg_customer_targets' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  column "ontime_targets%" does not exist
  LINE 14:     "ontime_targets%" as ontime_target,
               ^
  HINT:  Perhaps you meant to reference the column "customer_targets.ontime_target%".
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql.
[0m15:57:08.833430 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:08.833917 [debug] [MainThread]: On master: BEGIN
[0m15:57:08.834460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:08.838817 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:57:08.839811 [debug] [MainThread]: On master: COMMIT
[0m15:57:08.840355 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:08.840866 [debug] [MainThread]: On master: COMMIT
[0m15:57:08.841471 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:57:08.842014 [debug] [MainThread]: On master: Close
[0m15:57:08.842857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:08.843639 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m15:57:08.844435 [info ] [MainThread]: 
[0m15:57:08.845263 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m15:57:08.847138 [debug] [MainThread]: Command end result
[0m15:57:08.872050 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:57:08.874057 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:57:08.880452 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:57:08.880992 [info ] [MainThread]: 
[0m15:57:08.881729 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:57:08.883020 [info ] [MainThread]: 
[0m15:57:08.883741 [error] [MainThread]:   Database Error in model stg_customer_targets (models/src/stg_customer_targets.sql)
  column "ontime_targets%" does not exist
  LINE 14:     "ontime_targets%" as ontime_target,
               ^
  HINT:  Perhaps you meant to reference the column "customer_targets.ontime_target%".
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer_targets.sql
[0m15:57:08.884361 [info ] [MainThread]: 
[0m15:57:08.885356 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:57:08.886872 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1222277, "process_in_blocks": "0", "process_kernel_time": 0.288041, "process_mem_max_rss": "114816", "process_out_blocks": "2584", "process_user_time": 2.246097}
[0m15:57:08.887679 [debug] [MainThread]: Command `dbt run` failed at 15:57:08.887559 after 1.12 seconds
[0m15:57:08.888321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc0434872f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc042bcd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc042bcd280>]}
[0m15:57:08.889307 [debug] [MainThread]: Flushing usage events
[0m15:57:09.658988 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:56.629938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70984c015010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70984bf091c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70984c0158b0>]}


============================== 15:58:56.633398 | 091ebfe0-6e02-4ef6-a90a-9da670c80434 ==============================
[0m15:58:56.633398 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:58:56.634435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:58:56.833376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '091ebfe0-6e02-4ef6-a90a-9da670c80434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70984c5418b0>]}
[0m15:58:56.896855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '091ebfe0-6e02-4ef6-a90a-9da670c80434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70984bc2acf0>]}
[0m15:58:56.897825 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:58:57.013095 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:58:57.093771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:58:57.094645 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/src/stg_customer_targets.sql
[0m15:58:57.339763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '091ebfe0-6e02-4ef6-a90a-9da670c80434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709849ffb170>]}
[0m15:58:57.398537 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:58:57.401666 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:58:57.414755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '091ebfe0-6e02-4ef6-a90a-9da670c80434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709849fd3620>]}
[0m15:58:57.415423 [info ] [MainThread]: Found 6 models, 431 macros
[0m15:58:57.416039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '091ebfe0-6e02-4ef6-a90a-9da670c80434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709849faa0c0>]}
[0m15:58:57.417901 [info ] [MainThread]: 
[0m15:58:57.418513 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:58:57.419088 [info ] [MainThread]: 
[0m15:58:57.419867 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:58:57.421019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:58:57.458294 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:58:57.458885 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:58:57.459419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:57.463770 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m15:58:57.465829 [debug] [ThreadPool]: On list_raw: Close
[0m15:58:57.472531 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:58:57.483889 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:58:57.484640 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:58:57.485315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:57.489897 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:58:57.493237 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:58:57.494120 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:58:57.499575 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m15:58:57.502390 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:58:57.503371 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:58:57.516353 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:57.517316 [debug] [MainThread]: On master: BEGIN
[0m15:58:57.525016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:57.533067 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m15:58:57.533833 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:57.538273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:58:57.572928 [debug] [MainThread]: SQL status: SELECT 0 in 0.034 seconds
[0m15:58:57.575699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '091ebfe0-6e02-4ef6-a90a-9da670c80434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7098486a0b00>]}
[0m15:58:57.578599 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:57.580747 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:57.581610 [debug] [MainThread]: On master: BEGIN
[0m15:58:57.583004 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:58:57.583862 [debug] [MainThread]: On master: COMMIT
[0m15:58:57.584699 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:57.585539 [debug] [MainThread]: On master: COMMIT
[0m15:58:57.587262 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:58:57.588118 [debug] [MainThread]: On master: Close
[0m15:58:57.607512 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m15:58:57.608536 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m15:58:57.609442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m15:58:57.610544 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m15:58:57.621404 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:58:57.622651 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m15:58:57.682671 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:58:57.684134 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:58:57.685158 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m15:58:57.686192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:57.696703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:58:57.697291 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:58:57.697910 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m15:58:57.712672 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m15:58:57.725336 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:58:57.726365 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m15:58:57.727757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:58:57.758431 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m15:58:57.759610 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:58:57.760502 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m15:58:57.762957 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:58:57.769699 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m15:58:57.775882 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m15:58:57.776477 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m15:58:57.777299 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:58:57.780167 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m15:58:57.782705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '091ebfe0-6e02-4ef6-a90a-9da670c80434', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70984d75bb30>]}
[0m15:58:57.783812 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m15:58:57.784763 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m15:58:57.786541 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:57.787085 [debug] [MainThread]: On master: BEGIN
[0m15:58:57.787603 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:57.791410 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:58:57.792200 [debug] [MainThread]: On master: COMMIT
[0m15:58:57.792911 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:57.793603 [debug] [MainThread]: On master: COMMIT
[0m15:58:57.794507 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:58:57.795249 [debug] [MainThread]: On master: Close
[0m15:58:57.796514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:57.797303 [debug] [MainThread]: Connection 'list_raw' was properly closed.
[0m15:58:57.798067 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m15:58:57.798879 [info ] [MainThread]: 
[0m15:58:57.799574 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m15:58:57.801162 [debug] [MainThread]: Command end result
[0m15:58:57.825789 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:58:57.827635 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:58:57.833738 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:58:57.834289 [info ] [MainThread]: 
[0m15:58:57.835007 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:57.835544 [info ] [MainThread]: 
[0m15:58:57.836156 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:58:57.837384 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2656394, "process_in_blocks": "0", "process_kernel_time": 0.348449, "process_mem_max_rss": "115404", "process_out_blocks": "2584", "process_user_time": 2.363914}
[0m15:58:57.838003 [debug] [MainThread]: Command `dbt run` succeeded at 15:58:57.837853 after 1.27 seconds
[0m15:58:57.838590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70984bb67ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7098486676e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709848659280>]}
[0m15:58:57.839152 [debug] [MainThread]: Flushing usage events
[0m15:58:58.613023 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:02:03.637489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7864dd0d5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7864dee31940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7864dd200530>]}


============================== 16:02:03.641144 | d346167c-8486-47b0-83e0-161d84e6e34c ==============================
[0m16:02:03.641144 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:02:03.641995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:02:03.816732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd346167c-8486-47b0-83e0-161d84e6e34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7864dc73a7e0>]}
[0m16:02:03.880747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd346167c-8486-47b0-83e0-161d84e6e34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7864dcee9580>]}
[0m16:02:03.881740 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:02:03.991846 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:02:04.090357 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:02:04.091658 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/src/stg_customer.sql
[0m16:02:04.417568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd346167c-8486-47b0-83e0-161d84e6e34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7864db3ff3e0>]}
[0m16:02:04.539281 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:02:04.543833 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:02:04.564045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd346167c-8486-47b0-83e0-161d84e6e34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7864db3f3a70>]}
[0m16:02:04.565070 [info ] [MainThread]: Found 6 models, 431 macros
[0m16:02:04.565920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd346167c-8486-47b0-83e0-161d84e6e34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7864db352ab0>]}
[0m16:02:04.568711 [info ] [MainThread]: 
[0m16:02:04.569572 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:02:04.570402 [info ] [MainThread]: 
[0m16:02:04.571658 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:04.578225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m16:02:04.633262 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m16:02:04.634296 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m16:02:04.635137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:04.640985 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m16:02:04.643296 [debug] [ThreadPool]: On list_raw: Close
[0m16:02:04.648536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m16:02:04.663145 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:02:04.663915 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m16:02:04.664615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:04.679711 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m16:02:04.680713 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:02:04.681730 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m16:02:04.690361 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.008 seconds
[0m16:02:04.693619 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m16:02:04.699771 [debug] [ThreadPool]: On list_raw_raw: Close
[0m16:02:04.715591 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:04.718410 [debug] [MainThread]: On master: BEGIN
[0m16:02:04.719302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:04.727201 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m16:02:04.728181 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:04.729232 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:02:04.747665 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m16:02:04.750671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd346167c-8486-47b0-83e0-161d84e6e34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7864db7bb380>]}
[0m16:02:04.751772 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:04.752838 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:04.753735 [debug] [MainThread]: On master: BEGIN
[0m16:02:04.757991 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:02:04.758953 [debug] [MainThread]: On master: COMMIT
[0m16:02:04.759874 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:04.760766 [debug] [MainThread]: On master: COMMIT
[0m16:02:04.761944 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:02:04.763113 [debug] [MainThread]: On master: Close
[0m16:02:04.773164 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer
[0m16:02:04.774707 [info ] [Thread-1 (]: 1 of 2 START sql view model raw.stg_customer ................................... [RUN]
[0m16:02:04.775634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer)
[0m16:02:04.777260 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer
[0m16:02:04.776384 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m16:02:04.791936 [info ] [Thread-2 (]: 2 of 2 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m16:02:04.793179 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m16:02:04.793958 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m16:02:04.795313 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer"
[0m16:02:04.799849 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer
[0m16:02:04.798495 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:04.811127 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m16:02:04.912944 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:04.915960 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer"
[0m16:02:04.917327 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:02:04.918199 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: BEGIN
[0m16:02:04.919017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:04.920490 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:04.923917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:02:04.926049 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:02:04.924904 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m16:02:04.928359 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:04.927246 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */

  create view "raw"."raw"."stg_customer__dbt_tmp"
    
    
  as (
    WITH customer AS (
    SELECT * 
    FROM raw.raw.customer
)

SELECT
    customer_id,
    customer_name,
    city
   
FROM customer
  );
[0m16:02:04.930233 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.customer" does not exist
LINE 9:     FROM raw.raw.customer
                 ^

[0m16:02:04.931059 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: ROLLBACK
[0m16:02:04.932207 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: Close
[0m16:02:04.936185 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m16:02:04.940336 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:04.941574 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m16:02:04.948321 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:02:04.959828 [debug] [Thread-1 (]: Database Error in model stg_customer (models/src/stg_customer.sql)
  relation "raw.customer" does not exist
  LINE 9:     FROM raw.raw.customer
                   ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer.sql
[0m16:02:04.963546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd346167c-8486-47b0-83e0-161d84e6e34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7864dc73a720>]}
[0m16:02:04.976691 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model raw.stg_customer .......................... [[31mERROR[0m in 0.19s]
[0m16:02:04.978324 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer
[0m16:02:04.979791 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.stg_customer' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer (models/src/stg_customer.sql)
  relation "raw.customer" does not exist
  LINE 9:     FROM raw.raw.customer
                   ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer.sql.
[0m16:02:04.982799 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:04.984111 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets" rename to "stg_customer_targets__dbt_backup"
[0m16:02:04.986832 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:02:04.995289 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:04.996890 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m16:02:04.998507 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:02:05.045216 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:02:05.052554 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:05.054306 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:02:05.059815 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m16:02:05.074514 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m16:02:05.084438 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:05.085256 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m16:02:05.088368 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:02:05.092004 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m16:02:05.092962 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd346167c-8486-47b0-83e0-161d84e6e34c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7864debab9b0>]}
[0m16:02:05.094055 [info ] [Thread-2 (]: 2 of 2 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.30s]
[0m16:02:05.095254 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m16:02:05.097213 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:05.097722 [debug] [MainThread]: On master: BEGIN
[0m16:02:05.098338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:05.102045 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:02:05.104443 [debug] [MainThread]: On master: COMMIT
[0m16:02:05.104946 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:05.105452 [debug] [MainThread]: On master: COMMIT
[0m16:02:05.106086 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:02:05.106663 [debug] [MainThread]: On master: Close
[0m16:02:05.107390 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:05.108128 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m16:02:05.108871 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer' was properly closed.
[0m16:02:05.109793 [info ] [MainThread]: 
[0m16:02:05.110659 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m16:02:05.112181 [debug] [MainThread]: Command end result
[0m16:02:05.145279 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:02:05.147924 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:02:05.159047 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m16:02:05.159896 [info ] [MainThread]: 
[0m16:02:05.160855 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:02:05.161745 [info ] [MainThread]: 
[0m16:02:05.162785 [error] [MainThread]:   Database Error in model stg_customer (models/src/stg_customer.sql)
  relation "raw.customer" does not exist
  LINE 9:     FROM raw.raw.customer
                   ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_customer.sql
[0m16:02:05.163654 [info ] [MainThread]: 
[0m16:02:05.164562 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:02:05.166340 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5891997, "process_in_blocks": "0", "process_kernel_time": 0.278457, "process_mem_max_rss": "117700", "process_out_blocks": "2608", "process_user_time": 2.526009}
[0m16:02:05.167237 [debug] [MainThread]: Command `dbt run` failed at 16:02:05.167092 after 1.59 seconds
[0m16:02:05.168026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7864dd0049e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7864ddf9c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7864d9a933e0>]}
[0m16:02:05.170028 [debug] [MainThread]: Flushing usage events
[0m16:02:05.933967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:02:43.575720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efe862330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eff2e1f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8eff8caae0>]}


============================== 16:02:43.580868 | b8205d89-cf47-4ae9-8e3b-3eb297591a02 ==============================
[0m16:02:43.580868 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:02:43.582261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/codespace/.dbt', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:02:43.756956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8205d89-cf47-4ae9-8e3b-3eb297591a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efe4173e0>]}
[0m16:02:43.820788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8205d89-cf47-4ae9-8e3b-3eb297591a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efe7911f0>]}
[0m16:02:43.821873 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:02:43.980622 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:02:44.061798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:02:44.063137 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/src/stg_customer.sql
[0m16:02:44.329915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8205d89-cf47-4ae9-8e3b-3eb297591a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efcbfede0>]}
[0m16:02:44.387811 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:02:44.390847 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:02:44.403458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8205d89-cf47-4ae9-8e3b-3eb297591a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efc7231a0>]}
[0m16:02:44.404117 [info ] [MainThread]: Found 6 models, 431 macros
[0m16:02:44.404728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8205d89-cf47-4ae9-8e3b-3eb297591a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efc7260c0>]}
[0m16:02:44.406722 [info ] [MainThread]: 
[0m16:02:44.407318 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:02:44.407882 [info ] [MainThread]: 
[0m16:02:44.408671 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:44.413664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m16:02:44.450085 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m16:02:44.450821 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m16:02:44.451386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:44.455758 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m16:02:44.457223 [debug] [ThreadPool]: On list_raw: Close
[0m16:02:44.459620 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m16:02:44.466229 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:02:44.466797 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m16:02:44.467313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:44.470521 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:02:44.472343 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:02:44.473245 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m16:02:44.476132 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m16:02:44.478544 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m16:02:44.479346 [debug] [ThreadPool]: On list_raw_raw: Close
[0m16:02:44.485697 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:44.486281 [debug] [MainThread]: On master: BEGIN
[0m16:02:44.486804 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:44.489919 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:02:44.492846 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:44.493476 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:02:44.504957 [debug] [MainThread]: SQL status: SELECT 1 in 0.011 seconds
[0m16:02:44.506680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8205d89-cf47-4ae9-8e3b-3eb297591a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efd710860>]}
[0m16:02:44.507348 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:44.508002 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:44.508556 [debug] [MainThread]: On master: BEGIN
[0m16:02:44.509914 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:02:44.512326 [debug] [MainThread]: On master: COMMIT
[0m16:02:44.512896 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:44.513417 [debug] [MainThread]: On master: COMMIT
[0m16:02:44.514026 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:02:44.514607 [debug] [MainThread]: On master: Close
[0m16:02:44.518919 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer
[0m16:02:44.519430 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m16:02:44.520158 [info ] [Thread-1 (]: 1 of 2 START sql view model raw.stg_customer ................................... [RUN]
[0m16:02:44.520956 [info ] [Thread-2 (]: 2 of 2 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m16:02:44.521702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer)
[0m16:02:44.522364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m16:02:44.522979 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer
[0m16:02:44.523577 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m16:02:44.532247 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer"
[0m16:02:44.534211 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:44.535245 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer
[0m16:02:44.541094 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m16:02:44.595536 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer"
[0m16:02:44.599563 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:02:44.600478 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: BEGIN
[0m16:02:44.598435 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:44.601338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:02:44.602454 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:44.603464 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m16:02:44.604309 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:02:44.607604 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m16:02:44.608529 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:02:44.609539 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */

  create view "raw"."raw"."stg_customer__dbt_tmp"
    
    
  as (
    WITH customer AS (
    SELECT * 
    FROM raw.raw.customers
)

SELECT
    customer_id,
    customer_name,
    city
   
FROM customer
  );
[0m16:02:44.610865 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m16:02:44.611868 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:44.612930 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m16:02:44.616279 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:02:44.617209 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:02:44.632828 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:02:44.627431 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:44.634517 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m16:02:44.635438 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets" rename to "stg_customer_targets__dbt_backup"
[0m16:02:44.637016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:02:44.637631 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:02:44.651208 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:44.656384 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m16:02:44.656875 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m16:02:44.657487 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:02:44.658368 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m16:02:44.658961 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:02:44.663278 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:02:44.663900 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:02:44.664392 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:44.670941 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_customer__dbt_backup"
[0m16:02:44.671596 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:02:44.679089 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:02:44.680015 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
drop view if exists "raw"."raw"."stg_customer__dbt_backup" cascade
[0m16:02:44.680658 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:02:44.681470 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:02:44.683932 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m16:02:44.686587 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: Close
[0m16:02:44.687722 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:02:44.690400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8205d89-cf47-4ae9-8e3b-3eb297591a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f0006fe30>]}
[0m16:02:44.691208 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m16:02:44.692286 [info ] [Thread-1 (]: 1 of 2 OK created sql view model raw.stg_customer .............................. [[32mCREATE VIEW[0m in 0.17s]
[0m16:02:44.693958 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer
[0m16:02:44.694882 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:02:44.696565 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m16:02:44.697421 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8205d89-cf47-4ae9-8e3b-3eb297591a02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efafc7d40>]}
[0m16:02:44.698861 [info ] [Thread-2 (]: 2 of 2 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m16:02:44.701015 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m16:02:44.702842 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:44.703394 [debug] [MainThread]: On master: BEGIN
[0m16:02:44.703918 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:44.707714 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:02:44.709862 [debug] [MainThread]: On master: COMMIT
[0m16:02:44.710877 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:44.711340 [debug] [MainThread]: On master: COMMIT
[0m16:02:44.711939 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:02:44.712411 [debug] [MainThread]: On master: Close
[0m16:02:44.713384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:44.714620 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m16:02:44.715419 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer' was properly closed.
[0m16:02:44.716342 [info ] [MainThread]: 
[0m16:02:44.717002 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m16:02:44.718108 [debug] [MainThread]: Command end result
[0m16:02:44.744780 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:02:44.746779 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:02:44.752938 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m16:02:44.753492 [info ] [MainThread]: 
[0m16:02:44.754210 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:02:44.754830 [info ] [MainThread]: 
[0m16:02:44.755455 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:02:44.756665 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2409681, "process_in_blocks": "0", "process_kernel_time": 0.293346, "process_mem_max_rss": "116960", "process_out_blocks": "2616", "process_user_time": 2.437945}
[0m16:02:44.757310 [debug] [MainThread]: Command `dbt run` succeeded at 16:02:44.757189 after 1.24 seconds
[0m16:02:44.757892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efe618bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efee94680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efee61400>]}
[0m16:02:44.758513 [debug] [MainThread]: Flushing usage events
[0m16:02:45.512455 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:19.882120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7210402df110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72103fa96330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72103fbf54c0>]}


============================== 16:04:19.887390 | 5a449210-ffa8-4360-b4c0-64176af018c5 ==============================
[0m16:04:19.887390 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:04:19.888455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:04:20.085558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a449210-ffa8-4360-b4c0-64176af018c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72103ef261e0>]}
[0m16:04:20.149270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a449210-ffa8-4360-b4c0-64176af018c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72103ffa6b40>]}
[0m16:04:20.150331 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:04:20.264646 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:04:20.342305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:04:20.343093 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/src/stg_date.sql
[0m16:04:20.594323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a449210-ffa8-4360-b4c0-64176af018c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72103db0b740>]}
[0m16:04:20.651262 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:04:20.654223 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:04:20.666687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a449210-ffa8-4360-b4c0-64176af018c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72103dbdf410>]}
[0m16:04:20.667361 [info ] [MainThread]: Found 6 models, 431 macros
[0m16:04:20.667957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a449210-ffa8-4360-b4c0-64176af018c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72103dbfb320>]}
[0m16:04:20.669915 [info ] [MainThread]: 
[0m16:04:20.670517 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:04:20.671086 [info ] [MainThread]: 
[0m16:04:20.671883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:04:20.677047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m16:04:20.736775 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m16:04:20.738396 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m16:04:20.741382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:20.746888 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m16:04:20.748900 [debug] [ThreadPool]: On list_raw: Close
[0m16:04:20.762065 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m16:04:20.776689 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:04:20.777551 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m16:04:20.778334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:20.787018 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m16:04:20.787774 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:04:20.788553 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m16:04:20.792475 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m16:04:20.794886 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m16:04:20.795748 [debug] [ThreadPool]: On list_raw_raw: Close
[0m16:04:20.816647 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:20.819031 [debug] [MainThread]: On master: BEGIN
[0m16:04:20.821260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:04:20.826676 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:04:20.828013 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:20.829000 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:04:20.844315 [debug] [MainThread]: SQL status: SELECT 2 in 0.014 seconds
[0m16:04:20.846400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a449210-ffa8-4360-b4c0-64176af018c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72103f597170>]}
[0m16:04:20.847056 [debug] [MainThread]: On master: ROLLBACK
[0m16:04:20.847672 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:20.848157 [debug] [MainThread]: On master: BEGIN
[0m16:04:20.848888 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:04:20.850037 [debug] [MainThread]: On master: COMMIT
[0m16:04:20.850591 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:20.851085 [debug] [MainThread]: On master: COMMIT
[0m16:04:20.851677 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:04:20.852162 [debug] [MainThread]: On master: Close
[0m16:04:20.855653 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer
[0m16:04:20.857488 [info ] [Thread-1 (]: 1 of 3 START sql view model raw.stg_customer ................................... [RUN]
[0m16:04:20.858413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer)
[0m16:04:20.856471 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m16:04:20.859159 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_date
[0m16:04:20.859782 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer
[0m16:04:20.860468 [info ] [Thread-2 (]: 2 of 3 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m16:04:20.861243 [info ] [Thread-3 (]: 3 of 3 START sql view model raw.stg_date ....................................... [RUN]
[0m16:04:20.869274 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer"
[0m16:04:20.870079 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m16:04:20.870842 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_date'
[0m16:04:20.871795 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m16:04:20.872277 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer
[0m16:04:20.872839 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_date
[0m16:04:20.874757 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:04:20.898227 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_date"
[0m16:04:20.910002 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m16:04:20.920801 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer"
[0m16:04:20.921385 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_date
[0m16:04:20.925271 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:04:20.926300 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:04:20.929996 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_date"
[0m16:04:20.931054 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:04:20.931534 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: BEGIN
[0m16:04:20.932498 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:04:20.933071 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m16:04:20.933682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:20.934314 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: BEGIN
[0m16:04:20.935849 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:04:20.934914 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:04:20.941847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m16:04:20.942856 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:04:20.945249 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m16:04:20.945974 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */

  create view "raw"."raw"."stg_customer__dbt_tmp"
    
    
  as (
    WITH customer AS (
    SELECT * 
    FROM raw.raw.customers
)

SELECT
    customer_id,
    customer_name,
    city
   
FROM customer
  );
[0m16:04:20.946487 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m16:04:20.949118 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:04:20.947520 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:04:20.950118 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m16:04:20.950816 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:04:20.951415 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */

  create view "raw"."raw"."stg_date__dbt_tmp"
    
    
  as (
    WITH dates AS (
    SELECT * 
    FROM raw.raw.dates
)

SELECT
    date,
   mmm_yy,
    week_no
   
FROM dates
  );
[0m16:04:20.959492 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:04:20.966912 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:04:20.960886 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:04:20.968309 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:04:20.971362 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets" rename to "stg_customer_targets__dbt_backup"
[0m16:04:20.972699 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer" rename to "stg_customer__dbt_backup"
[0m16:04:20.975869 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:04:20.976960 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date__dbt_tmp" rename to "stg_date"
[0m16:04:20.977578 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:04:20.978212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:04:20.981420 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:04:20.982051 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:04:20.984922 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:04:20.997298 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m16:04:20.985577 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m16:04:21.000456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:04:21.009537 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m16:04:21.039555 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:04:21.040667 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m16:04:21.037294 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m16:04:21.041418 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:04:21.042034 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:04:21.042706 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:04:21.043316 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:04:21.043910 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m16:04:21.044517 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m16:04:21.046344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:04:21.047088 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m16:04:21.052828 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m16:04:21.054384 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_customer__dbt_backup"
[0m16:04:21.056927 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_date__dbt_backup"
[0m16:04:21.060687 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m16:04:21.067034 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:04:21.068171 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:04:21.069295 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:04:21.069919 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
drop view if exists "raw"."raw"."stg_customer__dbt_backup" cascade
[0m16:04:21.070572 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
drop view if exists "raw"."raw"."stg_date__dbt_backup" cascade
[0m16:04:21.071203 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m16:04:21.072285 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:04:21.073432 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:04:21.081059 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: Close
[0m16:04:21.079058 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m16:04:21.078066 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: Close
[0m16:04:21.088874 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a449210-ffa8-4360-b4c0-64176af018c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7210401055b0>]}
[0m16:04:21.089932 [info ] [Thread-3 (]: 3 of 3 OK created sql view model raw.stg_date .................................. [[32mCREATE VIEW[0m in 0.22s]
[0m16:04:21.091300 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_date
[0m16:04:21.092245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a449210-ffa8-4360-b4c0-64176af018c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72103dfdce90>]}
[0m16:04:21.086242 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m16:04:21.097344 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a449210-ffa8-4360-b4c0-64176af018c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72103c1837d0>]}
[0m16:04:21.093529 [info ] [Thread-1 (]: 1 of 3 OK created sql view model raw.stg_customer .............................. [[32mCREATE VIEW[0m in 0.23s]
[0m16:04:21.101470 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer
[0m16:04:21.100244 [info ] [Thread-2 (]: 2 of 3 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.23s]
[0m16:04:21.103206 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m16:04:21.105277 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:21.106331 [debug] [MainThread]: On master: BEGIN
[0m16:04:21.107230 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:04:21.112767 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:04:21.113687 [debug] [MainThread]: On master: COMMIT
[0m16:04:21.114608 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:21.115486 [debug] [MainThread]: On master: COMMIT
[0m16:04:21.116481 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:04:21.117362 [debug] [MainThread]: On master: Close
[0m16:04:21.121222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:21.121994 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m16:04:21.122946 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer' was properly closed.
[0m16:04:21.123788 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_date' was properly closed.
[0m16:04:21.124777 [info ] [MainThread]: 
[0m16:04:21.125730 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m16:04:21.127915 [debug] [MainThread]: Command end result
[0m16:04:21.160717 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:04:21.162751 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:04:21.169003 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m16:04:21.169561 [info ] [MainThread]: 
[0m16:04:21.170259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:21.170862 [info ] [MainThread]: 
[0m16:04:21.171485 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:04:21.172753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3876889, "process_in_blocks": "0", "process_kernel_time": 0.298368, "process_mem_max_rss": "116300", "process_out_blocks": "2648", "process_user_time": 2.470488}
[0m16:04:21.173454 [debug] [MainThread]: Command `dbt run` succeeded at 16:04:21.173334 after 1.39 seconds
[0m16:04:21.174056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72103f927b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72103c214860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72103c215a60>]}
[0m16:04:21.174716 [debug] [MainThread]: Flushing usage events
[0m16:04:21.953611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:06:03.171671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74ead6a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74ead695e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74ea9fbe30>]}


============================== 16:06:03.175174 | f0cec43f-acbb-45c4-b1a7-01a2be876995 ==============================
[0m16:06:03.175174 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:06:03.176187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/codespace/.dbt', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:06:03.455589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0cec43f-acbb-45c4-b1a7-01a2be876995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74ea89aff0>]}
[0m16:06:03.555506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0cec43f-acbb-45c4-b1a7-01a2be876995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74ea71a180>]}
[0m16:06:03.557318 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:06:03.714074 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:06:03.791084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:06:03.791883 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/src/stg_order_fulfillment.sql
[0m16:06:04.123798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0cec43f-acbb-45c4-b1a7-01a2be876995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74e8d26600>]}
[0m16:06:04.182091 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:06:04.185044 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:06:04.197414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0cec43f-acbb-45c4-b1a7-01a2be876995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74e8dfb830>]}
[0m16:06:04.198074 [info ] [MainThread]: Found 6 models, 431 macros
[0m16:06:04.198693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0cec43f-acbb-45c4-b1a7-01a2be876995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74e91fdfa0>]}
[0m16:06:04.200710 [info ] [MainThread]: 
[0m16:06:04.201285 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:06:04.201842 [info ] [MainThread]: 
[0m16:06:04.202673 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:06:04.207839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m16:06:04.242309 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m16:06:04.243046 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m16:06:04.243786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:04.256062 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m16:06:04.258517 [debug] [ThreadPool]: On list_raw: Close
[0m16:06:04.264486 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m16:06:04.274937 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:06:04.275657 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m16:06:04.276309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:04.280400 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:06:04.280886 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:06:04.281430 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m16:06:04.284140 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m16:06:04.285847 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m16:06:04.286489 [debug] [ThreadPool]: On list_raw_raw: Close
[0m16:06:04.294239 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:04.294821 [debug] [MainThread]: On master: BEGIN
[0m16:06:04.295341 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:04.298809 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:06:04.300287 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:04.301613 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:06:04.314882 [debug] [MainThread]: SQL status: SELECT 3 in 0.013 seconds
[0m16:06:04.317161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0cec43f-acbb-45c4-b1a7-01a2be876995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74e8d27b90>]}
[0m16:06:04.317854 [debug] [MainThread]: On master: ROLLBACK
[0m16:06:04.318568 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:04.319110 [debug] [MainThread]: On master: BEGIN
[0m16:06:04.319941 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:06:04.320736 [debug] [MainThread]: On master: COMMIT
[0m16:06:04.321572 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:04.322481 [debug] [MainThread]: On master: COMMIT
[0m16:06:04.323546 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:06:04.324033 [debug] [MainThread]: On master: Close
[0m16:06:04.328180 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer
[0m16:06:04.328692 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m16:06:04.329282 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_date
[0m16:06:04.330347 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order_fulfillment
[0m16:06:04.329895 [info ] [Thread-1 (]: 1 of 4 START sql view model raw.stg_customer ................................... [RUN]
[0m16:06:04.331200 [info ] [Thread-2 (]: 2 of 4 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m16:06:04.331815 [info ] [Thread-3 (]: 3 of 4 START sql view model raw.stg_date ....................................... [RUN]
[0m16:06:04.332805 [info ] [Thread-4 (]: 4 of 4 START sql view model raw.stg_order_fulfillment .......................... [RUN]
[0m16:06:04.333578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer)
[0m16:06:04.334230 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m16:06:04.335096 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_date'
[0m16:06:04.338005 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_date
[0m16:06:04.336449 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer
[0m16:06:04.337109 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m16:06:04.335795 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order_fulfillment'
[0m16:06:04.345301 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_date"
[0m16:06:04.347277 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer"
[0m16:06:04.349118 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:06:04.349720 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order_fulfillment
[0m16:06:04.350803 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer
[0m16:06:04.351275 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_date
[0m16:06:04.353329 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:06:04.366118 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m16:06:04.411500 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer"
[0m16:06:04.413684 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_date"
[0m16:06:04.417803 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:06:04.418357 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.stg_order_fulfillment
[0m16:06:04.419606 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:06:04.430385 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: BEGIN
[0m16:06:04.431148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:04.426467 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:06:04.432108 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m16:06:04.425081 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:06:04.435648 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:06:04.437871 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: BEGIN
[0m16:06:04.425604 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:06:04.439906 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: BEGIN
[0m16:06:04.440883 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:06:04.434467 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:06:04.438915 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:06:04.450016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m16:06:04.452865 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:06:04.458479 [debug] [Thread-2 (]: SQL status: BEGIN in 0.026 seconds
[0m16:06:04.462257 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:06:04.464033 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m16:06:04.460110 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m16:06:04.465381 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:06:04.468286 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */

  create view "raw"."raw"."stg_date__dbt_tmp"
    
    
  as (
    WITH dates AS (
    SELECT * 
    FROM raw.raw.dates
)

SELECT
    date,
   mmm_yy,
    week_no
   
FROM dates
  );
[0m16:06:04.460879 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */

  create view "raw"."raw"."stg_customer__dbt_tmp"
    
    
  as (
    WITH customer AS (
    SELECT * 
    FROM raw.raw.customers
)

SELECT
    customer_id,
    customer_name,
    city
   
FROM customer
  );
[0m16:06:04.470689 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:06:04.483045 [debug] [Thread-4 (]: SQL status: BEGIN in 0.044 seconds
[0m16:06:04.488543 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:06:04.489888 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */

  create view "raw"."raw"."stg_order_fulfillment__dbt_tmp"
    
    
  as (
    WITH order_fullfillment AS (
    SELECT * 
    FROM raw.raw.order_fullfillment
)

SELECT
    order_id,
    on_time,
    in_full,
    otif
   
FROM order_fullfillment
  );
[0m16:06:04.486941 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m16:06:04.487663 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m16:06:04.536130 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "raw.order_fullfillment" does not exist
LINE 9:     FROM raw.raw.order_fullfillment
                 ^

[0m16:06:04.555322 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:06:04.551952 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:06:04.561249 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:06:04.562000 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: ROLLBACK
[0m16:06:04.562804 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets" rename to "stg_customer_targets__dbt_backup"
[0m16:06:04.563430 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer" rename to "stg_customer__dbt_backup"
[0m16:06:04.564039 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date" rename to "stg_date__dbt_backup"
[0m16:06:04.565047 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: Close
[0m16:06:04.566064 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:06:04.573641 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:06:04.570254 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:06:04.566750 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:06:04.574585 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m16:06:04.576067 [debug] [Thread-4 (]: Database Error in model stg_order_fulfillment (models/src/stg_order_fulfillment.sql)
  relation "raw.order_fullfillment" does not exist
  LINE 9:     FROM raw.raw.order_fullfillment
                   ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_order_fulfillment.sql
[0m16:06:04.579217 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:06:04.583362 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:06:04.585695 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:06:04.586360 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0cec43f-acbb-45c4-b1a7-01a2be876995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74e8d268a0>]}
[0m16:06:04.586849 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date__dbt_tmp" rename to "stg_date"
[0m16:06:04.587447 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m16:06:04.606072 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:06:04.607010 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model raw.stg_order_fulfillment ................. [[31mERROR[0m in 0.25s]
[0m16:06:04.608214 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:06:04.608906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:06:04.609399 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:06:04.610243 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order_fulfillment
[0m16:06:04.612392 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m16:06:04.615229 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m16:06:04.618613 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:06:04.616828 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:06:04.617937 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.stg_order_fulfillment' to be skipped because of status 'error'.  Reason: Database Error in model stg_order_fulfillment (models/src/stg_order_fulfillment.sql)
  relation "raw.order_fullfillment" does not exist
  LINE 9:     FROM raw.raw.order_fullfillment
                   ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_order_fulfillment.sql.
[0m16:06:04.615847 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:06:04.619525 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m16:06:04.620159 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m16:06:04.623034 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:06:04.623916 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m16:06:04.624429 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:06:04.631198 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m16:06:04.633739 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_date__dbt_backup"
[0m16:06:04.636251 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_customer__dbt_backup"
[0m16:06:04.642733 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:06:04.643921 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:06:04.645045 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:06:04.645672 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m16:06:04.646318 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
drop view if exists "raw"."raw"."stg_date__dbt_backup" cascade
[0m16:06:04.646904 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
drop view if exists "raw"."raw"."stg_customer__dbt_backup" cascade
[0m16:06:04.649101 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:06:04.649891 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:06:04.650485 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:06:04.652993 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: Close
[0m16:06:04.656924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0cec43f-acbb-45c4-b1a7-01a2be876995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74ec5180b0>]}
[0m16:06:04.655996 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: Close
[0m16:06:04.660161 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0cec43f-acbb-45c4-b1a7-01a2be876995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74e7364740>]}
[0m16:06:04.654530 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m16:06:04.662425 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0cec43f-acbb-45c4-b1a7-01a2be876995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74e74c0380>]}
[0m16:06:04.658064 [info ] [Thread-1 (]: 1 of 4 OK created sql view model raw.stg_customer .............................. [[32mCREATE VIEW[0m in 0.32s]
[0m16:06:04.661518 [info ] [Thread-3 (]: 3 of 4 OK created sql view model raw.stg_date .................................. [[32mCREATE VIEW[0m in 0.33s]
[0m16:06:04.664577 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer
[0m16:06:04.663402 [info ] [Thread-2 (]: 2 of 4 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.33s]
[0m16:06:04.666371 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_date
[0m16:06:04.667484 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m16:06:04.669301 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:04.669845 [debug] [MainThread]: On master: BEGIN
[0m16:06:04.670519 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:04.675038 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:06:04.675605 [debug] [MainThread]: On master: COMMIT
[0m16:06:04.676143 [debug] [MainThread]: Using postgres connection "master"
[0m16:06:04.676657 [debug] [MainThread]: On master: COMMIT
[0m16:06:04.677265 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:06:04.677811 [debug] [MainThread]: On master: Close
[0m16:06:04.678603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:04.679332 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m16:06:04.680022 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer' was properly closed.
[0m16:06:04.680762 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_date' was properly closed.
[0m16:06:04.681288 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_order_fulfillment' was properly closed.
[0m16:06:04.682347 [info ] [MainThread]: 
[0m16:06:04.683062 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m16:06:04.684431 [debug] [MainThread]: Command end result
[0m16:06:04.707892 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:06:04.709528 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:06:04.715672 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m16:06:04.716194 [info ] [MainThread]: 
[0m16:06:04.716924 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:06:04.717553 [info ] [MainThread]: 
[0m16:06:04.718513 [error] [MainThread]:   Database Error in model stg_order_fulfillment (models/src/stg_order_fulfillment.sql)
  relation "raw.order_fullfillment" does not exist
  LINE 9:     FROM raw.raw.order_fullfillment
                   ^
  compiled code at target/run/nexabrands_dbt/models/src/stg_order_fulfillment.sql
[0m16:06:04.719435 [info ] [MainThread]: 
[0m16:06:04.720315 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m16:06:04.721846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.607676, "process_in_blocks": "0", "process_kernel_time": 0.328396, "process_mem_max_rss": "117392", "process_out_blocks": "2672", "process_user_time": 2.571101}
[0m16:06:04.722793 [debug] [MainThread]: Command `dbt run` failed at 16:06:04.722657 after 1.61 seconds
[0m16:06:04.724390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74eab05be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74e4256060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b74e73550d0>]}
[0m16:06:04.725266 [debug] [MainThread]: Flushing usage events
[0m16:06:05.697999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:07:00.653062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee9011730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee9011a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee8d46d20>]}


============================== 16:07:00.656488 | 3ca61363-b7fa-455a-a3bf-92e3bb18fbb6 ==============================
[0m16:07:00.656488 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:07:00.657421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:07:00.834653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ca61363-b7fa-455a-a3bf-92e3bb18fbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee8c85190>]}
[0m16:07:00.899036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ca61363-b7fa-455a-a3bf-92e3bb18fbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee8bafe90>]}
[0m16:07:00.900142 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:07:01.029887 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:07:01.115787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:07:01.116610 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/src/stg_order_fulfillment.sql
[0m16:07:01.562095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ca61363-b7fa-455a-a3bf-92e3bb18fbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee71ff650>]}
[0m16:07:01.663350 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:07:01.668386 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:07:01.683914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ca61363-b7fa-455a-a3bf-92e3bb18fbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee71faea0>]}
[0m16:07:01.684548 [info ] [MainThread]: Found 6 models, 431 macros
[0m16:07:01.685119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ca61363-b7fa-455a-a3bf-92e3bb18fbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee7125580>]}
[0m16:07:01.687148 [info ] [MainThread]: 
[0m16:07:01.687721 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:07:01.688262 [info ] [MainThread]: 
[0m16:07:01.689042 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:07:01.694561 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m16:07:01.730473 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m16:07:01.731152 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m16:07:01.731709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:01.736183 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m16:07:01.737680 [debug] [ThreadPool]: On list_raw: Close
[0m16:07:01.739960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m16:07:01.746646 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:07:01.747237 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m16:07:01.747790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:01.751141 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:07:01.752082 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:07:01.753083 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m16:07:01.756632 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m16:07:01.759263 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m16:07:01.759920 [debug] [ThreadPool]: On list_raw_raw: Close
[0m16:07:01.766901 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:01.767472 [debug] [MainThread]: On master: BEGIN
[0m16:07:01.767994 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:01.771602 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:07:01.774213 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:01.774829 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:07:01.787082 [debug] [MainThread]: SQL status: SELECT 3 in 0.012 seconds
[0m16:07:01.789179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ca61363-b7fa-455a-a3bf-92e3bb18fbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee71fba40>]}
[0m16:07:01.789803 [debug] [MainThread]: On master: ROLLBACK
[0m16:07:01.790422 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:01.790910 [debug] [MainThread]: On master: BEGIN
[0m16:07:01.791617 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:07:01.792364 [debug] [MainThread]: On master: COMMIT
[0m16:07:01.793114 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:01.793847 [debug] [MainThread]: On master: COMMIT
[0m16:07:01.794692 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:07:01.795453 [debug] [MainThread]: On master: Close
[0m16:07:01.799439 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer
[0m16:07:01.800148 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m16:07:01.800782 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_date
[0m16:07:01.801400 [info ] [Thread-1 (]: 1 of 4 START sql view model raw.stg_customer ................................... [RUN]
[0m16:07:01.802127 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order_fulfillment
[0m16:07:01.802721 [info ] [Thread-2 (]: 2 of 4 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m16:07:01.803450 [info ] [Thread-3 (]: 3 of 4 START sql view model raw.stg_date ....................................... [RUN]
[0m16:07:01.804199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer)
[0m16:07:01.804862 [info ] [Thread-4 (]: 4 of 4 START sql view model raw.stg_order_fulfillment .......................... [RUN]
[0m16:07:01.805568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m16:07:01.808898 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m16:07:01.807157 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer
[0m16:07:01.822129 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer"
[0m16:07:01.806509 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_date'
[0m16:07:01.808043 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order_fulfillment'
[0m16:07:01.824915 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order_fulfillment
[0m16:07:01.819183 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:07:01.824065 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer
[0m16:07:01.828043 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:07:01.823280 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_date
[0m16:07:01.834517 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m16:07:01.837899 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_date"
[0m16:07:01.838956 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.stg_order_fulfillment
[0m16:07:01.893492 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_date
[0m16:07:01.902953 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:07:01.906237 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer"
[0m16:07:01.910047 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:07:01.913846 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_date"
[0m16:07:01.915220 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:07:01.915923 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:07:01.916691 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: BEGIN
[0m16:07:01.917209 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:07:01.917926 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: BEGIN
[0m16:07:01.918445 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:07:01.918999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:01.919847 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m16:07:01.922007 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:01.920465 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:07:01.921089 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: BEGIN
[0m16:07:01.924225 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:07:01.928375 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m16:07:01.929407 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:07:01.930477 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m16:07:01.933146 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:07:01.943151 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:07:01.943815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m16:07:01.948001 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:07:01.949011 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */

  create view "raw"."raw"."stg_customer__dbt_tmp"
    
    
  as (
    WITH customer AS (
    SELECT * 
    FROM raw.raw.customers
)

SELECT
    customer_id,
    customer_name,
    city
   
FROM customer
  );
[0m16:07:01.945757 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m16:07:01.944589 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m16:07:01.951300 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:07:01.946867 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets" rename to "stg_customer_targets__dbt_backup"
[0m16:07:01.950305 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:07:01.952328 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */

  create view "raw"."raw"."stg_date__dbt_tmp"
    
    
  as (
    WITH dates AS (
    SELECT * 
    FROM raw.raw.dates
)

SELECT
    date,
   mmm_yy,
    week_no
   
FROM dates
  );
[0m16:07:01.953029 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:07:01.954127 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */

  create view "raw"."raw"."stg_order_fulfillment__dbt_tmp"
    
    
  as (
    WITH order_fulfillment AS (
    SELECT * 
    FROM raw.raw.order_fulfillment
)

SELECT
    order_id,
    on_time,
    in_full,
    otif
   
FROM order_fulfillment
  );
[0m16:07:01.954880 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:07:01.959157 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:07:01.959644 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:07:01.963564 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:07:01.964204 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:07:01.964680 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer" rename to "stg_customer__dbt_backup"
[0m16:07:01.968015 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:07:01.968658 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m16:07:01.971706 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:07:01.972625 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date" rename to "stg_date__dbt_backup"
[0m16:07:01.973140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:07:01.974031 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
alter table "raw"."raw"."stg_order_fulfillment__dbt_tmp" rename to "stg_order_fulfillment"
[0m16:07:01.974558 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:07:01.978905 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:07:01.979384 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:07:01.991681 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m16:07:01.990716 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m16:07:01.996930 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:07:02.007507 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:07:02.008148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:07:02.009805 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: COMMIT
[0m16:07:02.010477 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date__dbt_tmp" rename to "stg_date"
[0m16:07:02.011127 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:07:02.013074 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m16:07:02.013705 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:07:02.014637 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:07:02.015286 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:07:02.015763 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:07:02.016357 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: COMMIT
[0m16:07:02.020493 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m16:07:02.023454 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:07:02.024340 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m16:07:02.022250 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m16:07:02.029220 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m16:07:02.030148 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m16:07:02.030685 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:07:02.031135 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m16:07:02.038232 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m16:07:02.040777 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."stg_order_fulfillment__dbt_backup"
[0m16:07:02.043215 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_customer__dbt_backup"
[0m16:07:02.045687 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_date__dbt_backup"
[0m16:07:02.052242 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:07:02.053406 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:07:02.054558 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:07:02.055669 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:07:02.056290 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m16:07:02.056903 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
drop view if exists "raw"."raw"."stg_order_fulfillment__dbt_backup" cascade
[0m16:07:02.057505 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
drop view if exists "raw"."raw"."stg_customer__dbt_backup" cascade
[0m16:07:02.058098 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
drop view if exists "raw"."raw"."stg_date__dbt_backup" cascade
[0m16:07:02.061619 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:07:02.059999 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:07:02.065533 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: Close
[0m16:07:02.070442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ca61363-b7fa-455a-a3bf-92e3bb18fbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eeea937e90>]}
[0m16:07:02.066536 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m16:07:02.068021 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: Close
[0m16:07:02.074247 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ca61363-b7fa-455a-a3bf-92e3bb18fbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee577a150>]}
[0m16:07:02.066038 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m16:07:02.071579 [info ] [Thread-1 (]: 1 of 4 OK created sql view model raw.stg_customer .............................. [[32mCREATE VIEW[0m in 0.26s]
[0m16:07:02.073128 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: Close
[0m16:07:02.079926 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ca61363-b7fa-455a-a3bf-92e3bb18fbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee57a4530>]}
[0m16:07:02.080960 [info ] [Thread-3 (]: 3 of 4 OK created sql view model raw.stg_date .................................. [[32mCREATE VIEW[0m in 0.27s]
[0m16:07:02.081975 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_date
[0m16:07:02.077705 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m16:07:02.075681 [info ] [Thread-4 (]: 4 of 4 OK created sql view model raw.stg_order_fulfillment ..................... [[32mCREATE VIEW[0m in 0.27s]
[0m16:07:02.084023 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order_fulfillment
[0m16:07:02.078969 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer
[0m16:07:02.085430 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ca61363-b7fa-455a-a3bf-92e3bb18fbb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee5751d00>]}
[0m16:07:02.086214 [info ] [Thread-2 (]: 2 of 4 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.28s]
[0m16:07:02.087053 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m16:07:02.089972 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:02.092004 [debug] [MainThread]: On master: BEGIN
[0m16:07:02.092826 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:07:02.100298 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m16:07:02.101154 [debug] [MainThread]: On master: COMMIT
[0m16:07:02.102310 [debug] [MainThread]: Using postgres connection "master"
[0m16:07:02.103048 [debug] [MainThread]: On master: COMMIT
[0m16:07:02.103841 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:07:02.104402 [debug] [MainThread]: On master: Close
[0m16:07:02.105402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:02.106080 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m16:07:02.106997 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer' was properly closed.
[0m16:07:02.107648 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_date' was properly closed.
[0m16:07:02.108407 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_order_fulfillment' was properly closed.
[0m16:07:02.109266 [info ] [MainThread]: 
[0m16:07:02.110093 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m16:07:02.111477 [debug] [MainThread]: Command end result
[0m16:07:02.137320 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:07:02.139287 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:07:02.148317 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m16:07:02.149036 [info ] [MainThread]: 
[0m16:07:02.149901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:02.150703 [info ] [MainThread]: 
[0m16:07:02.152075 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:07:02.155005 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5582829, "process_in_blocks": "0", "process_kernel_time": 0.310969, "process_mem_max_rss": "118576", "process_out_blocks": "2672", "process_user_time": 2.680635}
[0m16:07:02.156026 [debug] [MainThread]: Command `dbt run` succeeded at 16:07:02.155772 after 1.56 seconds
[0m16:07:02.159308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee8d452e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee6d27f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77eee8595880>]}
[0m16:07:02.160169 [debug] [MainThread]: Flushing usage events
[0m16:07:03.096461 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:40.220548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739755198380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7397551983e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739754a40200>]}


============================== 16:09:40.224017 | 274adb39-6205-40f0-be2b-9197a7295896 ==============================
[0m16:09:40.224017 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:09:40.224931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:09:40.421739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '274adb39-6205-40f0-be2b-9197a7295896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739753ef1280>]}
[0m16:09:40.485033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '274adb39-6205-40f0-be2b-9197a7295896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739754dc6780>]}
[0m16:09:40.486125 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:09:40.628121 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:09:40.703678 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:09:40.704487 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/src/stg_order_lines.sql
[0m16:09:40.976206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '274adb39-6205-40f0-be2b-9197a7295896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739752bfb230>]}
[0m16:09:41.033429 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:09:41.036629 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:09:41.049056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '274adb39-6205-40f0-be2b-9197a7295896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739752be2720>]}
[0m16:09:41.049719 [info ] [MainThread]: Found 6 models, 431 macros
[0m16:09:41.050508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '274adb39-6205-40f0-be2b-9197a7295896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739752b04350>]}
[0m16:09:41.053227 [info ] [MainThread]: 
[0m16:09:41.054119 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:09:41.055003 [info ] [MainThread]: 
[0m16:09:41.056130 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:09:41.063382 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m16:09:41.113561 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m16:09:41.115032 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m16:09:41.115926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:41.122077 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m16:09:41.124512 [debug] [ThreadPool]: On list_raw: Close
[0m16:09:41.129682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m16:09:41.141003 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:09:41.141921 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m16:09:41.142817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:41.150867 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m16:09:41.151735 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:09:41.152648 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m16:09:41.161134 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m16:09:41.164118 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m16:09:41.165119 [debug] [ThreadPool]: On list_raw_raw: Close
[0m16:09:41.178577 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:41.179541 [debug] [MainThread]: On master: BEGIN
[0m16:09:41.180422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:41.185124 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:09:41.190615 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:41.192545 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:09:41.214289 [debug] [MainThread]: SQL status: SELECT 4 in 0.021 seconds
[0m16:09:41.218139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '274adb39-6205-40f0-be2b-9197a7295896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739752bf72f0>]}
[0m16:09:41.219225 [debug] [MainThread]: On master: ROLLBACK
[0m16:09:41.220254 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:41.221132 [debug] [MainThread]: On master: BEGIN
[0m16:09:41.225868 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:09:41.226781 [debug] [MainThread]: On master: COMMIT
[0m16:09:41.227659 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:41.228896 [debug] [MainThread]: On master: COMMIT
[0m16:09:41.230398 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:09:41.231292 [debug] [MainThread]: On master: Close
[0m16:09:41.237749 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer
[0m16:09:41.239353 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m16:09:41.241027 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_date
[0m16:09:41.242712 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order_fulfillment
[0m16:09:41.238755 [info ] [Thread-1 (]: 1 of 5 START sql view model raw.stg_customer ................................... [RUN]
[0m16:09:41.244696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer)
[0m16:09:41.247448 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer
[0m16:09:41.241920 [info ] [Thread-3 (]: 3 of 5 START sql view model raw.stg_date ....................................... [RUN]
[0m16:09:41.243598 [info ] [Thread-4 (]: 4 of 5 START sql view model raw.stg_order_fulfillment .......................... [RUN]
[0m16:09:41.240253 [info ] [Thread-2 (]: 2 of 5 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m16:09:41.256614 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_date'
[0m16:09:41.263386 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_date
[0m16:09:41.268117 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_date"
[0m16:09:41.269132 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_date
[0m16:09:41.262036 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m16:09:41.260282 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer"
[0m16:09:41.283031 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer
[0m16:09:41.276278 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m16:09:41.261227 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order_fulfillment'
[0m16:09:41.297880 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:09:41.303934 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order_fulfillment
[0m16:09:41.327297 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:09:41.305229 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m16:09:41.328280 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.stg_order_fulfillment
[0m16:09:41.368401 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:09:41.369612 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer"
[0m16:09:41.372579 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:09:41.374043 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_date"
[0m16:09:41.375060 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:09:41.375803 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:09:41.376780 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: BEGIN
[0m16:09:41.377347 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:09:41.377828 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:09:41.378459 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: BEGIN
[0m16:09:41.379059 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:09:41.379689 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m16:09:41.381810 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:09:41.380855 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:41.380276 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: BEGIN
[0m16:09:41.385413 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:09:41.388860 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m16:09:41.391280 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m16:09:41.392044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m16:09:41.392779 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:09:41.393677 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:09:41.394968 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m16:09:41.395452 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:09:41.398853 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */

  create view "raw"."raw"."stg_customer__dbt_tmp"
    
    
  as (
    WITH customer AS (
    SELECT * 
    FROM raw.raw.customers
)

SELECT
    customer_id,
    customer_name,
    city
   
FROM customer
  );
[0m16:09:41.396909 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m16:09:41.397838 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:09:41.396177 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */

  create view "raw"."raw"."stg_order_fulfillment__dbt_tmp"
    
    
  as (
    WITH order_fulfillment AS (
    SELECT * 
    FROM raw.raw.order_fulfillment
)

SELECT
    order_id,
    on_time,
    in_full,
    otif
   
FROM order_fulfillment
  );
[0m16:09:41.401611 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:09:41.402098 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */

  create view "raw"."raw"."stg_date__dbt_tmp"
    
    
  as (
    WITH dates AS (
    SELECT * 
    FROM raw.raw.dates
)

SELECT
    date,
   mmm_yy,
    week_no
   
FROM dates
  );
[0m16:09:41.402618 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:09:41.413436 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:09:41.412644 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m16:09:41.417589 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:09:41.421041 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:09:41.424348 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:09:41.427559 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:09:41.428206 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer" rename to "stg_customer__dbt_backup"
[0m16:09:41.428832 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets" rename to "stg_customer_targets__dbt_backup"
[0m16:09:41.429461 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date" rename to "stg_date__dbt_backup"
[0m16:09:41.430075 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
alter table "raw"."raw"."stg_order_fulfillment" rename to "stg_order_fulfillment__dbt_backup"
[0m16:09:41.431352 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:09:41.432105 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:09:41.432727 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:09:41.433257 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:09:41.436394 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:09:41.440615 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:09:41.443495 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:09:41.446450 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:09:41.447089 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m16:09:41.447715 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date__dbt_tmp" rename to "stg_date"
[0m16:09:41.448333 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m16:09:41.448950 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
alter table "raw"."raw"."stg_order_fulfillment__dbt_tmp" rename to "stg_order_fulfillment"
[0m16:09:41.450018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:09:41.450532 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:09:41.457218 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:09:41.462882 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m16:09:41.497191 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:09:41.509850 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:09:41.499943 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m16:09:41.512110 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:09:41.513000 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m16:09:41.508094 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m16:09:41.501188 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: COMMIT
[0m16:09:41.515602 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:09:41.516497 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: COMMIT
[0m16:09:41.511155 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:09:41.514354 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:09:41.519251 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m16:09:41.517722 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m16:09:41.520045 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:09:41.531570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m16:09:41.535373 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m16:09:41.535865 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m16:09:41.536279 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_date__dbt_backup"
[0m16:09:41.538868 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_customer__dbt_backup"
[0m16:09:41.552358 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:09:41.553199 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
drop view if exists "raw"."raw"."stg_customer__dbt_backup" cascade
[0m16:09:41.548909 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."stg_order_fulfillment__dbt_backup"
[0m16:09:41.550688 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:09:41.558917 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
drop view if exists "raw"."raw"."stg_date__dbt_backup" cascade
[0m16:09:41.545552 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:09:41.560694 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m16:09:41.557778 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:09:41.562692 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
drop view if exists "raw"."raw"."stg_order_fulfillment__dbt_backup" cascade
[0m16:09:41.570769 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.017 seconds
[0m16:09:41.574935 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: Close
[0m16:09:41.577444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274adb39-6205-40f0-be2b-9197a7295896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7397562fb9b0>]}
[0m16:09:41.578726 [info ] [Thread-1 (]: 1 of 5 OK created sql view model raw.stg_customer .............................. [[32mCREATE VIEW[0m in 0.33s]
[0m16:09:41.580075 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer
[0m16:09:41.580643 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.021 seconds
[0m16:09:41.581115 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.020 seconds
[0m16:09:41.581568 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.018 seconds
[0m16:09:41.582418 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m16:09:41.584015 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: Close
[0m16:09:41.589821 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274adb39-6205-40f0-be2b-9197a7295896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739751187fb0>]}
[0m16:09:41.587684 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: Close
[0m16:09:41.591993 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274adb39-6205-40f0-be2b-9197a7295896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7397512a56d0>]}
[0m16:09:41.585619 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m16:09:41.594188 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274adb39-6205-40f0-be2b-9197a7295896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7397512a7a10>]}
[0m16:09:41.595183 [info ] [Thread-2 (]: 2 of 5 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.33s]
[0m16:09:41.592986 [info ] [Thread-4 (]: 4 of 5 OK created sql view model raw.stg_order_fulfillment ..................... [[32mCREATE VIEW[0m in 0.33s]
[0m16:09:41.597400 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order_fulfillment
[0m16:09:41.590919 [info ] [Thread-3 (]: 3 of 5 OK created sql view model raw.stg_date .................................. [[32mCREATE VIEW[0m in 0.33s]
[0m16:09:41.598733 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_date
[0m16:09:41.596390 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m16:09:41.588762 [info ] [Thread-1 (]: 5 of 5 START sql view model raw.stg_order_lines ................................ [RUN]
[0m16:09:41.600090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer, now model.nexabrands_dbt.stg_order_lines)
[0m16:09:41.600953 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m16:09:41.603586 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m16:09:41.604371 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_order_lines
[0m16:09:41.608525 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_lines"
[0m16:09:41.609328 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:09:41.609918 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: BEGIN
[0m16:09:41.610565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:41.613933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m16:09:41.617169 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:09:41.617768 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */

  create view "raw"."raw"."stg_order_lines__dbt_tmp"
    
    
  as (
    WITH order_lines AS (
    SELECT * 
    FROM raw.raw.order_lines
)

SELECT
    order_id,
    product_id,
    order_qty,
    agreed_delivery_date,
    actual_delivery_date,
    delivery_qty 
   
FROM order_lines
  );
[0m16:09:41.620156 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:09:41.623781 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:09:41.624470 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines__dbt_tmp" rename to "stg_order_lines"
[0m16:09:41.625365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:09:41.627161 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m16:09:41.627761 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:09:41.628332 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m16:09:41.629697 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:09:41.633606 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_order_lines__dbt_backup"
[0m16:09:41.634752 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:09:41.635398 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
drop view if exists "raw"."raw"."stg_order_lines__dbt_backup" cascade
[0m16:09:41.636154 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:09:41.637604 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: Close
[0m16:09:41.638532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '274adb39-6205-40f0-be2b-9197a7295896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739739f521e0>]}
[0m16:09:41.639578 [info ] [Thread-1 (]: 5 of 5 OK created sql view model raw.stg_order_lines ........................... [[32mCREATE VIEW[0m in 0.04s]
[0m16:09:41.640832 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m16:09:41.642668 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:41.643149 [debug] [MainThread]: On master: BEGIN
[0m16:09:41.643633 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:41.647160 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:09:41.647886 [debug] [MainThread]: On master: COMMIT
[0m16:09:41.648586 [debug] [MainThread]: Using postgres connection "master"
[0m16:09:41.649277 [debug] [MainThread]: On master: COMMIT
[0m16:09:41.650107 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:09:41.650865 [debug] [MainThread]: On master: Close
[0m16:09:41.653037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:41.654430 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m16:09:41.654941 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_order_lines' was properly closed.
[0m16:09:41.655419 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_date' was properly closed.
[0m16:09:41.655878 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_order_fulfillment' was properly closed.
[0m16:09:41.656464 [info ] [MainThread]: 
[0m16:09:41.657106 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m16:09:41.659724 [debug] [MainThread]: Command end result
[0m16:09:41.683651 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:09:41.685575 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:09:41.691851 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m16:09:41.692866 [info ] [MainThread]: 
[0m16:09:41.693619 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:41.694894 [info ] [MainThread]: 
[0m16:09:41.695657 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:09:41.696969 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5327679, "process_in_blocks": "0", "process_kernel_time": 0.268685, "process_mem_max_rss": "119424", "process_out_blocks": "2704", "process_user_time": 2.540654}
[0m16:09:41.697607 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:41.697451 after 1.53 seconds
[0m16:09:41.698224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739754ac4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7397550df5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73975495d430>]}
[0m16:09:41.698800 [debug] [MainThread]: Flushing usage events
[0m16:09:42.664288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:10.825238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e214215f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e21404cca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2140a9e330>]}


============================== 16:11:10.828654 | 88343537-fdb7-4d45-85d7-a5daf3bcf943 ==============================
[0m16:11:10.828654 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:11:10.829562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:11:11.022419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88343537-fdb7-4d45-85d7-a5daf3bcf943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2140598470>]}
[0m16:11:11.092792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88343537-fdb7-4d45-85d7-a5daf3bcf943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2143112810>]}
[0m16:11:11.093819 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:11:11.244627 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:11:11.327976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:11:11.328844 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/src/stg_order.sql
[0m16:11:11.583168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88343537-fdb7-4d45-85d7-a5daf3bcf943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e213e7ff320>]}
[0m16:11:11.640704 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:11:11.643698 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:11:11.655949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88343537-fdb7-4d45-85d7-a5daf3bcf943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e213e32ff50>]}
[0m16:11:11.656560 [info ] [MainThread]: Found 6 models, 431 macros
[0m16:11:11.657139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88343537-fdb7-4d45-85d7-a5daf3bcf943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e213e7fb260>]}
[0m16:11:11.659181 [info ] [MainThread]: 
[0m16:11:11.659755 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:11.660311 [info ] [MainThread]: 
[0m16:11:11.661095 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:11.665878 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m16:11:11.701734 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m16:11:11.702404 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m16:11:11.702952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:11.707409 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m16:11:11.708838 [debug] [ThreadPool]: On list_raw: Close
[0m16:11:11.710956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m16:11:11.717396 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:11:11.717906 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m16:11:11.718438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:11.721927 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:11:11.723114 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:11:11.723756 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m16:11:11.726391 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m16:11:11.728454 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m16:11:11.729247 [debug] [ThreadPool]: On list_raw_raw: Close
[0m16:11:11.736875 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:11.737438 [debug] [MainThread]: On master: BEGIN
[0m16:11:11.737892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:11.741541 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:11:11.743564 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:11.744183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:11:11.758304 [debug] [MainThread]: SQL status: SELECT 5 in 0.014 seconds
[0m16:11:11.760866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88343537-fdb7-4d45-85d7-a5daf3bcf943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e213fbcbce0>]}
[0m16:11:11.761494 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:11.762113 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:11.762633 [debug] [MainThread]: On master: BEGIN
[0m16:11:11.763403 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:11:11.764356 [debug] [MainThread]: On master: COMMIT
[0m16:11:11.765301 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:11.766283 [debug] [MainThread]: On master: COMMIT
[0m16:11:11.767254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:11:11.767737 [debug] [MainThread]: On master: Close
[0m16:11:11.771915 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer
[0m16:11:11.772446 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m16:11:11.773083 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_date
[0m16:11:11.773676 [info ] [Thread-1 (]: 1 of 6 START sql view model raw.stg_customer ................................... [RUN]
[0m16:11:11.774399 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order
[0m16:11:11.774973 [info ] [Thread-2 (]: 2 of 6 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m16:11:11.776488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer)
[0m16:11:11.775568 [info ] [Thread-3 (]: 3 of 6 START sql view model raw.stg_date ....................................... [RUN]
[0m16:11:11.777328 [info ] [Thread-4 (]: 4 of 6 START sql view model raw.stg_order ...................................... [RUN]
[0m16:11:11.780419 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order'
[0m16:11:11.781186 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order
[0m16:11:11.779629 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_date'
[0m16:11:11.778078 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m16:11:11.778931 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer
[0m16:11:11.788153 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order"
[0m16:11:11.788767 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_date
[0m16:11:11.789368 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m16:11:11.791270 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer"
[0m16:11:11.792159 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.stg_order
[0m16:11:11.793784 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_date"
[0m16:11:11.795619 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:11.796522 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer
[0m16:11:11.820310 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m16:11:11.820806 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_date
[0m16:11:11.836125 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order"
[0m16:11:11.840070 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer"
[0m16:11:11.843961 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:11.847777 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_date"
[0m16:11:11.848716 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m16:11:11.849577 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:11.850441 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:11:11.850915 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:11:11.851489 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: BEGIN
[0m16:11:11.852120 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m16:11:11.852720 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: BEGIN
[0m16:11:11.853311 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: BEGIN
[0m16:11:11.853894 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:11:11.854516 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:11.855098 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:11:11.855677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:11.860595 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m16:11:11.861653 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m16:11:11.862665 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order"} */

  create view "raw"."raw"."stg_order__dbt_tmp"
    
    
  as (
    WITH orders AS (
    SELECT * 
    FROM raw.raw.orders
)

SELECT
    order_id,
    order_id ,
    order_placement_date 
   
FROM orders
  );
[0m16:11:11.864192 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "order_id" specified more than once

[0m16:11:11.865195 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: ROLLBACK
[0m16:11:11.866514 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: Close
[0m16:11:11.874641 [debug] [Thread-4 (]: Database Error in model stg_order (models/src/stg_order.sql)
  column "order_id" specified more than once
  compiled code at target/run/nexabrands_dbt/models/src/stg_order.sql
[0m16:11:11.877150 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88343537-fdb7-4d45-85d7-a5daf3bcf943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e213ce8ab10>]}
[0m16:11:11.878368 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model raw.stg_order ............................. [[31mERROR[0m in 0.10s]
[0m16:11:11.879318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m16:11:11.882067 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:11:11.880011 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m16:11:11.883971 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:11:11.886648 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */

  create view "raw"."raw"."stg_date__dbt_tmp"
    
    
  as (
    WITH dates AS (
    SELECT * 
    FROM raw.raw.dates
)

SELECT
    date,
   mmm_yy,
    week_no
   
FROM dates
  );
[0m16:11:11.882826 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */

  create view "raw"."raw"."stg_customer__dbt_tmp"
    
    
  as (
    WITH customer AS (
    SELECT * 
    FROM raw.raw.customers
)

SELECT
    customer_id,
    customer_name,
    city
   
FROM customer
  );
[0m16:11:11.881366 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order
[0m16:11:11.888143 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order_fulfillment
[0m16:11:11.889145 [info ] [Thread-4 (]: 5 of 6 START sql view model raw.stg_order_fulfillment .......................... [RUN]
[0m16:11:11.890108 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_order, now model.nexabrands_dbt.stg_order_fulfillment)
[0m16:11:11.891048 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order_fulfillment
[0m16:11:11.894262 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:11.895502 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.stg_order_fulfillment
[0m16:11:11.905794 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m16:11:11.922390 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.035 seconds
[0m16:11:11.938664 [debug] [Thread-2 (]: SQL status: BEGIN in 0.084 seconds
[0m16:11:11.940591 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:11.941452 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m16:11:11.954553 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m16:11:11.982886 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:11:11.983599 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:11.951042 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.stg_order' to be skipped because of status 'error'.  Reason: Database Error in model stg_order (models/src/stg_order.sql)
  column "order_id" specified more than once
  compiled code at target/run/nexabrands_dbt/models/src/stg_order.sql.
[0m16:11:11.985706 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:11.987133 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer" rename to "stg_customer__dbt_backup"
[0m16:11:11.986239 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:11:11.988560 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:11.989905 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets" rename to "stg_customer_targets__dbt_backup"
[0m16:11:11.990959 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date" rename to "stg_date__dbt_backup"
[0m16:11:11.991492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:11.992054 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: BEGIN
[0m16:11:11.997141 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:11:11.997864 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:11:11.998376 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:11:11.998834 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:11.999454 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m16:11:12.002524 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:11:12.005564 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:12.006783 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date__dbt_tmp" rename to "stg_date"
[0m16:11:12.008163 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m16:11:12.010527 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m16:11:12.011461 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:12.008953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:11:12.012324 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:11:12.012806 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */

  create view "raw"."raw"."stg_order_fulfillment__dbt_tmp"
    
    
  as (
    WITH order_fulfillment AS (
    SELECT * 
    FROM raw.raw.order_fulfillment
)

SELECT
    order_id,
    on_time,
    in_full,
    otif
   
FROM order_fulfillment
  );
[0m16:11:12.013267 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:11:12.032993 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m16:11:12.034950 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m16:11:12.037860 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:11:12.038396 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:11:12.039028 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:11:12.039648 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:11:12.040262 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:12.043758 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:12.044399 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m16:11:12.045013 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m16:11:12.045624 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:11:12.046257 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
alter table "raw"."raw"."stg_order_fulfillment" rename to "stg_order_fulfillment__dbt_backup"
[0m16:11:12.047987 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:11:12.048957 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:11:12.049454 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m16:11:12.049906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:11:12.052774 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:12.059944 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m16:11:12.062564 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_date__dbt_backup"
[0m16:11:12.065033 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_customer__dbt_backup"
[0m16:11:12.065682 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
alter table "raw"."raw"."stg_order_fulfillment__dbt_tmp" rename to "stg_order_fulfillment"
[0m16:11:12.072277 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:12.073431 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:11:12.074590 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:11:12.075631 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m16:11:12.076125 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:12.076787 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
drop view if exists "raw"."raw"."stg_date__dbt_backup" cascade
[0m16:11:12.077382 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
drop view if exists "raw"."raw"."stg_customer__dbt_backup" cascade
[0m16:11:12.080656 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: COMMIT
[0m16:11:12.082385 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:12.081156 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:11:12.083433 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: COMMIT
[0m16:11:12.084203 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:11:12.084671 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:11:12.087284 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m16:11:12.089297 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: Close
[0m16:11:12.095280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88343537-fdb7-4d45-85d7-a5daf3bcf943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e213cebc0b0>]}
[0m16:11:12.096358 [info ] [Thread-1 (]: 1 of 6 OK created sql view model raw.stg_customer .............................. [[32mCREATE VIEW[0m in 0.32s]
[0m16:11:12.097675 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer
[0m16:11:12.101349 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m16:11:12.089776 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m16:11:12.102680 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88343537-fdb7-4d45-85d7-a5daf3bcf943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e21420339b0>]}
[0m16:11:12.111707 [info ] [Thread-2 (]: 2 of 6 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.32s]
[0m16:11:12.112855 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m16:11:12.104910 [info ] [Thread-1 (]: 6 of 6 START sql view model raw.stg_order_lines ................................ [RUN]
[0m16:11:12.114946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer, now model.nexabrands_dbt.stg_order_lines)
[0m16:11:12.115819 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m16:11:12.091226 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: Close
[0m16:11:12.124356 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88343537-fdb7-4d45-85d7-a5daf3bcf943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e213cd489e0>]}
[0m16:11:12.119349 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m16:11:12.127403 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_order_lines
[0m16:11:12.109943 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."stg_order_fulfillment__dbt_backup"
[0m16:11:12.125636 [info ] [Thread-3 (]: 3 of 6 OK created sql view model raw.stg_date .................................. [[32mCREATE VIEW[0m in 0.34s]
[0m16:11:12.135705 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_date
[0m16:11:12.134627 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:12.136778 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
drop view if exists "raw"."raw"."stg_order_fulfillment__dbt_backup" cascade
[0m16:11:12.142628 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_lines"
[0m16:11:12.143383 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m16:11:12.145934 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: Close
[0m16:11:12.147177 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88343537-fdb7-4d45-85d7-a5daf3bcf943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e213c4a1bb0>]}
[0m16:11:12.148271 [info ] [Thread-4 (]: 5 of 6 OK created sql view model raw.stg_order_fulfillment ..................... [[32mCREATE VIEW[0m in 0.26s]
[0m16:11:12.149427 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order_fulfillment
[0m16:11:12.150706 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:11:12.153099 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: BEGIN
[0m16:11:12.154222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:12.158583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m16:11:12.159578 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:11:12.160568 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */

  create view "raw"."raw"."stg_order_lines__dbt_tmp"
    
    
  as (
    WITH order_lines AS (
    SELECT * 
    FROM raw.raw.order_lines
)

SELECT
    order_id,
    product_id,
    order_qty,
    agreed_delivery_date,
    actual_delivery_date,
    delivery_qty 
   
FROM order_lines
  );
[0m16:11:12.162804 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m16:11:12.167040 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:11:12.167613 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines" rename to "stg_order_lines__dbt_backup"
[0m16:11:12.168449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:11:12.171630 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:11:12.172206 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines__dbt_tmp" rename to "stg_order_lines"
[0m16:11:12.173038 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:11:12.175622 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m16:11:12.176262 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:11:12.177178 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m16:11:12.178835 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:11:12.181287 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_order_lines__dbt_backup"
[0m16:11:12.182437 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:11:12.183000 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
drop view if exists "raw"."raw"."stg_order_lines__dbt_backup" cascade
[0m16:11:12.184652 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:11:12.186373 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: Close
[0m16:11:12.187246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88343537-fdb7-4d45-85d7-a5daf3bcf943', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e213c4cfe60>]}
[0m16:11:12.188312 [info ] [Thread-1 (]: 6 of 6 OK created sql view model raw.stg_order_lines ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m16:11:12.189459 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m16:11:12.191534 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:12.192022 [debug] [MainThread]: On master: BEGIN
[0m16:11:12.192535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:12.196532 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:11:12.197505 [debug] [MainThread]: On master: COMMIT
[0m16:11:12.198788 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:12.199961 [debug] [MainThread]: On master: COMMIT
[0m16:11:12.201005 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:11:12.201857 [debug] [MainThread]: On master: Close
[0m16:11:12.205809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:12.206669 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m16:11:12.207143 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_order_lines' was properly closed.
[0m16:11:12.207626 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_date' was properly closed.
[0m16:11:12.208100 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_order_fulfillment' was properly closed.
[0m16:11:12.208717 [info ] [MainThread]: 
[0m16:11:12.209417 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m16:11:12.211152 [debug] [MainThread]: Command end result
[0m16:11:12.235365 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:11:12.237222 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:11:12.243631 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m16:11:12.244183 [info ] [MainThread]: 
[0m16:11:12.244847 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:11:12.245439 [info ] [MainThread]: 
[0m16:11:12.246100 [error] [MainThread]:   Database Error in model stg_order (models/src/stg_order.sql)
  column "order_id" specified more than once
  compiled code at target/run/nexabrands_dbt/models/src/stg_order.sql
[0m16:11:12.246706 [info ] [MainThread]: 
[0m16:11:12.247327 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m16:11:12.248573 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.501816, "process_in_blocks": "0", "process_kernel_time": 0.362497, "process_mem_max_rss": "118720", "process_out_blocks": "2728", "process_user_time": 2.525531}
[0m16:11:12.249225 [debug] [MainThread]: Command `dbt run` failed at 16:11:12.249103 after 1.50 seconds
[0m16:11:12.249848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2140490830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e21404917f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e213f370710>]}
[0m16:11:12.250543 [debug] [MainThread]: Flushing usage events
[0m16:11:13.206956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:33.578551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b024225f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02437091c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b024370a030>]}


============================== 16:11:33.581872 | 5c387e8b-27bf-4755-bf9f-68d79b80a695 ==============================
[0m16:11:33.581872 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:11:33.582846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:11:33.762020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c387e8b-27bf-4755-bf9f-68d79b80a695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b024197caa0>]}
[0m16:11:33.826102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c387e8b-27bf-4755-bf9f-68d79b80a695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0241806f90>]}
[0m16:11:33.827191 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:11:33.944765 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:11:34.036126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:11:34.036994 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/src/stg_order.sql
[0m16:11:34.284368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c387e8b-27bf-4755-bf9f-68d79b80a695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b023fdfaf60>]}
[0m16:11:34.341708 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:11:34.344889 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:11:34.357714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c387e8b-27bf-4755-bf9f-68d79b80a695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b023fdd33e0>]}
[0m16:11:34.358388 [info ] [MainThread]: Found 6 models, 431 macros
[0m16:11:34.359071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c387e8b-27bf-4755-bf9f-68d79b80a695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b02401fa5d0>]}
[0m16:11:34.361102 [info ] [MainThread]: 
[0m16:11:34.361778 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:34.362422 [info ] [MainThread]: 
[0m16:11:34.363224 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:34.368855 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m16:11:34.404231 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m16:11:34.404811 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m16:11:34.405339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:34.409712 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m16:11:34.411153 [debug] [ThreadPool]: On list_raw: Close
[0m16:11:34.413384 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m16:11:34.419908 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:11:34.420471 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m16:11:34.420964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:34.425148 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m16:11:34.426288 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m16:11:34.426834 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m16:11:34.429415 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m16:11:34.432074 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m16:11:34.432946 [debug] [ThreadPool]: On list_raw_raw: Close
[0m16:11:34.439945 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:34.440506 [debug] [MainThread]: On master: BEGIN
[0m16:11:34.440955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:34.445675 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:11:34.446434 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:34.447069 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:11:34.460936 [debug] [MainThread]: SQL status: SELECT 5 in 0.013 seconds
[0m16:11:34.463298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c387e8b-27bf-4755-bf9f-68d79b80a695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b023f968410>]}
[0m16:11:34.463899 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:34.464488 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:34.464947 [debug] [MainThread]: On master: BEGIN
[0m16:11:34.465934 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m16:11:34.466690 [debug] [MainThread]: On master: COMMIT
[0m16:11:34.467405 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:34.468117 [debug] [MainThread]: On master: COMMIT
[0m16:11:34.468850 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:11:34.469332 [debug] [MainThread]: On master: Close
[0m16:11:34.473132 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer
[0m16:11:34.474078 [info ] [Thread-1 (]: 1 of 6 START sql view model raw.stg_customer ................................... [RUN]
[0m16:11:34.475012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer)
[0m16:11:34.475538 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m16:11:34.476170 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_date
[0m16:11:34.476637 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer
[0m16:11:34.477092 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order
[0m16:11:34.477799 [info ] [Thread-2 (]: 2 of 6 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m16:11:34.487295 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer"
[0m16:11:34.478610 [info ] [Thread-3 (]: 3 of 6 START sql view model raw.stg_date ....................................... [RUN]
[0m16:11:34.488174 [info ] [Thread-4 (]: 4 of 6 START sql view model raw.stg_order ...................................... [RUN]
[0m16:11:34.491548 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order'
[0m16:11:34.492372 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order
[0m16:11:34.488940 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m16:11:34.489871 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer
[0m16:11:34.490618 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_date'
[0m16:11:34.494789 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order"
[0m16:11:34.495415 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m16:11:34.517135 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_date
[0m16:11:34.532808 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer"
[0m16:11:34.533844 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.stg_order
[0m16:11:34.536914 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:34.538767 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_date"
[0m16:11:34.542852 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order"
[0m16:11:34.543568 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:11:34.544551 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_date
[0m16:11:34.545371 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m16:11:34.545876 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m16:11:34.546362 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: BEGIN
[0m16:11:34.550085 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_date"
[0m16:11:34.553778 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:34.554425 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: BEGIN
[0m16:11:34.555029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:34.556165 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:11:34.556661 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:11:34.557703 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:34.560759 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m16:11:34.559939 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: BEGIN
[0m16:11:34.563027 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m16:11:34.561907 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:34.566132 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:11:34.568348 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m16:11:34.568838 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:11:34.572850 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */

  create view "raw"."raw"."stg_customer__dbt_tmp"
    
    
  as (
    WITH customer AS (
    SELECT * 
    FROM raw.raw.customers
)

SELECT
    customer_id,
    customer_name,
    city
   
FROM customer
  );
[0m16:11:34.570890 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m16:11:34.575456 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order"} */

  create view "raw"."raw"."stg_order__dbt_tmp"
    
    
  as (
    WITH orders AS (
    SELECT * 
    FROM raw.raw.orders
)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
  );
[0m16:11:34.576470 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:11:34.582789 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:11:34.586531 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:11:34.587623 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m16:11:34.588118 [debug] [Thread-2 (]: SQL status: BEGIN in 0.026 seconds
[0m16:11:34.591369 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m16:11:34.592004 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer" rename to "stg_customer__dbt_backup"
[0m16:11:34.592628 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:11:34.593203 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:34.593856 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order"} */
alter table "raw"."raw"."stg_order__dbt_tmp" rename to "stg_order"
[0m16:11:34.594772 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */

  create view "raw"."raw"."stg_date__dbt_tmp"
    
    
  as (
    WITH dates AS (
    SELECT * 
    FROM raw.raw.dates
)

SELECT
    date,
   mmm_yy,
    week_no
   
FROM dates
  );
[0m16:11:34.595311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:34.595922 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m16:11:34.600071 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:11:34.600735 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:11:34.607842 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:11:34.602323 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m16:11:34.602982 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m16:11:34.601321 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:11:34.608631 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date" rename to "stg_date__dbt_backup"
[0m16:11:34.615412 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:11:34.614689 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:34.637184 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:11:34.655231 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets" rename to "stg_customer_targets__dbt_backup"
[0m16:11:34.654184 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: COMMIT
[0m16:11:34.658693 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m16:11:34.665465 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:11:34.666531 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m16:11:34.667766 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:11:34.668472 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:11:34.669096 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date__dbt_tmp" rename to "stg_date"
[0m16:11:34.669692 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: COMMIT
[0m16:11:34.672756 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:34.673389 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m16:11:34.674641 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:34.676786 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m16:11:34.682003 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:11:34.680672 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m16:11:34.685023 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:11:34.685498 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m16:11:34.685966 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m16:11:34.699320 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_customer__dbt_backup"
[0m16:11:34.687209 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:34.686625 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:11:34.705272 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m16:11:34.695238 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."stg_order__dbt_backup"
[0m16:11:34.708688 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m16:11:34.709161 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m16:11:34.710738 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m16:11:34.711327 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:11:34.711816 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
drop view if exists "raw"."raw"."stg_customer__dbt_backup" cascade
[0m16:11:34.712484 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order"} */
drop view if exists "raw"."raw"."stg_order__dbt_backup" cascade
[0m16:11:34.713479 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m16:11:34.715963 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m16:11:34.719428 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_date__dbt_backup"
[0m16:11:34.720066 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:11:34.721062 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m16:11:34.721524 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m16:11:34.722728 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m16:11:34.725330 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: Close
[0m16:11:34.725989 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m16:11:34.727522 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: Close
[0m16:11:34.731739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c387e8b-27bf-4755-bf9f-68d79b80a695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b023e55a600>]}
[0m16:11:34.730576 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c387e8b-27bf-4755-bf9f-68d79b80a695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b023e387ef0>]}
[0m16:11:34.735168 [info ] [Thread-4 (]: 4 of 6 OK created sql view model raw.stg_order ................................. [[32mCREATE VIEW[0m in 0.24s]
[0m16:11:34.728144 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
drop view if exists "raw"."raw"."stg_date__dbt_backup" cascade
[0m16:11:34.732891 [info ] [Thread-1 (]: 1 of 6 OK created sql view model raw.stg_customer .............................. [[32mCREATE VIEW[0m in 0.26s]
[0m16:11:34.736216 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m16:11:34.736999 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order
[0m16:11:34.738696 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer
[0m16:11:34.739929 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:11:34.742431 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m16:11:34.746083 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c387e8b-27bf-4755-bf9f-68d79b80a695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b023e489190>]}
[0m16:11:34.747157 [info ] [Thread-2 (]: 2 of 6 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.26s]
[0m16:11:34.743758 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m16:11:34.743066 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order_fulfillment
[0m16:11:34.745237 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: Close
[0m16:11:34.750883 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c387e8b-27bf-4755-bf9f-68d79b80a695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b023e494110>]}
[0m16:11:34.748252 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m16:11:34.749900 [info ] [Thread-4 (]: 5 of 6 START sql view model raw.stg_order_fulfillment .......................... [RUN]
[0m16:11:34.753155 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_order, now model.nexabrands_dbt.stg_order_fulfillment)
[0m16:11:34.754901 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order_fulfillment
[0m16:11:34.749129 [info ] [Thread-1 (]: 6 of 6 START sql view model raw.stg_order_lines ................................ [RUN]
[0m16:11:34.751891 [info ] [Thread-3 (]: 3 of 6 OK created sql view model raw.stg_date .................................. [[32mCREATE VIEW[0m in 0.26s]
[0m16:11:34.757075 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:34.759710 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.stg_order_fulfillment
[0m16:11:34.758576 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_date
[0m16:11:34.757749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer, now model.nexabrands_dbt.stg_order_lines)
[0m16:11:34.764807 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:34.765677 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m16:11:34.766651 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:34.768368 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m16:11:34.769041 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: BEGIN
[0m16:11:34.769904 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_order_lines
[0m16:11:34.770433 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:34.774142 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_lines"
[0m16:11:34.775672 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:11:34.776591 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: BEGIN
[0m16:11:34.777461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:34.779791 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m16:11:34.780713 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:34.781656 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */

  create view "raw"."raw"."stg_order_fulfillment__dbt_tmp"
    
    
  as (
    WITH order_fulfillment AS (
    SELECT * 
    FROM raw.raw.order_fulfillment
)

SELECT
    order_id,
    on_time,
    in_full,
    otif
   
FROM order_fulfillment
  );
[0m16:11:34.782612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:11:34.783448 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:11:34.784827 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */

  create view "raw"."raw"."stg_order_lines__dbt_tmp"
    
    
  as (
    WITH order_lines AS (
    SELECT * 
    FROM raw.raw.order_lines
)

SELECT
    order_id,
    product_id,
    order_qty,
    agreed_delivery_date,
    actual_delivery_date,
    delivery_qty 
   
FROM order_lines
  );
[0m16:11:34.785667 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:11:34.790655 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:34.791295 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:11:34.791763 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
alter table "raw"."raw"."stg_order_fulfillment" rename to "stg_order_fulfillment__dbt_backup"
[0m16:11:34.796363 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:11:34.797258 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines" rename to "stg_order_lines__dbt_backup"
[0m16:11:34.797902 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:34.801063 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:34.801688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:11:34.802178 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
alter table "raw"."raw"."stg_order_fulfillment__dbt_tmp" rename to "stg_order_fulfillment"
[0m16:11:34.805124 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:11:34.805996 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines__dbt_tmp" rename to "stg_order_lines"
[0m16:11:34.806557 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:34.808807 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: COMMIT
[0m16:11:34.809275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:11:34.809875 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:34.811870 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m16:11:34.812494 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: COMMIT
[0m16:11:34.813116 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:11:34.814062 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m16:11:34.815555 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m16:11:34.816076 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:11:34.818648 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."stg_order_fulfillment__dbt_backup"
[0m16:11:34.821126 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_order_lines__dbt_backup"
[0m16:11:34.822313 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m16:11:34.823436 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m16:11:34.824063 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
drop view if exists "raw"."raw"."stg_order_fulfillment__dbt_backup" cascade
[0m16:11:34.824692 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
drop view if exists "raw"."raw"."stg_order_lines__dbt_backup" cascade
[0m16:11:34.826883 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:11:34.827444 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:11:34.828938 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: Close
[0m16:11:34.830421 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: Close
[0m16:11:34.831328 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c387e8b-27bf-4755-bf9f-68d79b80a695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b023c218110>]}
[0m16:11:34.834374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c387e8b-27bf-4755-bf9f-68d79b80a695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b023e4943e0>]}
[0m16:11:34.835232 [info ] [Thread-4 (]: 5 of 6 OK created sql view model raw.stg_order_fulfillment ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:11:34.836003 [info ] [Thread-1 (]: 6 of 6 OK created sql view model raw.stg_order_lines ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m16:11:34.837068 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order_fulfillment
[0m16:11:34.837847 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m16:11:34.839874 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:34.840349 [debug] [MainThread]: On master: BEGIN
[0m16:11:34.840985 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:34.845049 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:11:34.846318 [debug] [MainThread]: On master: COMMIT
[0m16:11:34.847478 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:34.848032 [debug] [MainThread]: On master: COMMIT
[0m16:11:34.848603 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:11:34.849077 [debug] [MainThread]: On master: Close
[0m16:11:34.849901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:34.850746 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer_targets' was properly closed.
[0m16:11:34.851509 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_order_lines' was properly closed.
[0m16:11:34.852237 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_date' was properly closed.
[0m16:11:34.852676 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_order_fulfillment' was properly closed.
[0m16:11:34.854122 [info ] [MainThread]: 
[0m16:11:34.854847 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m16:11:34.856435 [debug] [MainThread]: Command end result
[0m16:11:34.880772 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m16:11:34.882505 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m16:11:34.891360 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m16:11:34.892040 [info ] [MainThread]: 
[0m16:11:34.892811 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:34.893516 [info ] [MainThread]: 
[0m16:11:34.894286 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:11:34.895863 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3741381, "process_in_blocks": "0", "process_kernel_time": 0.305072, "process_mem_max_rss": "118292", "process_out_blocks": "2720", "process_user_time": 2.571323}
[0m16:11:34.896734 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:34.896580 after 1.38 seconds
[0m16:11:34.897487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b024225f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b023fdd37a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b0240ddd070>]}
[0m16:11:34.898432 [debug] [MainThread]: Flushing usage events
[0m16:11:35.830150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:08.951311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febedc33bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febedcedc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febec4eec60>]}


============================== 19:23:08.957818 | 1286d638-9799-4f51-9813-9cf0b569d573 ==============================
[0m19:23:08.957818 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:23:08.958820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'profiles_dir': '/home/codespace/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:23:08.975551 [info ] [MainThread]: dbt version: 1.9.1
[0m19:23:08.976206 [info ] [MainThread]: python version: 3.12.1
[0m19:23:08.976772 [info ] [MainThread]: python path: /workspaces/pyspark_practice-/venv/bin/python
[0m19:23:08.977349 [info ] [MainThread]: os info: Linux-6.5.0-1025-azure-x86_64-with-glibc2.31
[0m19:23:09.073651 [info ] [MainThread]: Using profiles dir at /home/codespace/.dbt
[0m19:23:09.074426 [info ] [MainThread]: Using profiles.yml file at /home/codespace/.dbt/profiles.yml
[0m19:23:09.075015 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/pyspark_practice-/nexabrands_dbt/dbt_project.yml
[0m19:23:09.075840 [info ] [MainThread]: adapter type: postgres
[0m19:23:09.076412 [info ] [MainThread]: adapter version: 1.9.0
[0m19:23:09.177755 [info ] [MainThread]: Configuration:
[0m19:23:09.178613 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:23:09.179211 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:23:09.179795 [info ] [MainThread]: Required dependencies:
[0m19:23:09.180401 [debug] [MainThread]: Executing "git --help"
[0m19:23:09.183812 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:23:09.184567 [debug] [MainThread]: STDERR: "b''"
[0m19:23:09.185097 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:23:09.185861 [info ] [MainThread]: Connection:
[0m19:23:09.186765 [info ] [MainThread]:   host: 172.19.0.2
[0m19:23:09.187497 [info ] [MainThread]:   port: 5432
[0m19:23:09.188060 [info ] [MainThread]:   user: root
[0m19:23:09.188607 [info ] [MainThread]:   database: raw
[0m19:23:09.189166 [info ] [MainThread]:   schema: raw
[0m19:23:09.189717 [info ] [MainThread]:   connect_timeout: 10
[0m19:23:09.190261 [info ] [MainThread]:   role: None
[0m19:23:09.190972 [info ] [MainThread]:   search_path: None
[0m19:23:09.191551 [info ] [MainThread]:   keepalives_idle: 0
[0m19:23:09.192407 [info ] [MainThread]:   sslmode: None
[0m19:23:09.193325 [info ] [MainThread]:   sslcert: None
[0m19:23:09.194026 [info ] [MainThread]:   sslkey: None
[0m19:23:09.194553 [info ] [MainThread]:   sslrootcert: None
[0m19:23:09.195092 [info ] [MainThread]:   application_name: dbt
[0m19:23:09.195619 [info ] [MainThread]:   retries: 1
[0m19:23:09.196357 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:23:09.326846 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:23:09.377129 [debug] [MainThread]: Using postgres connection "debug"
[0m19:23:09.378040 [debug] [MainThread]: On debug: select 1 as id
[0m19:23:09.378605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:09.484410 [debug] [MainThread]: SQL status: SELECT 1 in 0.106 seconds
[0m19:23:09.486032 [debug] [MainThread]: On debug: Close
[0m19:23:09.486620 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:23:09.487310 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:23:09.488919 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.59764904, "process_in_blocks": "90216", "process_kernel_time": 0.314487, "process_mem_max_rss": "102960", "process_out_blocks": "24", "process_user_time": 1.695846}
[0m19:23:09.490046 [debug] [MainThread]: Command `dbt debug` succeeded at 19:23:09.489927 after 0.60 seconds
[0m19:23:09.490566 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:23:09.491119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febedcedc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febec358da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febebd978f0>]}
[0m19:23:09.491706 [debug] [MainThread]: Flushing usage events
[0m19:23:10.418906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:16.489255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd014e29c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd0147e75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd014e29f70>]}


============================== 19:23:16.492736 | 08634c20-4b4b-4171-9953-9be6c179fdeb ==============================
[0m19:23:16.492736 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:23:16.493945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/codespace/.dbt', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:23:16.702514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08634c20-4b4b-4171-9953-9be6c179fdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd015e44980>]}
[0m19:23:16.768070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08634c20-4b4b-4171-9953-9be6c179fdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd01393c4d0>]}
[0m19:23:16.769368 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:23:16.880419 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:23:16.971094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:23:16.971902 [debug] [MainThread]: Partial parsing: added file: nexabrands_dbt://models/intermediate/int_order_delivery_metrics.sql
[0m19:23:17.222668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08634c20-4b4b-4171-9953-9be6c179fdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd0139ca690>]}
[0m19:23:17.281799 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m19:23:17.285550 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m19:23:17.301239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08634c20-4b4b-4171-9953-9be6c179fdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd012127a40>]}
[0m19:23:17.301998 [info ] [MainThread]: Found 7 models, 431 macros
[0m19:23:17.302691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08634c20-4b4b-4171-9953-9be6c179fdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd01252d8e0>]}
[0m19:23:17.304854 [info ] [MainThread]: 
[0m19:23:17.305503 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:23:17.306055 [info ] [MainThread]: 
[0m19:23:17.306818 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:23:17.312059 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m19:23:17.348782 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m19:23:17.349607 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m19:23:17.350106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:17.395502 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.045 seconds
[0m19:23:17.398411 [debug] [ThreadPool]: On list_raw: Close
[0m19:23:17.400915 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m19:23:17.410357 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m19:23:17.411183 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m19:23:17.411908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:17.416330 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m19:23:17.416894 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m19:23:17.417479 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m19:23:17.441361 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.023 seconds
[0m19:23:17.443243 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m19:23:17.443912 [debug] [ThreadPool]: On list_raw_raw: Close
[0m19:23:17.451392 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:17.451955 [debug] [MainThread]: On master: BEGIN
[0m19:23:17.452460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:17.455851 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:23:17.457002 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:17.458089 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:23:17.484433 [debug] [MainThread]: SQL status: SELECT 6 in 0.025 seconds
[0m19:23:17.487277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08634c20-4b4b-4171-9953-9be6c179fdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd0121963f0>]}
[0m19:23:17.487907 [debug] [MainThread]: On master: ROLLBACK
[0m19:23:17.488558 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:17.489091 [debug] [MainThread]: On master: BEGIN
[0m19:23:17.490534 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:23:17.491051 [debug] [MainThread]: On master: COMMIT
[0m19:23:17.491546 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:17.492021 [debug] [MainThread]: On master: COMMIT
[0m19:23:17.492593 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:23:17.493121 [debug] [MainThread]: On master: Close
[0m19:23:17.496890 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer
[0m19:23:17.498490 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m19:23:17.499103 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_date
[0m19:23:17.498002 [info ] [Thread-1 (]: 1 of 7 START sql view model raw.stg_customer ................................... [RUN]
[0m19:23:17.500246 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order
[0m19:23:17.499821 [info ] [Thread-2 (]: 2 of 7 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m19:23:17.501864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer)
[0m19:23:17.501086 [info ] [Thread-3 (]: 3 of 7 START sql view model raw.stg_date ....................................... [RUN]
[0m19:23:17.505094 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_date'
[0m19:23:17.507433 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_date
[0m19:23:17.502671 [info ] [Thread-4 (]: 4 of 7 START sql view model raw.stg_order ...................................... [RUN]
[0m19:23:17.514727 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order'
[0m19:23:17.515609 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order
[0m19:23:17.503946 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer
[0m19:23:17.503358 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m19:23:17.528465 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m19:23:17.531492 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:17.527721 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer"
[0m19:23:17.524839 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order"
[0m19:23:17.534359 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.stg_order
[0m19:23:17.533043 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer
[0m19:23:17.521314 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_date"
[0m19:23:17.551861 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_date
[0m19:23:17.550682 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m19:23:17.681762 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_date"
[0m19:23:17.684382 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order"
[0m19:23:17.688841 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer"
[0m19:23:17.691216 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:17.692358 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m19:23:17.694699 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: BEGIN
[0m19:23:17.695980 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:17.693353 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:23:17.694017 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:23:17.696931 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:23:17.697823 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m19:23:17.699896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:23:17.699019 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: BEGIN
[0m19:23:17.701289 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:23:17.698433 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: BEGIN
[0m19:23:17.704186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:17.707725 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m19:23:17.709450 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m19:23:17.710696 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m19:23:17.711569 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:23:17.712423 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m19:23:17.713771 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:17.714396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m19:23:17.715005 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */

  create view "raw"."raw"."stg_date__dbt_tmp"
    
    
  as (
    WITH dates AS (
    SELECT * 
    FROM raw.raw.dates
)

SELECT
    date,
   mmm_yy,
    week_no
   
FROM dates
  );
[0m19:23:17.715903 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order"} */

  create view "raw"."raw"."stg_order__dbt_tmp"
    
    
  as (
    WITH orders AS (
    SELECT * 
    FROM raw.raw.orders
)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
  );
[0m19:23:17.716767 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m19:23:17.717417 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:23:17.718936 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */

  create view "raw"."raw"."stg_customer__dbt_tmp"
    
    
  as (
    WITH customer AS (
    SELECT * 
    FROM raw.raw.customers
)

SELECT
    customer_id,
    customer_name,
    city
   
FROM customer
  );
[0m19:23:17.732231 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m19:23:17.732914 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m19:23:17.733433 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m19:23:17.733900 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m19:23:17.748315 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:23:17.744988 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m19:23:17.741309 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:17.752270 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:23:17.752908 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date" rename to "stg_date__dbt_backup"
[0m19:23:17.753543 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order"} */
alter table "raw"."raw"."stg_order" rename to "stg_order__dbt_backup"
[0m19:23:17.754142 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets" rename to "stg_customer_targets__dbt_backup"
[0m19:23:17.754827 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer" rename to "stg_customer__dbt_backup"
[0m19:23:17.756335 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:23:17.756961 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:23:17.759872 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:17.760358 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m19:23:17.760828 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m19:23:17.763736 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:23:17.764351 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m19:23:17.767369 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m19:23:17.770387 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:23:17.771022 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m19:23:17.771898 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order"} */
alter table "raw"."raw"."stg_order__dbt_tmp" rename to "stg_order"
[0m19:23:17.772385 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:23:17.772941 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date__dbt_tmp" rename to "stg_date"
[0m19:23:17.779302 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m19:23:17.779786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m19:23:17.794165 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m19:23:17.794703 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m19:23:17.799675 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:17.799038 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m19:23:17.796830 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: COMMIT
[0m19:23:17.801666 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m19:23:17.802284 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m19:23:17.802855 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:23:17.803461 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m19:23:17.804014 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:23:17.804767 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m19:23:17.806070 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: COMMIT
[0m19:23:17.808340 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m19:23:17.808951 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m19:23:17.815841 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m19:23:17.816347 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m19:23:17.818002 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m19:23:17.818636 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m19:23:17.821285 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_customer__dbt_backup"
[0m19:23:17.823880 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_date__dbt_backup"
[0m19:23:17.834669 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:23:17.833475 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."stg_order__dbt_backup"
[0m19:23:17.830752 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:17.835805 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:23:17.836430 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
drop view if exists "raw"."raw"."stg_customer__dbt_backup" cascade
[0m19:23:17.837574 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m19:23:17.838187 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m19:23:17.838883 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
drop view if exists "raw"."raw"."stg_date__dbt_backup" cascade
[0m19:23:17.839702 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order"} */
drop view if exists "raw"."raw"."stg_order__dbt_backup" cascade
[0m19:23:17.846070 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m19:23:17.849432 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m19:23:17.850164 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.009 seconds
[0m19:23:17.851766 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.012 seconds
[0m19:23:17.854652 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: Close
[0m19:23:17.855140 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.014 seconds
[0m19:23:17.856846 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: Close
[0m19:23:17.861595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08634c20-4b4b-4171-9953-9be6c179fdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd01211f6b0>]}
[0m19:23:17.858473 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08634c20-4b4b-4171-9953-9be6c179fdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd010c95a30>]}
[0m19:23:17.863035 [info ] [Thread-3 (]: 3 of 7 OK created sql view model raw.stg_date .................................. [[32mCREATE VIEW[0m in 0.35s]
[0m19:23:17.857479 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08634c20-4b4b-4171-9953-9be6c179fdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd015e279e0>]}
[0m19:23:17.860535 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: Close
[0m19:23:17.864125 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_date
[0m19:23:17.866595 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_order_fulfillment
[0m19:23:17.865700 [info ] [Thread-2 (]: 2 of 7 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.35s]
[0m19:23:17.867551 [info ] [Thread-3 (]: 5 of 7 START sql view model raw.stg_order_fulfillment .......................... [RUN]
[0m19:23:17.864875 [info ] [Thread-1 (]: 1 of 7 OK created sql view model raw.stg_customer .............................. [[32mCREATE VIEW[0m in 0.36s]
[0m19:23:17.869247 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08634c20-4b4b-4171-9953-9be6c179fdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd010c29670>]}
[0m19:23:17.869998 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m19:23:17.871347 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_date, now model.nexabrands_dbt.stg_order_fulfillment)
[0m19:23:17.872218 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer
[0m19:23:17.873704 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m19:23:17.873009 [info ] [Thread-4 (]: 4 of 7 OK created sql view model raw.stg_order ................................. [[32mCREATE VIEW[0m in 0.35s]
[0m19:23:17.874552 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_order_fulfillment
[0m19:23:17.875904 [info ] [Thread-2 (]: 6 of 7 START sql view model raw.stg_order_lines ................................ [RUN]
[0m19:23:17.876777 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order
[0m19:23:17.878912 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:17.879676 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer_targets, now model.nexabrands_dbt.stg_order_lines)
[0m19:23:17.881382 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m19:23:17.883644 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m19:23:17.884285 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_order_fulfillment
[0m19:23:17.890418 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_order_lines
[0m19:23:17.890126 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:17.894632 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_lines"
[0m19:23:17.895662 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:17.896397 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_fulfillment: BEGIN
[0m19:23:17.897260 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:23:17.897747 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:23:17.898328 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_lines: BEGIN
[0m19:23:17.899459 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:23:17.903100 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m19:23:17.905175 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:17.905692 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m19:23:17.906286 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */

  create view "raw"."raw"."stg_order_fulfillment__dbt_tmp"
    
    
  as (
    WITH order_fulfillment AS (
    SELECT * 
    FROM raw.raw.order_fulfillment
)

SELECT
    order_id,
    on_time,
    in_full,
    otif
   
FROM order_fulfillment
  );
[0m19:23:17.906869 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:23:17.907743 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */

  create view "raw"."raw"."stg_order_lines__dbt_tmp"
    
    
  as (
    WITH order_lines AS (
    SELECT * 
    FROM raw.raw.order_lines
)

SELECT
    order_id,
    product_id,
    order_qty,
    agreed_delivery_date,
    actual_delivery_date,
    delivery_qty 
   
FROM order_lines
  );
[0m19:23:17.910922 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:23:17.911496 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m19:23:17.915733 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:17.919170 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:23:17.919788 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
alter table "raw"."raw"."stg_order_fulfillment" rename to "stg_order_fulfillment__dbt_backup"
[0m19:23:17.920390 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines" rename to "stg_order_lines__dbt_backup"
[0m19:23:17.921476 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:23:17.921961 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:23:17.925014 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:23:17.928171 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:17.928809 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines__dbt_tmp" rename to "stg_order_lines"
[0m19:23:17.929445 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
alter table "raw"."raw"."stg_order_fulfillment__dbt_tmp" rename to "stg_order_fulfillment"
[0m19:23:17.930568 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:23:17.931172 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:23:17.933116 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m19:23:17.935193 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_fulfillment: COMMIT
[0m19:23:17.935822 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:23:17.936426 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:17.937016 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m19:23:17.937630 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_fulfillment: COMMIT
[0m19:23:17.939764 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m19:23:17.942679 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_order_lines__dbt_backup"
[0m19:23:17.943178 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m19:23:17.944324 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:23:17.946939 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_order_fulfillment__dbt_backup"
[0m19:23:17.947553 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
drop view if exists "raw"."raw"."stg_order_lines__dbt_backup" cascade
[0m19:23:17.948690 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:17.949515 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
drop view if exists "raw"."raw"."stg_order_fulfillment__dbt_backup" cascade
[0m19:23:17.951094 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:23:17.951858 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:23:17.953462 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_lines: Close
[0m19:23:17.955955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08634c20-4b4b-4171-9953-9be6c179fdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd0102697c0>]}
[0m19:23:17.956999 [info ] [Thread-2 (]: 6 of 7 OK created sql view model raw.stg_order_lines ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m19:23:17.955036 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_fulfillment: Close
[0m19:23:17.958391 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m19:23:17.959674 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08634c20-4b4b-4171-9953-9be6c179fdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd010cb8440>]}
[0m19:23:17.960784 [info ] [Thread-3 (]: 5 of 7 OK created sql view model raw.stg_order_fulfillment ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m19:23:17.961953 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_order_fulfillment
[0m19:23:17.962503 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.int_order_delivery_metrics
[0m19:23:17.963522 [info ] [Thread-1 (]: 7 of 7 START sql view model raw.int_order_delivery_metrics ..................... [RUN]
[0m19:23:17.964273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer, now model.nexabrands_dbt.int_order_delivery_metrics)
[0m19:23:17.966011 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.int_order_delivery_metrics
[0m19:23:17.970362 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.int_order_delivery_metrics"
[0m19:23:17.971541 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.int_order_delivery_metrics
[0m19:23:17.975667 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.int_order_delivery_metrics"
[0m19:23:17.976874 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.int_order_delivery_metrics"
[0m19:23:17.977534 [debug] [Thread-1 (]: On model.nexabrands_dbt.int_order_delivery_metrics: BEGIN
[0m19:23:17.978073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:17.981687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:23:17.982643 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.int_order_delivery_metrics"
[0m19:23:17.983670 [debug] [Thread-1 (]: On model.nexabrands_dbt.int_order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.int_order_delivery_metrics"} */

  create view "raw"."raw"."int_order_delivery_metrics__dbt_tmp"
    
    
  as (
    WITH order_lines AS (
    SELECT * FROM "raw"."raw"."stg_order_lines"
),

delivery_metrics AS (
    SELECT
        order_id,
        product_id,
        order_qty,
        delivery_qty,
        agreed_delivery_date,
        actual_delivery_date,
        -- Calculating  delivery metrics
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date THEN 1 
            ELSE 0 
        END as is_on_time,
        CASE 
            WHEN delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_in_full,
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date 
            AND delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_otif
    FROM order_lines
)

SELECT * FROM delivery_metrics
  );
[0m19:23:17.991710 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m19:23:17.995566 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.int_order_delivery_metrics"
[0m19:23:17.996159 [debug] [Thread-1 (]: On model.nexabrands_dbt.int_order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.int_order_delivery_metrics"} */
alter table "raw"."raw"."int_order_delivery_metrics__dbt_tmp" rename to "int_order_delivery_metrics"
[0m19:23:17.997185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:23:17.999037 [debug] [Thread-1 (]: On model.nexabrands_dbt.int_order_delivery_metrics: COMMIT
[0m19:23:17.999608 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.int_order_delivery_metrics"
[0m19:23:18.000154 [debug] [Thread-1 (]: On model.nexabrands_dbt.int_order_delivery_metrics: COMMIT
[0m19:23:18.001797 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:23:18.006333 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."int_order_delivery_metrics__dbt_backup"
[0m19:23:18.007439 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.int_order_delivery_metrics"
[0m19:23:18.008005 [debug] [Thread-1 (]: On model.nexabrands_dbt.int_order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.int_order_delivery_metrics"} */
drop view if exists "raw"."raw"."int_order_delivery_metrics__dbt_backup" cascade
[0m19:23:18.008788 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:23:18.010300 [debug] [Thread-1 (]: On model.nexabrands_dbt.int_order_delivery_metrics: Close
[0m19:23:18.011222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08634c20-4b4b-4171-9953-9be6c179fdeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd01028c200>]}
[0m19:23:18.012361 [info ] [Thread-1 (]: 7 of 7 OK created sql view model raw.int_order_delivery_metrics ................ [[32mCREATE VIEW[0m in 0.05s]
[0m19:23:18.013455 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.int_order_delivery_metrics
[0m19:23:18.015507 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:18.015987 [debug] [MainThread]: On master: BEGIN
[0m19:23:18.016463 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:23:18.020901 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m19:23:18.021670 [debug] [MainThread]: On master: COMMIT
[0m19:23:18.022453 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:18.023189 [debug] [MainThread]: On master: COMMIT
[0m19:23:18.023993 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:23:18.024475 [debug] [MainThread]: On master: Close
[0m19:23:18.025385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:18.026065 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_order_lines' was properly closed.
[0m19:23:18.027069 [debug] [MainThread]: Connection 'model.nexabrands_dbt.int_order_delivery_metrics' was properly closed.
[0m19:23:18.027731 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_order_fulfillment' was properly closed.
[0m19:23:18.028456 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_order' was properly closed.
[0m19:23:18.029053 [info ] [MainThread]: 
[0m19:23:18.029666 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m19:23:18.031374 [debug] [MainThread]: Command end result
[0m19:23:18.053384 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m19:23:18.055119 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m19:23:18.061249 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m19:23:18.061759 [info ] [MainThread]: 
[0m19:23:18.062395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:18.062932 [info ] [MainThread]: 
[0m19:23:18.063518 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:23:18.064702 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6338075, "process_in_blocks": "3168", "process_kernel_time": 0.339147, "process_mem_max_rss": "120008", "process_out_blocks": "2768", "process_user_time": 2.815715}
[0m19:23:18.065320 [debug] [MainThread]: Command `dbt run` succeeded at 19:23:18.065185 after 1.63 seconds
[0m19:23:18.065857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd01418e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd01444f0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd014c30650>]}
[0m19:23:18.066402 [debug] [MainThread]: Flushing usage events
[0m19:23:19.016636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:44.391210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b6c259d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b6ddf1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b6c259b20>]}


============================== 19:23:44.394954 | ac7901ab-1bd2-4697-8495-d0ab1dd1f75a ==============================
[0m19:23:44.394954 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:23:44.395794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/codespace/.dbt', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:23:44.582350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac7901ab-1bd2-4697-8495-d0ab1dd1f75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b6be13860>]}
[0m19:23:44.681334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac7901ab-1bd2-4697-8495-d0ab1dd1f75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b6bf171a0>]}
[0m19:23:44.682926 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:23:44.798218 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:23:44.888610 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m19:23:44.889363 [debug] [MainThread]: Partial parsing: added file: nexabrands_dbt://models/intermediate/order_delivery_metrics.sql
[0m19:23:44.889820 [debug] [MainThread]: Partial parsing: deleted file: nexabrands_dbt://models/intermediate/int_order_delivery_metrics.sql
[0m19:23:45.135487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac7901ab-1bd2-4697-8495-d0ab1dd1f75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b6a3ff6e0>]}
[0m19:23:45.191186 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m19:23:45.194133 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m19:23:45.206346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac7901ab-1bd2-4697-8495-d0ab1dd1f75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b69f2be60>]}
[0m19:23:45.206980 [info ] [MainThread]: Found 7 models, 431 macros
[0m19:23:45.207557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac7901ab-1bd2-4697-8495-d0ab1dd1f75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b6a3f8d40>]}
[0m19:23:45.209640 [info ] [MainThread]: 
[0m19:23:45.210210 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:23:45.210741 [info ] [MainThread]: 
[0m19:23:45.211493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:23:45.217202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m19:23:45.252110 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m19:23:45.252720 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m19:23:45.253375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:45.257710 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m19:23:45.259113 [debug] [ThreadPool]: On list_raw: Close
[0m19:23:45.261455 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m19:23:45.267919 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m19:23:45.268476 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m19:23:45.268969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:45.272373 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m19:23:45.273224 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m19:23:45.274069 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m19:23:45.277383 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m19:23:45.279249 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m19:23:45.280535 [debug] [ThreadPool]: On list_raw_raw: Close
[0m19:23:45.288152 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:45.288716 [debug] [MainThread]: On master: BEGIN
[0m19:23:45.289232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:45.293573 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:23:45.294497 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:45.295252 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:23:45.312038 [debug] [MainThread]: SQL status: SELECT 7 in 0.016 seconds
[0m19:23:45.315087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac7901ab-1bd2-4697-8495-d0ab1dd1f75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b69f2be60>]}
[0m19:23:45.315701 [debug] [MainThread]: On master: ROLLBACK
[0m19:23:45.316313 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:45.316826 [debug] [MainThread]: On master: BEGIN
[0m19:23:45.317660 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:23:45.318483 [debug] [MainThread]: On master: COMMIT
[0m19:23:45.319332 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:45.320170 [debug] [MainThread]: On master: COMMIT
[0m19:23:45.321043 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:23:45.321592 [debug] [MainThread]: On master: Close
[0m19:23:45.325420 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer
[0m19:23:45.327157 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m19:23:45.327726 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_date
[0m19:23:45.326549 [info ] [Thread-1 (]: 1 of 7 START sql view model raw.stg_customer ................................... [RUN]
[0m19:23:45.328466 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order
[0m19:23:45.329019 [info ] [Thread-2 (]: 2 of 7 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m19:23:45.329766 [info ] [Thread-3 (]: 3 of 7 START sql view model raw.stg_date ....................................... [RUN]
[0m19:23:45.330678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer)
[0m19:23:45.331340 [info ] [Thread-4 (]: 4 of 7 START sql view model raw.stg_order ...................................... [RUN]
[0m19:23:45.332155 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m19:23:45.332871 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_date'
[0m19:23:45.334100 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer
[0m19:23:45.334815 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order'
[0m19:23:45.335367 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m19:23:45.335932 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_date
[0m19:23:45.343618 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer"
[0m19:23:45.344251 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order
[0m19:23:45.346101 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:45.347873 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_date"
[0m19:23:45.351120 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order"
[0m19:23:45.352106 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer
[0m19:23:45.353447 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_date
[0m19:23:45.354142 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m19:23:45.354741 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.stg_order
[0m19:23:45.421109 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_date"
[0m19:23:45.425538 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer"
[0m19:23:45.427253 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:45.431361 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order"
[0m19:23:45.432726 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:23:45.433387 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:23:45.434479 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: BEGIN
[0m19:23:45.435212 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: BEGIN
[0m19:23:45.435836 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m19:23:45.436424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:23:45.437041 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:45.439147 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m19:23:45.438060 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: BEGIN
[0m19:23:45.437513 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:23:45.439956 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:23:45.440854 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:23:45.445828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m19:23:45.446713 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:23:45.450091 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */

  create view "raw"."raw"."stg_customer__dbt_tmp"
    
    
  as (
    WITH customer AS (
    SELECT * 
    FROM raw.raw.customers
)

SELECT
    customer_id,
    customer_name,
    city
   
FROM customer
  );
[0m19:23:45.449315 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m19:23:45.453113 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m19:23:45.454024 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order"} */

  create view "raw"."raw"."stg_order__dbt_tmp"
    
    
  as (
    WITH orders AS (
    SELECT * 
    FROM raw.raw.orders
)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
  );
[0m19:23:45.455089 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m19:23:45.451103 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m19:23:45.455974 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:45.456500 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:23:45.457073 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:23:45.457730 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:23:45.458304 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m19:23:45.465921 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:23:45.470715 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer" rename to "stg_customer__dbt_backup"
[0m19:23:45.469254 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m19:23:45.471804 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order"} */
alter table "raw"."raw"."stg_order" rename to "stg_order__dbt_backup"
[0m19:23:45.469854 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */

  create view "raw"."raw"."stg_date__dbt_tmp"
    
    
  as (
    WITH dates AS (
    SELECT * 
    FROM raw.raw.dates
)

SELECT
    date,
   mmm_yy,
    week_no
   
FROM dates
  );
[0m19:23:45.472574 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:23:45.473141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m19:23:45.477431 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:45.478070 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m19:23:45.478526 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m19:23:45.482232 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:23:45.482838 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets" rename to "stg_customer_targets__dbt_backup"
[0m19:23:45.485990 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:23:45.488919 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m19:23:45.489547 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m19:23:45.490316 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date" rename to "stg_date__dbt_backup"
[0m19:23:45.490865 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:23:45.491431 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order"} */
alter table "raw"."raw"."stg_order__dbt_tmp" rename to "stg_order"
[0m19:23:45.492384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:23:45.492851 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:23:45.495791 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:45.502016 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m19:23:45.515001 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:23:45.519955 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m19:23:45.520580 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m19:23:45.522547 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: COMMIT
[0m19:23:45.523135 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date__dbt_tmp" rename to "stg_date"
[0m19:23:45.523718 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:23:45.524467 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m19:23:45.525039 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:23:45.525883 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m19:23:45.526489 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:23:45.526946 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: COMMIT
[0m19:23:45.528843 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m19:23:45.531877 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m19:23:45.533079 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:45.534135 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:23:45.535006 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m19:23:45.535814 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m19:23:45.543321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m19:23:45.543982 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m19:23:45.551030 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_customer__dbt_backup"
[0m19:23:45.551546 [debug] [Thread-2 (]: SQL status: COMMIT in 0.015 seconds
[0m19:23:45.552003 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m19:23:45.554690 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."stg_order__dbt_backup"
[0m19:23:45.561344 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:23:45.564011 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m19:23:45.566477 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_date__dbt_backup"
[0m19:23:45.567610 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order"
[0m19:23:45.568202 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
drop view if exists "raw"."raw"."stg_customer__dbt_backup" cascade
[0m19:23:45.569336 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:23:45.571930 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m19:23:45.571090 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order"} */
drop view if exists "raw"."raw"."stg_order__dbt_backup" cascade
[0m19:23:45.570433 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:23:45.573548 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
drop view if exists "raw"."raw"."stg_date__dbt_backup" cascade
[0m19:23:45.575514 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:23:45.576318 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:23:45.576775 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:23:45.577256 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:23:45.579740 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: Close
[0m19:23:45.581248 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: Close
[0m19:23:45.582660 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m19:23:45.587430 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac7901ab-1bd2-4697-8495-d0ab1dd1f75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b5971e2a0>]}
[0m19:23:45.589934 [info ] [Thread-2 (]: 2 of 7 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m19:23:45.591321 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m19:23:45.588846 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac7901ab-1bd2-4697-8495-d0ab1dd1f75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b68952a50>]}
[0m19:23:45.584049 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order: Close
[0m19:23:45.594847 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac7901ab-1bd2-4697-8495-d0ab1dd1f75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b68990230>]}
[0m19:23:45.593334 [info ] [Thread-3 (]: 3 of 7 OK created sql view model raw.stg_date .................................. [[32mCREATE VIEW[0m in 0.25s]
[0m19:23:45.596642 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_date
[0m19:23:45.592188 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_order_fulfillment
[0m19:23:45.594078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac7901ab-1bd2-4697-8495-d0ab1dd1f75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b6db5fb60>]}
[0m19:23:45.597451 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m19:23:45.595813 [info ] [Thread-4 (]: 4 of 7 OK created sql view model raw.stg_order ................................. [[32mCREATE VIEW[0m in 0.26s]
[0m19:23:45.598630 [info ] [Thread-2 (]: 5 of 7 START sql view model raw.stg_order_fulfillment .......................... [RUN]
[0m19:23:45.599923 [info ] [Thread-1 (]: 1 of 7 OK created sql view model raw.stg_customer .............................. [[32mCREATE VIEW[0m in 0.26s]
[0m19:23:45.600836 [info ] [Thread-3 (]: 6 of 7 START sql view model raw.stg_order_lines ................................ [RUN]
[0m19:23:45.601709 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order
[0m19:23:45.602323 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer_targets, now model.nexabrands_dbt.stg_order_fulfillment)
[0m19:23:45.603066 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer
[0m19:23:45.603795 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_date, now model.nexabrands_dbt.stg_order_lines)
[0m19:23:45.604864 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_order_fulfillment
[0m19:23:45.606016 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m19:23:45.607975 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:45.609943 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m19:23:45.611147 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_order_fulfillment
[0m19:23:45.616611 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:45.617202 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_order_lines
[0m19:23:45.621060 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_lines"
[0m19:23:45.622045 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:45.622728 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_fulfillment: BEGIN
[0m19:23:45.623351 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:23:45.623807 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:23:45.624354 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: BEGIN
[0m19:23:45.625229 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:23:45.628488 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m19:23:45.629602 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:45.634492 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */

  create view "raw"."raw"."stg_order_fulfillment__dbt_tmp"
    
    
  as (
    WITH order_fulfillment AS (
    SELECT * 
    FROM raw.raw.order_fulfillment
)

SELECT
    order_id,
    on_time,
    in_full,
    otif
   
FROM order_fulfillment
  );
[0m19:23:45.635311 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m19:23:45.638561 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:23:45.639136 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:23:45.639705 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */

  create view "raw"."raw"."stg_order_lines__dbt_tmp"
    
    
  as (
    WITH order_lines AS (
    SELECT * 
    FROM raw.raw.order_lines
)

SELECT
    order_id,
    product_id,
    order_qty,
    agreed_delivery_date,
    actual_delivery_date,
    delivery_qty 
   
FROM order_lines
  );
[0m19:23:45.643183 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:45.644022 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
alter table "raw"."raw"."stg_order_fulfillment" rename to "stg_order_fulfillment__dbt_backup"
[0m19:23:45.645306 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:23:45.645798 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:23:45.648667 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:45.651798 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:23:45.652388 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
alter table "raw"."raw"."stg_order_fulfillment__dbt_tmp" rename to "stg_order_fulfillment"
[0m19:23:45.652983 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines" rename to "stg_order_lines__dbt_backup"
[0m19:23:45.654001 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:23:45.654474 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:23:45.656445 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_fulfillment: COMMIT
[0m19:23:45.659350 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:23:45.659941 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:45.660522 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines__dbt_tmp" rename to "stg_order_lines"
[0m19:23:45.661090 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_fulfillment: COMMIT
[0m19:23:45.662144 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:23:45.664533 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m19:23:45.665124 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m19:23:45.665624 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:23:45.667985 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_order_fulfillment__dbt_backup"
[0m19:23:45.668571 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m19:23:45.669694 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:23:45.670558 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
drop view if exists "raw"."raw"."stg_order_fulfillment__dbt_backup" cascade
[0m19:23:45.671287 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m19:23:45.674185 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_order_lines__dbt_backup"
[0m19:23:45.674831 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:23:45.675820 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:23:45.677271 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_order_fulfillment: Close
[0m19:23:45.677889 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
drop view if exists "raw"."raw"."stg_order_lines__dbt_backup" cascade
[0m19:23:45.680085 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac7901ab-1bd2-4697-8495-d0ab1dd1f75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b68ab50a0>]}
[0m19:23:45.680947 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:23:45.681910 [info ] [Thread-2 (]: 5 of 7 OK created sql view model raw.stg_order_fulfillment ..................... [[32mCREATE VIEW[0m in 0.08s]
[0m19:23:45.683694 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: Close
[0m19:23:45.684455 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_order_fulfillment
[0m19:23:45.685559 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac7901ab-1bd2-4697-8495-d0ab1dd1f75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b59741730>]}
[0m19:23:45.686634 [info ] [Thread-3 (]: 6 of 7 OK created sql view model raw.stg_order_lines ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m19:23:45.687805 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m19:23:45.688906 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.order_delivery_metrics
[0m19:23:45.689693 [info ] [Thread-4 (]: 7 of 7 START sql view model raw.order_delivery_metrics ......................... [RUN]
[0m19:23:45.690538 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_order, now model.nexabrands_dbt.order_delivery_metrics)
[0m19:23:45.691332 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.order_delivery_metrics
[0m19:23:45.694274 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.order_delivery_metrics"
[0m19:23:45.695024 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.order_delivery_metrics
[0m19:23:45.699597 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.order_delivery_metrics"
[0m19:23:45.700378 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m19:23:45.700969 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: BEGIN
[0m19:23:45.701562 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:23:45.704903 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m19:23:45.706079 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m19:23:45.706671 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */

  create view "raw"."raw"."order_delivery_metrics__dbt_tmp"
    
    
  as (
    WITH order_lines AS (
    SELECT * FROM "raw"."raw"."stg_order_lines"
),

delivery_metrics AS (
    SELECT
        order_id,
        product_id,
        order_qty,
        delivery_qty,
        agreed_delivery_date,
        actual_delivery_date,
        -- Calculating  delivery metrics
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date THEN 1 
            ELSE 0 
        END as is_on_time,
        CASE 
            WHEN delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_in_full,
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date 
            AND delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_otif
    FROM order_lines
)

SELECT * FROM delivery_metrics
  );
[0m19:23:45.708822 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:23:45.713651 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m19:23:45.714229 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics__dbt_tmp" rename to "order_delivery_metrics"
[0m19:23:45.715033 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:23:45.716750 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m19:23:45.717345 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m19:23:45.717882 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m19:23:45.719265 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m19:23:45.723170 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."order_delivery_metrics__dbt_backup"
[0m19:23:45.724235 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m19:23:45.724774 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
drop view if exists "raw"."raw"."order_delivery_metrics__dbt_backup" cascade
[0m19:23:45.725461 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:23:45.726855 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: Close
[0m19:23:45.727766 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac7901ab-1bd2-4697-8495-d0ab1dd1f75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b59768f20>]}
[0m19:23:45.728864 [info ] [Thread-4 (]: 7 of 7 OK created sql view model raw.order_delivery_metrics .................... [[32mCREATE VIEW[0m in 0.04s]
[0m19:23:45.730020 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.order_delivery_metrics
[0m19:23:45.731785 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:45.732283 [debug] [MainThread]: On master: BEGIN
[0m19:23:45.732752 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:23:45.736477 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:23:45.738498 [debug] [MainThread]: On master: COMMIT
[0m19:23:45.738989 [debug] [MainThread]: Using postgres connection "master"
[0m19:23:45.739504 [debug] [MainThread]: On master: COMMIT
[0m19:23:45.740080 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:23:45.740603 [debug] [MainThread]: On master: Close
[0m19:23:45.741640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:45.742271 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_order_fulfillment' was properly closed.
[0m19:23:45.742902 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_customer' was properly closed.
[0m19:23:45.743466 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_order_lines' was properly closed.
[0m19:23:45.744177 [debug] [MainThread]: Connection 'model.nexabrands_dbt.order_delivery_metrics' was properly closed.
[0m19:23:45.744780 [info ] [MainThread]: 
[0m19:23:45.745729 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m19:23:45.747921 [debug] [MainThread]: Command end result
[0m19:23:45.771323 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m19:23:45.773129 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m19:23:45.780063 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m19:23:45.780612 [info ] [MainThread]: 
[0m19:23:45.781282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:45.781856 [info ] [MainThread]: 
[0m19:23:45.782458 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m19:23:45.783668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4538686, "process_in_blocks": "0", "process_kernel_time": 0.290872, "process_mem_max_rss": "118668", "process_out_blocks": "2776", "process_user_time": 2.566051}
[0m19:23:45.784289 [debug] [MainThread]: Command `dbt run` succeeded at 19:23:45.784172 after 1.45 seconds
[0m19:23:45.784853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b6c99e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b6ca24590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772b689b77a0>]}
[0m19:23:45.785452 [debug] [MainThread]: Flushing usage events
[0m19:23:46.724482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:29:50.986635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77426486dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774265b97860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774263cbc8f0>]}


============================== 19:29:50.990151 | 2b468cca-018d-4922-82c4-815017200129 ==============================
[0m19:29:50.990151 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:29:50.991032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:29:51.176794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b468cca-018d-4922-82c4-815017200129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7742637781a0>]}
[0m19:29:51.247470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b468cca-018d-4922-82c4-815017200129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774264214d40>]}
[0m19:29:51.248553 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:29:51.364416 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:29:51.442737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:29:51.443494 [debug] [MainThread]: Partial parsing: added file: nexabrands_dbt://models/intermediate/customer_performance.sql
[0m19:29:51.660888 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nexabrands_dbt.customer_performance' (models/intermediate/customer_performance.sql) depends on a node named 'stg_orders' which was not found
[0m19:29:51.662385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7333207, "process_in_blocks": "0", "process_kernel_time": 0.235085, "process_mem_max_rss": "104412", "process_out_blocks": "16", "process_user_time": 2.131438}
[0m19:29:51.663038 [debug] [MainThread]: Command `dbt run` failed at 19:29:51.662888 after 0.73 seconds
[0m19:29:51.663599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774263c602c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774263e5b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774263bcb980>]}
[0m19:29:51.664155 [debug] [MainThread]: Flushing usage events
[0m19:29:52.451152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:43.363359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee7f8961c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee7f8962150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee7f89a8ef0>]}


============================== 19:30:43.366820 | 486b15b6-8ecf-45a3-a028-a94537b1784c ==============================
[0m19:30:43.366820 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:30:43.367674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/codespace/.dbt', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_orders', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:30:43.543910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '486b15b6-8ecf-45a3-a028-a94537b1784c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee7f88fa450>]}
[0m19:30:43.645966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '486b15b6-8ecf-45a3-a028-a94537b1784c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee7f88f8d40>]}
[0m19:30:43.647528 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:30:43.775817 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:30:43.854850 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m19:30:43.855608 [debug] [MainThread]: Partial parsing: added file: nexabrands_dbt://models/intermediate/customer_performance.sql
[0m19:30:43.856148 [debug] [MainThread]: Partial parsing: added file: nexabrands_dbt://models/src/stg_orders.sql
[0m19:30:43.856601 [debug] [MainThread]: Partial parsing: deleted file: nexabrands_dbt://models/src/stg_order.sql
[0m19:30:44.110447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '486b15b6-8ecf-45a3-a028-a94537b1784c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee7f690b5c0>]}
[0m19:30:44.167764 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m19:30:44.170766 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m19:30:44.183419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '486b15b6-8ecf-45a3-a028-a94537b1784c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee7f6908a70>]}
[0m19:30:44.184030 [info ] [MainThread]: Found 8 models, 431 macros
[0m19:30:44.184607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '486b15b6-8ecf-45a3-a028-a94537b1784c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee7f6d9ca40>]}
[0m19:30:44.186268 [info ] [MainThread]: 
[0m19:30:44.186834 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:30:44.187364 [info ] [MainThread]: 
[0m19:30:44.188113 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:30:44.189123 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m19:30:44.223902 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m19:30:44.224458 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m19:30:44.224962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:44.229344 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m19:30:44.230720 [debug] [ThreadPool]: On list_raw: Close
[0m19:30:44.236143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m19:30:44.242155 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m19:30:44.242636 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m19:30:44.243102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:44.246150 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m19:30:44.247284 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m19:30:44.247802 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m19:30:44.250374 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m19:30:44.251907 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m19:30:44.252687 [debug] [ThreadPool]: On list_raw_raw: Close
[0m19:30:44.260770 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:44.261324 [debug] [MainThread]: On master: BEGIN
[0m19:30:44.261775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:30:44.265465 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m19:30:44.266022 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:44.266613 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:30:44.283108 [debug] [MainThread]: SQL status: SELECT 7 in 0.016 seconds
[0m19:30:44.285962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '486b15b6-8ecf-45a3-a028-a94537b1784c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee7f50a48c0>]}
[0m19:30:44.286571 [debug] [MainThread]: On master: ROLLBACK
[0m19:30:44.287161 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:44.287635 [debug] [MainThread]: On master: BEGIN
[0m19:30:44.288559 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:30:44.289434 [debug] [MainThread]: On master: COMMIT
[0m19:30:44.289924 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:44.290388 [debug] [MainThread]: On master: COMMIT
[0m19:30:44.290963 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:30:44.291430 [debug] [MainThread]: On master: Close
[0m19:30:44.294198 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_orders
[0m19:30:44.295124 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.stg_orders ..................................... [RUN]
[0m19:30:44.295926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_orders)
[0m19:30:44.296725 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_orders
[0m19:30:44.308051 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_orders"
[0m19:30:44.308931 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_orders
[0m19:30:44.344894 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_orders"
[0m19:30:44.345851 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m19:30:44.346412 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: BEGIN
[0m19:30:44.346940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:44.350867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m19:30:44.351440 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m19:30:44.352003 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */

  create view "raw"."raw"."stg_orders__dbt_tmp"
    
    
  as (
    WITH orders AS (
    SELECT * 
    FROM raw.raw.orders
)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
  );
[0m19:30:44.353650 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m19:30:44.361971 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m19:30:44.362539 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */
alter table "raw"."raw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m19:30:44.363291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:30:44.378118 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: COMMIT
[0m19:30:44.378693 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m19:30:44.379241 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: COMMIT
[0m19:30:44.391448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m19:30:44.397754 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_orders__dbt_backup"
[0m19:30:44.403840 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m19:30:44.404400 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */
drop view if exists "raw"."raw"."stg_orders__dbt_backup" cascade
[0m19:30:44.405096 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:30:44.407574 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: Close
[0m19:30:44.410252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '486b15b6-8ecf-45a3-a028-a94537b1784c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee7f4f4d100>]}
[0m19:30:44.411233 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.stg_orders ................................ [[32mCREATE VIEW[0m in 0.11s]
[0m19:30:44.412090 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_orders
[0m19:30:44.413736 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:44.414216 [debug] [MainThread]: On master: BEGIN
[0m19:30:44.414701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:30:44.419065 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m19:30:44.419601 [debug] [MainThread]: On master: COMMIT
[0m19:30:44.420117 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:44.420588 [debug] [MainThread]: On master: COMMIT
[0m19:30:44.421136 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:30:44.421656 [debug] [MainThread]: On master: Close
[0m19:30:44.422351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:44.423071 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_orders' was properly closed.
[0m19:30:44.423819 [info ] [MainThread]: 
[0m19:30:44.424643 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m19:30:44.425651 [debug] [MainThread]: Command end result
[0m19:30:44.448615 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m19:30:44.450224 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m19:30:44.456052 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m19:30:44.456546 [info ] [MainThread]: 
[0m19:30:44.457264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:30:44.457836 [info ] [MainThread]: 
[0m19:30:44.458418 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:30:44.459580 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1560383, "process_in_blocks": "0", "process_kernel_time": 0.287607, "process_mem_max_rss": "116356", "process_out_blocks": "2632", "process_user_time": 2.276889}
[0m19:30:44.460201 [debug] [MainThread]: Command `dbt run` succeeded at 19:30:44.460089 after 1.16 seconds
[0m19:30:44.460750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee7f8961c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee7f8ea8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ee7f84c2690>]}
[0m19:30:44.461327 [debug] [MainThread]: Flushing usage events
[0m19:30:45.215296 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:51.177487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8d1aebb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8d03d4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8d06dd5b0>]}


============================== 19:30:51.182599 | 7387ac02-f24c-480c-9ee1-9d7dccc460f1 ==============================
[0m19:30:51.182599 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:30:51.183856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:30:51.463711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7387ac02-f24c-480c-9ee1-9d7dccc460f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8cfa26b70>]}
[0m19:30:51.558624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7387ac02-f24c-480c-9ee1-9d7dccc460f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8d01f6600>]}
[0m19:30:51.560053 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:30:51.702479 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:30:51.803214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:30:51.804134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:30:51.848448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7387ac02-f24c-480c-9ee1-9d7dccc460f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8cf3f38c0>]}
[0m19:30:51.908958 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m19:30:51.911982 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m19:30:51.924635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7387ac02-f24c-480c-9ee1-9d7dccc460f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8ce3a9970>]}
[0m19:30:51.925372 [info ] [MainThread]: Found 8 models, 431 macros
[0m19:30:51.925971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7387ac02-f24c-480c-9ee1-9d7dccc460f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8cf3f3dd0>]}
[0m19:30:51.928105 [info ] [MainThread]: 
[0m19:30:51.928679 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:30:51.929230 [info ] [MainThread]: 
[0m19:30:51.929995 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:30:51.935252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m19:30:51.971123 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m19:30:51.971779 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m19:30:51.972333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:51.976871 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m19:30:51.978350 [debug] [ThreadPool]: On list_raw: Close
[0m19:30:51.983873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m19:30:51.992155 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m19:30:51.992685 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m19:30:51.993198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:51.996666 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m19:30:51.997405 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m19:30:51.998117 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m19:30:52.001992 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.003 seconds
[0m19:30:52.004508 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m19:30:52.010885 [debug] [ThreadPool]: On list_raw_raw: Close
[0m19:30:52.023657 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:52.024544 [debug] [MainThread]: On master: BEGIN
[0m19:30:52.025423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:30:52.030142 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:30:52.030879 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:52.031748 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:30:52.060756 [debug] [MainThread]: SQL status: SELECT 8 in 0.028 seconds
[0m19:30:52.065975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7387ac02-f24c-480c-9ee1-9d7dccc460f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8cf301ee0>]}
[0m19:30:52.067017 [debug] [MainThread]: On master: ROLLBACK
[0m19:30:52.067979 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:52.068746 [debug] [MainThread]: On master: BEGIN
[0m19:30:52.070106 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:30:52.071653 [debug] [MainThread]: On master: COMMIT
[0m19:30:52.072432 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:52.073217 [debug] [MainThread]: On master: COMMIT
[0m19:30:52.074109 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:30:52.074874 [debug] [MainThread]: On master: Close
[0m19:30:52.082131 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer
[0m19:30:52.083311 [info ] [Thread-1 (]: 1 of 8 START sql view model raw.stg_customer ................................... [RUN]
[0m19:30:52.084527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer)
[0m19:30:52.085425 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer
[0m19:30:52.094364 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m19:30:52.095363 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer"
[0m19:30:52.095882 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_date
[0m19:30:52.096959 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order_fulfillment
[0m19:30:52.096499 [info ] [Thread-2 (]: 2 of 8 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m19:30:52.098188 [info ] [Thread-3 (]: 3 of 8 START sql view model raw.stg_date ....................................... [RUN]
[0m19:30:52.099513 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer
[0m19:30:52.098803 [info ] [Thread-4 (]: 4 of 8 START sql view model raw.stg_order_fulfillment .......................... [RUN]
[0m19:30:52.100855 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_customer_targets'
[0m19:30:52.101590 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_date'
[0m19:30:52.130098 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order_fulfillment'
[0m19:30:52.140886 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer"
[0m19:30:52.141626 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m19:30:52.142246 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_date
[0m19:30:52.142826 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order_fulfillment
[0m19:30:52.145137 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m19:30:52.147504 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_date"
[0m19:30:52.149488 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:30:52.150027 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:30:52.150859 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m19:30:52.151741 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_date
[0m19:30:52.152625 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: BEGIN
[0m19:30:52.156829 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m19:30:52.157520 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.stg_order_fulfillment
[0m19:30:52.161306 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_date"
[0m19:30:52.161934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:52.166994 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:30:52.169759 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:30:52.167905 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:30:52.170706 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:30:52.171486 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: BEGIN
[0m19:30:52.172389 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m19:30:52.174092 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: BEGIN
[0m19:30:52.174600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m19:30:52.175196 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:30:52.175777 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:30:52.176360 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:30:52.176938 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:30:52.180121 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */

  create view "raw"."raw"."stg_customer__dbt_tmp"
    
    
  as (
    WITH customer AS (
    SELECT * 
    FROM raw.raw.customers
)

SELECT
    customer_id,
    customer_name,
    city
   
FROM customer
  );
[0m19:30:52.182876 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:30:52.192816 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:30:52.193764 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m19:30:52.195489 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer" rename to "stg_customer__dbt_backup"
[0m19:30:52.195971 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m19:30:52.196938 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m19:30:52.197443 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:30:52.198522 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:30:52.199262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:30:52.199830 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:30:52.200412 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */

  create view "raw"."raw"."stg_date__dbt_tmp"
    
    
  as (
    WITH dates AS (
    SELECT * 
    FROM raw.raw.dates
)

SELECT
    date,
   mmm_yy,
    week_no
   
FROM dates
  );
[0m19:30:52.201001 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m19:30:52.204301 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:30:52.204913 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */

  create view "raw"."raw"."stg_order_fulfillment__dbt_tmp"
    
    
  as (
    WITH order_fulfillment AS (
    SELECT * 
    FROM raw.raw.order_fulfillment
)

SELECT
    order_id,
    on_time,
    in_full,
    otif
   
FROM order_fulfillment
  );
[0m19:30:52.206032 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
alter table "raw"."raw"."stg_customer__dbt_tmp" rename to "stg_customer"
[0m19:30:52.207395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:30:52.213440 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m19:30:52.214120 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m19:30:52.217516 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:30:52.218007 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m19:30:52.231575 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:30:52.234931 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m19:30:52.235577 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
alter table "raw"."raw"."stg_order_fulfillment" rename to "stg_order_fulfillment__dbt_backup"
[0m19:30:52.238972 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:30:52.239621 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets" rename to "stg_customer_targets__dbt_backup"
[0m19:30:52.240246 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:30:52.241059 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date" rename to "stg_date__dbt_backup"
[0m19:30:52.241658 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:30:52.242454 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: COMMIT
[0m19:30:52.242982 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:30:52.243826 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:30:52.246893 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:30:52.255956 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:30:52.252328 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:30:52.256950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m19:30:52.257489 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
alter table "raw"."raw"."stg_order_fulfillment__dbt_tmp" rename to "stg_order_fulfillment"
[0m19:30:52.258080 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
alter table "raw"."raw"."stg_date__dbt_tmp" rename to "stg_date"
[0m19:30:52.258666 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m19:30:52.265650 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_customer__dbt_backup"
[0m19:30:52.272157 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m19:30:52.272802 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m19:30:52.274848 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m19:30:52.276164 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer"
[0m19:30:52.276652 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m19:30:52.278653 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m19:30:52.279271 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:30:52.279861 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer"} */
drop view if exists "raw"."raw"."stg_customer__dbt_backup" cascade
[0m19:30:52.281916 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: COMMIT
[0m19:30:52.282517 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:30:52.283156 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m19:30:52.283944 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:30:52.284823 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: COMMIT
[0m19:30:52.285618 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:30:52.286629 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: COMMIT
[0m19:30:52.287344 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m19:30:52.290324 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer: Close
[0m19:30:52.290825 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m19:30:52.295752 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m19:30:52.302588 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m19:30:52.300007 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_date__dbt_backup"
[0m19:30:52.296241 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m19:30:52.303195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7387ac02-f24c-480c-9ee1-9d7dccc460f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8d05c1af0>]}
[0m19:30:52.303691 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m19:30:52.304780 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_date"
[0m19:30:52.309222 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_date"} */
drop view if exists "raw"."raw"."stg_date__dbt_backup" cascade
[0m19:30:52.308178 [info ] [Thread-1 (]: 1 of 8 OK created sql view model raw.stg_customer .............................. [[32mCREATE VIEW[0m in 0.22s]
[0m19:30:52.310710 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer
[0m19:30:52.307303 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."stg_order_fulfillment__dbt_backup"
[0m19:30:52.311667 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:30:52.312210 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m19:30:52.312676 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m19:30:52.314024 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_fulfillment"
[0m19:30:52.315920 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_date: Close
[0m19:30:52.316959 [info ] [Thread-1 (]: 5 of 8 START sql view model raw.stg_order_lines ................................ [RUN]
[0m19:30:52.320046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer, now model.nexabrands_dbt.stg_order_lines)
[0m19:30:52.320854 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m19:30:52.318606 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m19:30:52.319195 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_fulfillment"} */
drop view if exists "raw"."raw"."stg_order_fulfillment__dbt_backup" cascade
[0m19:30:52.323965 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m19:30:52.325109 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7387ac02-f24c-480c-9ee1-9d7dccc460f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8cc282420>]}
[0m19:30:52.330566 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7387ac02-f24c-480c-9ee1-9d7dccc460f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8cc2671d0>]}
[0m19:30:52.329972 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:30:52.329388 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_order_lines
[0m19:30:52.331705 [info ] [Thread-2 (]: 2 of 8 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m19:30:52.332990 [info ] [Thread-3 (]: 3 of 8 OK created sql view model raw.stg_date .................................. [[32mCREATE VIEW[0m in 0.23s]
[0m19:30:52.335004 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_fulfillment: Close
[0m19:30:52.339795 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_lines"
[0m19:30:52.340779 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m19:30:52.343440 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_orders
[0m19:30:52.341558 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_date
[0m19:30:52.342461 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7387ac02-f24c-480c-9ee1-9d7dccc460f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8cc277aa0>]}
[0m19:30:52.344384 [info ] [Thread-2 (]: 6 of 8 START sql view model raw.stg_orders ..................................... [RUN]
[0m19:30:52.345766 [info ] [Thread-4 (]: 4 of 8 OK created sql view model raw.stg_order_fulfillment ..................... [[32mCREATE VIEW[0m in 0.21s]
[0m19:30:52.346647 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:30:52.347176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer_targets, now model.nexabrands_dbt.stg_orders)
[0m19:30:52.347918 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order_fulfillment
[0m19:30:52.348506 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: BEGIN
[0m19:30:52.349086 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_orders
[0m19:30:52.349897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:52.352433 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_orders"
[0m19:30:52.354373 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_orders
[0m19:30:52.359367 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_orders"
[0m19:30:52.361115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m19:30:52.361791 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:30:52.362300 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m19:30:52.363458 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_orders: BEGIN
[0m19:30:52.362870 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */

  create view "raw"."raw"."stg_order_lines__dbt_tmp"
    
    
  as (
    WITH order_lines AS (
    SELECT * 
    FROM raw.raw.order_lines
)

SELECT
    order_id,
    product_id,
    order_qty,
    agreed_delivery_date,
    actual_delivery_date,
    delivery_qty 
   
FROM order_lines
  );
[0m19:30:52.363982 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:30:52.366534 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:30:52.371463 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:30:52.372135 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines" rename to "stg_order_lines__dbt_backup"
[0m19:30:52.373439 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m19:30:52.374272 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m19:30:52.374753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:30:52.375332 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */

  create view "raw"."raw"."stg_orders__dbt_tmp"
    
    
  as (
    WITH orders AS (
    SELECT * 
    FROM raw.raw.orders
)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
  );
[0m19:30:52.378680 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:30:52.379527 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines__dbt_tmp" rename to "stg_order_lines"
[0m19:30:52.380701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:30:52.381587 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:30:52.384009 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m19:30:52.387565 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m19:30:52.388173 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:30:52.388764 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */
alter table "raw"."raw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m19:30:52.389355 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m19:30:52.390495 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:30:52.391338 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:30:52.394447 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m19:30:52.397097 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_order_lines__dbt_backup"
[0m19:30:52.397735 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */
alter table "raw"."raw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m19:30:52.398869 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m19:30:52.399702 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
drop view if exists "raw"."raw"."stg_order_lines__dbt_backup" cascade
[0m19:30:52.400350 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:30:52.403447 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_orders: COMMIT
[0m19:30:52.404054 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:30:52.404534 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m19:30:52.406047 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_order_lines: Close
[0m19:30:52.406640 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_orders: COMMIT
[0m19:30:52.407658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7387ac02-f24c-480c-9ee1-9d7dccc460f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8cc2676e0>]}
[0m19:30:52.408927 [info ] [Thread-1 (]: 5 of 8 OK created sql view model raw.stg_order_lines ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m19:30:52.410389 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m19:30:52.411202 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m19:30:52.412031 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.order_delivery_metrics
[0m19:30:52.417916 [info ] [Thread-3 (]: 7 of 8 START sql view model raw.order_delivery_metrics ......................... [RUN]
[0m19:30:52.416888 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_orders__dbt_backup"
[0m19:30:52.418884 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_date, now model.nexabrands_dbt.order_delivery_metrics)
[0m19:30:52.420038 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m19:30:52.420618 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.order_delivery_metrics
[0m19:30:52.421249 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */
drop view if exists "raw"."raw"."stg_orders__dbt_backup" cascade
[0m19:30:52.424306 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.order_delivery_metrics"
[0m19:30:52.426640 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.order_delivery_metrics
[0m19:30:52.427187 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:30:52.431175 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.order_delivery_metrics"
[0m19:30:52.432805 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_orders: Close
[0m19:30:52.433938 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7387ac02-f24c-480c-9ee1-9d7dccc460f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8cc202570>]}
[0m19:30:52.435808 [info ] [Thread-2 (]: 6 of 8 OK created sql view model raw.stg_orders ................................ [[32mCREATE VIEW[0m in 0.09s]
[0m19:30:52.434882 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m19:30:52.437633 [debug] [Thread-3 (]: On model.nexabrands_dbt.order_delivery_metrics: BEGIN
[0m19:30:52.436939 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_orders
[0m19:30:52.438171 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:30:52.442439 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:30:52.443062 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m19:30:52.443766 [debug] [Thread-3 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */

  create view "raw"."raw"."order_delivery_metrics__dbt_tmp"
    
    
  as (
    WITH order_lines AS (
    SELECT * FROM "raw"."raw"."stg_order_lines"
),

delivery_metrics AS (
    SELECT
        order_id,
        product_id,
        order_qty,
        delivery_qty,
        agreed_delivery_date,
        actual_delivery_date,
        -- Calculating  delivery metrics
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date THEN 1 
            ELSE 0 
        END as is_on_time,
        CASE 
            WHEN delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_in_full,
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date 
            AND delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_otif
    FROM order_lines
)

SELECT * FROM delivery_metrics
  );
[0m19:30:52.446459 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:30:52.450787 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m19:30:52.451365 [debug] [Thread-3 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics__dbt_tmp" rename to "order_delivery_metrics"
[0m19:30:52.452228 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:30:52.454061 [debug] [Thread-3 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m19:30:52.454652 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m19:30:52.455202 [debug] [Thread-3 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m19:30:52.457051 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m19:30:52.459830 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."order_delivery_metrics__dbt_backup"
[0m19:30:52.460925 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m19:30:52.461526 [debug] [Thread-3 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
drop view if exists "raw"."raw"."order_delivery_metrics__dbt_backup" cascade
[0m19:30:52.462306 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:30:52.463931 [debug] [Thread-3 (]: On model.nexabrands_dbt.order_delivery_metrics: Close
[0m19:30:52.464902 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7387ac02-f24c-480c-9ee1-9d7dccc460f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8ccbe4f50>]}
[0m19:30:52.466079 [info ] [Thread-3 (]: 7 of 8 OK created sql view model raw.order_delivery_metrics .................... [[32mCREATE VIEW[0m in 0.05s]
[0m19:30:52.467303 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.order_delivery_metrics
[0m19:30:52.468365 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.customer_performance
[0m19:30:52.469021 [info ] [Thread-1 (]: 8 of 8 START sql view model raw.customer_performance ........................... [RUN]
[0m19:30:52.469745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_order_lines, now model.nexabrands_dbt.customer_performance)
[0m19:30:52.470307 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.customer_performance
[0m19:30:52.473749 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.customer_performance"
[0m19:30:52.475196 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.customer_performance
[0m19:30:52.479230 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.customer_performance"
[0m19:30:52.480040 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m19:30:52.480628 [debug] [Thread-1 (]: On model.nexabrands_dbt.customer_performance: BEGIN
[0m19:30:52.481181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:52.484989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m19:30:52.485759 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m19:30:52.486330 [debug] [Thread-1 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */

  create view "raw"."raw"."customer_performance__dbt_tmp"
    
    
  as (
    WITH delivery_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

customer_orders AS (
    SELECT * FROM "raw"."raw"."stg_orders"
),

customer_metrics AS (
    SELECT
        co.customer_id,
        COUNT(*) as total_orders,
        AVG(dm.is_on_time) as ontime_rate,
        AVG(dm.is_in_full) as infull_rate,
        AVG(dm.is_otif) as otif_rate
    FROM delivery_metrics dm
    JOIN customer_orders co ON dm.order_id = co.order_id
    GROUP BY co.customer_id
)

SELECT * FROM customer_metrics
  );
[0m19:30:52.488895 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m19:30:52.492877 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m19:30:52.493709 [debug] [Thread-1 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
alter table "raw"."raw"."customer_performance__dbt_tmp" rename to "customer_performance"
[0m19:30:52.494567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:30:52.496467 [debug] [Thread-1 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m19:30:52.497027 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m19:30:52.497596 [debug] [Thread-1 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m19:30:52.498986 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:30:52.501584 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."customer_performance__dbt_backup"
[0m19:30:52.502664 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m19:30:52.503214 [debug] [Thread-1 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
drop view if exists "raw"."raw"."customer_performance__dbt_backup" cascade
[0m19:30:52.503891 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m19:30:52.505379 [debug] [Thread-1 (]: On model.nexabrands_dbt.customer_performance: Close
[0m19:30:52.509284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7387ac02-f24c-480c-9ee1-9d7dccc460f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8cc2778c0>]}
[0m19:30:52.510447 [info ] [Thread-1 (]: 8 of 8 OK created sql view model raw.customer_performance ...................... [[32mCREATE VIEW[0m in 0.04s]
[0m19:30:52.511696 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.customer_performance
[0m19:30:52.514006 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:52.514731 [debug] [MainThread]: On master: BEGIN
[0m19:30:52.515459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:30:52.520229 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m19:30:52.521010 [debug] [MainThread]: On master: COMMIT
[0m19:30:52.521861 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:52.522626 [debug] [MainThread]: On master: COMMIT
[0m19:30:52.523615 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:30:52.524407 [debug] [MainThread]: On master: Close
[0m19:30:52.527748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:52.528535 [debug] [MainThread]: Connection 'model.nexabrands_dbt.customer_performance' was properly closed.
[0m19:30:52.529397 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_orders' was properly closed.
[0m19:30:52.530163 [debug] [MainThread]: Connection 'model.nexabrands_dbt.order_delivery_metrics' was properly closed.
[0m19:30:52.530907 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_order_fulfillment' was properly closed.
[0m19:30:52.531786 [info ] [MainThread]: 
[0m19:30:52.532620 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m19:30:52.535684 [debug] [MainThread]: Command end result
[0m19:30:52.577777 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m19:30:52.580672 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m19:30:52.588937 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m19:30:52.589482 [info ] [MainThread]: 
[0m19:30:52.590140 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:30:52.590674 [info ] [MainThread]: 
[0m19:30:52.591259 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:30:52.592458 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.501737, "process_in_blocks": "0", "process_kernel_time": 0.318611, "process_mem_max_rss": "112500", "process_out_blocks": "1968", "process_user_time": 2.513488}
[0m19:30:52.593062 [debug] [MainThread]: Command `dbt run` succeeded at 19:30:52.592928 after 1.50 seconds
[0m19:30:52.593782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8cfcace60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8ccbf8fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b8d05c3290>]}
[0m19:30:52.594321 [debug] [MainThread]: Flushing usage events
[0m19:30:53.550446 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:14:15.418588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256d8a68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256d673cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256d8a5b50>]}


============================== 20:14:15.421923 | 37280350-7f72-44f4-a73c-d2f64d99b5c4 ==============================
[0m20:14:15.421923 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:14:15.422832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'profiles_dir': '/home/codespace/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:14:15.596946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256ddac590>]}
[0m20:14:15.660868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256d25e240>]}
[0m20:14:15.661802 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:14:15.772696 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:14:15.857989 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 7 files added, 0 files changed.
[0m20:14:15.858719 [debug] [MainThread]: Partial parsing: added file: nexabrands_dbt://models/staging/stg_order_lines.sql
[0m20:14:15.859281 [debug] [MainThread]: Partial parsing: added file: nexabrands_dbt://models/marts/fct_order_fulfillment_lines.sql
[0m20:14:15.859802 [debug] [MainThread]: Partial parsing: added file: nexabrands_dbt://models/staging/stg_products.sql
[0m20:14:15.860307 [debug] [MainThread]: Partial parsing: added file: nexabrands_dbt://models/staging/stg_orders.sql
[0m20:14:15.860869 [debug] [MainThread]: Partial parsing: added file: nexabrands_dbt://models/staging/stg_customer_targets.sql
[0m20:14:15.861411 [debug] [MainThread]: Partial parsing: added file: nexabrands_dbt://models/staging/stg_customers.sql
[0m20:14:15.861923 [debug] [MainThread]: Partial parsing: added file: nexabrands_dbt://models/marts/dim_date.sql
[0m20:14:15.862362 [debug] [MainThread]: Partial parsing: deleted file: nexabrands_dbt://models/src/stg_date.sql
[0m20:14:15.862822 [debug] [MainThread]: Partial parsing: deleted file: nexabrands_dbt://models/src/stg_customer.sql
[0m20:14:15.863295 [debug] [MainThread]: Partial parsing: deleted file: nexabrands_dbt://models/src/stg_customer_targets.sql
[0m20:14:15.863853 [debug] [MainThread]: Partial parsing: deleted file: nexabrands_dbt://models/src/stg_orders.sql
[0m20:14:15.864306 [debug] [MainThread]: Partial parsing: deleted file: nexabrands_dbt://models/src/stg_order_fulfillment.sql
[0m20:14:15.864857 [debug] [MainThread]: Partial parsing: deleted file: nexabrands_dbt://models/src/stg_order_lines.sql
[0m20:14:16.138922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256b79acc0>]}
[0m20:14:16.194686 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m20:14:16.197558 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m20:14:16.210395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256b799280>]}
[0m20:14:16.211013 [info ] [MainThread]: Found 9 models, 431 macros
[0m20:14:16.211590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256b79d520>]}
[0m20:14:16.213719 [info ] [MainThread]: 
[0m20:14:16.214291 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:14:16.214833 [info ] [MainThread]: 
[0m20:14:16.215596 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:14:16.220801 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m20:14:16.254528 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m20:14:16.255070 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m20:14:16.255566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:16.259821 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m20:14:16.261260 [debug] [ThreadPool]: On list_raw: Close
[0m20:14:16.263575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m20:14:16.269931 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m20:14:16.270519 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m20:14:16.271273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:16.277543 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:14:16.278333 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m20:14:16.279126 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:14:16.283098 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.003 seconds
[0m20:14:16.285997 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m20:14:16.286625 [debug] [ThreadPool]: On list_raw_raw: Close
[0m20:14:16.294348 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:16.294884 [debug] [MainThread]: On master: BEGIN
[0m20:14:16.295339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:16.298925 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:14:16.299399 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:16.299985 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:14:16.318274 [debug] [MainThread]: SQL status: SELECT 10 in 0.018 seconds
[0m20:14:16.321532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256b7f9070>]}
[0m20:14:16.322115 [debug] [MainThread]: On master: ROLLBACK
[0m20:14:16.322680 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:16.323154 [debug] [MainThread]: On master: BEGIN
[0m20:14:16.323926 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:14:16.325118 [debug] [MainThread]: On master: COMMIT
[0m20:14:16.325873 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:16.326596 [debug] [MainThread]: On master: COMMIT
[0m20:14:16.327411 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:14:16.328020 [debug] [MainThread]: On master: Close
[0m20:14:16.331828 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.dim_date
[0m20:14:16.332342 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m20:14:16.332950 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_customers
[0m20:14:16.334151 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m20:14:16.333582 [info ] [Thread-1 (]: 1 of 9 START sql view model raw.dim_date ....................................... [RUN]
[0m20:14:16.335023 [info ] [Thread-2 (]: 2 of 9 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m20:14:16.335600 [info ] [Thread-3 (]: 3 of 9 START sql view model raw.stg_customers .................................. [RUN]
[0m20:14:16.337092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.dim_date)
[0m20:14:16.336373 [info ] [Thread-4 (]: 4 of 9 START sql view model raw.stg_order_lines ................................ [RUN]
[0m20:14:16.337914 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m20:14:16.338557 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_customers'
[0m20:14:16.339150 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.dim_date
[0m20:14:16.339905 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order_lines'
[0m20:14:16.340516 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m20:14:16.341715 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_customers
[0m20:14:16.349502 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m20:14:16.353045 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:16.355284 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customers"
[0m20:14:16.358442 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m20:14:16.359546 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_customers
[0m20:14:16.383748 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.stg_order_lines
[0m20:14:16.399988 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m20:14:16.409203 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_lines"
[0m20:14:16.420361 [debug] [Thread-1 (]: Compilation Error in model dim_date (models/marts/dim_date.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:14:16.423827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256d25ec90>]}
[0m20:14:16.415358 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:16.426627 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:14:16.430791 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customers"
[0m20:14:16.431492 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:16.432003 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: BEGIN
[0m20:14:16.425095 [error] [Thread-1 (]: 1 of 9 ERROR creating sql view model raw.dim_date .............................. [[31mERROR[0m in 0.09s]
[0m20:14:16.433322 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:14:16.434084 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m20:14:16.434662 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:14:16.435373 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.dim_date
[0m20:14:16.435941 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: BEGIN
[0m20:14:16.439661 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:14:16.437704 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_orders
[0m20:14:16.438813 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.dim_date' to be skipped because of status 'error'.  Reason: Compilation Error in model dim_date (models/marts/dim_date.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:14:16.436512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:16.445510 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m20:14:16.446459 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:14:16.442178 [info ] [Thread-1 (]: 5 of 9 START sql view model raw.stg_orders ..................................... [RUN]
[0m20:14:16.449230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.dim_date, now model.nexabrands_dbt.stg_orders)
[0m20:14:16.452449 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_orders
[0m20:14:16.451672 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m20:14:16.456826 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:16.457690 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m20:14:16.450720 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m20:14:16.455975 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_orders"
[0m20:14:16.447788 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */

  create view "raw"."raw"."stg_order_lines__dbt_tmp"
    
    
  as (
    -- models/staging/stg_order_lines.sql
WITH order_lines AS (
    SELECT * FROM raw.raw.order_lines
)

SELECT
    order_id,
    product_id,
    order_qty,
    agreed_delivery_date,
    actual_delivery_date,
    delivery_qty 
   
FROM order_lines
  );
[0m20:14:16.460309 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:14:16.462216 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customers"} */

  create view "raw"."raw"."stg_customers__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   raw.raw.customers    
)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
  );
[0m20:14:16.461169 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:14:16.472939 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_orders
[0m20:14:16.480555 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:16.481664 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets" rename to "stg_customer_targets__dbt_backup"
[0m20:14:16.483164 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_orders"
[0m20:14:16.483670 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m20:14:16.484255 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m20:14:16.488512 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:14:16.489191 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m20:14:16.492171 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:14:16.492933 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:14:16.493551 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customers"} */
alter table "raw"."raw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:14:16.496384 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:16.497666 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines" rename to "stg_order_lines__dbt_backup"
[0m20:14:16.498491 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: BEGIN
[0m20:14:16.499643 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m20:14:16.500164 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:14:16.500992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:16.501503 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:14:16.513312 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m20:14:16.522744 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:14:16.523251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m20:14:16.519227 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: COMMIT
[0m20:14:16.528309 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m20:14:16.528913 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines__dbt_tmp" rename to "stg_order_lines"
[0m20:14:16.529537 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:14:16.530172 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:14:16.530782 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:16.531552 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */

  create view "raw"."raw"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM raw.raw.orders
)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
  );
[0m20:14:16.532112 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:14:16.532664 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: COMMIT
[0m20:14:16.533269 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m20:14:16.535967 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m20:14:16.536459 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:14:16.537575 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:14:16.541390 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:14:16.542051 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m20:14:16.542524 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m20:14:16.542983 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m20:14:16.543563 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */
alter table "raw"."raw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:14:16.550244 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m20:14:16.553072 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_customers__dbt_backup"
[0m20:14:16.553603 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m20:14:16.560432 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:16.561036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m20:14:16.562064 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:14:16.564497 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."stg_order_lines__dbt_backup"
[0m20:14:16.565095 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m20:14:16.568094 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:14:16.570666 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */
alter table "raw"."raw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:14:16.568697 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customers"} */
drop view if exists "raw"."raw"."stg_customers__dbt_backup" cascade
[0m20:14:16.569824 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:14:16.572042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:14:16.572642 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:14:16.573365 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
drop view if exists "raw"."raw"."stg_order_lines__dbt_backup" cascade
[0m20:14:16.573846 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:14:16.580544 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: Close
[0m20:14:16.575773 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: COMMIT
[0m20:14:16.581698 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:14:16.582470 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: COMMIT
[0m20:14:16.583497 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256b7b6fc0>]}
[0m20:14:16.578272 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m20:14:16.585399 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m20:14:16.585973 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:14:16.586677 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256efebad0>]}
[0m20:14:16.584806 [info ] [Thread-3 (]: 3 of 9 OK created sql view model raw.stg_customers ............................. [[32mCREATE VIEW[0m in 0.24s]
[0m20:14:16.588977 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: Close
[0m20:14:16.592280 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_orders__dbt_backup"
[0m20:14:16.595604 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:14:16.593982 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_customers
[0m20:14:16.593096 [info ] [Thread-2 (]: 2 of 9 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m20:14:16.596379 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */
drop view if exists "raw"."raw"."stg_orders__dbt_backup" cascade
[0m20:14:16.597312 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_products
[0m20:14:16.599810 [info ] [Thread-3 (]: 6 of 9 START sql view model raw.stg_products ................................... [RUN]
[0m20:14:16.598854 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m20:14:16.597881 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792569d5b4d0>]}
[0m20:14:16.601513 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customers, now model.nexabrands_dbt.stg_products)
[0m20:14:16.602157 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:14:16.603039 [info ] [Thread-4 (]: 4 of 9 OK created sql view model raw.stg_order_lines ........................... [[32mCREATE VIEW[0m in 0.26s]
[0m20:14:16.603729 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_products
[0m20:14:16.605201 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: Close
[0m20:14:16.606059 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m20:14:16.608430 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_products"
[0m20:14:16.610873 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_products
[0m20:14:16.609451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792569e8d8e0>]}
[0m20:14:16.616568 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_products"
[0m20:14:16.618135 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.order_delivery_metrics
[0m20:14:16.617554 [info ] [Thread-1 (]: 5 of 9 OK created sql view model raw.stg_orders ................................ [[32mCREATE VIEW[0m in 0.16s]
[0m20:14:16.619095 [info ] [Thread-2 (]: 7 of 9 START sql view model raw.order_delivery_metrics ......................... [RUN]
[0m20:14:16.619901 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:14:16.620562 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_orders
[0m20:14:16.621168 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer_targets, now model.nexabrands_dbt.order_delivery_metrics)
[0m20:14:16.621764 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: BEGIN
[0m20:14:16.622559 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.order_delivery_metrics
[0m20:14:16.623211 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:14:16.626364 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.order_delivery_metrics"
[0m20:14:16.627684 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.order_delivery_metrics
[0m20:14:16.632441 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.order_delivery_metrics"
[0m20:14:16.633423 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:14:16.634661 [debug] [Thread-2 (]: On model.nexabrands_dbt.order_delivery_metrics: BEGIN
[0m20:14:16.635149 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m20:14:16.635709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:16.636289 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:14:16.637344 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_products"} */

  create view "raw"."raw"."stg_products__dbt_tmp"
    
    
  as (
    -- models/staging/stg_products.sql
WITH products AS (
    SELECT * 
    FROM   raw.raw.products
)

SELECT
    product_id ,
    product_name ,
    category
FROM products
  );
[0m20:14:16.640588 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:14:16.644837 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:14:16.645357 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m20:14:16.646035 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_products"} */
alter table "raw"."raw"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:14:16.646669 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:14:16.647686 [debug] [Thread-2 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */

  create view "raw"."raw"."order_delivery_metrics__dbt_tmp"
    
    
  as (
    WITH order_lines AS (
    SELECT * FROM "raw"."raw"."stg_order_lines"
),

delivery_metrics AS (
    SELECT
        order_id,
        product_id,
        order_qty,
        delivery_qty,
        agreed_delivery_date,
        actual_delivery_date,
        -- Calculating  delivery metrics
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date THEN 1 
            ELSE 0 
        END as is_on_time,
        CASE 
            WHEN delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_in_full,
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date 
            AND delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_otif
    FROM order_lines
)

SELECT * FROM delivery_metrics
  );
[0m20:14:16.648541 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:14:16.651404 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: COMMIT
[0m20:14:16.652204 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:14:16.652992 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: COMMIT
[0m20:14:16.654118 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:14:16.657628 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:14:16.658228 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m20:14:16.658703 [debug] [Thread-2 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics__dbt_tmp" rename to "order_delivery_metrics"
[0m20:14:16.661051 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_products__dbt_backup"
[0m20:14:16.662516 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:14:16.662990 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:14:16.663584 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_products"} */
drop view if exists "raw"."raw"."stg_products__dbt_backup" cascade
[0m20:14:16.665354 [debug] [Thread-2 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m20:14:16.666169 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:14:16.666648 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:14:16.668058 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: Close
[0m20:14:16.668648 [debug] [Thread-2 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m20:14:16.669634 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792568408f20>]}
[0m20:14:16.670712 [info ] [Thread-3 (]: 6 of 9 OK created sql view model raw.stg_products .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m20:14:16.672264 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_products
[0m20:14:16.672756 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:14:16.675499 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."order_delivery_metrics__dbt_backup"
[0m20:14:16.676814 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:14:16.677699 [debug] [Thread-2 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
drop view if exists "raw"."raw"."order_delivery_metrics__dbt_backup" cascade
[0m20:14:16.678566 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:14:16.679967 [debug] [Thread-2 (]: On model.nexabrands_dbt.order_delivery_metrics: Close
[0m20:14:16.680773 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7925684a1f10>]}
[0m20:14:16.681870 [info ] [Thread-2 (]: 7 of 9 OK created sql view model raw.order_delivery_metrics .................... [[32mCREATE VIEW[0m in 0.06s]
[0m20:14:16.682939 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.order_delivery_metrics
[0m20:14:16.684082 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.customer_performance
[0m20:14:16.684586 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m20:14:16.685285 [info ] [Thread-4 (]: 8 of 9 START sql view model raw.customer_performance ........................... [RUN]
[0m20:14:16.686587 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_order_lines, now model.nexabrands_dbt.customer_performance)
[0m20:14:16.686049 [info ] [Thread-1 (]: 9 of 9 START sql view model raw.fct_order_fulfillment_lines .................... [RUN]
[0m20:14:16.687301 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.customer_performance
[0m20:14:16.688011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_orders, now model.nexabrands_dbt.fct_order_fulfillment_lines)
[0m20:14:16.692123 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.customer_performance"
[0m20:14:16.692797 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m20:14:16.696586 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m20:14:16.697515 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.customer_performance
[0m20:14:16.701729 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.customer_performance"
[0m20:14:16.702328 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m20:14:16.706517 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m20:14:16.707033 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:14:16.708063 [debug] [Thread-4 (]: On model.nexabrands_dbt.customer_performance: BEGIN
[0m20:14:16.708848 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m20:14:16.709332 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:14:16.709910 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: BEGIN
[0m20:14:16.710759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:16.716066 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:14:16.716948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:14:16.717456 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:14:16.718280 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m20:14:16.718979 [debug] [Thread-4 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */

  create view "raw"."raw"."customer_performance__dbt_tmp"
    
    
  as (
    WITH delivery_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

customer_orders AS (
    SELECT * FROM "raw"."raw"."stg_orders"
),

customer_metrics AS (
    SELECT
        co.customer_id,
        COUNT(*) as total_orders,
        AVG(dm.is_on_time) as ontime_rate,
        AVG(dm.is_in_full) as infull_rate,
        AVG(dm.is_otif) as otif_rate
    FROM delivery_metrics dm
    JOIN customer_orders co ON dm.order_id = co.order_id
    GROUP BY co.customer_id
)

SELECT * FROM customer_metrics
  );
[0m20:14:16.719845 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */

  create view "raw"."raw"."fct_order_fulfillment_lines__dbt_tmp"
    
    
  as (
    -- models/marts/fct_order_fulfillment_lines.sql
WITH order_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

orders AS (
    SELECT * FROM "raw"."raw"."stg_orders"
),

customers AS (
    SELECT * FROM "raw"."raw"."stg_customers"
),

customer_targets AS (
    SELECT * FROM "raw"."raw"."stg_customer_targets"
)

SELECT
    om.order_id,
    om.product_id,
    o.customer_id,
    o.order_placement_date,
    om.agreed_delivery_date,
    om.actual_delivery_date,
    om.order_qty,
    om.delivery_qty,
    om.is_on_time as on_time,
    om.is_in_full as in_full,
    om.is_otif as otif,
    -- Add target comparisons
    ct.ontime_target_percentage,
    ct.infull_target_percentage,
    ct.otif_target_percentage,
    -- Add variance from targets
    (om.is_on_time * 100) - ct.ontime_target_percentage as ontime_variance,
    (om.is_in_full * 100) - ct.infull_target_percentage as infull_variance,
    (om.is_otif * 100) - ct.otif_target_percentage as otif_variance
FROM order_metrics om
JOIN orders o ON om.order_id = o.order_id
JOIN customers c ON o.customer_id = c.customer_id
LEFT JOIN customer_targets ct ON c.customer_id = ct.customer_id
  );
[0m20:14:16.736156 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m20:14:16.737367 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column ct.ontime_target_percentage does not exist
LINE 37:     ct.ontime_target_percentage,
             ^

[0m20:14:16.748753 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: ROLLBACK
[0m20:14:16.751900 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: Close
[0m20:14:16.762339 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:14:16.763437 [debug] [Thread-4 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
alter table "raw"."raw"."customer_performance__dbt_tmp" rename to "customer_performance"
[0m20:14:16.766723 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:14:16.770828 [debug] [Thread-1 (]: Database Error in model fct_order_fulfillment_lines (models/marts/fct_order_fulfillment_lines.sql)
  column ct.ontime_target_percentage does not exist
  LINE 37:     ct.ontime_target_percentage,
               ^
  compiled code at target/run/nexabrands_dbt/models/marts/fct_order_fulfillment_lines.sql
[0m20:14:16.780480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256842f3e0>]}
[0m20:14:16.781746 [error] [Thread-1 (]: 9 of 9 ERROR creating sql view model raw.fct_order_fulfillment_lines ........... [[31mERROR[0m in 0.09s]
[0m20:14:16.783261 [debug] [Thread-4 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m20:14:16.786463 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:14:16.785126 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m20:14:16.788771 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.fct_order_fulfillment_lines' to be skipped because of status 'error'.  Reason: Database Error in model fct_order_fulfillment_lines (models/marts/fct_order_fulfillment_lines.sql)
  column ct.ontime_target_percentage does not exist
  LINE 37:     ct.ontime_target_percentage,
               ^
  compiled code at target/run/nexabrands_dbt/models/marts/fct_order_fulfillment_lines.sql.
[0m20:14:16.787549 [debug] [Thread-4 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m20:14:16.791794 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m20:14:16.798363 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."customer_performance__dbt_backup"
[0m20:14:16.799858 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:14:16.800426 [debug] [Thread-4 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
drop view if exists "raw"."raw"."customer_performance__dbt_backup" cascade
[0m20:14:16.801209 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:14:16.802772 [debug] [Thread-4 (]: On model.nexabrands_dbt.customer_performance: Close
[0m20:14:16.803633 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37280350-7f72-44f4-a73c-d2f64d99b5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792568474320>]}
[0m20:14:16.804680 [info ] [Thread-4 (]: 8 of 9 OK created sql view model raw.customer_performance ...................... [[32mCREATE VIEW[0m in 0.12s]
[0m20:14:16.805758 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.customer_performance
[0m20:14:16.807989 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:16.808474 [debug] [MainThread]: On master: BEGIN
[0m20:14:16.808959 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:16.812311 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:14:16.813350 [debug] [MainThread]: On master: COMMIT
[0m20:14:16.813905 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:16.814612 [debug] [MainThread]: On master: COMMIT
[0m20:14:16.815406 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:14:16.815918 [debug] [MainThread]: On master: Close
[0m20:14:16.816686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:16.817458 [debug] [MainThread]: Connection 'model.nexabrands_dbt.order_delivery_metrics' was properly closed.
[0m20:14:16.818156 [debug] [MainThread]: Connection 'model.nexabrands_dbt.fct_order_fulfillment_lines' was properly closed.
[0m20:14:16.818876 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_products' was properly closed.
[0m20:14:16.819336 [debug] [MainThread]: Connection 'model.nexabrands_dbt.customer_performance' was properly closed.
[0m20:14:16.820233 [info ] [MainThread]: 
[0m20:14:16.821019 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m20:14:16.823029 [debug] [MainThread]: Command end result
[0m20:14:16.845476 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m20:14:16.847153 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m20:14:16.854369 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m20:14:16.855080 [info ] [MainThread]: 
[0m20:14:16.855877 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m20:14:16.856659 [info ] [MainThread]: 
[0m20:14:16.857515 [error] [MainThread]:   Compilation Error in model dim_date (models/marts/dim_date.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:14:16.858142 [info ] [MainThread]: 
[0m20:14:16.858787 [error] [MainThread]:   Database Error in model fct_order_fulfillment_lines (models/marts/fct_order_fulfillment_lines.sql)
  column ct.ontime_target_percentage does not exist
  LINE 37:     ct.ontime_target_percentage,
               ^
  compiled code at target/run/nexabrands_dbt/models/marts/fct_order_fulfillment_lines.sql
[0m20:14:16.859314 [info ] [MainThread]: 
[0m20:14:16.859886 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m20:14:16.861062 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.506981, "process_in_blocks": "624", "process_kernel_time": 0.315684, "process_mem_max_rss": "119028", "process_out_blocks": "2880", "process_user_time": 2.638798}
[0m20:14:16.861687 [debug] [MainThread]: Command `dbt run` failed at 20:14:16.861552 after 1.51 seconds
[0m20:14:16.862220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256d5657f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256de08380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79256d3f5850>]}
[0m20:14:16.862889 [debug] [MainThread]: Flushing usage events
[0m20:14:17.960739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:14:45.225657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e86ca66600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e86c2dc770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e86c545b50>]}


============================== 20:14:45.228971 | 9339f557-76c5-4b3b-b681-88186c928f93 ==============================
[0m20:14:45.228971 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:14:45.229818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'profiles_dir': '/home/codespace/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:14:45.446286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9339f557-76c5-4b3b-b681-88186c928f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e86c544c20>]}
[0m20:14:45.537555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9339f557-76c5-4b3b-b681-88186c928f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e86c1e7980>]}
[0m20:14:45.538970 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:14:45.654151 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:14:45.739335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:14:45.740104 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/marts/fct_order_fulfillment_lines.sql
[0m20:14:45.989568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9339f557-76c5-4b3b-b681-88186c928f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e86a92b560>]}
[0m20:14:46.045769 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m20:14:46.048718 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m20:14:46.060942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9339f557-76c5-4b3b-b681-88186c928f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e86a548d40>]}
[0m20:14:46.061573 [info ] [MainThread]: Found 9 models, 431 macros
[0m20:14:46.062146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9339f557-76c5-4b3b-b681-88186c928f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e86bd76240>]}
[0m20:14:46.064213 [info ] [MainThread]: 
[0m20:14:46.064771 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:14:46.065340 [info ] [MainThread]: 
[0m20:14:46.066072 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:14:46.071333 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m20:14:46.106435 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m20:14:46.106956 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m20:14:46.107431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:46.111620 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m20:14:46.112976 [debug] [ThreadPool]: On list_raw: Close
[0m20:14:46.115292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m20:14:46.121487 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m20:14:46.122007 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m20:14:46.122481 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:46.126294 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:14:46.126825 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m20:14:46.127338 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:14:46.129849 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.002 seconds
[0m20:14:46.131660 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m20:14:46.132479 [debug] [ThreadPool]: On list_raw_raw: Close
[0m20:14:46.140941 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:46.141483 [debug] [MainThread]: On master: BEGIN
[0m20:14:46.141958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:46.146028 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:14:46.146526 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:46.147102 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:14:46.166624 [debug] [MainThread]: SQL status: SELECT 12 in 0.019 seconds
[0m20:14:46.170278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9339f557-76c5-4b3b-b681-88186c928f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e86a928ec0>]}
[0m20:14:46.170891 [debug] [MainThread]: On master: ROLLBACK
[0m20:14:46.171499 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:46.172017 [debug] [MainThread]: On master: BEGIN
[0m20:14:46.172708 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:14:46.173558 [debug] [MainThread]: On master: COMMIT
[0m20:14:46.174375 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:46.175153 [debug] [MainThread]: On master: COMMIT
[0m20:14:46.176084 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:14:46.176813 [debug] [MainThread]: On master: Close
[0m20:14:46.180132 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.dim_date
[0m20:14:46.181255 [info ] [Thread-1 (]: 1 of 8 START sql view model raw.dim_date ....................................... [RUN]
[0m20:14:46.182054 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m20:14:46.182798 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_customers
[0m20:14:46.183336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.dim_date)
[0m20:14:46.183804 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m20:14:46.184485 [info ] [Thread-2 (]: 2 of 8 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m20:14:46.185259 [info ] [Thread-3 (]: 3 of 8 START sql view model raw.stg_customers .................................. [RUN]
[0m20:14:46.185937 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.dim_date
[0m20:14:46.186574 [info ] [Thread-4 (]: 4 of 8 START sql view model raw.stg_order_lines ................................ [RUN]
[0m20:14:46.187462 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_customer_targets'
[0m20:14:46.188176 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_customers'
[0m20:14:46.197707 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order_lines'
[0m20:14:46.198967 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m20:14:46.199796 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_customers
[0m20:14:46.200541 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m20:14:46.202930 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:46.204796 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customers"
[0m20:14:46.206710 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m20:14:46.210060 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.stg_order_lines
[0m20:14:46.211533 [debug] [Thread-1 (]: Compilation Error in model dim_date (models/marts/dim_date.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:14:46.212324 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_customers
[0m20:14:46.218069 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m20:14:46.240001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9339f557-76c5-4b3b-b681-88186c928f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e86cc516a0>]}
[0m20:14:46.264722 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:46.265574 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customers"
[0m20:14:46.268167 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_lines"
[0m20:14:46.268961 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model raw.dim_date .............................. [[31mERROR[0m in 0.06s]
[0m20:14:46.270496 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:14:46.271330 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.dim_date
[0m20:14:46.272096 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: BEGIN
[0m20:14:46.272965 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_orders
[0m20:14:46.273486 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:46.274028 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.dim_date' to be skipped because of status 'error'.  Reason: Compilation Error in model dim_date (models/marts/dim_date.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m20:14:46.274641 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:14:46.275251 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:14:46.278953 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: BEGIN
[0m20:14:46.279713 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:14:46.275960 [info ] [Thread-1 (]: 5 of 8 START sql view model raw.stg_orders ..................................... [RUN]
[0m20:14:46.281072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.dim_date, now model.nexabrands_dbt.stg_orders)
[0m20:14:46.282199 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_orders
[0m20:14:46.283965 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m20:14:46.277061 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m20:14:46.287102 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_orders"
[0m20:14:46.287853 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:14:46.289013 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m20:14:46.289618 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:14:46.290654 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customers"} */

  create view "raw"."raw"."stg_customers__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   raw.raw.customers    
)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
  );
[0m20:14:46.292162 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:14:46.293847 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */

  create view "raw"."raw"."stg_order_lines__dbt_tmp"
    
    
  as (
    -- models/staging/stg_order_lines.sql
WITH order_lines AS (
    SELECT * FROM raw.raw.order_lines
)

SELECT
    order_id,
    product_id,
    order_qty,
    agreed_delivery_date,
    actual_delivery_date,
    delivery_qty 
   
FROM order_lines
  );
[0m20:14:46.292824 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_orders
[0m20:14:46.300668 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_orders"
[0m20:14:46.301351 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:14:46.302437 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m20:14:46.302918 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:14:46.309375 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:14:46.311462 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:14:46.311941 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:46.315201 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:14:46.315792 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: BEGIN
[0m20:14:46.316372 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customers"} */
alter table "raw"."raw"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:14:46.316973 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m20:14:46.317600 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines" rename to "stg_order_lines__dbt_backup"
[0m20:14:46.318167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:46.319125 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:14:46.324295 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:14:46.324806 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:14:46.325284 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m20:14:46.326660 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customers"} */
alter table "raw"."raw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:14:46.327144 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m20:14:46.331377 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:46.335290 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:14:46.336118 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:14:46.336990 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:14:46.337511 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets" rename to "stg_customer_targets__dbt_backup"
[0m20:14:46.338099 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines__dbt_tmp" rename to "stg_order_lines"
[0m20:14:46.338677 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */

  create view "raw"."raw"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM raw.raw.orders
)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
  );
[0m20:14:46.360959 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: COMMIT
[0m20:14:46.362232 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:14:46.363007 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:14:46.363944 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:14:46.364560 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:14:46.366563 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m20:14:46.371204 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:46.374473 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:14:46.375060 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: COMMIT
[0m20:14:46.375653 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:14:46.376233 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m20:14:46.376799 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */
alter table "raw"."raw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:14:46.377580 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m20:14:46.378394 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m20:14:46.379785 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m20:14:46.385406 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:14:46.385874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m20:14:46.387271 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_customers__dbt_backup"
[0m20:14:46.389851 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."stg_order_lines__dbt_backup"
[0m20:14:46.391802 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m20:14:46.394845 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:14:46.401048 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:14:46.402204 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:14:46.402793 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:46.403383 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */
alter table "raw"."raw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:14:46.403953 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customers"} */
drop view if exists "raw"."raw"."stg_customers__dbt_backup" cascade
[0m20:14:46.406014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:14:46.404524 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
drop view if exists "raw"."raw"."stg_order_lines__dbt_backup" cascade
[0m20:14:46.405081 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m20:14:46.408379 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: COMMIT
[0m20:14:46.409878 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:14:46.410759 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: COMMIT
[0m20:14:46.408866 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:14:46.411711 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:14:46.412419 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m20:14:46.412960 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:14:46.415341 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_customers: Close
[0m20:14:46.416778 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_order_lines: Close
[0m20:14:46.422737 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9339f557-76c5-4b3b-b681-88186c928f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e868c86780>]}
[0m20:14:46.419314 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m20:14:46.421798 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_orders__dbt_backup"
[0m20:14:46.427020 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:14:46.423767 [info ] [Thread-4 (]: 4 of 8 OK created sql view model raw.stg_order_lines ........................... [[32mCREATE VIEW[0m in 0.23s]
[0m20:14:46.425129 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:14:46.427785 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */
drop view if exists "raw"."raw"."stg_orders__dbt_backup" cascade
[0m20:14:46.428646 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9339f557-76c5-4b3b-b681-88186c928f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e86de67bf0>]}
[0m20:14:46.430962 [info ] [Thread-3 (]: 3 of 8 OK created sql view model raw.stg_customers ............................. [[32mCREATE VIEW[0m in 0.24s]
[0m20:14:46.429887 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m20:14:46.432667 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:14:46.429320 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m20:14:46.432193 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_customers
[0m20:14:46.436265 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_orders: Close
[0m20:14:46.436751 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:14:46.440455 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m20:14:46.441410 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9339f557-76c5-4b3b-b681-88186c928f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e868dc9310>]}
[0m20:14:46.442471 [info ] [Thread-2 (]: 2 of 8 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m20:14:46.437426 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_products
[0m20:14:46.443539 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m20:14:46.438411 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.order_delivery_metrics
[0m20:14:46.444426 [info ] [Thread-4 (]: 6 of 8 START sql view model raw.stg_products ................................... [RUN]
[0m20:14:46.445278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9339f557-76c5-4b3b-b681-88186c928f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e868307d10>]}
[0m20:14:46.446032 [info ] [Thread-3 (]: 7 of 8 START sql view model raw.order_delivery_metrics ......................... [RUN]
[0m20:14:46.446730 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_order_lines, now model.nexabrands_dbt.stg_products)
[0m20:14:46.447521 [info ] [Thread-1 (]: 5 of 8 OK created sql view model raw.stg_orders ................................ [[32mCREATE VIEW[0m in 0.16s]
[0m20:14:46.448212 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customers, now model.nexabrands_dbt.order_delivery_metrics)
[0m20:14:46.448794 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_products
[0m20:14:46.449558 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_orders
[0m20:14:46.450242 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.order_delivery_metrics
[0m20:14:46.452844 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_products"
[0m20:14:46.455658 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.order_delivery_metrics"
[0m20:14:46.456834 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.stg_products
[0m20:14:46.462766 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.order_delivery_metrics
[0m20:14:46.462421 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_products"
[0m20:14:46.466573 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.order_delivery_metrics"
[0m20:14:46.467918 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:14:46.468535 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:14:46.469099 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_products: BEGIN
[0m20:14:46.469690 [debug] [Thread-3 (]: On model.nexabrands_dbt.order_delivery_metrics: BEGIN
[0m20:14:46.470241 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:14:46.470786 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:14:46.474556 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m20:14:46.477561 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:14:46.479039 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_products"} */

  create view "raw"."raw"."stg_products__dbt_tmp"
    
    
  as (
    -- models/staging/stg_products.sql
WITH products AS (
    SELECT * 
    FROM   raw.raw.products
)

SELECT
    product_id ,
    product_name ,
    category
FROM products
  );
[0m20:14:46.481387 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m20:14:46.482247 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:14:46.483154 [debug] [Thread-3 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */

  create view "raw"."raw"."order_delivery_metrics__dbt_tmp"
    
    
  as (
    WITH order_lines AS (
    SELECT * FROM "raw"."raw"."stg_order_lines"
),

delivery_metrics AS (
    SELECT
        order_id,
        product_id,
        order_qty,
        delivery_qty,
        agreed_delivery_date,
        actual_delivery_date,
        -- Calculating  delivery metrics
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date THEN 1 
            ELSE 0 
        END as is_on_time,
        CASE 
            WHEN delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_in_full,
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date 
            AND delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_otif
    FROM order_lines
)

SELECT * FROM delivery_metrics
  );
[0m20:14:46.483804 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:14:46.488891 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:14:46.489972 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_products"} */
alter table "raw"."raw"."stg_products" rename to "stg_products__dbt_backup"
[0m20:14:46.489398 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:14:46.491384 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:14:46.494585 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:14:46.498203 [debug] [Thread-3 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics__dbt_tmp" rename to "order_delivery_metrics"
[0m20:14:46.497607 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:14:46.499061 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_products"} */
alter table "raw"."raw"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:14:46.499538 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:14:46.501520 [debug] [Thread-3 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m20:14:46.501992 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:14:46.504462 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_products: COMMIT
[0m20:14:46.502550 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:14:46.505614 [debug] [Thread-3 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m20:14:46.505011 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:14:46.506702 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_products: COMMIT
[0m20:14:46.507625 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:14:46.510296 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."order_delivery_metrics__dbt_backup"
[0m20:14:46.510771 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m20:14:46.511831 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:14:46.514284 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."stg_products__dbt_backup"
[0m20:14:46.514876 [debug] [Thread-3 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
drop view if exists "raw"."raw"."order_delivery_metrics__dbt_backup" cascade
[0m20:14:46.515957 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:14:46.516739 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:14:46.517238 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_products"} */
drop view if exists "raw"."raw"."stg_products__dbt_backup" cascade
[0m20:14:46.518644 [debug] [Thread-3 (]: On model.nexabrands_dbt.order_delivery_metrics: Close
[0m20:14:46.519675 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9339f557-76c5-4b3b-b681-88186c928f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e8683d4140>]}
[0m20:14:46.520855 [info ] [Thread-3 (]: 7 of 8 OK created sql view model raw.order_delivery_metrics .................... [[32mCREATE VIEW[0m in 0.07s]
[0m20:14:46.522081 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:14:46.522965 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.order_delivery_metrics
[0m20:14:46.524361 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_products: Close
[0m20:14:46.525230 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.customer_performance
[0m20:14:46.526134 [info ] [Thread-2 (]: 8 of 8 START sql view model raw.customer_performance ........................... [RUN]
[0m20:14:46.527129 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer_targets, now model.nexabrands_dbt.customer_performance)
[0m20:14:46.527902 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.customer_performance
[0m20:14:46.529047 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9339f557-76c5-4b3b-b681-88186c928f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e868dc9e20>]}
[0m20:14:46.532310 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.customer_performance"
[0m20:14:46.533124 [info ] [Thread-4 (]: 6 of 8 OK created sql view model raw.stg_products .............................. [[32mCREATE VIEW[0m in 0.08s]
[0m20:14:46.534305 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_products
[0m20:14:46.535115 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.customer_performance
[0m20:14:46.538956 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.customer_performance"
[0m20:14:46.540116 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:14:46.540968 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: BEGIN
[0m20:14:46.541641 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:46.545383 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m20:14:46.545950 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:14:46.546505 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */

  create view "raw"."raw"."customer_performance__dbt_tmp"
    
    
  as (
    WITH delivery_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

customer_orders AS (
    SELECT * FROM "raw"."raw"."stg_orders"
),

customer_metrics AS (
    SELECT
        co.customer_id,
        COUNT(*) as total_orders,
        AVG(dm.is_on_time) as ontime_rate,
        AVG(dm.is_in_full) as infull_rate,
        AVG(dm.is_otif) as otif_rate
    FROM delivery_metrics dm
    JOIN customer_orders co ON dm.order_id = co.order_id
    GROUP BY co.customer_id
)

SELECT * FROM customer_metrics
  );
[0m20:14:46.548715 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:14:46.553058 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:14:46.553670 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
alter table "raw"."raw"."customer_performance__dbt_tmp" rename to "customer_performance"
[0m20:14:46.554484 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:14:46.556162 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m20:14:46.556749 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:14:46.557297 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m20:14:46.558775 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m20:14:46.561139 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."customer_performance__dbt_backup"
[0m20:14:46.562287 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:14:46.562826 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
drop view if exists "raw"."raw"."customer_performance__dbt_backup" cascade
[0m20:14:46.563496 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:14:46.564953 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: Close
[0m20:14:46.565778 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9339f557-76c5-4b3b-b681-88186c928f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e868da0290>]}
[0m20:14:46.566837 [info ] [Thread-2 (]: 8 of 8 OK created sql view model raw.customer_performance ...................... [[32mCREATE VIEW[0m in 0.04s]
[0m20:14:46.567903 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.customer_performance
[0m20:14:46.569770 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:46.570269 [debug] [MainThread]: On master: BEGIN
[0m20:14:46.570928 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:46.575798 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m20:14:46.576542 [debug] [MainThread]: On master: COMMIT
[0m20:14:46.577288 [debug] [MainThread]: Using postgres connection "master"
[0m20:14:46.577977 [debug] [MainThread]: On master: COMMIT
[0m20:14:46.578714 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:14:46.579403 [debug] [MainThread]: On master: Close
[0m20:14:46.582707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:46.583365 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_orders' was properly closed.
[0m20:14:46.584249 [debug] [MainThread]: Connection 'model.nexabrands_dbt.customer_performance' was properly closed.
[0m20:14:46.585716 [debug] [MainThread]: Connection 'model.nexabrands_dbt.order_delivery_metrics' was properly closed.
[0m20:14:46.586721 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_products' was properly closed.
[0m20:14:46.589638 [info ] [MainThread]: 
[0m20:14:46.593130 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m20:14:46.596648 [debug] [MainThread]: Command end result
[0m20:14:46.636902 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m20:14:46.639468 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m20:14:46.647480 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m20:14:46.647973 [info ] [MainThread]: 
[0m20:14:46.648661 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:14:46.649217 [info ] [MainThread]: 
[0m20:14:46.650485 [error] [MainThread]:   Compilation Error in model dim_date (models/marts/dim_date.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m20:14:46.651788 [info ] [MainThread]: 
[0m20:14:46.653064 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m20:14:46.656495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4874856, "process_in_blocks": "152", "process_kernel_time": 0.305016, "process_mem_max_rss": "121016", "process_out_blocks": "2816", "process_user_time": 2.47578}
[0m20:14:46.657511 [debug] [MainThread]: Command `dbt run` failed at 20:14:46.657342 after 1.49 seconds
[0m20:14:46.658450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e86c1e5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e86cd0c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72e86b570b90>]}
[0m20:14:46.659530 [debug] [MainThread]: Flushing usage events
[0m20:14:47.594716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:15:06.195583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452ff6a84d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452ff2dae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452ff6a93a0>]}


============================== 20:15:06.200455 | 0b576279-0403-403c-9792-fb96f8aceef7 ==============================
[0m20:15:06.200455 [info ] [MainThread]: Running with dbt=1.9.1
[0m20:15:06.201291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/codespace/.dbt', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:15:06.374032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b576279-0403-403c-9792-fb96f8aceef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452fe307c50>]}
[0m20:15:06.440194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b576279-0403-403c-9792-fb96f8aceef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452feeaf5f0>]}
[0m20:15:06.441144 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:15:06.548196 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m20:15:06.625701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:15:06.626458 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/marts/dim_date.sql
[0m20:15:06.877703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b576279-0403-403c-9792-fb96f8aceef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452fcf23560>]}
[0m20:15:06.939623 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m20:15:06.942545 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m20:15:06.954653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b576279-0403-403c-9792-fb96f8aceef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452fcb1c170>]}
[0m20:15:06.955257 [info ] [MainThread]: Found 9 models, 431 macros
[0m20:15:06.955849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b576279-0403-403c-9792-fb96f8aceef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452fcb2f9b0>]}
[0m20:15:06.957886 [info ] [MainThread]: 
[0m20:15:06.958466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:15:06.959005 [info ] [MainThread]: 
[0m20:15:06.959739 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:15:06.964598 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m20:15:06.998559 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m20:15:06.999154 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m20:15:06.999644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:07.006095 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m20:15:07.007452 [debug] [ThreadPool]: On list_raw: Close
[0m20:15:07.009774 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m20:15:07.015859 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m20:15:07.016363 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m20:15:07.016842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:07.020326 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:15:07.020860 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m20:15:07.021412 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m20:15:07.023823 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.002 seconds
[0m20:15:07.025630 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m20:15:07.026454 [debug] [ThreadPool]: On list_raw_raw: Close
[0m20:15:07.034848 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:07.035350 [debug] [MainThread]: On master: BEGIN
[0m20:15:07.035820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:15:07.039230 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:15:07.039726 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:07.040303 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:15:07.059600 [debug] [MainThread]: SQL status: SELECT 12 in 0.019 seconds
[0m20:15:07.063363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b576279-0403-403c-9792-fb96f8aceef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452fb784470>]}
[0m20:15:07.063957 [debug] [MainThread]: On master: ROLLBACK
[0m20:15:07.064529 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:07.065021 [debug] [MainThread]: On master: BEGIN
[0m20:15:07.066379 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:15:07.066874 [debug] [MainThread]: On master: COMMIT
[0m20:15:07.067357 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:07.067820 [debug] [MainThread]: On master: COMMIT
[0m20:15:07.068387 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:15:07.068856 [debug] [MainThread]: On master: Close
[0m20:15:07.071719 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m20:15:07.072593 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customers
[0m20:15:07.073473 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m20:15:07.074087 [info ] [Thread-1 (]: 1 of 7 START sql view model raw.stg_customer_targets ........................... [RUN]
[0m20:15:07.074956 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_orders
[0m20:15:07.075542 [info ] [Thread-2 (]: 2 of 7 START sql view model raw.stg_customers .................................. [RUN]
[0m20:15:07.076254 [info ] [Thread-3 (]: 3 of 7 START sql view model raw.stg_order_lines ................................ [RUN]
[0m20:15:07.076954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m20:15:07.077619 [info ] [Thread-4 (]: 4 of 7 START sql view model raw.stg_orders ..................................... [RUN]
[0m20:15:07.078308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customers)
[0m20:15:07.078965 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order_lines'
[0m20:15:07.079545 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m20:15:07.080318 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_orders'
[0m20:15:07.080879 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customers
[0m20:15:07.081827 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m20:15:07.088399 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m20:15:07.089006 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_orders
[0m20:15:07.091043 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customers"
[0m20:15:07.092948 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m20:15:07.095173 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_orders"
[0m20:15:07.095975 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.stg_customer_targets
[0m20:15:07.097053 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.stg_customers
[0m20:15:07.097863 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_order_lines
[0m20:15:07.110606 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.stg_orders
[0m20:15:07.165968 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_orders"
[0m20:15:07.168254 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_order_lines"
[0m20:15:07.169679 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customers"
[0m20:15:07.171104 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_customer_targets"
[0m20:15:07.172574 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:15:07.173631 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: BEGIN
[0m20:15:07.174264 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:15:07.174737 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:15:07.175385 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:15:07.176034 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:15:07.176484 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: BEGIN
[0m20:15:07.177025 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customers: BEGIN
[0m20:15:07.178367 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_orders: BEGIN
[0m20:15:07.179160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:07.180031 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:07.180896 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:15:07.182909 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m20:15:07.184664 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:15:07.185577 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */

  create view "raw"."raw"."stg_order_lines__dbt_tmp"
    
    
  as (
    -- models/staging/stg_order_lines.sql
WITH order_lines AS (
    SELECT * FROM raw.raw.order_lines
)

SELECT
    order_id,
    product_id,
    order_qty,
    agreed_delivery_date,
    actual_delivery_date,
    delivery_qty 
   
FROM order_lines
  );
[0m20:15:07.188720 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:15:07.196884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m20:15:07.197682 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:15:07.200958 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:15:07.201484 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m20:15:07.202199 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */

  create view "raw"."raw"."stg_customer_targets__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM raw.raw.customer_targets
)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
  );
[0m20:15:07.203297 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m20:15:07.205343 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:15:07.203893 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines" rename to "stg_order_lines__dbt_backup"
[0m20:15:07.204467 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:15:07.206223 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customers"} */

  create view "raw"."raw"."stg_customers__dbt_tmp"
    
    
  as (
    -- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   raw.raw.customers    
)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
  );
[0m20:15:07.206825 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:15:07.207565 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */

  create view "raw"."raw"."stg_orders__dbt_tmp"
    
    
  as (
    -- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM raw.raw.orders
)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
  );
[0m20:15:07.212644 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:15:07.214451 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets" rename to "stg_customer_targets__dbt_backup"
[0m20:15:07.213758 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:15:07.213306 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m20:15:07.218319 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:15:07.218856 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m20:15:07.219409 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:15:07.222280 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:15:07.222885 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customers"} */
alter table "raw"."raw"."stg_customers" rename to "stg_customers__dbt_backup"
[0m20:15:07.226893 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:15:07.230002 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:15:07.230610 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
alter table "raw"."raw"."stg_order_lines__dbt_tmp" rename to "stg_order_lines"
[0m20:15:07.231403 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
alter table "raw"."raw"."stg_customer_targets__dbt_tmp" rename to "stg_customer_targets"
[0m20:15:07.231976 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:15:07.232550 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */
alter table "raw"."raw"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:15:07.235972 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:15:07.236443 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:15:07.236903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m20:15:07.237786 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customers"} */
alter table "raw"."raw"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:15:07.238289 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:15:07.257438 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m20:15:07.259392 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m20:15:07.262755 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:15:07.263236 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:15:07.268053 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customers: COMMIT
[0m20:15:07.268895 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:15:07.264993 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */
alter table "raw"."raw"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:15:07.263815 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:15:07.270705 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: COMMIT
[0m20:15:07.264409 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:15:07.271632 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: COMMIT
[0m20:15:07.269744 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customers: COMMIT
[0m20:15:07.273228 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:15:07.276596 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_orders: COMMIT
[0m20:15:07.277585 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:15:07.278645 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m20:15:07.279125 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m20:15:07.279584 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m20:15:07.280036 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_orders: COMMIT
[0m20:15:07.286843 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_order_lines__dbt_backup"
[0m20:15:07.289266 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."stg_customer_targets__dbt_backup"
[0m20:15:07.291692 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."stg_customers__dbt_backup"
[0m20:15:07.297863 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m20:15:07.299360 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_order_lines"
[0m20:15:07.300494 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.stg_customer_targets"
[0m20:15:07.301613 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.stg_customers"
[0m20:15:07.304080 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."stg_orders__dbt_backup"
[0m20:15:07.304663 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_order_lines"} */
drop view if exists "raw"."raw"."stg_order_lines__dbt_backup" cascade
[0m20:15:07.305288 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customer_targets"} */
drop view if exists "raw"."raw"."stg_customer_targets__dbt_backup" cascade
[0m20:15:07.305866 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_customers"} */
drop view if exists "raw"."raw"."stg_customers__dbt_backup" cascade
[0m20:15:07.306973 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.stg_orders"
[0m20:15:07.310776 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_orders"} */
drop view if exists "raw"."raw"."stg_orders__dbt_backup" cascade
[0m20:15:07.310081 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:15:07.309073 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:15:07.311631 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:15:07.314759 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_order_lines: Close
[0m20:15:07.315435 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:15:07.320840 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b576279-0403-403c-9792-fb96f8aceef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745300807aa0>]}
[0m20:15:07.318371 [debug] [Thread-2 (]: On model.nexabrands_dbt.stg_customers: Close
[0m20:15:07.324224 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b576279-0403-403c-9792-fb96f8aceef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452fb6b0470>]}
[0m20:15:07.316895 [debug] [Thread-1 (]: On model.nexabrands_dbt.stg_customer_targets: Close
[0m20:15:07.326098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b576279-0403-403c-9792-fb96f8aceef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452fb6ace30>]}
[0m20:15:07.323426 [info ] [Thread-3 (]: 3 of 7 OK created sql view model raw.stg_order_lines ........................... [[32mCREATE VIEW[0m in 0.24s]
[0m20:15:07.325288 [info ] [Thread-2 (]: 2 of 7 OK created sql view model raw.stg_customers ............................. [[32mCREATE VIEW[0m in 0.25s]
[0m20:15:07.322596 [debug] [Thread-4 (]: On model.nexabrands_dbt.stg_orders: Close
[0m20:15:07.328569 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m20:15:07.327075 [info ] [Thread-1 (]: 1 of 7 OK created sql view model raw.stg_customer_targets ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m20:15:07.329575 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customers
[0m20:15:07.332085 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b576279-0403-403c-9792-fb96f8aceef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452fb586d20>]}
[0m20:15:07.332903 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_products
[0m20:15:07.333833 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m20:15:07.334485 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.order_delivery_metrics
[0m20:15:07.335295 [info ] [Thread-4 (]: 4 of 7 OK created sql view model raw.stg_orders ................................ [[32mCREATE VIEW[0m in 0.25s]
[0m20:15:07.335921 [info ] [Thread-3 (]: 5 of 7 START sql view model raw.stg_products ................................... [RUN]
[0m20:15:07.337126 [info ] [Thread-2 (]: 6 of 7 START sql view model raw.order_delivery_metrics ......................... [RUN]
[0m20:15:07.338008 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_orders
[0m20:15:07.338625 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_order_lines, now model.nexabrands_dbt.stg_products)
[0m20:15:07.339219 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customers, now model.nexabrands_dbt.order_delivery_metrics)
[0m20:15:07.339973 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_products
[0m20:15:07.340569 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.order_delivery_metrics
[0m20:15:07.343233 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_products"
[0m20:15:07.346202 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.order_delivery_metrics"
[0m20:15:07.347463 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.stg_products
[0m20:15:07.351527 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.stg_products"
[0m20:15:07.352302 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.order_delivery_metrics
[0m20:15:07.357774 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.order_delivery_metrics"
[0m20:15:07.358377 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:15:07.359195 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:15:07.359834 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: BEGIN
[0m20:15:07.360406 [debug] [Thread-2 (]: On model.nexabrands_dbt.order_delivery_metrics: BEGIN
[0m20:15:07.360963 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:15:07.361552 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:15:07.365737 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:15:07.366906 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:15:07.368095 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_products"} */

  create view "raw"."raw"."stg_products__dbt_tmp"
    
    
  as (
    -- models/staging/stg_products.sql
WITH products AS (
    SELECT * 
    FROM   raw.raw.products
)

SELECT
    product_id ,
    product_name ,
    category
FROM products
  );
[0m20:15:07.369469 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m20:15:07.370338 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:15:07.372505 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m20:15:07.373343 [debug] [Thread-2 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */

  create view "raw"."raw"."order_delivery_metrics__dbt_tmp"
    
    
  as (
    WITH order_lines AS (
    SELECT * FROM "raw"."raw"."stg_order_lines"
),

delivery_metrics AS (
    SELECT
        order_id,
        product_id,
        order_qty,
        delivery_qty,
        agreed_delivery_date,
        actual_delivery_date,
        -- Calculating  delivery metrics
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date THEN 1 
            ELSE 0 
        END as is_on_time,
        CASE 
            WHEN delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_in_full,
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date 
            AND delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_otif
    FROM order_lines
)

SELECT * FROM delivery_metrics
  );
[0m20:15:07.377082 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:15:07.378300 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_products"} */
alter table "raw"."raw"."stg_products" rename to "stg_products__dbt_backup"
[0m20:15:07.379413 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:15:07.382719 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:15:07.383318 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:15:07.383784 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_products"} */
alter table "raw"."raw"."stg_products__dbt_tmp" rename to "stg_products"
[0m20:15:07.386694 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:15:07.387543 [debug] [Thread-2 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics__dbt_tmp" rename to "order_delivery_metrics"
[0m20:15:07.388135 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:15:07.390350 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: COMMIT
[0m20:15:07.390830 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:15:07.391389 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:15:07.393088 [debug] [Thread-2 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m20:15:07.393709 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: COMMIT
[0m20:15:07.394297 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:15:07.395146 [debug] [Thread-2 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m20:15:07.396520 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m20:15:07.399078 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."stg_products__dbt_backup"
[0m20:15:07.399543 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m20:15:07.400693 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.stg_products"
[0m20:15:07.403050 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."order_delivery_metrics__dbt_backup"
[0m20:15:07.403646 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.stg_products"} */
drop view if exists "raw"."raw"."stg_products__dbt_backup" cascade
[0m20:15:07.404730 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m20:15:07.405565 [debug] [Thread-2 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
drop view if exists "raw"."raw"."order_delivery_metrics__dbt_backup" cascade
[0m20:15:07.406614 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:15:07.408136 [debug] [Thread-3 (]: On model.nexabrands_dbt.stg_products: Close
[0m20:15:07.408725 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:15:07.410649 [debug] [Thread-2 (]: On model.nexabrands_dbt.order_delivery_metrics: Close
[0m20:15:07.411600 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b576279-0403-403c-9792-fb96f8aceef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452fcb1c380>]}
[0m20:15:07.412758 [info ] [Thread-2 (]: 6 of 7 OK created sql view model raw.order_delivery_metrics .................... [[32mCREATE VIEW[0m in 0.07s]
[0m20:15:07.413864 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.order_delivery_metrics
[0m20:15:07.414849 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b576279-0403-403c-9792-fb96f8aceef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452fcb1c380>]}
[0m20:15:07.415806 [info ] [Thread-3 (]: 5 of 7 OK created sql view model raw.stg_products .............................. [[32mCREATE VIEW[0m in 0.08s]
[0m20:15:07.416622 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.customer_performance
[0m20:15:07.417279 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_products
[0m20:15:07.417929 [info ] [Thread-1 (]: 7 of 7 START sql view model raw.customer_performance ........................... [RUN]
[0m20:15:07.418855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer_targets, now model.nexabrands_dbt.customer_performance)
[0m20:15:07.419600 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.customer_performance
[0m20:15:07.423306 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.customer_performance"
[0m20:15:07.424323 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.customer_performance
[0m20:15:07.428239 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.customer_performance"
[0m20:15:07.429274 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:15:07.429833 [debug] [Thread-1 (]: On model.nexabrands_dbt.customer_performance: BEGIN
[0m20:15:07.430360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:07.434232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m20:15:07.435528 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:15:07.436096 [debug] [Thread-1 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */

  create view "raw"."raw"."customer_performance__dbt_tmp"
    
    
  as (
    WITH delivery_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

customer_orders AS (
    SELECT * FROM "raw"."raw"."stg_orders"
),

customer_metrics AS (
    SELECT
        co.customer_id,
        COUNT(*) as total_orders,
        AVG(dm.is_on_time) as ontime_rate,
        AVG(dm.is_in_full) as infull_rate,
        AVG(dm.is_otif) as otif_rate
    FROM delivery_metrics dm
    JOIN customer_orders co ON dm.order_id = co.order_id
    GROUP BY co.customer_id
)

SELECT * FROM customer_metrics
  );
[0m20:15:07.438405 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:15:07.442249 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:15:07.442844 [debug] [Thread-1 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
alter table "raw"."raw"."customer_performance__dbt_tmp" rename to "customer_performance"
[0m20:15:07.443689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:15:07.445426 [debug] [Thread-1 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m20:15:07.445990 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:15:07.446528 [debug] [Thread-1 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m20:15:07.447884 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:15:07.450260 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."customer_performance__dbt_backup"
[0m20:15:07.451340 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m20:15:07.451900 [debug] [Thread-1 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
drop view if exists "raw"."raw"."customer_performance__dbt_backup" cascade
[0m20:15:07.452582 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:15:07.453989 [debug] [Thread-1 (]: On model.nexabrands_dbt.customer_performance: Close
[0m20:15:07.454857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b576279-0403-403c-9792-fb96f8aceef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452f83feab0>]}
[0m20:15:07.455951 [info ] [Thread-1 (]: 7 of 7 OK created sql view model raw.customer_performance ...................... [[32mCREATE VIEW[0m in 0.04s]
[0m20:15:07.457116 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.customer_performance
[0m20:15:07.458730 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:07.459227 [debug] [MainThread]: On master: BEGIN
[0m20:15:07.459695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:15:07.463385 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:15:07.464140 [debug] [MainThread]: On master: COMMIT
[0m20:15:07.464853 [debug] [MainThread]: Using postgres connection "master"
[0m20:15:07.465374 [debug] [MainThread]: On master: COMMIT
[0m20:15:07.465935 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:15:07.466431 [debug] [MainThread]: On master: Close
[0m20:15:07.467141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:07.467872 [debug] [MainThread]: Connection 'model.nexabrands_dbt.order_delivery_metrics' was properly closed.
[0m20:15:07.468578 [debug] [MainThread]: Connection 'model.nexabrands_dbt.customer_performance' was properly closed.
[0m20:15:07.469341 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_products' was properly closed.
[0m20:15:07.469803 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_orders' was properly closed.
[0m20:15:07.470399 [info ] [MainThread]: 
[0m20:15:07.471234 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m20:15:07.473347 [debug] [MainThread]: Command end result
[0m20:15:07.496969 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m20:15:07.498679 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m20:15:07.504816 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m20:15:07.505350 [info ] [MainThread]: 
[0m20:15:07.505962 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:15:07.506498 [info ] [MainThread]: 
[0m20:15:07.507081 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:15:07.508228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3696872, "process_in_blocks": "0", "process_kernel_time": 0.315232, "process_mem_max_rss": "117568", "process_out_blocks": "2824", "process_user_time": 2.402151}
[0m20:15:07.508828 [debug] [MainThread]: Command `dbt run` succeeded at 20:15:07.508704 after 1.37 seconds
[0m20:15:07.509382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452fec70a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452ff620590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7452fdb68e30>]}
[0m20:15:07.509919 [debug] [MainThread]: Flushing usage events
[0m20:15:08.448215 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:19:55.319085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db9ccdcb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db9ce8a5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db9ccdc8860>]}


============================== 06:19:55.325156 | 879edb08-3831-4d60-8550-84ab42a67a7a ==============================
[0m06:19:55.325156 [info ] [MainThread]: Running with dbt=1.9.1
[0m06:19:55.325999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:19:55.553348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '879edb08-3831-4d60-8550-84ab42a67a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db9ccd33080>]}
[0m06:19:55.618585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '879edb08-3831-4d60-8550-84ab42a67a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db9cce945c0>]}
[0m06:19:55.619713 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:19:55.739276 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m06:19:55.829801 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m06:19:55.830862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '879edb08-3831-4d60-8550-84ab42a67a7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db9cbdf5e20>]}
[0m06:19:57.100999 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_date (models/marts/dim_date.sql)
  expected token ',', got '='
    line 4
      --         datepart="day",
[0m06:19:57.103598 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.8417646, "process_in_blocks": "87440", "process_kernel_time": 0.315564, "process_mem_max_rss": "104444", "process_out_blocks": "16", "process_user_time": 2.954473}
[0m06:19:57.104956 [debug] [MainThread]: Command `dbt compile` failed at 06:19:57.104770 after 1.84 seconds
[0m06:19:57.105911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db9cd89b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db9cec971a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db9cd2b4bf0>]}
[0m06:19:57.106860 [debug] [MainThread]: Flushing usage events
[0m06:19:57.919758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:20:18.419531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ed99785070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ed991930b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ed999739b0>]}


============================== 06:20:18.423123 | 2307e51c-8066-4779-a12d-46d00ab75fa4 ==============================
[0m06:20:18.423123 [info ] [MainThread]: Running with dbt=1.9.1
[0m06:20:18.423930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m06:20:18.623300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2307e51c-8066-4779-a12d-46d00ab75fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ed99a2c800>]}
[0m06:20:18.685904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2307e51c-8066-4779-a12d-46d00ab75fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ed99a96a50>]}
[0m06:20:18.686880 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:20:18.822063 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m06:20:18.893530 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m06:20:18.894331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2307e51c-8066-4779-a12d-46d00ab75fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ed9942f710>]}
[0m06:20:20.166282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2307e51c-8066-4779-a12d-46d00ab75fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ed973beba0>]}
[0m06:20:20.286869 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m06:20:20.290205 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m06:20:20.307696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2307e51c-8066-4779-a12d-46d00ab75fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ed96f0c680>]}
[0m06:20:20.308359 [info ] [MainThread]: Found 9 models, 6 sources, 431 macros
[0m06:20:20.308942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2307e51c-8066-4779-a12d-46d00ab75fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ed96b0e1b0>]}
[0m06:20:20.311013 [info ] [MainThread]: 
[0m06:20:20.311571 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:20:20.312107 [info ] [MainThread]: 
[0m06:20:20.312886 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:20:20.317957 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m06:20:20.357854 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m06:20:20.358502 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m06:20:20.359050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:20:20.368242 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m06:20:20.370233 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m06:20:20.370802 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m06:20:20.377857 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.006 seconds
[0m06:20:20.379767 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m06:20:20.380441 [debug] [ThreadPool]: On list_raw_raw: Close
[0m06:20:20.388673 [debug] [MainThread]: Using postgres connection "master"
[0m06:20:20.389207 [debug] [MainThread]: On master: BEGIN
[0m06:20:20.389708 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:20:20.392916 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m06:20:20.393911 [debug] [MainThread]: Using postgres connection "master"
[0m06:20:20.394876 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:20:20.424335 [debug] [MainThread]: SQL status: SELECT 12 in 0.029 seconds
[0m06:20:20.428269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2307e51c-8066-4779-a12d-46d00ab75fa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ed96f0c080>]}
[0m06:20:20.428940 [debug] [MainThread]: On master: ROLLBACK
[0m06:20:20.429552 [debug] [MainThread]: On master: Close
[0m06:20:20.434515 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m06:20:20.435148 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customers
[0m06:20:20.437126 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_customers'
[0m06:20:20.438118 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customers
[0m06:20:20.436188 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m06:20:20.435699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m06:20:20.448727 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customers"
[0m06:20:20.449363 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_orders
[0m06:20:20.449942 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order_lines'
[0m06:20:20.450515 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m06:20:20.451714 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customers
[0m06:20:20.452266 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_orders'
[0m06:20:20.452856 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m06:20:20.455436 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m06:20:20.456100 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_products
[0m06:20:20.456795 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_orders
[0m06:20:20.459369 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m06:20:20.460608 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m06:20:20.461099 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customers, now model.nexabrands_dbt.stg_products)
[0m06:20:20.463652 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_orders"
[0m06:20:20.464822 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_products
[0m06:20:20.465513 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m06:20:20.468384 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_products"
[0m06:20:20.469385 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_orders
[0m06:20:20.470114 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.order_delivery_metrics
[0m06:20:20.471318 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_products
[0m06:20:20.471897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer_targets, now model.nexabrands_dbt.order_delivery_metrics)
[0m06:20:20.472705 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.order_delivery_metrics
[0m06:20:20.480818 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.order_delivery_metrics"
[0m06:20:20.481573 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.order_delivery_metrics
[0m06:20:20.482452 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.order_delivery_metrics
[0m06:20:20.483391 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.customer_performance
[0m06:20:20.483880 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m06:20:20.484652 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_order_lines, now model.nexabrands_dbt.customer_performance)
[0m06:20:20.485241 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_orders, now model.nexabrands_dbt.fct_order_fulfillment_lines)
[0m06:20:20.485819 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.customer_performance
[0m06:20:20.486395 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m06:20:20.494638 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.customer_performance"
[0m06:20:20.506898 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m06:20:20.507752 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m06:20:20.508845 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m06:20:20.509693 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.customer_performance
[0m06:20:20.510527 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.customer_performance
[0m06:20:20.512023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:20:20.512581 [debug] [MainThread]: Connection 'model.nexabrands_dbt.order_delivery_metrics' was properly closed.
[0m06:20:20.513056 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_products' was properly closed.
[0m06:20:20.513514 [debug] [MainThread]: Connection 'model.nexabrands_dbt.customer_performance' was properly closed.
[0m06:20:20.513961 [debug] [MainThread]: Connection 'model.nexabrands_dbt.fct_order_fulfillment_lines' was properly closed.
[0m06:20:20.515007 [debug] [MainThread]: Command end result
[0m06:20:20.538699 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m06:20:20.540400 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m06:20:20.546889 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m06:20:20.548022 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.1950884, "process_in_blocks": "5256", "process_kernel_time": 0.272053, "process_mem_max_rss": "118576", "process_out_blocks": "2760", "process_user_time": 3.41267}
[0m06:20:20.548682 [debug] [MainThread]: Command `dbt compile` succeeded at 06:20:20.548553 after 2.20 seconds
[0m06:20:20.549218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ed99785070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ed95ad38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ed993f76b0>]}
[0m06:20:20.549772 [debug] [MainThread]: Flushing usage events
[0m06:20:21.298736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:20:51.942021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a62f14e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a62eddec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a62fa80b90>]}


============================== 06:20:51.945426 | 3a3d8065-86fd-44e8-94db-f3991274f649 ==============================
[0m06:20:51.945426 [info ] [MainThread]: Running with dbt=1.9.1
[0m06:20:51.946269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:20:52.123565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a3d8065-86fd-44e8-94db-f3991274f649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a62f784380>]}
[0m06:20:52.186626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a3d8065-86fd-44e8-94db-f3991274f649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a62ecec410>]}
[0m06:20:52.187592 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:20:52.354050 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m06:20:52.465782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:20:52.466404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:20:52.501104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a3d8065-86fd-44e8-94db-f3991274f649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a62dd0c440>]}
[0m06:20:52.579537 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m06:20:52.582590 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m06:20:52.595328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a3d8065-86fd-44e8-94db-f3991274f649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a62d10a3c0>]}
[0m06:20:52.595964 [info ] [MainThread]: Found 9 models, 6 sources, 431 macros
[0m06:20:52.596623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a3d8065-86fd-44e8-94db-f3991274f649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a62e542870>]}
[0m06:20:52.598770 [info ] [MainThread]: 
[0m06:20:52.599403 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:20:52.599981 [info ] [MainThread]: 
[0m06:20:52.600762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:20:52.605490 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m06:20:52.642563 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m06:20:52.643184 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:20:52.643669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:20:52.647930 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m06:20:52.649369 [debug] [ThreadPool]: On list_raw: Close
[0m06:20:52.651416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m06:20:52.657766 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m06:20:52.658309 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m06:20:52.658816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:20:52.662155 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m06:20:52.663835 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m06:20:52.664390 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m06:20:52.666936 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.002 seconds
[0m06:20:52.669345 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m06:20:52.670194 [debug] [ThreadPool]: On list_raw_raw: Close
[0m06:20:52.679372 [debug] [MainThread]: Using postgres connection "master"
[0m06:20:52.679867 [debug] [MainThread]: On master: BEGIN
[0m06:20:52.680382 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:20:52.683597 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m06:20:52.684955 [debug] [MainThread]: Using postgres connection "master"
[0m06:20:52.686140 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:20:52.705399 [debug] [MainThread]: SQL status: SELECT 12 in 0.019 seconds
[0m06:20:52.709031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a3d8065-86fd-44e8-94db-f3991274f649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a62d519910>]}
[0m06:20:52.709621 [debug] [MainThread]: On master: ROLLBACK
[0m06:20:52.710197 [debug] [MainThread]: Using postgres connection "master"
[0m06:20:52.710682 [debug] [MainThread]: On master: BEGIN
[0m06:20:52.711457 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:20:52.712395 [debug] [MainThread]: On master: COMMIT
[0m06:20:52.713226 [debug] [MainThread]: Using postgres connection "master"
[0m06:20:52.713712 [debug] [MainThread]: On master: COMMIT
[0m06:20:52.714280 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:20:52.714758 [debug] [MainThread]: On master: Close
[0m06:20:52.717380 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m06:20:52.718059 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customers
[0m06:20:52.718768 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m06:20:52.719381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m06:20:52.720539 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_orders
[0m06:20:52.721154 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customers)
[0m06:20:52.721825 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order_lines'
[0m06:20:52.722401 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m06:20:52.723092 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_orders'
[0m06:20:52.723674 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customers
[0m06:20:52.724263 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m06:20:52.731651 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m06:20:52.732248 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_orders
[0m06:20:52.734949 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customers"
[0m06:20:52.737509 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m06:20:52.740491 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_orders"
[0m06:20:52.741689 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customers
[0m06:20:52.743049 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_orders
[0m06:20:52.743801 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_products
[0m06:20:52.744645 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m06:20:52.745458 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m06:20:52.746186 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customers, now model.nexabrands_dbt.stg_products)
[0m06:20:52.747078 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_products
[0m06:20:52.749842 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_products"
[0m06:20:52.750360 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.order_delivery_metrics
[0m06:20:52.751314 [info ] [Thread-4 (]: 1 of 3 START sql view model raw.order_delivery_metrics ......................... [RUN]
[0m06:20:52.752456 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_products
[0m06:20:52.752951 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_orders, now model.nexabrands_dbt.order_delivery_metrics)
[0m06:20:52.753680 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.order_delivery_metrics
[0m06:20:52.762865 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.order_delivery_metrics"
[0m06:20:52.763736 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.order_delivery_metrics
[0m06:20:52.801456 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.order_delivery_metrics"
[0m06:20:52.802372 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m06:20:52.802955 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: BEGIN
[0m06:20:52.803498 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:20:52.807427 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m06:20:52.808016 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m06:20:52.808652 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */

  create view "raw"."raw"."order_delivery_metrics__dbt_tmp"
    
    
  as (
    

WITH  __dbt__cte__stg_order_lines as (
-- models/staging/stg_order_lines.sql
WITH order_lines AS (
    SELECT * FROM   "raw"."raw"."order_lines" 

)

SELECT
    order_id,
    product_id,
    order_qty,
    agreed_delivery_date,
    actual_delivery_date,
    delivery_qty 
   
FROM order_lines
), order_lines AS (
    SELECT * FROM __dbt__cte__stg_order_lines
),

delivery_metrics AS (
    SELECT
        order_id,
        product_id,
        order_qty,
        delivery_qty,
        agreed_delivery_date,
        actual_delivery_date,
        -- Calculating  delivery metrics
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date THEN 1 
            ELSE 0 
        END as is_on_time,
        CASE 
            WHEN delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_in_full,
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date 
            AND delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_otif
    FROM order_lines
)

SELECT * FROM delivery_metrics
  );
[0m06:20:52.824814 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m06:20:52.832093 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m06:20:52.832843 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics" rename to "order_delivery_metrics__dbt_backup"
[0m06:20:52.834167 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:20:52.837952 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m06:20:52.838777 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics__dbt_tmp" rename to "order_delivery_metrics"
[0m06:20:52.839985 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:20:52.868709 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m06:20:52.869629 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m06:20:52.870491 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m06:20:52.879372 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m06:20:52.890105 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."order_delivery_metrics__dbt_backup"
[0m06:20:52.900072 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m06:20:52.901038 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
drop view if exists "raw"."raw"."order_delivery_metrics__dbt_backup" cascade
[0m06:20:52.907911 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m06:20:52.912068 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: Close
[0m06:20:52.918951 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3d8065-86fd-44e8-94db-f3991274f649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a6308c3aa0>]}
[0m06:20:52.920854 [info ] [Thread-4 (]: 1 of 3 OK created sql view model raw.order_delivery_metrics .................... [[32mCREATE VIEW[0m in 0.16s]
[0m06:20:52.923028 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.order_delivery_metrics
[0m06:20:52.925480 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.customer_performance
[0m06:20:52.926416 [info ] [Thread-3 (]: 2 of 3 START sql view model raw.customer_performance ........................... [RUN]
[0m06:20:52.927321 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_order_lines, now model.nexabrands_dbt.customer_performance)
[0m06:20:52.928098 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.customer_performance
[0m06:20:52.929392 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m06:20:52.941006 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.customer_performance"
[0m06:20:52.941691 [info ] [Thread-1 (]: 3 of 3 START sql incremental model raw.fct_order_fulfillment_lines ............. [RUN]
[0m06:20:52.942544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer_targets, now model.nexabrands_dbt.fct_order_fulfillment_lines)
[0m06:20:52.943259 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m06:20:52.950380 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.customer_performance
[0m06:20:52.964594 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.customer_performance"
[0m06:20:52.960585 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m06:20:52.966087 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m06:20:52.966680 [debug] [Thread-3 (]: On model.nexabrands_dbt.customer_performance: BEGIN
[0m06:20:52.967362 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:20:52.967954 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m06:20:52.983208 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m06:20:52.992287 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m06:20:53.003075 [debug] [Thread-3 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */

  create view "raw"."raw"."customer_performance__dbt_tmp"
    
    
  as (
    


WITH  __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
), delivery_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

customer_orders AS (
    SELECT * FROM __dbt__cte__stg_orders
),

customer_metrics AS (
    SELECT
        co.customer_id,
        COUNT(*) as total_orders,
        AVG(dm.is_on_time) as ontime_rate,
        AVG(dm.is_in_full) as infull_rate,
        AVG(dm.is_otif) as otif_rate
    FROM delivery_metrics dm
    JOIN customer_orders co ON dm.order_id = co.order_id
    GROUP BY co.customer_id
)

SELECT * FROM customer_metrics
  );
[0m06:20:53.012832 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m06:20:53.016774 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m06:20:53.024572 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m06:20:53.025080 [debug] [Thread-3 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
alter table "raw"."raw"."customer_performance__dbt_tmp" rename to "customer_performance"
[0m06:20:53.025955 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m06:20:53.026754 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: BEGIN
[0m06:20:53.027350 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:20:53.027899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:20:53.029694 [debug] [Thread-3 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m06:20:53.031260 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m06:20:53.032172 [debug] [Thread-3 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m06:20:53.034925 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m06:20:53.038541 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."customer_performance__dbt_backup"
[0m06:20:53.039042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m06:20:53.040303 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m06:20:53.041198 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m06:20:53.042436 [debug] [Thread-3 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
drop view if exists "raw"."raw"."customer_performance__dbt_backup" cascade
[0m06:20:53.043091 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */

      
  
    

  create  table "raw"."raw"."fct_order_fulfillment_lines"
  
  
    as
  
  (
    

WITH  __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
),  __dbt__cte__stg_customer_targets as (
-- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM  "raw"."raw"."customer_targets"

)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
), order_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

orders AS (
    SELECT * FROM __dbt__cte__stg_orders
),

customers AS (
    SELECT * FROM __dbt__cte__stg_customers
),

customer_targets AS (
    SELECT * FROM __dbt__cte__stg_customer_targets
)

SELECT
    om.order_id,
    om.product_id,
    o.customer_id,
    o.order_placement_date,
    om.agreed_delivery_date,
    om.actual_delivery_date,
    om.order_qty,
    om.delivery_qty,
    om.is_on_time as on_time,
    om.is_in_full as in_full,
    om.is_otif as otif,
    -- Add target comparisons
    ct.ontime_target_percentage,
    ct.infull_target_percentage,
    ct.otif_target_percentage,
    -- Add variance from targets
    (om.is_on_time * 100) - ct.ontime_target_percentage as ontime_variance,
    (om.is_in_full * 100) - ct.infull_target_percentage as infull_variance,
    (om.is_otif * 100) - ct.otif_target_percentage as otif_variance,
    current_timestamp() as last_updated_at

FROM order_metrics om
JOIN orders o ON om.order_id = o.order_id
JOIN customers c ON o.customer_id = c.customer_id
LEFT JOIN customer_targets ct ON c.customer_id = ct.customer_id


  );
  
  
[0m06:20:53.044655 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 93:     current_timestamp() as last_updated_at
                               ^

[0m06:20:53.048713 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: ROLLBACK
[0m06:20:53.050389 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: Close
[0m06:20:53.061038 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.017 seconds
[0m06:20:53.065323 [debug] [Thread-3 (]: On model.nexabrands_dbt.customer_performance: Close
[0m06:20:53.067257 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3d8065-86fd-44e8-94db-f3991274f649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a628c8cb90>]}
[0m06:20:53.071479 [info ] [Thread-3 (]: 2 of 3 OK created sql view model raw.customer_performance ...................... [[32mCREATE VIEW[0m in 0.14s]
[0m06:20:53.074200 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.customer_performance
[0m06:20:53.087364 [debug] [Thread-1 (]: Database Error in model fct_order_fulfillment_lines (models/marts/fct_order_fulfillment_lines.sql)
  syntax error at or near ")"
  LINE 93:     current_timestamp() as last_updated_at
                                 ^
  compiled code at target/run/nexabrands_dbt/models/marts/fct_order_fulfillment_lines.sql
[0m06:20:53.088293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3d8065-86fd-44e8-94db-f3991274f649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a628c67470>]}
[0m06:20:53.089490 [error] [Thread-1 (]: 3 of 3 ERROR creating sql incremental model raw.fct_order_fulfillment_lines .... [[31mERROR[0m in 0.15s]
[0m06:20:53.093407 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m06:20:53.094596 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.fct_order_fulfillment_lines' to be skipped because of status 'error'.  Reason: Database Error in model fct_order_fulfillment_lines (models/marts/fct_order_fulfillment_lines.sql)
  syntax error at or near ")"
  LINE 93:     current_timestamp() as last_updated_at
                                 ^
  compiled code at target/run/nexabrands_dbt/models/marts/fct_order_fulfillment_lines.sql.
[0m06:20:53.099085 [debug] [MainThread]: Using postgres connection "master"
[0m06:20:53.099813 [debug] [MainThread]: On master: BEGIN
[0m06:20:53.100548 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:20:53.106186 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:20:53.106958 [debug] [MainThread]: On master: COMMIT
[0m06:20:53.107699 [debug] [MainThread]: Using postgres connection "master"
[0m06:20:53.108440 [debug] [MainThread]: On master: COMMIT
[0m06:20:53.109312 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:20:53.110132 [debug] [MainThread]: On master: Close
[0m06:20:53.111334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:20:53.112380 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_products' was properly closed.
[0m06:20:53.113084 [debug] [MainThread]: Connection 'model.nexabrands_dbt.fct_order_fulfillment_lines' was properly closed.
[0m06:20:53.113751 [debug] [MainThread]: Connection 'model.nexabrands_dbt.customer_performance' was properly closed.
[0m06:20:53.114394 [debug] [MainThread]: Connection 'model.nexabrands_dbt.order_delivery_metrics' was properly closed.
[0m06:20:53.115518 [info ] [MainThread]: 
[0m06:20:53.116707 [info ] [MainThread]: Finished running 1 incremental model, 2 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m06:20:53.119148 [debug] [MainThread]: Command end result
[0m06:20:53.211543 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m06:20:53.213593 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m06:20:53.219738 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m06:20:53.220276 [info ] [MainThread]: 
[0m06:20:53.220959 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:20:53.221555 [info ] [MainThread]: 
[0m06:20:53.222216 [error] [MainThread]:   Database Error in model fct_order_fulfillment_lines (models/marts/fct_order_fulfillment_lines.sql)
  syntax error at or near ")"
  LINE 93:     current_timestamp() as last_updated_at
                                 ^
  compiled code at target/run/nexabrands_dbt/models/marts/fct_order_fulfillment_lines.sql
[0m06:20:53.222835 [info ] [MainThread]: 
[0m06:20:53.223490 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m06:20:53.224745 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3412337, "process_in_blocks": "480", "process_kernel_time": 0.301161, "process_mem_max_rss": "112600", "process_out_blocks": "1952", "process_user_time": 2.327157}
[0m06:20:53.225372 [debug] [MainThread]: Command `dbt run` failed at 06:20:53.225256 after 1.34 seconds
[0m06:20:53.225981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a62ed17530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a62ec524b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a62ec52030>]}
[0m06:20:53.226617 [debug] [MainThread]: Flushing usage events
[0m06:20:53.997644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:22:23.683337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906349c58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79063427b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790634333f20>]}


============================== 06:22:23.688481 | 35a19970-9a3b-4100-8373-d67d1e8b8010 ==============================
[0m06:22:23.688481 [info ] [MainThread]: Running with dbt=1.9.1
[0m06:22:23.689774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:22:23.868250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35a19970-9a3b-4100-8373-d67d1e8b8010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790636f3ba70>]}
[0m06:22:23.950228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35a19970-9a3b-4100-8373-d67d1e8b8010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790633b83bc0>]}
[0m06:22:23.951630 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:22:24.159094 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m06:22:24.259778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:22:24.260595 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/marts/fct_order_fulfillment_lines.sql
[0m06:22:24.544398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35a19970-9a3b-4100-8373-d67d1e8b8010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906317808f0>]}
[0m06:22:24.615626 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m06:22:24.618535 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m06:22:24.631216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35a19970-9a3b-4100-8373-d67d1e8b8010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906348e8830>]}
[0m06:22:24.631814 [info ] [MainThread]: Found 9 models, 6 sources, 431 macros
[0m06:22:24.632432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35a19970-9a3b-4100-8373-d67d1e8b8010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790632f3a750>]}
[0m06:22:24.634520 [info ] [MainThread]: 
[0m06:22:24.635102 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:22:24.635644 [info ] [MainThread]: 
[0m06:22:24.636423 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:22:24.641288 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m06:22:24.676064 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m06:22:24.676744 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:22:24.677364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:24.681711 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m06:22:24.683115 [debug] [ThreadPool]: On list_raw: Close
[0m06:22:24.685278 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m06:22:24.691862 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m06:22:24.692396 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m06:22:24.692871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:24.695887 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m06:22:24.696638 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m06:22:24.697414 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m06:22:24.700907 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.003 seconds
[0m06:22:24.703024 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m06:22:24.703818 [debug] [ThreadPool]: On list_raw_raw: Close
[0m06:22:24.711604 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:24.712107 [debug] [MainThread]: On master: BEGIN
[0m06:22:24.712616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:22:24.715597 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m06:22:24.716351 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:24.717272 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:22:24.735736 [debug] [MainThread]: SQL status: SELECT 12 in 0.018 seconds
[0m06:22:24.739307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35a19970-9a3b-4100-8373-d67d1e8b8010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906306e3e00>]}
[0m06:22:24.739897 [debug] [MainThread]: On master: ROLLBACK
[0m06:22:24.740493 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:24.740976 [debug] [MainThread]: On master: BEGIN
[0m06:22:24.741714 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:22:24.742468 [debug] [MainThread]: On master: COMMIT
[0m06:22:24.743201 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:24.743910 [debug] [MainThread]: On master: COMMIT
[0m06:22:24.744656 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:22:24.745130 [debug] [MainThread]: On master: Close
[0m06:22:24.747654 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m06:22:24.748474 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customers
[0m06:22:24.749005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m06:22:24.749661 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m06:22:24.752207 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_orders
[0m06:22:24.752772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customers)
[0m06:22:24.753352 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m06:22:24.754035 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order_lines'
[0m06:22:24.754685 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_orders'
[0m06:22:24.755246 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customers
[0m06:22:24.762588 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m06:22:24.763071 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m06:22:24.763633 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_orders
[0m06:22:24.766285 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customers"
[0m06:22:24.769153 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m06:22:24.771946 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_orders"
[0m06:22:24.772840 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m06:22:24.774111 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_orders
[0m06:22:24.775106 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m06:22:24.775718 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.stg_products
[0m06:22:24.776553 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customers
[0m06:22:24.777546 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.order_delivery_metrics
[0m06:22:24.778045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer_targets, now model.nexabrands_dbt.stg_products)
[0m06:22:24.778931 [info ] [Thread-4 (]: 1 of 3 START sql view model raw.order_delivery_metrics ......................... [RUN]
[0m06:22:24.779680 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.stg_products
[0m06:22:24.780401 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_orders, now model.nexabrands_dbt.order_delivery_metrics)
[0m06:22:24.783012 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_products"
[0m06:22:24.783679 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.order_delivery_metrics
[0m06:22:24.792826 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.order_delivery_metrics"
[0m06:22:24.793995 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.stg_products
[0m06:22:24.794777 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.order_delivery_metrics
[0m06:22:24.831225 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.order_delivery_metrics"
[0m06:22:24.832108 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m06:22:24.832707 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: BEGIN
[0m06:22:24.833234 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:22:24.837127 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m06:22:24.838574 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m06:22:24.839557 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */

  create view "raw"."raw"."order_delivery_metrics__dbt_tmp"
    
    
  as (
    

WITH  __dbt__cte__stg_order_lines as (
-- models/staging/stg_order_lines.sql
WITH order_lines AS (
    SELECT * FROM   "raw"."raw"."order_lines" 

)

SELECT
    order_id,
    product_id,
    order_qty,
    agreed_delivery_date,
    actual_delivery_date,
    delivery_qty 
   
FROM order_lines
), order_lines AS (
    SELECT * FROM __dbt__cte__stg_order_lines
),

delivery_metrics AS (
    SELECT
        order_id,
        product_id,
        order_qty,
        delivery_qty,
        agreed_delivery_date,
        actual_delivery_date,
        -- Calculating  delivery metrics
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date THEN 1 
            ELSE 0 
        END as is_on_time,
        CASE 
            WHEN delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_in_full,
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date 
            AND delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_otif
    FROM order_lines
)

SELECT * FROM delivery_metrics
  );
[0m06:22:24.843916 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:22:24.854327 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m06:22:24.854934 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics" rename to "order_delivery_metrics__dbt_backup"
[0m06:22:24.855776 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:22:24.858970 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m06:22:24.859526 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics__dbt_tmp" rename to "order_delivery_metrics"
[0m06:22:24.860375 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:22:24.879145 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m06:22:24.879746 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m06:22:24.880291 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m06:22:24.881802 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m06:22:24.890676 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."order_delivery_metrics__dbt_backup"
[0m06:22:24.896808 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m06:22:24.897378 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
drop view if exists "raw"."raw"."order_delivery_metrics__dbt_backup" cascade
[0m06:22:24.899269 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:22:24.901784 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: Close
[0m06:22:24.904136 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35a19970-9a3b-4100-8373-d67d1e8b8010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790634159910>]}
[0m06:22:24.905258 [info ] [Thread-4 (]: 1 of 3 OK created sql view model raw.order_delivery_metrics .................... [[32mCREATE VIEW[0m in 0.12s]
[0m06:22:24.906153 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.order_delivery_metrics
[0m06:22:24.907139 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.customer_performance
[0m06:22:24.907629 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m06:22:24.908283 [info ] [Thread-3 (]: 2 of 3 START sql view model raw.customer_performance ........................... [RUN]
[0m06:22:24.909602 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_order_lines, now model.nexabrands_dbt.customer_performance)
[0m06:22:24.909068 [info ] [Thread-2 (]: 3 of 3 START sql incremental model raw.fct_order_fulfillment_lines ............. [RUN]
[0m06:22:24.910309 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.customer_performance
[0m06:22:24.910990 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customers, now model.nexabrands_dbt.fct_order_fulfillment_lines)
[0m06:22:24.918962 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.customer_performance"
[0m06:22:24.919561 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m06:22:24.932054 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m06:22:24.932578 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.customer_performance
[0m06:22:24.937001 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.customer_performance"
[0m06:22:24.937487 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m06:22:24.943758 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m06:22:24.958755 [debug] [Thread-3 (]: On model.nexabrands_dbt.customer_performance: BEGIN
[0m06:22:24.969576 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:22:24.981567 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m06:22:24.983921 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m06:22:24.985664 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m06:22:24.986854 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m06:22:24.986240 [debug] [Thread-2 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: BEGIN
[0m06:22:24.987431 [debug] [Thread-3 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */

  create view "raw"."raw"."customer_performance__dbt_tmp"
    
    
  as (
    


WITH  __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
), delivery_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

customer_orders AS (
    SELECT * FROM __dbt__cte__stg_orders
),

customer_metrics AS (
    SELECT
        co.customer_id,
        COUNT(*) as total_orders,
        AVG(dm.is_on_time) as ontime_rate,
        AVG(dm.is_in_full) as infull_rate,
        AVG(dm.is_otif) as otif_rate
    FROM delivery_metrics dm
    JOIN customer_orders co ON dm.order_id = co.order_id
    GROUP BY co.customer_id
)

SELECT * FROM customer_metrics
  );
[0m06:22:24.988039 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:22:24.992251 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m06:22:24.995997 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m06:22:24.996944 [debug] [Thread-3 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
alter table "raw"."raw"."customer_performance__dbt_tmp" rename to "customer_performance"
[0m06:22:24.997849 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m06:22:24.999031 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m06:22:25.000965 [debug] [Thread-2 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */

      
  
    

  create  table "raw"."raw"."fct_order_fulfillment_lines"
  
  
    as
  
  (
    

WITH  __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
),  __dbt__cte__stg_customer_targets as (
-- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM  "raw"."raw"."customer_targets"

)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
), order_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

orders AS (
    SELECT * FROM __dbt__cte__stg_orders
),

customers AS (
    SELECT * FROM __dbt__cte__stg_customers
),

customer_targets AS (
    SELECT * FROM __dbt__cte__stg_customer_targets
)

SELECT
    om.order_id,
    om.product_id,
    o.customer_id,
    o.order_placement_date,
    om.agreed_delivery_date,
    om.actual_delivery_date,
    om.order_qty,
    om.delivery_qty,
    om.is_on_time as on_time,
    om.is_in_full as in_full,
    om.is_otif as otif,
    -- Add target comparisons
    ct.ontime_target_percentage,
    ct.infull_target_percentage,
    ct.otif_target_percentage,
    -- Add variance from targets
    (om.is_on_time * 100) - ct.ontime_target_percentage as ontime_variance,
    (om.is_in_full * 100) - ct.infull_target_percentage as infull_variance,
    (om.is_otif * 100) - ct.otif_target_percentage as otif_variance,
    current_timestamp as last_updated_at

FROM order_metrics om
JOIN orders o ON om.order_id = o.order_id
JOIN customers c ON o.customer_id = c.customer_id
LEFT JOIN customer_targets ct ON c.customer_id = ct.customer_id


  );
  
  
[0m06:22:24.999976 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:22:25.005628 [debug] [Thread-3 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m06:22:25.006541 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column ct.ontime_target_percentage does not exist
LINE 86:     ct.ontime_target_percentage,
             ^

[0m06:22:25.008232 [debug] [Thread-2 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: ROLLBACK
[0m06:22:25.009385 [debug] [Thread-2 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: Close
[0m06:22:25.018380 [debug] [Thread-2 (]: Database Error in model fct_order_fulfillment_lines (models/marts/fct_order_fulfillment_lines.sql)
  column ct.ontime_target_percentage does not exist
  LINE 86:     ct.ontime_target_percentage,
               ^
  compiled code at target/run/nexabrands_dbt/models/marts/fct_order_fulfillment_lines.sql
[0m06:22:25.019392 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35a19970-9a3b-4100-8373-d67d1e8b8010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790630653a40>]}
[0m06:22:25.020631 [error] [Thread-2 (]: 3 of 3 ERROR creating sql incremental model raw.fct_order_fulfillment_lines .... [[31mERROR[0m in 0.11s]
[0m06:22:25.021864 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m06:22:25.022961 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.fct_order_fulfillment_lines' to be skipped because of status 'error'.  Reason: Database Error in model fct_order_fulfillment_lines (models/marts/fct_order_fulfillment_lines.sql)
  column ct.ontime_target_percentage does not exist
  LINE 86:     ct.ontime_target_percentage,
               ^
  compiled code at target/run/nexabrands_dbt/models/marts/fct_order_fulfillment_lines.sql.
[0m06:22:25.007326 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m06:22:25.025186 [debug] [Thread-3 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m06:22:25.057961 [debug] [Thread-3 (]: SQL status: COMMIT in 0.031 seconds
[0m06:22:25.062701 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."customer_performance__dbt_backup"
[0m06:22:25.072306 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m06:22:25.073181 [debug] [Thread-3 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
drop view if exists "raw"."raw"."customer_performance__dbt_backup" cascade
[0m06:22:25.076536 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:22:25.085171 [debug] [Thread-3 (]: On model.nexabrands_dbt.customer_performance: Close
[0m06:22:25.097863 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35a19970-9a3b-4100-8373-d67d1e8b8010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7906305b5a90>]}
[0m06:22:25.105642 [info ] [Thread-3 (]: 2 of 3 OK created sql view model raw.customer_performance ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:22:25.109617 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.customer_performance
[0m06:22:25.112060 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:25.113167 [debug] [MainThread]: On master: BEGIN
[0m06:22:25.114000 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:22:25.120116 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m06:22:25.120937 [debug] [MainThread]: On master: COMMIT
[0m06:22:25.121517 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:25.121998 [debug] [MainThread]: On master: COMMIT
[0m06:22:25.122805 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:22:25.123323 [debug] [MainThread]: On master: Close
[0m06:22:25.124632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:22:25.125283 [debug] [MainThread]: Connection 'model.nexabrands_dbt.fct_order_fulfillment_lines' was properly closed.
[0m06:22:25.125881 [debug] [MainThread]: Connection 'model.nexabrands_dbt.stg_products' was properly closed.
[0m06:22:25.126460 [debug] [MainThread]: Connection 'model.nexabrands_dbt.customer_performance' was properly closed.
[0m06:22:25.127113 [debug] [MainThread]: Connection 'model.nexabrands_dbt.order_delivery_metrics' was properly closed.
[0m06:22:25.127696 [info ] [MainThread]: 
[0m06:22:25.128345 [info ] [MainThread]: Finished running 1 incremental model, 2 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m06:22:25.129576 [debug] [MainThread]: Command end result
[0m06:22:25.155498 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m06:22:25.157247 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m06:22:25.163927 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m06:22:25.164460 [info ] [MainThread]: 
[0m06:22:25.165087 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:22:25.165646 [info ] [MainThread]: 
[0m06:22:25.166292 [error] [MainThread]:   Database Error in model fct_order_fulfillment_lines (models/marts/fct_order_fulfillment_lines.sql)
  column ct.ontime_target_percentage does not exist
  LINE 86:     ct.ontime_target_percentage,
               ^
  compiled code at target/run/nexabrands_dbt/models/marts/fct_order_fulfillment_lines.sql
[0m06:22:25.166845 [info ] [MainThread]: 
[0m06:22:25.167456 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m06:22:25.168668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5685071, "process_in_blocks": "0", "process_kernel_time": 0.302345, "process_mem_max_rss": "115788", "process_out_blocks": "2832", "process_user_time": 2.571899}
[0m06:22:25.169292 [debug] [MainThread]: Command `dbt run` failed at 06:22:25.169157 after 1.57 seconds
[0m06:22:25.169856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79063384b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x790635425be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79063418c680>]}
[0m06:22:25.170505 [debug] [MainThread]: Flushing usage events
[0m06:22:26.082915 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:26:07.903464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e86a97e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e86a97aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e88495cd0>]}


============================== 06:26:07.906894 | a59f1c10-612b-4383-989c-83e9115156cb ==============================
[0m06:26:07.906894 [info ] [MainThread]: Running with dbt=1.9.1
[0m06:26:07.907790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:26:08.083897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a59f1c10-612b-4383-989c-83e9115156cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e865bbc80>]}
[0m06:26:08.146833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a59f1c10-612b-4383-989c-83e9115156cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e864898e0>]}
[0m06:26:08.147817 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m06:26:08.277347 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m06:26:08.379630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:26:08.380441 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/marts/fct_order_fulfillment_lines.sql
[0m06:26:08.656991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a59f1c10-612b-4383-989c-83e9115156cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e8490d5e0>]}
[0m06:26:08.727449 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m06:26:08.730390 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m06:26:08.743028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a59f1c10-612b-4383-989c-83e9115156cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e84541a00>]}
[0m06:26:08.743631 [info ] [MainThread]: Found 9 models, 6 sources, 431 macros
[0m06:26:08.744206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a59f1c10-612b-4383-989c-83e9115156cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775e84550fb0>]}
[0m06:26:08.746331 [info ] [MainThread]: 
[0m06:26:08.746893 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:26:08.747439 [info ] [MainThread]: 
[0m06:26:08.748189 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:26:08.753001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m06:26:08.787450 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m06:26:08.788008 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:26:08.788570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:26:08.792877 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m06:26:08.794234 [debug] [ThreadPool]: On list_raw: Close
[0m06:26:08.796253 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m06:26:08.802636 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m06:26:08.803166 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m06:26:08.803695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:26:08.806661 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m06:26:08.807449 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m06:26:08.808280 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m06:26:08.811723 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.003 seconds
[0m06:26:08.813846 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m06:26:08.814783 [debug] [ThreadPool]: On list_raw_raw: Close
[0m06:26:08.822367 [debug] [MainThread]: Using postgres connection "master"
[0m06:26:08.822902 [debug] [MainThread]: On master: BEGIN
[0m06:26:08.823394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:26:08.826424 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m06:26:08.827203 [debug] [MainThread]: Using postgres connection "master"
[0m06:26:08.828167 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
      