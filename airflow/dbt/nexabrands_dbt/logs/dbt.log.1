[0m08:44:09.602218 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */


       insert into "raw"."elementary"."elementary_test_results"
         (id,data_issue_id,test_execution_id,test_unique_id,model_unique_id,invocation_id,detected_at,created_at,database_name,schema_name,table_name,column_name,test_type,test_sub_type,test_results_description,owners,tags,test_results_query,other,test_name,test_params,severity,status,failures,test_short_name,test_alias,result_rows,failed_row_count) values
    ('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630','model.nexabrands_dbt.stg_order_fulfillment','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','in_full','dbt_test','generic',NULL,'[]','[]','



with all_values as (

    select
        in_full as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by in_full

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',NULL,'accepted_values_stg_order_fulfillment_in_full__True__0__1','{"values": [0, 1], "quote": true, "column_name": "in_full", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'accepted_values','accepted_values_stg_order_fulfillment_in_full__True__0__1',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73','model.nexabrands_dbt.stg_order_fulfillment','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','ontime_in_full','dbt_test','generic',NULL,'[]','[]','



with all_values as (

    select
        ontime_in_full as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by ontime_in_full

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',NULL,'accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1','{"values": [0, 1], "quote": true, "column_name": "ontime_in_full", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'accepted_values','accepted_values_stg_order_fulf_04ff2bb97b4eb37802ca1fb38147b18b',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95','model.nexabrands_dbt.stg_order_fulfillment','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','on_time','dbt_test','generic',NULL,'[]','[]','



with all_values as (

    select
        on_time as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by on_time

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',NULL,'accepted_values_stg_order_fulfillment_on_time__True__0__1','{"values": [0, 1], "quote": true, "column_name": "on_time", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'accepted_values','accepted_values_stg_order_fulfillment_on_time__True__0__1',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e','test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e','model.nexabrands_dbt.stg_customers','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','city','dbt_test','generic',NULL,'[]','[]','



with all_values as (

    select
        city as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_customers"
    group by city

)

select *
from all_values
where value_field not in (
    ''Klerksdorp'',''Polokwane'',''Stellenbosch'',''Paarl'',''East London'',''Grahamstown'',''George'',''Upington'',''Bloemfontein'',''Worcester'',''Pietermaritzburg'',''Pretoria'',''Nelspruit'',''Kimberley'',''Johannesburg'',''Cape Town''
)


',NULL,'accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town','{"values": ["Klerksdorp", "Polokwane", "Stellenbosch", "Paarl", "East London", "Grahamstown", "George", "Upington", "Bloemfontein", "Worcester", "Pietermaritzburg", "Pretoria", "Nelspruit", "Kimberley", "Johannesburg", "Cape Town"], "quote": true, "column_name": "city", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'accepted_values','accepted_values_stg_customers_a11ae74a9713a9aa51bccac4422d6868',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc','test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc','model.nexabrands_dbt.stg_customer_targets','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets',NULL,'dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select



  ontime_target >= otif_target as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True','{"column_A": "ontime_target", "column_B": "otif_target", "or_equal": true, "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'expect_column_pair_values_A_to_be_greater_than_B','dbt_expectations_expect_column_5118ea56378d56fb0cad08c9d352485a',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575','test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575','model.nexabrands_dbt.stg_products','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','category','dbt_test','generic',NULL,'[]','[]','



with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_products"
    group by category

)

select *
from all_values
where value_field not in (
    ''Dairy'',''beverages'',''Food''
)


',NULL,'accepted_values_stg_products_category__Dairy__beverages__Food','{"values": ["Dairy", "beverages", "Food"], "column_name": "category", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'accepted_values','accepted_values_stg_products_category__Dairy__beverages__Food',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182','model.nexabrands_dbt.stg_customers','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','city','dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select




( 1=1 and length(
        city
    ) >= 2 and length(
        city
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',NULL,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2','{"min_value": 2, "max_value": 50, "column_name": "city", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'expect_column_value_lengths_to_be_between','dbt_expectations_expect_column_403f18a3c9e0d04c6b9349a550b7eb3f',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478','test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478','model.nexabrands_dbt.stg_customer_targets','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets',NULL,'dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select



  infull_target >= otif_target as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True','{"column_A": "infull_target", "column_B": "otif_target", "or_equal": true, "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'expect_column_pair_values_A_to_be_greater_than_B','dbt_expectations_expect_column_9b169ad9eac85f6a49ea6c376dd6e4ec',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf','model.nexabrands_dbt.stg_customers','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','customer_name','dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select




( 1=1 and length(
        customer_name
    ) >= 2 and length(
        customer_name
    ) <= 100
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',NULL,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2','{"min_value": 2, "max_value": 100, "column_name": "customer_name", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'expect_column_value_lengths_to_be_between','dbt_expectations_expect_column_b21fb3cea116e61a8bcc4c1962a96616',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012','model.nexabrands_dbt.stg_orders','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders','customer_id','dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select




( 1=1 and length(
        customer_id
    ) >= 1 and length(
        customer_id
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',NULL,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1','{"min_value": 1, "max_value": 50, "column_name": "customer_id", "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'expect_column_value_lengths_to_be_between','dbt_expectations_expect_column_0dc13966be4c7aca951937ba4bb76c9a',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db','model.nexabrands_dbt.stg_orders','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders','order_id','dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select




( 1=1 and length(
        order_id
    ) >= 1 and length(
        order_id
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',NULL,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1','{"min_value": 1, "max_value": 50, "column_name": "order_id", "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'expect_column_value_lengths_to_be_between','dbt_expectations_expect_column_24d6f8b120f055b64ef4ed7ed3d53acb',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2','model.nexabrands_dbt.stg_products','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','category','dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select




( 1=1 and length(
        category
    ) >= 2 and length(
        category
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',NULL,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2','{"min_value": 2, "max_value": 50, "column_name": "category", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_column_value_lengths_to_be_between','dbt_expectations_expect_column_c8b2251fe2fa0c3fec399bb3cfce08e7',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710','model.nexabrands_dbt.stg_products','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','product_name','dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select




( 1=1 and length(
        product_name
    ) >= 1 and length(
        product_name
    ) <= 100
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',NULL,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1','{"min_value": 1, "max_value": 100, "column_name": "product_name", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_column_value_lengths_to_be_between','dbt_expectations_expect_column_28b9f971af35df2e1c062af316d4438b',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63','model.nexabrands_dbt.stg_dates','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_dates','date','dbt_test','expectation',NULL,'[]','[]','




    with grouped_expression as (
    select





    length(
        date
    ) = 10 as expression


    from "raw"."staging"."stg_dates"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10','{"value": 10, "column_name": "date", "model": "{{ get_where_subquery(ref(''stg_dates'')) }}"}','warn','pass',0,'expect_column_value_lengths_to_equal','dbt_expectations_expect_column_2e1f04256a3bdef6d9e60546966ce694',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5','model.nexabrands_dbt.stg_customer_targets','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','infull_target','dbt_test','expectation',NULL,'[]','[]','






    with grouped_expression as (
    select




( 1=1 and infull_target >= 0 and infull_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',NULL,'dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0','{"min_value": 0, "max_value": 100, "column_name": "infull_target", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'expect_column_values_to_be_between','dbt_expectations_expect_column_92ed44125b24680cf5fd53215584233f',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6','model.nexabrands_dbt.stg_customer_targets','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','ontime_target','dbt_test','expectation',NULL,'[]','[]','






    with grouped_expression as (
    select




( 1=1 and ontime_target >= 0 and ontime_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',NULL,'dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0','{"min_value": 0, "max_value": 100, "column_name": "ontime_target", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'expect_column_values_to_be_between','dbt_expectations_expect_column_c37238951ff6a9df0fa361701d957c06',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69','model.nexabrands_dbt.stg_customer_targets','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','otif_target','dbt_test','expectation',NULL,'[]','[]','






    with grouped_expression as (
    select




( 1=1 and otif_target >= 0 and otif_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',NULL,'dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0','{"min_value": 0, "max_value": 100, "column_name": "otif_target", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'expect_column_values_to_be_between','dbt_expectations_expect_column_7e0fb491e8e984b8096010a9ad4ef898',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed','model.nexabrands_dbt.stg_products','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','product_id','dbt_test','expectation',NULL,'[]','[]','






    with grouped_expression as (
    select




( 1=1 and product_id > 1
)
 as expression


    from "raw"."staging"."stg_products"
    where
        product_id IS NOT NULL



),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',NULL,'dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True','{"min_value": 1, "row_condition": "product_id IS NOT NULL", "strictly": true, "column_name": "product_id", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_column_values_to_be_between','dbt_expectations_expect_column_13b0887fde6ea84df52530caacf44573',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386','model.nexabrands_dbt.stg_orders','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders','order_placement_date','dbt_test','expectation',NULL,'[]','[]','






    with grouped_expression as (
    select




( 1=1 and order_placement_date >= ''2024-01-01'' and order_placement_date <= current_date
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',NULL,'dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_','{"min_value": "''2024-01-01''", "max_value": "current_date", "column_name": "order_placement_date", "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'expect_column_values_to_be_between','dbt_expectations_expect_column_409d93b693cbb12b199565006e77047a',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10','model.nexabrands_dbt.stg_products','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','category','dbt_test','expectation',NULL,'[]','[]','

with all_values as (

    select
        category as value_field

    from "raw"."staging"."stg_products"


),
set_values as (

    select
        cast(''Dairy'' as TEXT) as value_field
    union all
    select
        cast(''beverages'' as TEXT) as value_field
    union all
    select
        cast(''Food'' as TEXT) as value_field


),
validation_errors as (
    -- values from the model that are not in the set
    select
        v.value_field
    from
        all_values v
        left join
        set_values s on v.value_field = s.value_field
    where
        s.value_field is null

)

select *
from validation_errors

',NULL,'dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food','{"value_set": ["Dairy", "beverages", "Food"], "column_name": "category", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_column_values_to_be_in_set','dbt_expectations_expect_column_e007770c70acc1cacd84b4bc32225097',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39','model.nexabrands_dbt.stg_customers','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','city','dbt_test','expectation',NULL,'[]','[]','




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(city, ''^[A-Za-z\s\-\.]+$'', '''')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_','{"regex": "^[A-Za-z\\s\\-\\.]+$", "column_name": "city", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'expect_column_values_to_match_regex','dbt_expectations_expect_column_37daf38b3f95e5561c473a8d803a9133',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0','model.nexabrands_dbt.stg_orders','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders','order_placement_date','dbt_test','expectation',NULL,'[]','[]','with relation_columns as (


        select
            cast(''ORDER_ID'' as TEXT) as relation_column,
            cast(''TEXT'' as TEXT) as relation_column_type
        union all

        select
            cast(''CUSTOMER_ID'' as TEXT) as relation_column,
            cast(''TEXT'' as TEXT) as relation_column_type
        union all

        select
            cast(''ORDER_PLACEMENT_DATE'' as TEXT) as relation_column,
            cast(''DATE'' as TEXT) as relation_column_type


    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = ''ORDER_PLACEMENT_DATE''
            and
            relation_column_type not in (''DATE'')

    )
    select *
    from test_data',NULL,'dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date','{"column_type": "date", "column_name": "order_placement_date", "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'expect_column_values_to_be_of_type','dbt_expectations_expect_column_3eed0db1b7cb49ee8c04627bc30b4059',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828','model.nexabrands_dbt.stg_customers','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','customer_name','dbt_test','expectation',NULL,'[]','[]','




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(customer_name, ''^[A-Za-z0-9\s\-\.]+$'', '''')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_','{"regex": "^[A-Za-z0-9\\s\\-\\.]+$", "column_name": "customer_name", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'expect_column_values_to_match_regex','dbt_expectations_expect_column_49aa95aecd296f28018254cac402e9da',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86','model.nexabrands_dbt.stg_order_fulfillment','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','order_id','dbt_test','expectation',NULL,'[]','[]','




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(order_id, ''^[A-Za-z0-9\-_]+$'', '''')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_order_fulfillment"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___','{"regex": "^[A-Za-z0-9\\-_]+$", "column_name": "order_id", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'expect_column_values_to_match_regex','dbt_expectations_expect_column_f3be49ab72b7b434af26d1e21a87faef',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908','model.nexabrands_dbt.stg_products','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','product_name','dbt_test','expectation',NULL,'[]','[]','




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(product_name, ''^\\s*$'', '''')), 1), 0)


 = 0
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_','{"regex": "^\\\\s*$", "column_name": "product_name", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_column_values_to_not_match_regex','dbt_expectations_expect_column_cdb611b836b2688162293f0a40d06eeb',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419','test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419','model.nexabrands_dbt.stg_products','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products',NULL,'dbt_test','expectation',NULL,'[]','[]','



with validation_errors as (

    select
        product_name,category,
        count(*) as "n_records"
    from "raw"."staging"."stg_products"
    where
        1=1
        and
    not (
        product_name is null and
        category is null

    )



    group by
        product_name,category
    having count(*) > 1

)
select * from validation_errors
',NULL,'dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category','{"column_list": ["product_name", "category"], "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_compound_columns_to_be_unique','dbt_expectations_expect_compou_3e423aa6dd2c92095dc7c3d71b929a00',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404','model.nexabrands_dbt.stg_orders','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders',NULL,'dbt_test','expectation',NULL,'[]','[]','with relation_columns as (


        select
            1 as relation_column_idx,
            cast(''ORDER_ID'' as TEXT) as relation_column
        union all

        select
            2 as relation_column_idx,
            cast(''CUSTOMER_ID'' as TEXT) as relation_column
        union all

        select
            3 as relation_column_idx,
            cast(''ORDER_PLACEMENT_DATE'' as TEXT) as relation_column


    ),
    input_columns as (


        select
            1 as input_column_idx,
            cast(''ORDER_ID'' as TEXT) as input_column
        union all

        select
            2 as input_column_idx,
            cast(''CUSTOMER_ID'' as TEXT) as input_column
        union all

        select
            3 as input_column_idx,
            cast(''ORDER_PLACEMENT_DATE'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx
    where
        -- catch any column in input list that is not in the sequence of table columns
        -- or any table column that is not in the input sequence
        r.relation_column is null or
        i.input_column is null',NULL,'dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date','{"column_list": ["order_id", "customer_id", "order_placement_date"], "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'expect_table_columns_to_match_ordered_list','dbt_expectations_expect_table__90495e7a5a0a4bba36425a1a78f198be',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a','test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a','model.nexabrands_dbt.stg_orders','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders',NULL,'dbt_test','expectation',NULL,'[]','[]','



with validation_errors as (

    select
        customer_id,order_placement_date,order_id,
        count(*) as "n_records"
    from "raw"."staging"."stg_orders"
    where
        1=1
        and
    not (
        customer_id is null and
        order_placement_date is null and
        order_id is null

    )



    group by
        customer_id,order_placement_date,order_id
    having count(*) > 1

)
select * from validation_errors
',NULL,'dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id','{"column_list": ["customer_id", "order_placement_date", "order_id"], "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'expect_compound_columns_to_be_unique','dbt_expectations_expect_compou_cc2740621c79336532fe5b448e893219',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602','model.nexabrands_dbt.stg_products','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products',NULL,'dbt_test','expectation',NULL,'[]','[]','with relation_columns as (


        select
            1 as relation_column_idx,
            cast(''PRODUCT_ID'' as TEXT) as relation_column
        union all

        select
            2 as relation_column_idx,
            cast(''PRODUCT_NAME'' as TEXT) as relation_column
        union all

        select
            3 as relation_column_idx,
            cast(''CATEGORY'' as TEXT) as relation_column


    ),
    input_columns as (


        select
            1 as input_column_idx,
            cast(''PRODUCT_ID'' as TEXT) as input_column
        union all

        select
            2 as input_column_idx,
            cast(''PRODUCT_NAME'' as TEXT) as input_column
        union all

        select
            3 as input_column_idx,
            cast(''CATEGORY'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx
    where
        -- catch any column in input list that is not in the sequence of table columns
        -- or any table column that is not in the input sequence
        r.relation_column is null or
        i.input_column is null',NULL,'dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category','{"column_list": ["product_id", "product_name", "category"], "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_table_columns_to_match_ordered_list','dbt_expectations_expect_table__f7fdf9cc34bf79cb7f9015811d9e5b7c',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d','model.nexabrands_dbt.stg_customers','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers',NULL,'dbt_test','expectation',NULL,'[]','[]','with relation_columns as (


        select cast(''CUSTOMER_ID'' as TEXT) as relation_column
        union all

        select cast(''CUSTOMER_NAME'' as TEXT) as relation_column
        union all

        select cast(''CITY'' as TEXT) as relation_column


    ),
    input_columns as (


        select cast(''CUSTOMER_ID'' as TEXT) as input_column
        union all

        select cast(''CUSTOMER_NAME'' as TEXT) as input_column
        union all

        select cast(''CITY'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null',NULL,'dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city','{"column_list": ["customer_id", "customer_name", "city"], "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'expect_table_columns_to_match_set','dbt_expectations_expect_table__c671e6c8880679154e0c08b03b908b76',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06','model.nexabrands_dbt.stg_dates','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_dates',NULL,'dbt_test','expectation',NULL,'[]','[]','with relation_columns as (


        select cast(''DATE'' as TEXT) as relation_column


    ),
    input_columns as (


        select cast(''DATE'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null',NULL,'dbt_expectations_expect_table_columns_to_match_set_stg_dates_date','{"column_list": ["date"], "model": "{{ get_where_subquery(ref(''stg_dates'')) }}"}','warn','pass',0,'expect_table_columns_to_match_set','dbt_expectations_expect_table__7a72d20b0feff6046903efc48c05244a',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185','model.nexabrands_dbt.stg_order_fulfillment','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment',NULL,'dbt_test','expectation',NULL,'[]','[]','with relation_columns as (


        select cast(''ORDER_ID'' as TEXT) as relation_column
        union all

        select cast(''ON_TIME'' as TEXT) as relation_column
        union all

        select cast(''IN_FULL'' as TEXT) as relation_column
        union all

        select cast(''ONTIME_IN_FULL'' as TEXT) as relation_column


    ),
    input_columns as (


        select cast(''ORDER_ID'' as TEXT) as input_column
        union all

        select cast(''ON_TIME'' as TEXT) as input_column
        union all

        select cast(''IN_FULL'' as TEXT) as input_column
        union all

        select cast(''ONTIME_IN_FULL'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null',NULL,'dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full','{"column_list": ["order_id", "on_time", "in_full", "ontime_in_full"], "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'expect_table_columns_to_match_set','dbt_expectations_expect_table__a9b6ee92f6a580f2bedcd5ac7a609c6e',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc','model.nexabrands_dbt.stg_customers','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers',NULL,'dbt_test','expectation',NULL,'[]','[]','



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 40
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',NULL,'dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1','{"min_value": 1, "max_value": 40, "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'expect_table_row_count_to_be_between','dbt_expectations_expect_table__5a69b43933dcbf22ebff9eb25f9435b0',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a','model.nexabrands_dbt.stg_dates','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_dates',NULL,'dbt_test','expectation',NULL,'[]','[]','



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1
)
 as expression


    from "raw"."staging"."stg_dates"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',NULL,'dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1','{"min_value": 1, "model": "{{ get_where_subquery(ref(''stg_dates'')) }}"}','warn','pass',0,'expect_table_row_count_to_be_between','dbt_expectations_expect_table__2b508938b40be8d3bba14b6d451c1f36',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212','model.nexabrands_dbt.stg_order_fulfillment','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment',NULL,'dbt_test','expectation',NULL,'[]','[]','



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1
)
 as expression


    from "raw"."staging"."stg_order_fulfillment"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',NULL,'dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1','{"min_value": 1, "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'expect_table_row_count_to_be_between','dbt_expectations_expect_table__e1bf090b95002c3ef95b01b652a78e66',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191','model.nexabrands_dbt.stg_products','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products',NULL,'dbt_test','expectation',NULL,'[]','[]','



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 100
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',NULL,'dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1','{"min_value": 1, "max_value": 100, "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_table_row_count_to_be_between','dbt_expectations_expect_table__df878d5d68d5c994b7f7b419d288917e',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241','test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241','model.nexabrands_dbt.stg_customer_targets','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','customer_id','dbt_test','generic',NULL,'[]','[]','





select customer_id
from "raw"."staging"."stg_customer_targets"
where customer_id is null


',NULL,'not_null_stg_customer_targets_customer_id','{"column_name": "customer_id", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'not_null','not_null_stg_customer_targets_customer_id',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3','model.nexabrands_dbt.stg_orders','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders',NULL,'dbt_test','expectation',NULL,'[]','[]','



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 10000000
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',NULL,'dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1','{"min_value": 1, "max_value": 10000000, "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'expect_table_row_count_to_be_between','dbt_expectations_expect_table__6c04b1a1efe7977e3189026354d032ef',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728','test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728','model.nexabrands_dbt.stg_customer_targets','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','infull_target','dbt_test','generic',NULL,'[]','[]','





select infull_target
from "raw"."staging"."stg_customer_targets"
where infull_target is null


',NULL,'not_null_stg_customer_targets_infull_target','{"column_name": "infull_target", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'not_null','not_null_stg_customer_targets_infull_target',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108','test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108','model.nexabrands_dbt.stg_customer_targets','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','ontime_target','dbt_test','generic',NULL,'[]','[]','





select ontime_target
from "raw"."staging"."stg_customer_targets"
where ontime_target is null


',NULL,'not_null_stg_customer_targets_ontime_target','{"column_name": "ontime_target", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'not_null','not_null_stg_customer_targets_ontime_target',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8','test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8','model.nexabrands_dbt.stg_customers','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','city','dbt_test','generic',NULL,'[]','[]','





select city
from "raw"."staging"."stg_customers"
where city is null


',NULL,'not_null_stg_customers_city','{"column_name": "city", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'not_null','not_null_stg_customers_city',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a','test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a','model.nexabrands_dbt.stg_customer_targets','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','otif_target','dbt_test','generic',NULL,'[]','[]','





select otif_target
from "raw"."staging"."stg_customer_targets"
where otif_target is null


',NULL,'not_null_stg_customer_targets_otif_target','{"column_name": "otif_target", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'not_null','not_null_stg_customer_targets_otif_target',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa','test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa','model.nexabrands_dbt.stg_customers','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','customer_id','dbt_test','generic',NULL,'[]','[]','





select customer_id
from "raw"."staging"."stg_customers"
where customer_id is null


',NULL,'not_null_stg_customers_customer_id','{"column_name": "customer_id", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'not_null','not_null_stg_customers_customer_id',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60','test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60','model.nexabrands_dbt.stg_customers','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','customer_name','dbt_test','generic',NULL,'[]','[]','





select customer_name
from "raw"."staging"."stg_customers"
where customer_name is null


',NULL,'not_null_stg_customers_customer_name','{"column_name": "customer_name", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'not_null','not_null_stg_customers_customer_name',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd','test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd','model.nexabrands_dbt.stg_dates','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_dates','date','dbt_test','generic',NULL,'[]','[]','





select date
from "raw"."staging"."stg_dates"
where date is null


',NULL,'not_null_stg_dates_date','{"column_name": "date", "model": "{{ get_where_subquery(ref(''stg_dates'')) }}"}','warn','pass',0,'not_null','not_null_stg_dates_date',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8','test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8','model.nexabrands_dbt.stg_order_fulfillment','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','in_full','dbt_test','generic',NULL,'[]','[]','





select in_full
from "raw"."staging"."stg_order_fulfillment"
where in_full is null


',NULL,'not_null_stg_order_fulfillment_in_full','{"column_name": "in_full", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'not_null','not_null_stg_order_fulfillment_in_full',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996','test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996','model.nexabrands_dbt.stg_order_fulfillment','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','on_time','dbt_test','generic',NULL,'[]','[]','





select on_time
from "raw"."staging"."stg_order_fulfillment"
where on_time is null


',NULL,'not_null_stg_order_fulfillment_on_time','{"column_name": "on_time", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'not_null','not_null_stg_order_fulfillment_on_time',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a','test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a','model.nexabrands_dbt.stg_order_fulfillment','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','ontime_in_full','dbt_test','generic',NULL,'[]','[]','





select ontime_in_full
from "raw"."staging"."stg_order_fulfillment"
where ontime_in_full is null


',NULL,'not_null_stg_order_fulfillment_ontime_in_full','{"column_name": "ontime_in_full", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'not_null','not_null_stg_order_fulfillment_ontime_in_full',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5','test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5','model.nexabrands_dbt.stg_orders','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders','customer_id','dbt_test','generic',NULL,'[]','[]','





select customer_id
from "raw"."staging"."stg_orders"
where customer_id is null


',NULL,'not_null_stg_orders_customer_id','{"column_name": "customer_id", "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'not_null','not_null_stg_orders_customer_id',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8','test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8','model.nexabrands_dbt.stg_orders','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders','order_placement_date','dbt_test','generic',NULL,'[]','[]','





select order_placement_date
from "raw"."staging"."stg_orders"
where order_placement_date is null


',NULL,'not_null_stg_orders_order_placement_date','{"column_name": "order_placement_date", "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'not_null','not_null_stg_orders_order_placement_date',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1','test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1','model.nexabrands_dbt.stg_products','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','category','dbt_test','generic',NULL,'[]','[]','





select category
from "raw"."staging"."stg_products"
where category is null


',NULL,'not_null_stg_products_category','{"column_name": "category", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_products_category',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939','test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939','model.nexabrands_dbt.stg_products','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','product_name','dbt_test','generic',NULL,'[]','[]','





select product_name
from "raw"."staging"."stg_products"
where product_name is null


',NULL,'not_null_stg_products_product_name','{"column_name": "product_name", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'not_null','not_null_stg_products_product_name',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3','test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3','model.nexabrands_dbt.stg_products','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','product_id','dbt_test','generic',NULL,'[]','[]','





select product_id
from "raw"."staging"."stg_products"
where product_id is null


',NULL,'not_null_stg_products_product_id','{"column_name": "product_id", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_products_product_id',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63','test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63','model.nexabrands_dbt.stg_order_fulfillment','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','order_id','dbt_test','generic',NULL,'[]','[]','

WITH validation AS (
	SELECT
		order_id AS primary_key,
		COUNT(1) AS occurrences

	FROM "raw"."staging"."stg_order_fulfillment"
	GROUP BY 1
)

SELECT *

FROM validation
WHERE primary_key IS NULL
	OR occurrences > 1

',NULL,'primary_key_stg_order_fulfillment_order_id','{"column_name": "order_id", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','error','pass',0,'primary_key','primary_key_stg_order_fulfillment_order_id',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9','test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9','model.nexabrands_dbt.stg_customer_targets','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','customer_id','dbt_test','generic',NULL,'[]','[]','



select
    customer_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_customer_targets"
where customer_id is not null
group by customer_id
having count(*) > 1


',NULL,'unique_stg_customer_targets_customer_id','{"column_name": "customer_id", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'unique','unique_stg_customer_targets_customer_id',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6','test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6','model.nexabrands_dbt.stg_orders','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders','order_id','dbt_test','generic',NULL,'[]','[]','

WITH validation AS (
	SELECT
		order_id AS primary_key,
		COUNT(1) AS occurrences

	FROM "raw"."staging"."stg_orders"
	GROUP BY 1
)

SELECT *

FROM validation
WHERE primary_key IS NULL
	OR occurrences > 1

',NULL,'primary_key_stg_orders_order_id','{"column_name": "order_id", "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','error','pass',0,'primary_key','primary_key_stg_orders_order_id',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada','test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada','model.nexabrands_dbt.stg_customers','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','customer_id','dbt_test','generic',NULL,'[]','[]','



select
    customer_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1


',NULL,'unique_stg_customers_customer_id','{"column_name": "customer_id", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'unique','unique_stg_customers_customer_id',NULL,NULL),('06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467',NULL,'06c95c8c-a1e7-4fc2-abfd-c43354afce77.test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467','test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467','model.nexabrands_dbt.stg_products','06c95c8c-a1e7-4fc2-abfd-c43354afce77',cast('2025-02-10 08:44:08' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','product_id','dbt_test','generic',NULL,'[]','[]','



select
    product_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1


',NULL,'unique_stg_products_product_id','{"column_name": "product_id", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','ERROR','pass',0,'unique','unique_stg_products_product_id',NULL,NULL)

[0m08:44:09.611414 [debug] [MainThread]: SQL status: INSERT 0 58 in 0.005 seconds
[0m08:44:09.614030 [debug] [MainThread]: On master: COMMIT
[0m08:44:09.614813 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:09.615532 [debug] [MainThread]: On master: COMMIT
[0m08:44:09.618187 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m08:44:09.619983 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m08:44:09.635467 [debug] [MainThread]: Elementary: Uploading dbt invocation.
[0m08:44:09.712020 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:09.712986 [debug] [MainThread]: On master: BEGIN
[0m08:44:09.714214 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:44:09.715332 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:09.720492 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_invocations'

        and table_schema = 'elementary'

      order by ordinal_position


[0m08:44:09.728318 [debug] [MainThread]: SQL status: SELECT 35 in 0.003 seconds
[0m08:44:09.739798 [debug] [MainThread]: Elementary: Inserting 1 rows to table "raw"."elementary"."dbt_invocations"
[0m08:44:09.762514 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m08:44:09.764604 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:09.765898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */


       insert into "raw"."elementary"."dbt_invocations"
         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values
    ('06c95c8c-a1e7-4fc2-abfd-c43354afce77',NULL,NULL,NULL,'2025-02-10 08:44:02','2025-02-10 08:44:09','2025-02-10 08:44:09',
    current_timestamp::timestamp
,'test','1.9.2','0.16.4',False,'{}','{"dbt_date": {"time_zone": "UTC"}}','dev','raw','raw','nexabrands_dbt',4,'[]',NULL,'Ajay263/pyspark_practice-','nexabrands_dbt',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'{"user": "root"}')

[0m08:44:09.767704 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m08:44:09.771214 [debug] [MainThread]: On master: COMMIT
[0m08:44:09.771855 [debug] [MainThread]: Using postgres connection "master"
[0m08:44:09.772609 [debug] [MainThread]: On master: COMMIT
[0m08:44:09.774168 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m08:44:09.775945 [debug] [MainThread]: Elementary: Uploaded dbt invocation successfully.
[0m08:44:09.782884 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m08:44:09.784358 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]
[0m08:44:09.785809 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-end.0 ........................................ [[32mOK[0m in 3.26s]
[0m08:44:09.786750 [debug] [MainThread]: On master: Close
[0m08:44:09.787746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:44:09.788418 [debug] [MainThread]: Connection 'test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9' was properly closed.
[0m08:44:09.789093 [debug] [MainThread]: Connection 'test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6' was properly closed.
[0m08:44:09.789708 [debug] [MainThread]: Connection 'test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m08:44:09.790312 [debug] [MainThread]: Connection 'test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m08:44:09.791348 [info ] [MainThread]:
[0m08:44:09.792405 [info ] [MainThread]: Finished running 2 project hooks, 58 data tests in 0 hours 0 minutes and 6.51 seconds (6.51s).
[0m08:44:09.803250 [debug] [MainThread]: Command end result
[0m08:44:09.975467 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m08:44:09.979169 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m08:44:09.992278 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m08:44:09.993107 [info ] [MainThread]:
[0m08:44:09.994033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:44:09.994931 [info ] [MainThread]:
[0m08:44:09.995579 [info ] [MainThread]: Done. PASS=60 WARN=0 ERROR=0 SKIP=0 TOTAL=60
[0m08:44:09.997376 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.9730477, "process_in_blocks": "13920", "process_kernel_time": 1.153851, "process_mem_max_rss": "122308", "process_out_blocks": "10856", "process_user_time": 7.413097}
[0m08:44:09.998260 [debug] [MainThread]: Command `dbt test` succeeded at 08:44:09.998106 after 7.97 seconds
[0m08:44:09.999064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779e4d3fd070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779e4efba750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779e4efb8e30>]}
[0m08:44:09.999875 [debug] [MainThread]: Flushing usage events
[0m08:44:11.103170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:16:41.548102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04c9d3e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04ca2486b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04ca24a600>]}


============================== 10:16:41.552696 | 65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae ==============================
[0m10:16:41.552696 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:16:41.553692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'profiles_dir': '/home/codespace/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:16:41.806311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04c9a36960>]}
[0m10:16:41.871237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04cb641310>]}
[0m10:16:41.872216 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:16:42.007270 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:16:42.393711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:16:42.394525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:16:42.412345 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests.nexabrands_dbt.marts
[0m10:16:42.551469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04c990ff80>]}
[0m10:16:42.750409 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m10:16:42.753931 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m10:16:42.784313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04c8a3a6c0>]}
[0m10:16:42.784977 [info ] [MainThread]: Found 45 models, 2 snapshots, 60 data tests, 2 operations, 7 sources, 1529 macros
[0m10:16:42.785583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04c990d9a0>]}
[0m10:16:42.790207 [info ] [MainThread]:
[0m10:16:42.790849 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:16:42.791404 [info ] [MainThread]:
[0m10:16:42.792274 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:16:42.800036 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m10:16:42.800848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_marts'
[0m10:16:42.812246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_elementary'
[0m10:16:42.818313 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_staging'
[0m10:16:42.849012 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m10:16:42.849486 [debug] [ThreadPool]: Using postgres connection "list_raw_marts"
[0m10:16:42.850009 [debug] [ThreadPool]: Using postgres connection "list_raw_elementary"
[0m10:16:42.850445 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m10:16:42.850859 [debug] [ThreadPool]: Using postgres connection "list_raw_staging"
[0m10:16:42.851335 [debug] [ThreadPool]: On list_raw_marts: BEGIN
[0m10:16:42.851841 [debug] [ThreadPool]: On list_raw_elementary: BEGIN
[0m10:16:42.852334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:42.852866 [debug] [ThreadPool]: On list_raw_staging: BEGIN
[0m10:16:42.854584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:42.853834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:42.853341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:16:42.859534 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:16:42.865906 [debug] [ThreadPool]: Using postgres connection "list_raw_staging"
[0m10:16:42.867402 [debug] [ThreadPool]: On list_raw_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_staging"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'

[0m10:16:42.866648 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:16:42.868246 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m10:16:42.869010 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'

[0m10:16:42.873135 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.003 seconds
[0m10:16:42.877201 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m10:16:42.878241 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m10:16:42.884680 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m10:16:42.885397 [debug] [ThreadPool]: Using postgres connection "list_raw_elementary"
[0m10:16:42.887733 [debug] [ThreadPool]: On list_raw_elementary: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_elementary"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'elementary'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'elementary'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'elementary'

[0m10:16:42.886086 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.018 seconds
[0m10:16:42.890304 [debug] [ThreadPool]: On list_raw_staging: ROLLBACK
[0m10:16:42.879727 [debug] [ThreadPool]: On list_raw_raw: Close
[0m10:16:42.891551 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw_raw, now list_raw_intermediate)
[0m10:16:42.886951 [debug] [ThreadPool]: Using postgres connection "list_raw_marts"
[0m10:16:42.899211 [debug] [ThreadPool]: On list_raw_staging: Close
[0m10:16:42.899638 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.011 seconds
[0m10:16:42.902664 [debug] [ThreadPool]: Using postgres connection "list_raw_intermediate"
[0m10:16:42.903221 [debug] [ThreadPool]: On list_raw_marts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_marts"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'

[0m10:16:42.905928 [debug] [ThreadPool]: On list_raw_elementary: ROLLBACK
[0m10:16:42.906828 [debug] [ThreadPool]: On list_raw_intermediate: BEGIN
[0m10:16:42.908607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:16:42.909848 [debug] [ThreadPool]: On list_raw_elementary: Close
[0m10:16:42.918229 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m10:16:42.921788 [debug] [ThreadPool]: On list_raw_marts: ROLLBACK
[0m10:16:42.923089 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:16:42.923633 [debug] [ThreadPool]: Using postgres connection "list_raw_intermediate"
[0m10:16:42.924040 [debug] [ThreadPool]: On list_raw_marts: Close
[0m10:16:42.924724 [debug] [ThreadPool]: On list_raw_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_intermediate"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intermediate'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intermediate'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intermediate'

[0m10:16:42.930466 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.002 seconds
[0m10:16:42.931771 [debug] [ThreadPool]: On list_raw_intermediate: ROLLBACK
[0m10:16:42.932341 [debug] [ThreadPool]: On list_raw_intermediate: Close
[0m10:16:42.986109 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:42.986682 [debug] [MainThread]: On master: BEGIN
[0m10:16:42.987149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:16:42.990734 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m10:16:42.992229 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:42.994130 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:16:43.001946 [debug] [MainThread]: SQL status: SELECT 55 in 0.007 seconds
[0m10:16:43.013541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04c7ed9b50>]}
[0m10:16:43.014140 [debug] [MainThread]: On master: ROLLBACK
[0m10:16:43.014725 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:43.015211 [debug] [MainThread]: On master: BEGIN
[0m10:16:43.016780 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:16:43.017267 [debug] [MainThread]: On master: COMMIT
[0m10:16:43.017722 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:43.018163 [debug] [MainThread]: On master: COMMIT
[0m10:16:43.018683 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:43.069657 [info ] [MainThread]:
IMPORTANT - Starting from dbt 1.8, users must explicitly allow packages to override materializations.
Elementary requires this ability to support collection of samples and failed row count for dbt tests.
Please add the following flag to dbt_project.yml to allow it:

flags:
  require_explicit_package_overrides_for_builtin_materializations: false

Notes -
* This is a temporary measure that will result in a deprecation warning, please ignore it for now. Elementary is working with the dbt-core team on a more permanent solution.
* This message can be muted by setting the 'mute_ensure_materialization_override' var to true.

[0m10:16:43.110537 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:43.111211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */

    select count(*) from pg_namespace where nspname = 'elementary__tests'

[0m10:16:43.112201 [debug] [MainThread]: SQL status: SELECT 1 in 0.000 seconds
[0m10:16:43.115261 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m10:16:43.119206 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]
[0m10:16:43.119952 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-start.0 ...................................... [[32mOK[0m in 0.10s]
[0m10:16:43.120489 [info ] [MainThread]:
[0m10:16:43.121080 [debug] [MainThread]: On master: Close
[0m10:16:43.124616 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e
[0m10:16:43.125406 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630
[0m10:16:43.126490 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95
[0m10:16:43.125920 [info ] [Thread-1 (]: 1 of 58 START test accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town  [RUN]
[0m10:16:43.127751 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73
[0m10:16:43.128260 [info ] [Thread-2 (]: 2 of 58 START test accepted_values_stg_order_fulfillment_in_full__True__0__1 ... [RUN]
[0m10:16:43.128788 [info ] [Thread-3 (]: 3 of 58 START test accepted_values_stg_order_fulfillment_on_time__True__0__1 ... [RUN]
[0m10:16:43.129699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_elementary, now test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e)
[0m10:16:43.130261 [info ] [Thread-4 (]: 4 of 58 START test accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1  [RUN]
[0m10:16:43.130976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw_marts, now test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630)
[0m10:16:43.131539 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_raw_staging, now test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95)
[0m10:16:43.132807 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e
[0m10:16:43.133402 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_raw_intermediate, now test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73)
[0m10:16:43.133946 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630
[0m10:16:43.134513 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95
[0m10:16:43.150680 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73
[0m10:16:43.158293 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e"
[0m10:16:43.162949 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630"
[0m10:16:43.167422 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95"
[0m10:16:43.172220 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73"
[0m10:16:43.173241 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e
[0m10:16:43.174292 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95
[0m10:16:43.175100 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73
[0m10:16:43.175721 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630
[0m10:16:43.199429 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e"
[0m10:16:43.200639 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95"
[0m10:16:43.203511 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73"
[0m10:16:43.206487 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630"
[0m10:16:43.207510 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e"
[0m10:16:43.208402 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73"
[0m10:16:43.209308 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630"
[0m10:16:43.209923 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95"
[0m10:16:43.210410 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e: BEGIN
[0m10:16:43.210975 [debug] [Thread-4 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73: BEGIN
[0m10:16:43.211516 [debug] [Thread-2 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630: BEGIN
[0m10:16:43.212043 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95: BEGIN
[0m10:16:43.212637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:43.213171 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:43.213701 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:16:43.214219 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:43.219058 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m10:16:43.220041 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73"
[0m10:16:43.221483 [debug] [Thread-4 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




with all_values as (

    select
        ontime_in_full as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by ontime_in_full

)

select *
from all_values
where value_field not in (
    '0','1'
)




    ) dbt_internal_test
[0m10:16:43.225312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m10:16:43.226440 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e"
[0m10:16:43.229099 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




with all_values as (

    select
        city as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_customers"
    group by city

)

select *
from all_values
where value_field not in (
    'Klerksdorp','Polokwane','Stellenbosch','Paarl','East London','Grahamstown','George','Upington','Bloemfontein','Worcester','Pietermaritzburg','Pretoria','Nelspruit','Kimberley','Johannesburg','Cape Town'
)




    ) dbt_internal_test
[0m10:16:43.230386 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m10:16:43.231257 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630"
[0m10:16:43.232128 [debug] [Thread-2 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




with all_values as (

    select
        in_full as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by in_full

)

select *
from all_values
where value_field not in (
    '0','1'
)




    ) dbt_internal_test
[0m10:16:43.236987 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m10:16:43.244023 [debug] [Thread-2 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630: ROLLBACK
[0m10:16:43.244801 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m10:16:43.245980 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95"
[0m10:16:43.247555 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




with all_values as (

    select
        on_time as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by on_time

)

select *
from all_values
where value_field not in (
    '0','1'
)




    ) dbt_internal_test
[0m10:16:43.252407 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.030 seconds
[0m10:16:43.254415 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:16:43.256473 [debug] [Thread-4 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73: ROLLBACK
[0m10:16:43.257865 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.028 seconds
[0m10:16:43.258585 [debug] [Thread-2 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630: Close
[0m10:16:43.260421 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95: ROLLBACK
[0m10:16:43.261370 [debug] [Thread-4 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73: Close
[0m10:16:43.262766 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e: ROLLBACK
[0m10:16:43.265809 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e: Close
[0m10:16:43.264927 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95: Close
[0m10:16:43.267024 [info ] [Thread-3 (]: 3 of 58 PASS accepted_values_stg_order_fulfillment_on_time__True__0__1 ......... [[32mPASS[0m in 0.14s]
[0m10:16:43.270787 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95
[0m10:16:43.271626 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575
[0m10:16:43.263862 [info ] [Thread-2 (]: 2 of 58 PASS accepted_values_stg_order_fulfillment_in_full__True__0__1 ......... [[32mPASS[0m in 0.13s]
[0m10:16:43.269322 [info ] [Thread-4 (]: 4 of 58 PASS accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1 .. [[32mPASS[0m in 0.14s]
[0m10:16:43.272673 [info ] [Thread-1 (]: 1 of 58 PASS accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town  [[32mPASS[0m in 0.14s]
[0m10:16:43.273978 [info ] [Thread-3 (]: 5 of 58 START test accepted_values_stg_products_category__Dairy__beverages__Food  [RUN]
[0m10:16:43.274952 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630
[0m10:16:43.275809 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73
[0m10:16:43.276586 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e
[0m10:16:43.277724 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95, now test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575)
[0m10:16:43.278336 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478
[0m10:16:43.278980 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc
[0m10:16:43.279627 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182
[0m10:16:43.280211 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575
[0m10:16:43.280802 [info ] [Thread-2 (]: 6 of 58 START test dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True  [RUN]
[0m10:16:43.281453 [info ] [Thread-4 (]: 7 of 58 START test dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True  [RUN]
[0m10:16:43.282096 [info ] [Thread-1 (]: 8 of 58 START test dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2  [RUN]
[0m10:16:43.291217 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575"
[0m10:16:43.291817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630, now test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478)
[0m10:16:43.292425 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73, now test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc)
[0m10:16:43.293041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e, now test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182)
[0m10:16:43.293900 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575
[0m10:16:43.294421 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478
[0m10:16:43.294957 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc
[0m10:16:43.295507 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182
[0m10:16:43.298484 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575"
[0m10:16:43.322802 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc"
[0m10:16:43.322275 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478"
[0m10:16:43.335814 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182"
[0m10:16:43.336884 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc
[0m10:16:43.337544 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575"
[0m10:16:43.338358 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478
[0m10:16:43.339214 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182
[0m10:16:43.343150 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc"
[0m10:16:43.343726 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575: BEGIN
[0m10:16:43.346638 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478"
[0m10:16:43.349694 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182"
[0m10:16:43.350443 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:43.351365 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478"
[0m10:16:43.354355 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478: BEGIN
[0m10:16:43.355180 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:16:43.352051 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc"
[0m10:16:43.356343 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc: BEGIN
[0m10:16:43.357178 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:43.353253 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182"
[0m10:16:43.358485 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182: BEGIN
[0m10:16:43.359763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:43.361803 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m10:16:43.365382 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575"
[0m10:16:43.367252 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_products"
    group by category

)

select *
from all_values
where value_field not in (
    'Dairy','beverages','Food'
)




    ) dbt_internal_test
[0m10:16:43.364633 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m10:16:43.366188 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m10:16:43.369670 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc"
[0m10:16:43.371993 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m10:16:43.372481 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m10:16:43.373104 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478"
[0m10:16:43.373684 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select



  ontime_target >= otif_target as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






    ) dbt_internal_test
[0m10:16:43.375349 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575: ROLLBACK
[0m10:16:43.375930 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182"
[0m10:16:43.376551 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select



  infull_target >= otif_target as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






    ) dbt_internal_test
[0m10:16:43.377573 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575: Close
[0m10:16:43.380424 [info ] [Thread-3 (]: 5 of 58 PASS accepted_values_stg_products_category__Dairy__beverages__Food ..... [[32mPASS[0m in 0.10s]
[0m10:16:43.381513 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575
[0m10:16:43.378725 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select




( 1=1 and length(
        city
    ) >= 2 and length(
        city
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








    ) dbt_internal_test
[0m10:16:43.379326 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:43.382297 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf
[0m10:16:43.384791 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc: ROLLBACK
[0m10:16:43.385354 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:43.385885 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:16:43.387883 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182: ROLLBACK
[0m10:16:43.386369 [info ] [Thread-3 (]: 9 of 58 START test dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2  [RUN]
[0m10:16:43.388536 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc: Close
[0m10:16:43.392757 [info ] [Thread-4 (]: 7 of 58 PASS dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True  [[32mPASS[0m in 0.10s]
[0m10:16:43.393800 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc
[0m10:16:43.391836 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575, now test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf)
[0m10:16:43.390493 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478: ROLLBACK
[0m10:16:43.391319 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182: Close
[0m10:16:43.394570 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012
[0m10:16:43.396716 [info ] [Thread-4 (]: 10 of 58 START test dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1  [RUN]
[0m10:16:43.396018 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478: Close
[0m10:16:43.398631 [info ] [Thread-2 (]: 6 of 58 PASS dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True  [[32mPASS[0m in 0.11s]
[0m10:16:43.399680 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478
[0m10:16:43.395339 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf
[0m10:16:43.397570 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc, now test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012)
[0m10:16:43.400457 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db
[0m10:16:43.401657 [info ] [Thread-1 (]: 8 of 58 PASS dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2  [[32mPASS[0m in 0.11s]
[0m10:16:43.409523 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf"
[0m10:16:43.410034 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012
[0m10:16:43.410624 [info ] [Thread-2 (]: 11 of 58 START test dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1  [RUN]
[0m10:16:43.418252 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478, now test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db)
[0m10:16:43.411484 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182
[0m10:16:43.412384 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf
[0m10:16:43.419095 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db
[0m10:16:43.420923 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012"
[0m10:16:43.421471 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2
[0m10:16:43.424536 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf"
[0m10:16:43.429732 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db"
[0m10:16:43.430754 [info ] [Thread-1 (]: 12 of 58 START test dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2  [RUN]
[0m10:16:43.431638 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012
[0m10:16:43.432861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182, now test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2)
[0m10:16:43.438170 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2
[0m10:16:43.433485 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf"
[0m10:16:43.437165 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012"
[0m10:16:43.434188 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db
[0m10:16:43.443587 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2"
[0m10:16:43.444174 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf: BEGIN
[0m10:16:43.445094 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012"
[0m10:16:43.448800 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db"
[0m10:16:43.449574 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:43.450234 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012: BEGIN
[0m10:16:43.453014 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:43.451970 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db"
[0m10:16:43.450821 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2
[0m10:16:43.455107 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db: BEGIN
[0m10:16:43.459814 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2"
[0m10:16:43.460429 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m10:16:43.461521 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:16:43.464078 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m10:16:43.465060 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2"
[0m10:16:43.465557 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf"
[0m10:16:43.468239 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select




( 1=1 and length(
        customer_name
    ) >= 2 and length(
        customer_name
    ) <= 100
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








    ) dbt_internal_test
[0m10:16:43.471201 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m10:16:43.472027 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db"
[0m10:16:43.472896 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select




( 1=1 and length(
        order_id
    ) >= 1 and length(
        order_id
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








    ) dbt_internal_test
[0m10:16:43.478479 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.008 seconds
[0m10:16:43.481263 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf: ROLLBACK
[0m10:16:43.482932 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m10:16:43.466406 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012"
[0m10:16:43.486773 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select




( 1=1 and length(
        customer_id
    ) >= 1 and length(
        customer_id
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








    ) dbt_internal_test
[0m10:16:43.467258 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2: BEGIN
[0m10:16:43.487752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:43.489824 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf: Close
[0m10:16:43.485853 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db: ROLLBACK
[0m10:16:43.490916 [info ] [Thread-3 (]: 9 of 58 PASS dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2  [[32mPASS[0m in 0.10s]
[0m10:16:43.492238 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf
[0m10:16:43.493289 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db: Close
[0m10:16:43.495242 [info ] [Thread-2 (]: 11 of 58 PASS dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1  [[32mPASS[0m in 0.08s]
[0m10:16:43.494074 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710
[0m10:16:43.501300 [info ] [Thread-3 (]: 13 of 58 START test dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1  [RUN]
[0m10:16:43.502303 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf, now test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710)
[0m10:16:43.503176 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710
[0m10:16:43.500171 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db
[0m10:16:43.511986 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63
[0m10:16:43.513851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m10:16:43.511021 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.023 seconds
[0m10:16:43.512987 [info ] [Thread-2 (]: 14 of 58 START test dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10  [RUN]
[0m10:16:43.520038 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710"
[0m10:16:43.520603 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2"
[0m10:16:43.522417 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012: ROLLBACK
[0m10:16:43.523710 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db, now test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63)
[0m10:16:43.524617 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710
[0m10:16:43.525201 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select




( 1=1 and length(
        category
    ) >= 2 and length(
        category
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








    ) dbt_internal_test
[0m10:16:43.525925 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012: Close
[0m10:16:43.526415 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63
[0m10:16:43.529573 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710"
[0m10:16:43.530594 [info ] [Thread-4 (]: 10 of 58 PASS dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1  [[32mPASS[0m in 0.13s]
[0m10:16:43.538131 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m10:16:43.541146 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63"
[0m10:16:43.542059 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012
[0m10:16:43.543718 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2: ROLLBACK
[0m10:16:43.544642 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710"
[0m10:16:43.545175 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5
[0m10:16:43.545882 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63
[0m10:16:43.546604 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710: BEGIN
[0m10:16:43.547172 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2: Close
[0m10:16:43.547661 [info ] [Thread-4 (]: 15 of 58 START test dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0  [RUN]
[0m10:16:43.552058 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5)
[0m10:16:43.552861 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5
[0m10:16:43.551286 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:43.550708 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63"
[0m10:16:43.561872 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5"
[0m10:16:43.560254 [info ] [Thread-1 (]: 12 of 58 PASS dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2  [[32mPASS[0m in 0.13s]
[0m10:16:43.565063 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2
[0m10:16:43.563800 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63"
[0m10:16:43.566003 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6
[0m10:16:43.568256 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m10:16:43.571161 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710"
[0m10:16:43.570460 [info ] [Thread-1 (]: 16 of 58 START test dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0  [RUN]
[0m10:16:43.569050 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63: BEGIN
[0m10:16:43.572340 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5
[0m10:16:43.572966 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select




( 1=1 and length(
        product_name
    ) >= 1 and length(
        product_name
    ) <= 100
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








    ) dbt_internal_test
[0m10:16:43.574768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6)
[0m10:16:43.580039 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6
[0m10:16:43.579262 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5"
[0m10:16:43.575332 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:16:43.585461 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6"
[0m10:16:43.585983 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:16:43.590466 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710: ROLLBACK
[0m10:16:43.592665 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6
[0m10:16:43.593829 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5"
[0m10:16:43.595257 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m10:16:43.595846 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710: Close
[0m10:16:43.600658 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6"
[0m10:16:43.601258 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5: BEGIN
[0m10:16:43.603054 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:43.601851 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63"
[0m10:16:43.605350 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (





    with grouped_expression as (
    select





    length(
        date
    ) = 10 as expression


    from "raw"."staging"."stg_dates"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






    ) dbt_internal_test
[0m10:16:43.604179 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6"
[0m10:16:43.607276 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6: BEGIN
[0m10:16:43.608389 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:16:43.606526 [info ] [Thread-3 (]: 13 of 58 PASS dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1  [[32mPASS[0m in 0.10s]
[0m10:16:43.609166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:43.610869 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63: ROLLBACK
[0m10:16:43.612755 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710
[0m10:16:43.613245 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m10:16:43.614476 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69
[0m10:16:43.615800 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63: Close
[0m10:16:43.616776 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5"
[0m10:16:43.619554 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (







    with grouped_expression as (
    select




( 1=1 and infull_target >= 0 and infull_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors









    ) dbt_internal_test
[0m10:16:43.621549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:16:43.622514 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6"
[0m10:16:43.623541 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (







    with grouped_expression as (
    select




( 1=1 and ontime_target >= 0 and ontime_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors









    ) dbt_internal_test
[0m10:16:43.625739 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:16:43.617936 [info ] [Thread-3 (]: 17 of 58 START test dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0  [RUN]
[0m10:16:43.630403 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69)
[0m10:16:43.618897 [info ] [Thread-2 (]: 14 of 58 PASS dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10  [[32mPASS[0m in 0.10s]
[0m10:16:43.633754 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63
[0m10:16:43.634708 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386
[0m10:16:43.629123 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:16:43.632732 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69
[0m10:16:43.628362 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5: ROLLBACK
[0m10:16:43.638118 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6: ROLLBACK
[0m10:16:43.635749 [info ] [Thread-2 (]: 18 of 58 START test dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_  [RUN]
[0m10:16:43.645148 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5: Close
[0m10:16:43.648482 [info ] [Thread-4 (]: 15 of 58 PASS dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0  [[32mPASS[0m in 0.10s]
[0m10:16:43.649564 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5
[0m10:16:43.650349 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed
[0m10:16:43.651118 [info ] [Thread-4 (]: 19 of 58 START test dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True  [RUN]
[0m10:16:43.652092 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed)
[0m10:16:43.647290 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386)
[0m10:16:43.654625 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386
[0m10:16:43.652958 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed
[0m10:16:43.653826 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6: Close
[0m10:16:43.669733 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed"
[0m10:16:43.671738 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69"
[0m10:16:43.674171 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386"
[0m10:16:43.675158 [info ] [Thread-1 (]: 16 of 58 PASS dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0  [[32mPASS[0m in 0.10s]
[0m10:16:43.677296 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69
[0m10:16:43.678273 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6
[0m10:16:43.678984 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed
[0m10:16:43.683972 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69"
[0m10:16:43.684650 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10
[0m10:16:43.687670 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed"
[0m10:16:43.688271 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386
[0m10:16:43.689061 [info ] [Thread-1 (]: 20 of 58 START test dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food  [RUN]
[0m10:16:43.690112 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed"
[0m10:16:43.690733 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69"
[0m10:16:43.693614 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386"
[0m10:16:43.694208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10)
[0m10:16:43.696301 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10
[0m10:16:43.694896 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed: BEGIN
[0m10:16:43.695482 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69: BEGIN
[0m10:16:43.706972 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10"
[0m10:16:43.707631 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:43.708249 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:43.708786 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386"
[0m10:16:43.710831 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386: BEGIN
[0m10:16:43.709628 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10
[0m10:16:43.712205 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:16:43.717325 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10"
[0m10:16:43.720225 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m10:16:43.722529 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69"
[0m10:16:43.721055 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m10:16:43.723422 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10"
[0m10:16:43.725235 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (







    with grouped_expression as (
    select




( 1=1 and otif_target >= 0 and otif_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors









    ) dbt_internal_test
[0m10:16:43.726020 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m10:16:43.728476 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386"
[0m10:16:43.727469 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10: BEGIN
[0m10:16:43.726630 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed"
[0m10:16:43.729489 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (







    with grouped_expression as (
    select




( 1=1 and order_placement_date >= '2024-01-01' and order_placement_date <= current_date
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors









    ) dbt_internal_test
[0m10:16:43.730324 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:43.734744 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69: ROLLBACK
[0m10:16:43.732193 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (







    with grouped_expression as (
    select




( 1=1 and product_id > 1
)
 as expression


    from "raw"."staging"."stg_products"
    where
        product_id IS NOT NULL



),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors









    ) dbt_internal_test
[0m10:16:43.730891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:43.735690 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69: Close
[0m10:16:43.737516 [info ] [Thread-3 (]: 17 of 58 PASS dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0  [[32mPASS[0m in 0.11s]
[0m10:16:43.739926 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69
[0m10:16:43.738592 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:43.740786 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0
[0m10:16:43.746855 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed: ROLLBACK
[0m10:16:43.747412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m10:16:43.747919 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.015 seconds
[0m10:16:43.748545 [info ] [Thread-3 (]: 21 of 58 START test dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date  [RUN]
[0m10:16:43.749339 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10"
[0m10:16:43.749894 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed: Close
[0m10:16:43.752056 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386: ROLLBACK
[0m10:16:43.752714 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0)
[0m10:16:43.754460 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0
[0m10:16:43.753329 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (


with all_values as (

    select
        category as value_field

    from "raw"."staging"."stg_products"


),
set_values as (

    select
        cast('Dairy' as TEXT) as value_field
    union all
    select
        cast('beverages' as TEXT) as value_field
    union all
    select
        cast('Food' as TEXT) as value_field


),
validation_errors as (
    -- values from the model that are not in the set
    select
        v.value_field
    from
        all_values v
        left join
        set_values s on v.value_field = s.value_field
    where
        s.value_field is null

)

select *
from validation_errors



    ) dbt_internal_test
[0m10:16:43.762080 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386: Close
[0m10:16:43.770739 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m10:16:43.762754 [info ] [Thread-4 (]: 19 of 58 PASS dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True  [[32mPASS[0m in 0.11s]
[0m10:16:43.778500 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0"
[0m10:16:43.780466 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10: ROLLBACK
[0m10:16:43.781929 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed
[0m10:16:43.781284 [info ] [Thread-2 (]: 18 of 58 PASS dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_  [[32mPASS[0m in 0.13s]
[0m10:16:43.782670 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0: BEGIN
[0m10:16:43.783400 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39
[0m10:16:43.783867 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10: Close
[0m10:16:43.784675 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386
[0m10:16:43.787728 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828
[0m10:16:43.785815 [info ] [Thread-4 (]: 22 of 58 START test dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_  [RUN]
[0m10:16:43.785232 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:43.788529 [info ] [Thread-2 (]: 23 of 58 START test dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_  [RUN]
[0m10:16:43.786924 [info ] [Thread-1 (]: 20 of 58 PASS dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food  [[32mPASS[0m in 0.09s]
[0m10:16:43.792569 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10
[0m10:16:43.789431 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39)
[0m10:16:43.791151 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828)
[0m10:16:43.793564 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86
[0m10:16:43.794308 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39
[0m10:16:43.795882 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m10:16:43.796446 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828
[0m10:16:43.797067 [info ] [Thread-1 (]: 24 of 58 START test dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___  [RUN]
[0m10:16:43.810048 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39"
[0m10:16:43.810674 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0"
[0m10:16:43.816465 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828"
[0m10:16:43.817114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86)
[0m10:16:43.817984 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_orders'

        and table_schema = 'staging'

      order by ordinal_position


[0m10:16:43.818780 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86
[0m10:16:43.819491 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828
[0m10:16:43.819999 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39
[0m10:16:43.883665 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86"
[0m10:16:43.884426 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.064 seconds
[0m10:16:43.887439 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828"
[0m10:16:43.890389 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39"
[0m10:16:43.897412 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0"
[0m10:16:43.898147 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86
[0m10:16:43.899093 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39"
[0m10:16:43.899946 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0
[0m10:16:43.900596 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828"
[0m10:16:43.903486 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86"
[0m10:16:43.904087 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39: BEGIN
[0m10:16:43.907064 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0"
[0m10:16:43.907660 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828: BEGIN
[0m10:16:43.908581 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86"
[0m10:16:43.909118 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:43.909860 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:16:43.910528 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86: BEGIN
[0m10:16:43.912580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:43.911165 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0"
[0m10:16:43.914007 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (


        select
            cast('ORDER_ID' as TEXT) as relation_column,
            cast('TEXT' as TEXT) as relation_column_type
        union all

        select
            cast('CUSTOMER_ID' as TEXT) as relation_column,
            cast('TEXT' as TEXT) as relation_column_type
        union all

        select
            cast('ORDER_PLACEMENT_DATE' as TEXT) as relation_column,
            cast('DATE' as TEXT) as relation_column_type


    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'ORDER_PLACEMENT_DATE'
            and
            relation_column_type not in ('DATE')

    )
    select *
    from test_data

    ) dbt_internal_test
[0m10:16:43.915610 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:16:43.918275 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0: ROLLBACK
[0m10:16:43.919580 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0: Close
[0m10:16:43.920409 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m10:16:43.922159 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39"
[0m10:16:43.923962 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (





    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(city, '^[A-Za-z\s\-\.]+$', '')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






    ) dbt_internal_test
[0m10:16:43.924935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:16:43.925651 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86"
[0m10:16:43.928406 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m10:16:43.930003 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (





    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(order_id, '^[A-Za-z0-9\-_]+$', '')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_order_fulfillment"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






    ) dbt_internal_test
[0m10:16:43.931364 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828"
[0m10:16:43.932428 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (





    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(customer_name, '^[A-Za-z0-9\s\-\.]+$', '')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






    ) dbt_internal_test
[0m10:16:43.927395 [info ] [Thread-3 (]: 21 of 58 PASS dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date  [[32mPASS[0m in 0.17s]
[0m10:16:43.934012 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0
[0m10:16:43.934885 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908
[0m10:16:43.935770 [info ] [Thread-3 (]: 25 of 58 START test dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_  [RUN]
[0m10:16:43.936704 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908)
[0m10:16:43.937618 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908
[0m10:16:43.938387 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:16:43.946059 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828: ROLLBACK
[0m10:16:43.947133 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.022 seconds
[0m10:16:43.948249 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828: Close
[0m10:16:43.951709 [info ] [Thread-2 (]: 23 of 58 PASS dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_  [[32mPASS[0m in 0.16s]
[0m10:16:43.952846 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828
[0m10:16:43.953636 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a
[0m10:16:43.950579 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39: ROLLBACK
[0m10:16:43.961292 [info ] [Thread-2 (]: 26 of 58 START test dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id  [RUN]
[0m10:16:43.963162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828, now test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a)
[0m10:16:43.962358 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39: Close
[0m10:16:43.965163 [info ] [Thread-4 (]: 22 of 58 PASS dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_  [[32mPASS[0m in 0.18s]
[0m10:16:43.966277 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39
[0m10:16:43.964043 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a
[0m10:16:43.967169 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419
[0m10:16:43.986231 [info ] [Thread-4 (]: 27 of 58 START test dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category  [RUN]
[0m10:16:43.987141 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39, now test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419)
[0m10:16:43.985430 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908"
[0m10:16:43.987983 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419
[0m10:16:43.994145 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.062 seconds
[0m10:16:43.998010 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a"
[0m10:16:43.998829 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908
[0m10:16:44.005124 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419"
[0m10:16:44.006878 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86: ROLLBACK
[0m10:16:44.010543 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908"
[0m10:16:44.011524 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86: Close
[0m10:16:44.014466 [info ] [Thread-1 (]: 24 of 58 PASS dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___  [[32mPASS[0m in 0.20s]
[0m10:16:44.015667 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86
[0m10:16:44.016431 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404
[0m10:16:44.012632 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908"
[0m10:16:44.013121 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419
[0m10:16:44.013578 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a
[0m10:16:44.017273 [info ] [Thread-1 (]: 28 of 58 START test dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date  [RUN]
[0m10:16:44.017956 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908: BEGIN
[0m10:16:44.023246 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419"
[0m10:16:44.026308 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a"
[0m10:16:44.026940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86, now test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404)
[0m10:16:44.027514 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:44.028459 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419"
[0m10:16:44.029207 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404
[0m10:16:44.030353 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a"
[0m10:16:44.031130 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419: BEGIN
[0m10:16:44.037640 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a: BEGIN
[0m10:16:44.048064 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404"
[0m10:16:44.048590 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m10:16:44.049121 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:44.049673 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:16:44.050226 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404: BEGIN
[0m10:16:44.050767 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908"
[0m10:16:44.053237 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (





    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(product_name, '^\\s*$', '')), 1), 0)


 = 0
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






    ) dbt_internal_test
[0m10:16:44.052027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:44.055853 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:44.060370 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908: ROLLBACK
[0m10:16:44.061174 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m10:16:44.063169 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908: Close
[0m10:16:44.066015 [info ] [Thread-3 (]: 25 of 58 PASS dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_  [[32mPASS[0m in 0.13s]
[0m10:16:44.067147 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908
[0m10:16:44.063869 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a"
[0m10:16:44.064428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:16:44.067984 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602
[0m10:16:44.069784 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m10:16:44.070304 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




with validation_errors as (

    select
        customer_id,order_placement_date,order_id,
        count(*) as "n_records"
    from "raw"."staging"."stg_orders"
    where
        1=1
        and
    not (
        customer_id is null and
        order_placement_date is null and
        order_id is null

    )



    group by
        customer_id,order_placement_date,order_id
    having count(*) > 1

)
select * from validation_errors


    ) dbt_internal_test
[0m10:16:44.070896 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404"
[0m10:16:44.073013 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_orders'

        and table_schema = 'staging'

      order by ordinal_position


[0m10:16:44.071462 [info ] [Thread-3 (]: 29 of 58 START test dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category  [RUN]
[0m10:16:44.074149 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908, now test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602)
[0m10:16:44.075029 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602
[0m10:16:44.072118 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419"
[0m10:16:44.082302 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




with validation_errors as (

    select
        product_name,category,
        count(*) as "n_records"
    from "raw"."staging"."stg_products"
    where
        1=1
        and
    not (
        product_name is null and
        category is null

    )



    group by
        product_name,category
    having count(*) > 1

)
select * from validation_errors


    ) dbt_internal_test
[0m10:16:44.089501 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:16:44.091931 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419: ROLLBACK
[0m10:16:44.095168 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602"
[0m10:16:44.095962 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419: Close
[0m10:16:44.098799 [info ] [Thread-4 (]: 27 of 58 PASS dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category  [[32mPASS[0m in 0.11s]
[0m10:16:44.099930 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419
[0m10:16:44.096777 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.023 seconds
[0m10:16:44.100817 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d
[0m10:16:44.108925 [info ] [Thread-4 (]: 30 of 58 START test dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city  [RUN]
[0m10:16:44.110210 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419, now test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d)
[0m10:16:44.110980 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d
[0m10:16:44.097677 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602: BEGIN
[0m10:16:44.107653 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404"
[0m10:16:44.117914 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:44.119769 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404
[0m10:16:44.120551 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.048 seconds
[0m10:16:44.135484 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d"
[0m10:16:44.134024 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m10:16:44.133443 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404"
[0m10:16:44.137766 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a: ROLLBACK
[0m10:16:44.139058 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d: BEGIN
[0m10:16:44.139629 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602"
[0m10:16:44.140602 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404"
[0m10:16:44.141096 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a: Close
[0m10:16:44.141629 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:44.142197 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_products'

        and table_schema = 'staging'

      order by ordinal_position


[0m10:16:44.142837 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (


        select
            1 as relation_column_idx,
            cast('ORDER_ID' as TEXT) as relation_column
        union all

        select
            2 as relation_column_idx,
            cast('CUSTOMER_ID' as TEXT) as relation_column
        union all

        select
            3 as relation_column_idx,
            cast('ORDER_PLACEMENT_DATE' as TEXT) as relation_column


    ),
    input_columns as (


        select
            1 as input_column_idx,
            cast('ORDER_ID' as TEXT) as input_column
        union all

        select
            2 as input_column_idx,
            cast('CUSTOMER_ID' as TEXT) as input_column
        union all

        select
            3 as input_column_idx,
            cast('ORDER_PLACEMENT_DATE' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx
    where
        -- catch any column in input list that is not in the sequence of table columns
        -- or any table column that is not in the input sequence
        r.relation_column is null or
        i.input_column is null

    ) dbt_internal_test
[0m10:16:44.143840 [info ] [Thread-2 (]: 26 of 58 PASS dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id  [[32mPASS[0m in 0.18s]
[0m10:16:44.145396 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a
[0m10:16:44.146227 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:16:44.154694 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404: ROLLBACK
[0m10:16:44.157095 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.012 seconds
[0m10:16:44.155573 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06
[0m10:16:44.162155 [info ] [Thread-2 (]: 31 of 58 START test dbt_expectations_expect_table_columns_to_match_set_stg_dates_date  [RUN]
[0m10:16:44.163755 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404: Close
[0m10:16:44.165609 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m10:16:44.166569 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d"
[0m10:16:44.167487 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_customers'

        and table_schema = 'staging'

      order by ordinal_position


[0m10:16:44.168743 [info ] [Thread-1 (]: 28 of 58 PASS dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date  [[32mPASS[0m in 0.14s]
[0m10:16:44.169839 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404
[0m10:16:44.170594 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185
[0m10:16:44.164718 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a, now test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06)
[0m10:16:44.161179 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602"
[0m10:16:44.181618 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602
[0m10:16:44.180451 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06
[0m10:16:44.171416 [info ] [Thread-1 (]: 32 of 58 START test dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full  [RUN]
[0m10:16:44.202046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404, now test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185)
[0m10:16:44.202887 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185
[0m10:16:44.191551 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.023 seconds
[0m10:16:44.214269 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d"
[0m10:16:44.222412 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06"
[0m10:16:44.218644 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602"
[0m10:16:44.223316 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d
[0m10:16:44.238937 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d"
[0m10:16:44.224335 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06: BEGIN
[0m10:16:44.241728 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:16:44.240808 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602"
[0m10:16:44.243171 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (


        select
            1 as relation_column_idx,
            cast('PRODUCT_ID' as TEXT) as relation_column
        union all

        select
            2 as relation_column_idx,
            cast('PRODUCT_NAME' as TEXT) as relation_column
        union all

        select
            3 as relation_column_idx,
            cast('CATEGORY' as TEXT) as relation_column


    ),
    input_columns as (


        select
            1 as input_column_idx,
            cast('PRODUCT_ID' as TEXT) as input_column
        union all

        select
            2 as input_column_idx,
            cast('PRODUCT_NAME' as TEXT) as input_column
        union all

        select
            3 as input_column_idx,
            cast('CATEGORY' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx
    where
        -- catch any column in input list that is not in the sequence of table columns
        -- or any table column that is not in the input sequence
        r.relation_column is null or
        i.input_column is null

    ) dbt_internal_test
[0m10:16:44.239994 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185"
[0m10:16:44.245249 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185: BEGIN
[0m10:16:44.246043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:44.247232 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:16:44.249737 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602: ROLLBACK
[0m10:16:44.251087 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d"
[0m10:16:44.252071 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (


        select cast('CUSTOMER_ID' as TEXT) as relation_column
        union all

        select cast('CUSTOMER_NAME' as TEXT) as relation_column
        union all

        select cast('CITY' as TEXT) as relation_column


    ),
    input_columns as (


        select cast('CUSTOMER_ID' as TEXT) as input_column
        union all

        select cast('CUSTOMER_NAME' as TEXT) as input_column
        union all

        select cast('CITY' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null

    ) dbt_internal_test
[0m10:16:44.256850 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m10:16:44.257864 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06"
[0m10:16:44.258831 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_dates'

        and table_schema = 'staging'

      order by ordinal_position


[0m10:16:44.256020 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602: Close
[0m10:16:44.262090 [info ] [Thread-3 (]: 29 of 58 PASS dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category  [[32mPASS[0m in 0.19s]
[0m10:16:44.265649 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602
[0m10:16:44.270201 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m10:16:44.270993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m10:16:44.278449 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185"
[0m10:16:44.271756 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.012 seconds
[0m10:16:44.276279 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d: ROLLBACK
[0m10:16:44.273158 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc
[0m10:16:44.279360 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_fulfillment'

        and table_schema = 'staging'

      order by ordinal_position


[0m10:16:44.282839 [info ] [Thread-3 (]: 33 of 58 START test dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1  [RUN]
[0m10:16:44.285607 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602, now test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc)
[0m10:16:44.286510 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc
[0m10:16:44.282317 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d: Close
[0m10:16:44.281506 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06"
[0m10:16:44.293498 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.010 seconds
[0m10:16:44.300281 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc"
[0m10:16:44.302438 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06
[0m10:16:44.301622 [info ] [Thread-4 (]: 30 of 58 PASS dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city  [[32mPASS[0m in 0.19s]
[0m10:16:44.305172 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185"
[0m10:16:44.309395 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06"
[0m10:16:44.310495 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d
[0m10:16:44.311230 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc
[0m10:16:44.312073 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a
[0m10:16:44.312754 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185
[0m10:16:44.313563 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06"
[0m10:16:44.316631 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc"
[0m10:16:44.317217 [info ] [Thread-4 (]: 34 of 58 START test dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1  [RUN]
[0m10:16:44.321331 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185"
[0m10:16:44.321972 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (


        select cast('DATE' as TEXT) as relation_column


    ),
    input_columns as (


        select cast('DATE' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null

    ) dbt_internal_test
[0m10:16:44.322819 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d, now test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a)
[0m10:16:44.323959 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a
[0m10:16:44.330157 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:16:44.330734 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185"
[0m10:16:44.329924 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a"
[0m10:16:44.333541 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06: ROLLBACK
[0m10:16:44.334060 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc"
[0m10:16:44.334966 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (


        select cast('ORDER_ID' as TEXT) as relation_column
        union all

        select cast('ON_TIME' as TEXT) as relation_column
        union all

        select cast('IN_FULL' as TEXT) as relation_column
        union all

        select cast('ONTIME_IN_FULL' as TEXT) as relation_column


    ),
    input_columns as (


        select cast('ORDER_ID' as TEXT) as input_column
        union all

        select cast('ON_TIME' as TEXT) as input_column
        union all

        select cast('IN_FULL' as TEXT) as input_column
        union all

        select cast('ONTIME_IN_FULL' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null

    ) dbt_internal_test
[0m10:16:44.336038 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a
[0m10:16:44.336673 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06: Close
[0m10:16:44.337155 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc: BEGIN
[0m10:16:44.341980 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:44.341263 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m10:16:44.340662 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a"
[0m10:16:44.344759 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185: ROLLBACK
[0m10:16:44.345838 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a"
[0m10:16:44.347627 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a: BEGIN
[0m10:16:44.348402 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:44.349098 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185: Close
[0m10:16:44.350008 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m10:16:44.346820 [info ] [Thread-2 (]: 31 of 58 PASS dbt_expectations_expect_table_columns_to_match_set_stg_dates_date  [[32mPASS[0m in 0.18s]
[0m10:16:44.356341 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc"
[0m10:16:44.359427 [info ] [Thread-1 (]: 32 of 58 PASS dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full  [[32mPASS[0m in 0.16s]
[0m10:16:44.361959 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m10:16:44.363071 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06
[0m10:16:44.363657 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 40
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







    ) dbt_internal_test
[0m10:16:44.364413 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185
[0m10:16:44.366680 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3
[0m10:16:44.365800 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212
[0m10:16:44.365008 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a"
[0m10:16:44.368224 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:44.369121 [info ] [Thread-1 (]: 36 of 58 START test dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1  [RUN]
[0m10:16:44.372867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185, now test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3)
[0m10:16:44.370464 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




    with grouped_expression as (
    select




( 1=1 and count(*) >= 1
)
 as expression


    from "raw"."staging"."stg_dates"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







    ) dbt_internal_test
[0m10:16:44.375616 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:16:44.378264 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a: ROLLBACK
[0m10:16:44.373688 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3
[0m10:16:44.372100 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc: ROLLBACK
[0m10:16:44.369807 [info ] [Thread-2 (]: 35 of 58 START test dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1  [RUN]
[0m10:16:44.384961 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc: Close
[0m10:16:44.385785 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a: Close
[0m10:16:44.399892 [info ] [Thread-4 (]: 34 of 58 PASS dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1  [[32mPASS[0m in 0.08s]
[0m10:16:44.401208 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a
[0m10:16:44.395935 [info ] [Thread-3 (]: 33 of 58 PASS dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1  [[32mPASS[0m in 0.11s]
[0m10:16:44.403399 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc
[0m10:16:44.404332 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241
[0m10:16:44.402162 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191
[0m10:16:44.390856 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3"
[0m10:16:44.391792 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06, now test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212)
[0m10:16:44.405508 [info ] [Thread-3 (]: 38 of 58 START test not_null_stg_customer_targets_customer_id .................. [RUN]
[0m10:16:44.406374 [info ] [Thread-4 (]: 37 of 58 START test dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1  [RUN]
[0m10:16:44.407233 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212
[0m10:16:44.407993 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3
[0m10:16:44.408548 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc, now test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241)
[0m10:16:44.409164 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a, now test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191)
[0m10:16:44.416703 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212"
[0m10:16:44.419875 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3"
[0m10:16:44.420522 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241
[0m10:16:44.421135 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191
[0m10:16:44.422073 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212
[0m10:16:44.429713 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241"
[0m10:16:44.434737 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191"
[0m10:16:44.435409 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3"
[0m10:16:44.438355 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212"
[0m10:16:44.439165 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241
[0m10:16:44.440020 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191
[0m10:16:44.440576 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3: BEGIN
[0m10:16:44.441417 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212"
[0m10:16:44.448757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:44.448066 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191"
[0m10:16:44.445183 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241"
[0m10:16:44.449563 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212: BEGIN
[0m10:16:44.451835 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241"
[0m10:16:44.453220 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:16:44.454091 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241: BEGIN
[0m10:16:44.457338 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:44.458621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:16:44.455271 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191"
[0m10:16:44.463156 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191: BEGIN
[0m10:16:44.461648 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m10:16:44.459802 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3"
[0m10:16:44.464585 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:44.465353 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212"
[0m10:16:44.469150 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




    with grouped_expression as (
    select




( 1=1 and count(*) >= 1
)
 as expression


    from "raw"."staging"."stg_order_fulfillment"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







    ) dbt_internal_test
[0m10:16:44.467249 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m10:16:44.470195 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241"
[0m10:16:44.471064 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select customer_id
from "raw"."staging"."stg_customer_targets"
where customer_id is null




    ) dbt_internal_test
[0m10:16:44.467755 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 10000000
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







    ) dbt_internal_test
[0m10:16:44.475188 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m10:16:44.476697 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191"
[0m10:16:44.477735 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m10:16:44.480211 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:16:44.480813 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.009 seconds
[0m10:16:44.481456 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 100
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







    ) dbt_internal_test
[0m10:16:44.483625 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212: ROLLBACK
[0m10:16:44.485166 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3: ROLLBACK
[0m10:16:44.486623 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241: ROLLBACK
[0m10:16:44.487541 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212: Close
[0m10:16:44.489476 [info ] [Thread-2 (]: 35 of 58 PASS dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1  [[32mPASS[0m in 0.10s]
[0m10:16:44.493510 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212
[0m10:16:44.494309 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241: Close
[0m10:16:44.495028 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3: Close
[0m10:16:44.501541 [info ] [Thread-1 (]: 36 of 58 PASS dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1  [[32mPASS[0m in 0.13s]
[0m10:16:44.502709 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3
[0m10:16:44.503545 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108
[0m10:16:44.488348 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:16:44.506714 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191: ROLLBACK
[0m10:16:44.495830 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728
[0m10:16:44.499734 [info ] [Thread-3 (]: 38 of 58 PASS not_null_stg_customer_targets_customer_id ........................ [[32mPASS[0m in 0.09s]
[0m10:16:44.508142 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191: Close
[0m10:16:44.511237 [info ] [Thread-4 (]: 37 of 58 PASS dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1  [[32mPASS[0m in 0.10s]
[0m10:16:44.504346 [info ] [Thread-1 (]: 40 of 58 START test not_null_stg_customer_targets_ontime_target ................ [RUN]
[0m10:16:44.507619 [info ] [Thread-2 (]: 39 of 58 START test not_null_stg_customer_targets_infull_target ................ [RUN]
[0m10:16:44.509604 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241
[0m10:16:44.512466 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191
[0m10:16:44.513577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3, now test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108)
[0m10:16:44.514466 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212, now test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728)
[0m10:16:44.515358 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a
[0m10:16:44.516002 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8
[0m10:16:44.516615 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108
[0m10:16:44.517164 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728
[0m10:16:44.517731 [info ] [Thread-3 (]: 41 of 58 START test not_null_stg_customer_targets_otif_target .................. [RUN]
[0m10:16:44.518377 [info ] [Thread-4 (]: 42 of 58 START test not_null_stg_customers_city ................................ [RUN]
[0m10:16:44.523824 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108"
[0m10:16:44.529145 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728"
[0m10:16:44.529761 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241, now test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a)
[0m10:16:44.530337 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191, now test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8)
[0m10:16:44.531232 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108
[0m10:16:44.531905 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a
[0m10:16:44.532607 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8
[0m10:16:44.533204 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728
[0m10:16:44.537259 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108"
[0m10:16:44.541671 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a"
[0m10:16:44.546256 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8"
[0m10:16:44.549191 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728"
[0m10:16:44.550088 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108"
[0m10:16:44.550958 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8
[0m10:16:44.551868 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728"
[0m10:16:44.552471 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a
[0m10:16:44.552986 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108: BEGIN
[0m10:16:44.556107 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8"
[0m10:16:44.556714 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728: BEGIN
[0m10:16:44.560481 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a"
[0m10:16:44.561087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:44.561795 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:16:44.563653 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a"
[0m10:16:44.565731 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a: BEGIN
[0m10:16:44.566510 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:44.564933 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8"
[0m10:16:44.568124 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8: BEGIN
[0m10:16:44.568969 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m10:16:44.572209 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728"
[0m10:16:44.573186 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select infull_target
from "raw"."staging"."stg_customer_targets"
where infull_target is null




    ) dbt_internal_test
[0m10:16:44.574292 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m10:16:44.575424 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:16:44.576664 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108"
[0m10:16:44.570070 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:44.580345 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728: ROLLBACK
[0m10:16:44.581721 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select ontime_target
from "raw"."staging"."stg_customer_targets"
where ontime_target is null




    ) dbt_internal_test
[0m10:16:44.583039 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m10:16:44.584471 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a"
[0m10:16:44.586094 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:44.587992 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select otif_target
from "raw"."staging"."stg_customer_targets"
where otif_target is null




    ) dbt_internal_test
[0m10:16:44.590047 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108: ROLLBACK
[0m10:16:44.590527 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728: Close
[0m10:16:44.591909 [info ] [Thread-2 (]: 39 of 58 PASS not_null_stg_customer_targets_infull_target ...................... [[32mPASS[0m in 0.08s]
[0m10:16:44.593719 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728
[0m10:16:44.592773 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:44.595402 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:16:44.598111 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m10:16:44.598647 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108: Close
[0m10:16:44.600707 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a: ROLLBACK
[0m10:16:44.601573 [info ] [Thread-2 (]: 43 of 58 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m10:16:44.603660 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728, now test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m10:16:44.604497 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:16:44.602549 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8"
[0m10:16:44.611025 [info ] [Thread-1 (]: 40 of 58 PASS not_null_stg_customer_targets_ontime_target ...................... [[32mPASS[0m in 0.10s]
[0m10:16:44.613950 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108
[0m10:16:44.614787 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60
[0m10:16:44.611922 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a: Close
[0m10:16:44.615691 [info ] [Thread-1 (]: 44 of 58 START test not_null_stg_customers_customer_name ....................... [RUN]
[0m10:16:44.620347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108, now test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60)
[0m10:16:44.621623 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60
[0m10:16:44.619615 [info ] [Thread-3 (]: 41 of 58 PASS not_null_stg_customer_targets_otif_target ........................ [[32mPASS[0m in 0.09s]
[0m10:16:44.634118 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a
[0m10:16:44.634991 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd
[0m10:16:44.612811 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select city
from "raw"."staging"."stg_customers"
where city is null




    ) dbt_internal_test
[0m10:16:44.625310 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:16:44.637056 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:16:44.637900 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:16:44.635825 [info ] [Thread-3 (]: 45 of 58 START test not_null_stg_dates_date .................................... [RUN]
[0m10:16:44.657085 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a, now test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd)
[0m10:16:44.657793 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd
[0m10:16:44.649284 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8: ROLLBACK
[0m10:16:44.633029 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60"
[0m10:16:44.667522 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8: Close
[0m10:16:44.669224 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60
[0m10:16:44.666210 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:16:44.665219 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd"
[0m10:16:44.668627 [info ] [Thread-4 (]: 42 of 58 PASS not_null_stg_customers_city ...................................... [[32mPASS[0m in 0.14s]
[0m10:16:44.769630 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8
[0m10:16:44.772288 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8
[0m10:16:44.771548 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd
[0m10:16:44.770778 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:16:44.782898 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m10:16:44.783646 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:16:44.773093 [info ] [Thread-4 (]: 46 of 58 START test not_null_stg_order_fulfillment_in_full ..................... [RUN]
[0m10:16:44.785642 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8, now test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8)
[0m10:16:44.786415 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8
[0m10:16:44.778183 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd"
[0m10:16:44.795024 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd"
[0m10:16:44.795749 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd: BEGIN
[0m10:16:44.796424 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:44.798655 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m10:16:44.805360 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:16:44.806695 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select customer_id
from "raw"."staging"."stg_customers"
where customer_id is null




    ) dbt_internal_test
[0m10:16:44.781818 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60"
[0m10:16:44.808398 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60"
[0m10:16:44.811186 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60: BEGIN
[0m10:16:44.812020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:44.809224 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:16:44.815049 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m10:16:44.793749 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8"
[0m10:16:44.827545 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m10:16:44.830042 [debug] [Thread-3 (]: SQL status: BEGIN in 0.034 seconds
[0m10:16:44.833489 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd"
[0m10:16:44.834368 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select date
from "raw"."staging"."stg_dates"
where date is null




    ) dbt_internal_test
[0m10:16:44.831224 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8
[0m10:16:44.846196 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m10:16:44.848535 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd: ROLLBACK
[0m10:16:44.849435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m10:16:44.851755 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60"
[0m10:16:44.852599 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select customer_name
from "raw"."staging"."stg_customers"
where customer_name is null




    ) dbt_internal_test
[0m10:16:44.835603 [info ] [Thread-2 (]: 43 of 58 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.23s]
[0m10:16:44.854485 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:16:44.855974 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996
[0m10:16:44.853352 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd: Close
[0m10:16:44.855244 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:16:44.862670 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60: ROLLBACK
[0m10:16:44.859479 [info ] [Thread-2 (]: 47 of 58 START test not_null_stg_order_fulfillment_on_time ..................... [RUN]
[0m10:16:44.860465 [info ] [Thread-3 (]: 45 of 58 PASS not_null_stg_dates_date .......................................... [[32mPASS[0m in 0.20s]
[0m10:16:44.865291 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd
[0m10:16:44.864101 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996)
[0m10:16:44.858701 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8"
[0m10:16:44.869937 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8"
[0m10:16:44.870691 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8: BEGIN
[0m10:16:44.871408 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:44.867343 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a
[0m10:16:44.868867 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60: Close
[0m10:16:44.868148 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996
[0m10:16:44.872341 [info ] [Thread-3 (]: 48 of 58 START test not_null_stg_order_fulfillment_ontime_in_full .............. [RUN]
[0m10:16:44.883079 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd, now test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a)
[0m10:16:44.884165 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a
[0m10:16:44.873332 [info ] [Thread-1 (]: 44 of 58 PASS not_null_stg_customers_customer_name ............................. [[32mPASS[0m in 0.25s]
[0m10:16:44.893878 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60
[0m10:16:44.894701 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:16:44.896110 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m10:16:44.905288 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8"
[0m10:16:44.906368 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select in_full
from "raw"."staging"."stg_order_fulfillment"
where in_full is null




    ) dbt_internal_test
[0m10:16:44.901369 [info ] [Thread-1 (]: 49 of 58 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m10:16:44.919802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60, now test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5)
[0m10:16:44.920826 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:16:44.916658 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996"
[0m10:16:44.929070 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996
[0m10:16:44.928028 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m10:16:44.936710 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8: ROLLBACK
[0m10:16:44.892761 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a"
[0m10:16:44.937910 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a
[0m10:16:44.942648 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a"
[0m10:16:44.943603 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8: Close
[0m10:16:44.946745 [info ] [Thread-4 (]: 46 of 58 PASS not_null_stg_order_fulfillment_in_full ........................... [[32mPASS[0m in 0.16s]
[0m10:16:44.947962 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8
[0m10:16:44.948784 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8
[0m10:16:44.934140 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996"
[0m10:16:44.945459 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:16:44.952462 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:16:44.954868 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996"
[0m10:16:44.963703 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996: BEGIN
[0m10:16:44.950277 [info ] [Thread-4 (]: 50 of 58 START test not_null_stg_orders_order_placement_date ................... [RUN]
[0m10:16:44.965555 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8, now test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8)
[0m10:16:44.966333 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8
[0m10:16:44.956139 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a"
[0m10:16:44.974303 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a: BEGIN
[0m10:16:44.975060 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:44.964494 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:16:44.978978 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:16:44.981273 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:16:44.982164 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m10:16:44.973525 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8"
[0m10:16:44.984716 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8
[0m10:16:44.983044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:45.002509 [debug] [Thread-2 (]: SQL status: BEGIN in 0.038 seconds
[0m10:16:45.003200 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m10:16:45.007888 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a"
[0m10:16:45.009307 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select ontime_in_full
from "raw"."staging"."stg_order_fulfillment"
where ontime_in_full is null




    ) dbt_internal_test
[0m10:16:45.005740 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996"
[0m10:16:45.010375 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select on_time
from "raw"."staging"."stg_order_fulfillment"
where on_time is null




    ) dbt_internal_test
[0m10:16:44.990054 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8"
[0m10:16:45.013501 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8"
[0m10:16:45.014299 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8: BEGIN
[0m10:16:45.015121 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:45.015789 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m10:16:45.018357 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996: ROLLBACK
[0m10:16:45.025305 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.015 seconds
[0m10:16:45.033686 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a: ROLLBACK
[0m10:16:45.040065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m10:16:45.043522 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:16:45.044346 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select customer_id
from "raw"."staging"."stg_orders"
where customer_id is null




    ) dbt_internal_test
[0m10:16:45.048885 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m10:16:45.042539 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996: Close
[0m10:16:45.054418 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a: Close
[0m10:16:45.053779 [info ] [Thread-2 (]: 47 of 58 PASS not_null_stg_order_fulfillment_on_time ........................... [[32mPASS[0m in 0.19s]
[0m10:16:45.056722 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996
[0m10:16:45.055505 [info ] [Thread-3 (]: 48 of 58 PASS not_null_stg_order_fulfillment_ontime_in_full .................... [[32mPASS[0m in 0.17s]
[0m10:16:45.052534 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m10:16:45.059075 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a
[0m10:16:45.065292 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3
[0m10:16:45.064408 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m10:16:45.057927 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1
[0m10:16:45.060274 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m10:16:45.066157 [info ] [Thread-3 (]: 52 of 58 START test not_null_stg_products_product_id ........................... [RUN]
[0m10:16:45.077064 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a, now test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3)
[0m10:16:45.066881 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8"
[0m10:16:45.079825 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select order_placement_date
from "raw"."staging"."stg_orders"
where order_placement_date is null




    ) dbt_internal_test
[0m10:16:45.072355 [info ] [Thread-2 (]: 51 of 58 START test not_null_stg_products_category ............................. [RUN]
[0m10:16:45.080788 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996, now test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1)
[0m10:16:45.081564 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1
[0m10:16:45.078658 [info ] [Thread-1 (]: 49 of 58 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.16s]
[0m10:16:45.090224 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:16:45.090971 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939
[0m10:16:45.091661 [info ] [Thread-1 (]: 53 of 58 START test not_null_stg_products_product_name ......................... [RUN]
[0m10:16:45.077742 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3
[0m10:16:45.097222 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m10:16:45.126853 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8: ROLLBACK
[0m10:16:45.101051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5, now test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939)
[0m10:16:45.136917 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939
[0m10:16:45.119948 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1"
[0m10:16:45.149412 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m10:16:45.150155 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8: Close
[0m10:16:45.151636 [info ] [Thread-4 (]: 50 of 58 PASS not_null_stg_orders_order_placement_date ......................... [[32mPASS[0m in 0.19s]
[0m10:16:45.152814 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8
[0m10:16:45.153619 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63
[0m10:16:45.155066 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3
[0m10:16:45.156006 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1
[0m10:16:45.173612 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1"
[0m10:16:45.161242 [info ] [Thread-4 (]: 54 of 58 START test primary_key_stg_order_fulfillment_order_id ................. [RUN]
[0m10:16:45.174826 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8, now test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63)
[0m10:16:45.175608 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63
[0m10:16:45.167513 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m10:16:45.185861 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1"
[0m10:16:45.187731 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1: BEGIN
[0m10:16:45.188537 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:16:45.186898 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m10:16:45.190521 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m10:16:45.191314 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:45.160234 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939"
[0m10:16:45.193751 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939
[0m10:16:45.200851 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939"
[0m10:16:45.184437 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63"
[0m10:16:45.202585 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63
[0m10:16:45.206750 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m10:16:45.216582 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1"
[0m10:16:45.217487 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select category
from "raw"."staging"."stg_products"
where category is null




    ) dbt_internal_test
[0m10:16:45.210434 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m10:16:45.218755 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m10:16:45.219761 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select product_id
from "raw"."staging"."stg_products"
where product_id is null




    ) dbt_internal_test
[0m10:16:45.221830 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:16:45.222601 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m10:16:45.229190 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1: ROLLBACK
[0m10:16:45.230341 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939"
[0m10:16:45.231295 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939: BEGIN
[0m10:16:45.232744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:45.232012 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1: Close
[0m10:16:45.225418 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m10:16:45.236942 [info ] [Thread-2 (]: 51 of 58 PASS not_null_stg_products_category ................................... [[32mPASS[0m in 0.16s]
[0m10:16:45.238409 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1
[0m10:16:45.234560 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63"
[0m10:16:45.240083 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3: Close
[0m10:16:45.243529 [info ] [Thread-3 (]: 52 of 58 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.17s]
[0m10:16:45.244749 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3
[0m10:16:45.245580 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9
[0m10:16:45.239233 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6
[0m10:16:45.248671 [info ] [Thread-2 (]: 55 of 58 START test primary_key_stg_orders_order_id ............................ [RUN]
[0m10:16:45.249594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1, now test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6)
[0m10:16:45.250392 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6
[0m10:16:45.247658 [info ] [Thread-3 (]: 56 of 58 START test unique_stg_customer_targets_customer_id .................... [RUN]
[0m10:16:45.258309 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3, now test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9)
[0m10:16:45.259192 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9
[0m10:16:45.246863 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63"
[0m10:16:45.270200 [debug] [Thread-4 (]: On test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63: BEGIN
[0m10:16:45.270993 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:45.260490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m10:16:45.272965 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939"
[0m10:16:45.273814 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select product_name
from "raw"."staging"."stg_products"
where product_name is null




    ) dbt_internal_test
[0m10:16:45.277053 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6"
[0m10:16:45.277843 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:16:45.289082 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939: ROLLBACK
[0m10:16:45.286471 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m10:16:45.290056 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63"
[0m10:16:45.290893 [debug] [Thread-4 (]: On test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (


WITH validation AS (
	SELECT
		order_id AS primary_key,
		COUNT(1) AS occurrences

	FROM "raw"."staging"."stg_order_fulfillment"
	GROUP BY 1
)

SELECT *

FROM validation
WHERE primary_key IS NULL
	OR occurrences > 1



    ) dbt_internal_test
[0m10:16:45.291928 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939: Close
[0m10:16:45.293118 [info ] [Thread-1 (]: 53 of 58 PASS not_null_stg_products_product_name ............................... [[32mPASS[0m in 0.19s]
[0m10:16:45.294205 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939
[0m10:16:45.295014 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada
[0m10:16:45.303893 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6
[0m10:16:45.302968 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9"
[0m10:16:45.307607 [info ] [Thread-1 (]: 57 of 58 START test unique_stg_customers_customer_id ........................... [RUN]
[0m10:16:45.316005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939, now test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada)
[0m10:16:45.316997 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada
[0m10:16:45.313424 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6"
[0m10:16:45.329004 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6"
[0m10:16:45.329784 [debug] [Thread-2 (]: On test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6: BEGIN
[0m10:16:45.330571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:16:45.327553 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9
[0m10:16:45.338695 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9"
[0m10:16:45.339410 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.048 seconds
[0m10:16:45.343205 [debug] [Thread-4 (]: On test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63: ROLLBACK
[0m10:16:45.349848 [debug] [Thread-4 (]: On test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63: Close
[0m10:16:45.351971 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m10:16:45.353984 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6"
[0m10:16:45.356553 [debug] [Thread-2 (]: On test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (


WITH validation AS (
	SELECT
		order_id AS primary_key,
		COUNT(1) AS occurrences

	FROM "raw"."staging"."stg_orders"
	GROUP BY 1
)

SELECT *

FROM validation
WHERE primary_key IS NULL
	OR occurrences > 1



    ) dbt_internal_test
[0m10:16:45.353096 [info ] [Thread-4 (]: 54 of 58 PASS primary_key_stg_order_fulfillment_order_id ....................... [[32mPASS[0m in 0.18s]
[0m10:16:45.367382 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63
[0m10:16:45.326208 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada"
[0m10:16:45.369756 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada
[0m10:16:45.368294 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467
[0m10:16:45.364969 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9"
[0m10:16:45.376352 [info ] [Thread-4 (]: 58 of 58 START test unique_stg_products_product_id ............................. [RUN]
[0m10:16:45.380798 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada"
[0m10:16:45.389630 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63, now test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467)
[0m10:16:45.390699 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467
[0m10:16:45.388815 [debug] [Thread-3 (]: On test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9: BEGIN
[0m10:16:45.399088 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:16:45.400333 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada"
[0m10:16:45.403049 [debug] [Thread-1 (]: On test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m10:16:45.403944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:16:45.398160 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467"
[0m10:16:45.407872 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467
[0m10:16:45.421438 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m10:16:45.424438 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9"
[0m10:16:45.427525 [debug] [Thread-3 (]: On test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




select
    customer_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_customer_targets"
where customer_id is not null
group by customer_id
having count(*) > 1




    ) dbt_internal_test
[0m10:16:45.422211 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.065 seconds
[0m10:16:45.423151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:16:45.433882 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada"
[0m10:16:45.435783 [debug] [Thread-1 (]: On test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




select
    customer_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1




    ) dbt_internal_test
[0m10:16:45.438591 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:16:45.440964 [debug] [Thread-1 (]: On test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m10:16:45.433041 [debug] [Thread-2 (]: On test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6: ROLLBACK
[0m10:16:45.436792 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:16:45.443603 [debug] [Thread-3 (]: On test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9: ROLLBACK
[0m10:16:45.444637 [debug] [Thread-3 (]: On test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9: Close
[0m10:16:45.445345 [debug] [Thread-2 (]: On test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6: Close
[0m10:16:45.449243 [info ] [Thread-2 (]: 55 of 58 PASS primary_key_stg_orders_order_id .................................. [[32mPASS[0m in 0.20s]
[0m10:16:45.450468 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6
[0m10:16:45.445993 [debug] [Thread-1 (]: On test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada: Close
[0m10:16:45.454580 [info ] [Thread-1 (]: 57 of 58 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.14s]
[0m10:16:45.462189 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada
[0m10:16:45.459357 [info ] [Thread-3 (]: 56 of 58 PASS unique_stg_customer_targets_customer_id .......................... [[32mPASS[0m in 0.20s]
[0m10:16:45.447959 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467"
[0m10:16:45.466954 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467"
[0m10:16:45.468834 [debug] [Thread-4 (]: On test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467: BEGIN
[0m10:16:45.469649 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:16:45.463864 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9
[0m10:16:45.480839 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m10:16:45.481694 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467"
[0m10:16:45.482540 [debug] [Thread-4 (]: On test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




select
    product_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1




    ) dbt_internal_test
[0m10:16:45.484446 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:16:45.488705 [debug] [Thread-4 (]: On test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m10:16:45.496476 [debug] [Thread-4 (]: On test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467: Close
[0m10:16:45.500610 [info ] [Thread-4 (]: 58 of 58 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.11s]
[0m10:16:45.501802 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467
[0m10:16:45.507796 [info ] [MainThread]:
[0m10:16:45.520183 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:45.521018 [debug] [MainThread]: On master: BEGIN
[0m10:16:45.521689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:16:45.527080 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:16:45.527710 [debug] [MainThread]: On master: COMMIT
[0m10:16:45.528305 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:45.534156 [debug] [MainThread]: On master: COMMIT
[0m10:16:45.534959 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:16:45.653485 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:45.660470 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */


    select artifacts_model, metadata_hash from "raw"."elementary"."dbt_artifacts_hashes"
    order by metadata_hash


[0m10:16:45.664943 [debug] [MainThread]: SQL status: SELECT 201 in 0.003 seconds
[0m10:16:45.674908 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m10:16:45.729696 [debug] [MainThread]: Elementary: [dbt_models] Flattening the artifacts.
[0m10:16:45.870847 [debug] [MainThread]: Elementary: [dbt_models] Flattened 45 artifacts.
[0m10:16:45.883184 [debug] [MainThread]: Elementary: [dbt_models] Comparing the artifacts state.
[0m10:16:45.884870 [debug] [MainThread]: Elementary: [dbt_models] Artifacts did not change.
[0m10:16:45.886956 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:
[0m10:16:45.888480 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.139059 (1 runs)
[0m10:16:45.890181 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.157254 (1 runs)
[0m10:16:45.898453 [debug] [MainThread]: Elementary: [dbt_tests] Flattening the artifacts.
[0m10:16:46.363629 [debug] [MainThread]: Elementary: [dbt_tests] Flattened 60 artifacts.
[0m10:16:46.366219 [debug] [MainThread]: Elementary: [dbt_tests] Comparing the artifacts state.
[0m10:16:46.371097 [debug] [MainThread]: Elementary: [dbt_tests] Artifacts did not change.
[0m10:16:46.376462 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:
[0m10:16:46.379112 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.463302 (1 runs)
[0m10:16:46.382293 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.477889 (1 runs)
[0m10:16:46.391211 [debug] [MainThread]: Elementary: [dbt_sources] Flattening the artifacts.
[0m10:16:46.431280 [debug] [MainThread]: Elementary: [dbt_sources] Flattened 7 artifacts.
[0m10:16:46.433642 [debug] [MainThread]: Elementary: [dbt_sources] Comparing the artifacts state.
[0m10:16:46.435224 [debug] [MainThread]: Elementary: [dbt_sources] Artifacts did not change.
[0m10:16:46.437557 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:
[0m10:16:46.439134 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.038099 (1 runs)
[0m10:16:46.440739 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.046111 (1 runs)
[0m10:16:46.448919 [debug] [MainThread]: Elementary: [dbt_snapshots] Flattening the artifacts.
[0m10:16:46.454377 [debug] [MainThread]: Elementary: [dbt_snapshots] Flattened 2 artifacts.
[0m10:16:46.456611 [debug] [MainThread]: Elementary: [dbt_snapshots] Comparing the artifacts state.
[0m10:16:46.458079 [debug] [MainThread]: Elementary: [dbt_snapshots] Artifacts did not change.
[0m10:16:46.460326 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:
[0m10:16:46.461947 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.003338 (1 runs)
[0m10:16:46.463523 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.011314 (1 runs)
[0m10:16:46.471853 [debug] [MainThread]: Elementary: [dbt_metrics] Flattening the artifacts.
[0m10:16:46.474333 [debug] [MainThread]: Elementary: [dbt_metrics] Flattened 0 artifacts.
[0m10:16:46.476652 [debug] [MainThread]: Elementary: [dbt_metrics] Comparing the artifacts state.
[0m10:16:46.478110 [debug] [MainThread]: Elementary: [dbt_metrics] Artifacts did not change.
[0m10:16:46.480265 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:
[0m10:16:46.481880 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00.000550 (1 runs)
[0m10:16:46.483474 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.008263 (1 runs)
[0m10:16:46.491680 [debug] [MainThread]: Elementary: [dbt_exposures] Flattening the artifacts.
[0m10:16:46.494438 [debug] [MainThread]: Elementary: [dbt_exposures] Flattened 0 artifacts.
[0m10:16:46.496474 [debug] [MainThread]: Elementary: [dbt_exposures] Comparing the artifacts state.
[0m10:16:46.497957 [debug] [MainThread]: Elementary: [dbt_exposures] Artifacts did not change.
[0m10:16:46.500191 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:
[0m10:16:46.501832 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00.000910 (1 runs)
[0m10:16:46.503387 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.008278 (1 runs)
[0m10:16:46.511570 [debug] [MainThread]: Elementary: [dbt_seeds] Flattening the artifacts.
[0m10:16:46.514369 [debug] [MainThread]: Elementary: [dbt_seeds] Flattened 0 artifacts.
[0m10:16:46.516472 [debug] [MainThread]: Elementary: [dbt_seeds] Comparing the artifacts state.
[0m10:16:46.517979 [debug] [MainThread]: Elementary: [dbt_seeds] Artifacts did not change.
[0m10:16:46.520200 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:
[0m10:16:46.521831 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00.000796 (1 runs)
[0m10:16:46.523356 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.008540 (1 runs)
[0m10:16:46.533001 [debug] [MainThread]: Elementary: [dbt_columns] Flattening the artifacts.
[0m10:16:46.847577 [debug] [MainThread]: Elementary: [dbt_columns] Flattened 87 artifacts.
[0m10:16:46.850061 [debug] [MainThread]: Elementary: [dbt_columns] Comparing the artifacts state.
[0m10:16:46.852082 [debug] [MainThread]: Elementary: [dbt_columns] Artifacts did not change.
[0m10:16:46.854302 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:
[0m10:16:46.855904 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.312654 (1 runs)
[0m10:16:46.857532 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.321186 (1 runs)
[0m10:16:46.859314 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m10:16:46.866591 [debug] [MainThread]: Elementary: Uploading run results.
[0m10:16:46.868191 [debug] [MainThread]: Elementary: [dbt_run_results] Flattening the artifacts.
[0m10:16:46.976981 [debug] [MainThread]: Elementary: [dbt_run_results] Flattened 58 artifacts.
[0m10:16:47.008783 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:47.009813 [debug] [MainThread]: On master: BEGIN
[0m10:16:47.015405 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:16:47.016245 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:47.017109 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_run_results'

        and table_schema = 'elementary'

      order by ordinal_position


[0m10:16:47.035984 [debug] [MainThread]: SQL status: SELECT 22 in 0.018 seconds
[0m10:16:47.041037 [debug] [MainThread]: Elementary: Inserting 58 rows to table "raw"."elementary"."dbt_run_results"
[0m10:16:48.695922 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m10:16:48.698630 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:48.704134 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */


       insert into "raw"."elementary"."dbt_run_results"
         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values
    ('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'accepted_values_stg_order_fulfillment_on_time__True__0__1',NULL,'pass','test',0.1353764533996582,'2025-02-10T10:16:43.191433Z','2025-02-10T10:16:43.260150Z','2025-02-10T10:16:43.163389Z','2025-02-10T10:16:43.174126Z',1,False,'



with all_values as (

    select
        on_time as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by on_time

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'accepted_values_stg_order_fulfillment_in_full__True__0__1',NULL,'pass','test',0.13273167610168457,'2025-02-10T10:16:43.203941Z','2025-02-10T10:16:43.243834Z','2025-02-10T10:16:43.158750Z','2025-02-10T10:16:43.175581Z',1,False,'



with all_values as (

    select
        in_full as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by in_full

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1',NULL,'pass','test',0.1358320713043213,'2025-02-10T10:16:43.201072Z','2025-02-10T10:16:43.256284Z','2025-02-10T10:16:43.167862Z','2025-02-10T10:16:43.174938Z',1,False,'



with all_values as (

    select
        ontime_in_full as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by ontime_in_full

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e','test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town',NULL,'pass','test',0.1427781581878662,'2025-02-10T10:16:43.176076Z','2025-02-10T10:16:43.262630Z','2025-02-10T10:16:43.134916Z','2025-02-10T10:16:43.173040Z',1,False,'



with all_values as (

    select
        city as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_customers"
    group by city

)

select *
from all_values
where value_field not in (
    ''Klerksdorp'',''Polokwane'',''Stellenbosch'',''Paarl'',''East London'',''Grahamstown'',''George'',''Upington'',''Bloemfontein'',''Worcester'',''Pietermaritzburg'',''Pretoria'',''Nelspruit'',''Kimberley'',''Johannesburg'',''Cape Town''
)


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575','test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'accepted_values_stg_products_category__Dairy__beverages__Food',NULL,'pass','test',0.10252952575683594,'2025-02-10T10:16:43.295934Z','2025-02-10T10:16:43.375220Z','2025-02-10T10:16:43.282624Z','2025-02-10T10:16:43.293721Z',1,False,'



with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_products"
    group by category

)

select *
from all_values
where value_field not in (
    ''Dairy'',''beverages'',''Food''
)


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc','test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True',NULL,'pass','test',0.10017728805541992,'2025-02-10T10:16:43.339602Z','2025-02-10T10:16:43.384661Z','2025-02-10T10:16:43.309347Z','2025-02-10T10:16:43.336699Z',1,False,'





    with grouped_expression as (
    select



  ontime_target >= otif_target as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478','test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True',NULL,'pass','test',0.10670781135559082,'2025-02-10T10:16:43.344169Z','2025-02-10T10:16:43.390134Z','2025-02-10T10:16:43.298946Z','2025-02-10T10:16:43.338184Z',1,False,'





    with grouped_expression as (
    select



  infull_target >= otif_target as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2',NULL,'pass','test',0.10836362838745117,'2025-02-10T10:16:43.347090Z','2025-02-10T10:16:43.387760Z','2025-02-10T10:16:43.323176Z','2025-02-10T10:16:43.339049Z',1,False,'





    with grouped_expression as (
    select




( 1=1 and length(
        city
    ) >= 2 and length(
        city
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2',NULL,'pass','test',0.09894132614135742,'2025-02-10T10:16:43.421955Z','2025-02-10T10:16:43.481054Z','2025-02-10T10:16:43.402229Z','2025-02-10T10:16:43.412205Z',1,False,'





    with grouped_expression as (
    select




( 1=1 and length(
        customer_name
    ) >= 2 and length(
        customer_name
    ) <= 100
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1',NULL,'pass','test',0.07694315910339355,'2025-02-10T10:16:43.445495Z','2025-02-10T10:16:43.485654Z','2025-02-10T10:16:43.424977Z','2025-02-10T10:16:43.434030Z',1,False,'





    with grouped_expression as (
    select




( 1=1 and length(
        order_id
    ) >= 1 and length(
        order_id
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1',NULL,'pass','test',0.13293004035949707,'2025-02-10T10:16:43.434573Z','2025-02-10T10:16:43.522223Z','2025-02-10T10:16:43.412885Z','2025-02-10T10:16:43.431445Z',1,False,'





    with grouped_expression as (
    select




( 1=1 and length(
        customer_id
    ) >= 1 and length(
        customer_id
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2',NULL,'pass','test',0.12737083435058594,'2025-02-10T10:16:43.456722Z','2025-02-10T10:16:43.543590Z','2025-02-10T10:16:43.438788Z','2025-02-10T10:16:43.450679Z',1,False,'





    with grouped_expression as (
    select




( 1=1 and length(
        category
    ) >= 2 and length(
        category
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1',NULL,'pass','test',0.10414338111877441,'2025-02-10T10:16:43.526854Z','2025-02-10T10:16:43.590260Z','2025-02-10T10:16:43.503870Z','2025-02-10T10:16:43.524401Z',1,False,'





    with grouped_expression as (
    select




( 1=1 and length(
        product_name
    ) >= 1 and length(
        product_name
    ) <= 100
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10',NULL,'pass','test',0.09534192085266113,'2025-02-10T10:16:43.548162Z','2025-02-10T10:16:43.610741Z','2025-02-10T10:16:43.531163Z','2025-02-10T10:16:43.545708Z',1,False,'




    with grouped_expression as (
    select





    length(
        date
    ) = 10 as expression


    from "raw"."staging"."stg_dates"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0',NULL,'pass','test',0.09634613990783691,'2025-02-10T10:16:43.575789Z','2025-02-10T10:16:43.628170Z','2025-02-10T10:16:43.553513Z','2025-02-10T10:16:43.572156Z',1,False,'






    with grouped_expression as (
    select




( 1=1 and infull_target >= 0 and infull_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0',NULL,'pass','test',0.10028362274169922,'2025-02-10T10:16:43.596210Z','2025-02-10T10:16:43.637884Z','2025-02-10T10:16:43.580714Z','2025-02-10T10:16:43.591832Z',1,False,'






    with grouped_expression as (
    select




( 1=1 and ontime_target >= 0 and ontime_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0',NULL,'pass','test',0.10704159736633301,'2025-02-10T10:16:43.679364Z','2025-02-10T10:16:43.734554Z','2025-02-10T10:16:43.639103Z','2025-02-10T10:16:43.677062Z',1,False,'






    with grouped_expression as (
    select




( 1=1 and otif_target >= 0 and otif_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True',NULL,'pass','test',0.11079668998718262,'2025-02-10T10:16:43.685202Z','2025-02-10T10:16:43.746721Z','2025-02-10T10:16:43.661741Z','2025-02-10T10:16:43.678735Z',1,False,'






    with grouped_expression as (
    select




( 1=1 and product_id > 1
)
 as expression


    from "raw"."staging"."stg_products"
    where
        product_id IS NOT NULL



),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_',NULL,'pass','test',0.13401484489440918,'2025-02-10T10:16:43.691097Z','2025-02-10T10:16:43.751809Z','2025-02-10T10:16:43.655264Z','2025-02-10T10:16:43.688110Z',1,False,'






    with grouped_expression as (
    select




( 1=1 and order_placement_date >= ''2024-01-01'' and order_placement_date <= current_date
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food',NULL,'pass','test',0.09262561798095703,'2025-02-10T10:16:43.713060Z','2025-02-10T10:16:43.780332Z','2025-02-10T10:16:43.697045Z','2025-02-10T10:16:43.709430Z',1,False,'

with all_values as (

    select
        category as value_field

    from "raw"."staging"."stg_products"


),
set_values as (

    select
        cast(''Dairy'' as TEXT) as value_field
    union all
    select
        cast(''beverages'' as TEXT) as value_field
    union all
    select
        cast(''Food'' as TEXT) as value_field


),
validation_errors as (
    -- values from the model that are not in the set
    select
        v.value_field
    from
        all_values v
        left join
        set_values s on v.value_field = s.value_field
    where
        s.value_field is null

)

select *
from validation_errors

',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date',NULL,'pass','test',0.17395353317260742,'2025-02-10T10:16:43.904528Z','2025-02-10T10:16:43.918056Z','2025-02-10T10:16:43.755116Z','2025-02-10T10:16:43.899770Z',1,False,'with relation_columns as (


        select
            cast(''ORDER_ID'' as TEXT) as relation_column,
            cast(''TEXT'' as TEXT) as relation_column_type
        union all

        select
            cast(''CUSTOMER_ID'' as TEXT) as relation_column,
            cast(''TEXT'' as TEXT) as relation_column_type
        union all

        select
            cast(''ORDER_PLACEMENT_DATE'' as TEXT) as relation_column,
            cast(''DATE'' as TEXT) as relation_column_type


    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = ''ORDER_PLACEMENT_DATE''
            and
            relation_column_type not in (''DATE'')

    )
    select *
    from test_data',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_',NULL,'pass','test',0.16133952140808105,'2025-02-10T10:16:43.884864Z','2025-02-10T10:16:43.945853Z','2025-02-10T10:16:43.811111Z','2025-02-10T10:16:43.819316Z',1,False,'




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(customer_name, ''^[A-Za-z0-9\s\-\.]+$'', '''')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_',NULL,'pass','test',0.1756730079650879,'2025-02-10T10:16:43.887885Z','2025-02-10T10:16:43.950390Z','2025-02-10T10:16:43.797605Z','2025-02-10T10:16:43.819887Z',1,False,'




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(city, ''^[A-Za-z\s\-\.]+$'', '''')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___',NULL,'pass','test',0.1972513198852539,'2025-02-10T10:16:43.901006Z','2025-02-10T10:16:44.006738Z','2025-02-10T10:16:43.820531Z','2025-02-10T10:16:43.897971Z',1,False,'




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(order_id, ''^[A-Za-z0-9\-_]+$'', '''')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_order_fulfillment"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_',NULL,'pass','test',0.12927889823913574,'2025-02-10T10:16:44.007476Z','2025-02-10T10:16:44.059328Z','2025-02-10T10:16:43.939020Z','2025-02-10T10:16:43.998644Z',1,False,'




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(product_name, ''^\\s*$'', '''')), 1), 0)


 = 0
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419','test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category',NULL,'pass','test',0.1115884780883789,'2025-02-10T10:16:44.018370Z','2025-02-10T10:16:44.091733Z','2025-02-10T10:16:43.999279Z','2025-02-10T10:16:44.012998Z',1,False,'



with validation_errors as (

    select
        product_name,category,
        count(*) as "n_records"
    from "raw"."staging"."stg_products"
    where
        1=1
        and
    not (
        product_name is null and
        category is null

    )



    group by
        product_name,category
    having count(*) > 1

)
select * from validation_errors
',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a','test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id',NULL,'pass','test',0.18061590194702148,'2025-02-10T10:16:44.023755Z','2025-02-10T10:16:44.137628Z','2025-02-10T10:16:43.968152Z','2025-02-10T10:16:44.013463Z',1,False,'



with validation_errors as (

    select
        customer_id,order_placement_date,order_id,
        count(*) as "n_records"
    from "raw"."staging"."stg_orders"
    where
        1=1
        and
    not (
        customer_id is null and
        order_placement_date is null and
        order_id is null

    )



    group by
        customer_id,order_placement_date,order_id
    having count(*) > 1

)
select * from validation_errors
',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date',NULL,'pass','test',0.14164948463439941,'2025-02-10T10:16:44.129869Z','2025-02-10T10:16:44.154471Z','2025-02-10T10:16:44.031826Z','2025-02-10T10:16:44.119578Z',1,False,'with relation_columns as (


        select
            1 as relation_column_idx,
            cast(''ORDER_ID'' as TEXT) as relation_column
        union all

        select
            2 as relation_column_idx,
            cast(''CUSTOMER_ID'' as TEXT) as relation_column
        union all

        select
            3 as relation_column_idx,
            cast(''ORDER_PLACEMENT_DATE'' as TEXT) as relation_column


    ),
    input_columns as (


        select
            1 as input_column_idx,
            cast(''ORDER_ID'' as TEXT) as input_column
        union all

        select
            2 as input_column_idx,
            cast(''CUSTOMER_ID'' as TEXT) as input_column
        union all

        select
            3 as input_column_idx,
            cast(''ORDER_PLACEMENT_DATE'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx
    where
        -- catch any column in input list that is not in the sequence of table columns
        -- or any table column that is not in the input sequence
        r.relation_column is null or
        i.input_column is null',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category',NULL,'pass','test',0.18783807754516602,'2025-02-10T10:16:44.183403Z','2025-02-10T10:16:44.249524Z','2025-02-10T10:16:44.075694Z','2025-02-10T10:16:44.181429Z',1,False,'with relation_columns as (


        select
            1 as relation_column_idx,
            cast(''PRODUCT_ID'' as TEXT) as relation_column
        union all

        select
            2 as relation_column_idx,
            cast(''PRODUCT_NAME'' as TEXT) as relation_column
        union all

        select
            3 as relation_column_idx,
            cast(''CATEGORY'' as TEXT) as relation_column


    ),
    input_columns as (


        select
            1 as input_column_idx,
            cast(''PRODUCT_ID'' as TEXT) as input_column
        union all

        select
            2 as input_column_idx,
            cast(''PRODUCT_NAME'' as TEXT) as input_column
        union all

        select
            3 as input_column_idx,
            cast(''CATEGORY'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx
    where
        -- catch any column in input list that is not in the sequence of table columns
        -- or any table column that is not in the input sequence
        r.relation_column is null or
        i.input_column is null',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city',NULL,'pass','test',0.1913743019104004,'2025-02-10T10:16:44.234589Z','2025-02-10T10:16:44.275689Z','2025-02-10T10:16:44.111575Z','2025-02-10T10:16:44.223103Z',1,False,'with relation_columns as (


        select cast(''CUSTOMER_ID'' as TEXT) as relation_column
        union all

        select cast(''CUSTOMER_NAME'' as TEXT) as relation_column
        union all

        select cast(''CITY'' as TEXT) as relation_column


    ),
    input_columns as (


        select cast(''CUSTOMER_ID'' as TEXT) as input_column
        union all

        select cast(''CUSTOMER_NAME'' as TEXT) as input_column
        union all

        select cast(''CITY'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_columns_to_match_set_stg_dates_date',NULL,'pass','test',0.18211722373962402,'2025-02-10T10:16:44.305785Z','2025-02-10T10:16:44.333412Z','2025-02-10T10:16:44.192233Z','2025-02-10T10:16:44.302264Z',1,False,'with relation_columns as (


        select cast(''DATE'' as TEXT) as relation_column


    ),
    input_columns as (


        select cast(''DATE'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full',NULL,'pass','test',0.1555953025817871,'2025-02-10T10:16:44.317774Z','2025-02-10T10:16:44.344576Z','2025-02-10T10:16:44.203433Z','2025-02-10T10:16:44.312579Z',1,False,'with relation_columns as (


        select cast(''ORDER_ID'' as TEXT) as relation_column
        union all

        select cast(''ON_TIME'' as TEXT) as relation_column
        union all

        select cast(''IN_FULL'' as TEXT) as relation_column
        union all

        select cast(''ONTIME_IN_FULL'' as TEXT) as relation_column


    ),
    input_columns as (


        select cast(''ORDER_ID'' as TEXT) as input_column
        union all

        select cast(''ON_TIME'' as TEXT) as input_column
        union all

        select cast(''IN_FULL'' as TEXT) as input_column
        union all

        select cast(''ONTIME_IN_FULL'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1',NULL,'pass','test',0.07699346542358398,'2025-02-10T10:16:44.337685Z','2025-02-10T10:16:44.378007Z','2025-02-10T10:16:44.324601Z','2025-02-10T10:16:44.335863Z',1,False,'



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1
)
 as expression


    from "raw"."staging"."stg_dates"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1',NULL,'pass','test',0.11023664474487305,'2025-02-10T10:16:44.313934Z','2025-02-10T10:16:44.371971Z','2025-02-10T10:16:44.287190Z','2025-02-10T10:16:44.311020Z',1,False,'



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 40
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1',NULL,'pass','test',0.09761428833007812,'2025-02-10T10:16:44.435785Z','2025-02-10T10:16:44.483490Z','2025-02-10T10:16:44.409620Z','2025-02-10T10:16:44.421835Z',1,False,'



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1
)
 as expression


    from "raw"."staging"."stg_order_fulfillment"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1',NULL,'pass','test',0.1286306381225586,'2025-02-10T10:16:44.417217Z','2025-02-10T10:16:44.485031Z','2025-02-10T10:16:44.379311Z','2025-02-10T10:16:44.407821Z',1,False,'



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 10000000
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241','test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_customer_targets_customer_id',NULL,'pass','test',0.09109115600585938,'2025-02-10T10:16:44.441874Z','2025-02-10T10:16:44.486506Z','2025-02-10T10:16:44.422675Z','2025-02-10T10:16:44.438998Z',1,False,'





select customer_id
from "raw"."staging"."stg_customer_targets"
where customer_id is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1',NULL,'pass','test',0.10199427604675293,'2025-02-10T10:16:44.445653Z','2025-02-10T10:16:44.506526Z','2025-02-10T10:16:44.430240Z','2025-02-10T10:16:44.439854Z',1,False,'



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 100
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728','test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_customer_targets_infull_target',NULL,'pass','test',0.07754826545715332,'2025-02-10T10:16:44.546722Z','2025-02-10T10:16:44.580150Z','2025-02-10T10:16:44.524740Z','2025-02-10T10:16:44.533078Z',1,False,'





select infull_target
from "raw"."staging"."stg_customer_targets"
where infull_target is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108','test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_customer_targets_ontime_target',NULL,'pass','test',0.0972740650177002,'2025-02-10T10:16:44.533564Z','2025-02-10T10:16:44.589927Z','2025-02-10T10:16:44.518903Z','2025-02-10T10:16:44.531064Z',1,False,'





select ontime_target
from "raw"."staging"."stg_customer_targets"
where ontime_target is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a','test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_customer_targets_otif_target',NULL,'pass','test',0.08972477912902832,'2025-02-10T10:16:44.557156Z','2025-02-10T10:16:44.600481Z','2025-02-10T10:16:44.537696Z','2025-02-10T10:16:44.552320Z',1,False,'





select otif_target
from "raw"."staging"."stg_customer_targets"
where otif_target is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8','test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_customers_city',NULL,'pass','test',0.13816380500793457,'2025-02-10T10:16:44.553392Z','2025-02-10T10:16:44.649092Z','2025-02-10T10:16:44.542113Z','2025-02-10T10:16:44.550798Z',1,False,'





select city
from "raw"."staging"."stg_customers"
where city is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa','test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_customers_customer_id',NULL,'pass','test',0.23187613487243652,'2025-02-10T10:16:44.638734Z','2025-02-10T10:16:44.814879Z','2025-02-10T10:16:44.605195Z','2025-02-10T10:16:44.636878Z',1,False,'





select customer_id
from "raw"."staging"."stg_customers"
where customer_id is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd','test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_dates_date',NULL,'pass','test',0.20334768295288086,'2025-02-10T10:16:44.773648Z','2025-02-10T10:16:44.848352Z','2025-02-10T10:16:44.658316Z','2025-02-10T10:16:44.771377Z',1,False,'





select date
from "raw"."staging"."stg_dates"
where date is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60','test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_customers_customer_name',NULL,'pass','test',0.25294017791748047,'2025-02-10T10:16:44.669794Z','2025-02-10T10:16:44.862389Z','2025-02-10T10:16:44.625891Z','2025-02-10T10:16:44.669064Z',1,False,'





select customer_name
from "raw"."staging"."stg_customers"
where customer_name is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8','test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_order_fulfillment_in_full',NULL,'pass','test',0.16106009483337402,'2025-02-10T10:16:44.836120Z','2025-02-10T10:16:44.936532Z','2025-02-10T10:16:44.787185Z','2025-02-10T10:16:44.831030Z',1,False,'





select in_full
from "raw"."staging"."stg_order_fulfillment"
where in_full is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996','test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_order_fulfillment_on_time',NULL,'pass','test',0.189589262008667,'2025-02-10T10:16:44.929666Z','2025-02-10T10:16:45.018188Z','2025-02-10T10:16:44.873782Z','2025-02-10T10:16:44.928907Z',1,False,'





select on_time
from "raw"."staging"."stg_order_fulfillment"
where on_time is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a','test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_order_fulfillment_ontime_in_full',NULL,'pass','test',0.17235708236694336,'2025-02-10T10:16:44.938506Z','2025-02-10T10:16:45.033509Z','2025-02-10T10:16:44.884780Z','2025-02-10T10:16:44.937739Z',1,False,'





select ontime_in_full
from "raw"."staging"."stg_order_fulfillment"
where ontime_in_full is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5','test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_orders_customer_id',NULL,'pass','test',0.15883708000183105,'2025-02-10T10:16:44.956941Z','2025-02-10T10:16:45.052335Z','2025-02-10T10:16:44.921401Z','2025-02-10T10:16:44.952300Z',1,False,'





select customer_id
from "raw"."staging"."stg_orders"
where customer_id is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8','test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_orders_order_placement_date',NULL,'pass','test',0.18600916862487793,'2025-02-10T10:16:44.985354Z','2025-02-10T10:16:45.126623Z','2025-02-10T10:16:44.966981Z','2025-02-10T10:16:44.984455Z',1,False,'





select order_placement_date
from "raw"."staging"."stg_orders"
where order_placement_date is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1','test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_products_category',NULL,'pass','test',0.15607023239135742,'2025-02-10T10:16:45.168152Z','2025-02-10T10:16:45.229014Z','2025-02-10T10:16:45.082164Z','2025-02-10T10:16:45.155854Z',1,False,'





select category
from "raw"."staging"."stg_products"
where category is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3','test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_products_product_id',NULL,'pass','test',0.16640520095825195,'2025-02-10T10:16:45.161755Z','2025-02-10T10:16:45.225237Z','2025-02-10T10:16:45.101710Z','2025-02-10T10:16:45.154887Z',1,False,'





select product_id
from "raw"."staging"."stg_products"
where product_id is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939','test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'not_null_stg_products_product_name',NULL,'pass','test',0.19204974174499512,'2025-02-10T10:16:45.194352Z','2025-02-10T10:16:45.288902Z','2025-02-10T10:16:45.137559Z','2025-02-10T10:16:45.193574Z',1,False,'





select product_name
from "raw"."staging"."stg_products"
where product_name is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63','test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'primary_key_stg_order_fulfillment_order_id',NULL,'pass','test',0.178206205368042,'2025-02-10T10:16:45.211100Z','2025-02-10T10:16:45.343013Z','2025-02-10T10:16:45.176264Z','2025-02-10T10:16:45.202395Z',1,False,'

WITH validation AS (
	SELECT
		order_id AS primary_key,
		COUNT(1) AS occurrences

	FROM "raw"."staging"."stg_order_fulfillment"
	GROUP BY 1
)

SELECT *

FROM validation
WHERE primary_key IS NULL
	OR occurrences > 1

',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6','test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'primary_key_stg_orders_order_id',NULL,'pass','test',0.19957232475280762,'2025-02-10T10:16:45.308183Z','2025-02-10T10:16:45.432851Z','2025-02-10T10:16:45.251040Z','2025-02-10T10:16:45.303717Z',1,False,'

WITH validation AS (
	SELECT
		order_id AS primary_key,
		COUNT(1) AS occurrences

	FROM "raw"."staging"."stg_orders"
	GROUP BY 1
)

SELECT *

FROM validation
WHERE primary_key IS NULL
	OR occurrences > 1

',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada','test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'unique_stg_customers_customer_id',NULL,'pass','test',0.1385655403137207,'2025-02-10T10:16:45.370420Z','2025-02-10T10:16:45.440792Z','2025-02-10T10:16:45.317690Z','2025-02-10T10:16:45.369578Z',1,False,'



select
    customer_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9','test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'unique_stg_customer_targets_customer_id',NULL,'pass','test',0.2009880542755127,'2025-02-10T10:16:45.332903Z','2025-02-10T10:16:45.443426Z','2025-02-10T10:16:45.264058Z','2025-02-10T10:16:45.327368Z',1,False,'



select
    customer_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_customer_targets"
where customer_id is not null
group by customer_id
having count(*) > 1


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467','test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae','2025-02-10 10:16:46',
    current_timestamp::timestamp
,'unique_stg_products_product_id',NULL,'pass','test',0.11084961891174316,'2025-02-10T10:16:45.409750Z','2025-02-10T10:16:45.488436Z','2025-02-10T10:16:45.391378Z','2025-02-10T10:16:45.407696Z',1,False,'



select
    product_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}')

[0m10:16:48.716241 [debug] [MainThread]: SQL status: INSERT 0 58 in 0.007 seconds
[0m10:16:48.720104 [debug] [MainThread]: On master: COMMIT
[0m10:16:48.721679 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:48.722481 [debug] [MainThread]: On master: COMMIT
[0m10:16:48.727341 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m10:16:48.732200 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:
[0m10:16:48.735514 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.106811 (1 runs)
[0m10:16:48.737650 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.037070 (1 runs)
[0m10:16:48.740025 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.001102 (1 runs)
[0m10:16:48.742362 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:01.542516 (58 runs)
[0m10:16:48.745182 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:01.617697 (1 runs)
[0m10:16:48.747489 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.021491 (1 runs)
[0m10:16:48.750168 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.commit: 0:00:00.009351 (1 runs)
[0m10:16:48.752227 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:01.726892 (1 runs)
[0m10:16:48.753707 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:01.863579 (1 runs)
[0m10:16:48.755198 [debug] [MainThread]: Elementary: Uploaded run results successfully.
[0m10:16:48.771758 [debug] [MainThread]: Elementary: Handling test results.
[0m10:16:49.199976 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:49.201373 [debug] [MainThread]: On master: BEGIN
[0m10:16:49.202785 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:16:49.203861 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:49.211194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'elementary_test_results'

        and table_schema = 'elementary'

      order by ordinal_position


[0m10:16:49.239073 [debug] [MainThread]: SQL status: SELECT 28 in 0.016 seconds
[0m10:16:49.258869 [debug] [MainThread]: Elementary: Inserting 58 rows to table "raw"."elementary"."elementary_test_results"
[0m10:16:50.883051 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m10:16:50.885347 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:50.892315 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */


       insert into "raw"."elementary"."elementary_test_results"
         (id,data_issue_id,test_execution_id,test_unique_id,model_unique_id,invocation_id,detected_at,created_at,database_name,schema_name,table_name,column_name,test_type,test_sub_type,test_results_description,owners,tags,test_results_query,other,test_name,test_params,severity,status,failures,test_short_name,test_alias,result_rows,failed_row_count) values
    ('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95','model.nexabrands_dbt.stg_order_fulfillment','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','on_time','dbt_test','generic',NULL,'[]','[]','



with all_values as (

    select
        on_time as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by on_time

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',NULL,'accepted_values_stg_order_fulfillment_on_time__True__0__1','{"values": [0, 1], "quote": true, "column_name": "on_time", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'accepted_values','accepted_values_stg_order_fulfillment_on_time__True__0__1',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630','model.nexabrands_dbt.stg_order_fulfillment','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','in_full','dbt_test','generic',NULL,'[]','[]','



with all_values as (

    select
        in_full as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by in_full

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',NULL,'accepted_values_stg_order_fulfillment_in_full__True__0__1','{"values": [0, 1], "quote": true, "column_name": "in_full", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'accepted_values','accepted_values_stg_order_fulfillment_in_full__True__0__1',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73','model.nexabrands_dbt.stg_order_fulfillment','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','ontime_in_full','dbt_test','generic',NULL,'[]','[]','



with all_values as (

    select
        ontime_in_full as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by ontime_in_full

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',NULL,'accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1','{"values": [0, 1], "quote": true, "column_name": "ontime_in_full", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'accepted_values','accepted_values_stg_order_fulf_04ff2bb97b4eb37802ca1fb38147b18b',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e','test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e','model.nexabrands_dbt.stg_customers','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','city','dbt_test','generic',NULL,'[]','[]','



with all_values as (

    select
        city as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_customers"
    group by city

)

select *
from all_values
where value_field not in (
    ''Klerksdorp'',''Polokwane'',''Stellenbosch'',''Paarl'',''East London'',''Grahamstown'',''George'',''Upington'',''Bloemfontein'',''Worcester'',''Pietermaritzburg'',''Pretoria'',''Nelspruit'',''Kimberley'',''Johannesburg'',''Cape Town''
)


',NULL,'accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town','{"values": ["Klerksdorp", "Polokwane", "Stellenbosch", "Paarl", "East London", "Grahamstown", "George", "Upington", "Bloemfontein", "Worcester", "Pietermaritzburg", "Pretoria", "Nelspruit", "Kimberley", "Johannesburg", "Cape Town"], "quote": true, "column_name": "city", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'accepted_values','accepted_values_stg_customers_a11ae74a9713a9aa51bccac4422d6868',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575','test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575','model.nexabrands_dbt.stg_products','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','category','dbt_test','generic',NULL,'[]','[]','



with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_products"
    group by category

)

select *
from all_values
where value_field not in (
    ''Dairy'',''beverages'',''Food''
)


',NULL,'accepted_values_stg_products_category__Dairy__beverages__Food','{"values": ["Dairy", "beverages", "Food"], "column_name": "category", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'accepted_values','accepted_values_stg_products_category__Dairy__beverages__Food',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc','test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc','model.nexabrands_dbt.stg_customer_targets','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets',NULL,'dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select



  ontime_target >= otif_target as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True','{"column_A": "ontime_target", "column_B": "otif_target", "or_equal": true, "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'expect_column_pair_values_A_to_be_greater_than_B','dbt_expectations_expect_column_5118ea56378d56fb0cad08c9d352485a',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478','test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478','model.nexabrands_dbt.stg_customer_targets','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets',NULL,'dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select



  infull_target >= otif_target as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True','{"column_A": "infull_target", "column_B": "otif_target", "or_equal": true, "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'expect_column_pair_values_A_to_be_greater_than_B','dbt_expectations_expect_column_9b169ad9eac85f6a49ea6c376dd6e4ec',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182','model.nexabrands_dbt.stg_customers','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','city','dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select




( 1=1 and length(
        city
    ) >= 2 and length(
        city
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',NULL,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2','{"min_value": 2, "max_value": 50, "column_name": "city", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'expect_column_value_lengths_to_be_between','dbt_expectations_expect_column_403f18a3c9e0d04c6b9349a550b7eb3f',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf','model.nexabrands_dbt.stg_customers','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','customer_name','dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select




( 1=1 and length(
        customer_name
    ) >= 2 and length(
        customer_name
    ) <= 100
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',NULL,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2','{"min_value": 2, "max_value": 100, "column_name": "customer_name", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'expect_column_value_lengths_to_be_between','dbt_expectations_expect_column_b21fb3cea116e61a8bcc4c1962a96616',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db','model.nexabrands_dbt.stg_orders','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders','order_id','dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select




( 1=1 and length(
        order_id
    ) >= 1 and length(
        order_id
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',NULL,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1','{"min_value": 1, "max_value": 50, "column_name": "order_id", "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'expect_column_value_lengths_to_be_between','dbt_expectations_expect_column_24d6f8b120f055b64ef4ed7ed3d53acb',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012','model.nexabrands_dbt.stg_orders','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders','customer_id','dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select




( 1=1 and length(
        customer_id
    ) >= 1 and length(
        customer_id
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',NULL,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1','{"min_value": 1, "max_value": 50, "column_name": "customer_id", "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'expect_column_value_lengths_to_be_between','dbt_expectations_expect_column_0dc13966be4c7aca951937ba4bb76c9a',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2','model.nexabrands_dbt.stg_products','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','category','dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select




( 1=1 and length(
        category
    ) >= 2 and length(
        category
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',NULL,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2','{"min_value": 2, "max_value": 50, "column_name": "category", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_column_value_lengths_to_be_between','dbt_expectations_expect_column_c8b2251fe2fa0c3fec399bb3cfce08e7',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710','model.nexabrands_dbt.stg_products','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','product_name','dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select




( 1=1 and length(
        product_name
    ) >= 1 and length(
        product_name
    ) <= 100
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',NULL,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1','{"min_value": 1, "max_value": 100, "column_name": "product_name", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_column_value_lengths_to_be_between','dbt_expectations_expect_column_28b9f971af35df2e1c062af316d4438b',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63','model.nexabrands_dbt.stg_dates','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_dates','date','dbt_test','expectation',NULL,'[]','[]','




    with grouped_expression as (
    select





    length(
        date
    ) = 10 as expression


    from "raw"."staging"."stg_dates"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10','{"value": 10, "column_name": "date", "model": "{{ get_where_subquery(ref(''stg_dates'')) }}"}','warn','pass',0,'expect_column_value_lengths_to_equal','dbt_expectations_expect_column_2e1f04256a3bdef6d9e60546966ce694',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5','model.nexabrands_dbt.stg_customer_targets','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','infull_target','dbt_test','expectation',NULL,'[]','[]','






    with grouped_expression as (
    select




( 1=1 and infull_target >= 0 and infull_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',NULL,'dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0','{"min_value": 0, "max_value": 100, "column_name": "infull_target", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'expect_column_values_to_be_between','dbt_expectations_expect_column_92ed44125b24680cf5fd53215584233f',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6','model.nexabrands_dbt.stg_customer_targets','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','ontime_target','dbt_test','expectation',NULL,'[]','[]','






    with grouped_expression as (
    select




( 1=1 and ontime_target >= 0 and ontime_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',NULL,'dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0','{"min_value": 0, "max_value": 100, "column_name": "ontime_target", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'expect_column_values_to_be_between','dbt_expectations_expect_column_c37238951ff6a9df0fa361701d957c06',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69','model.nexabrands_dbt.stg_customer_targets','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','otif_target','dbt_test','expectation',NULL,'[]','[]','






    with grouped_expression as (
    select




( 1=1 and otif_target >= 0 and otif_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',NULL,'dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0','{"min_value": 0, "max_value": 100, "column_name": "otif_target", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'expect_column_values_to_be_between','dbt_expectations_expect_column_7e0fb491e8e984b8096010a9ad4ef898',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed','model.nexabrands_dbt.stg_products','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','product_id','dbt_test','expectation',NULL,'[]','[]','






    with grouped_expression as (
    select




( 1=1 and product_id > 1
)
 as expression


    from "raw"."staging"."stg_products"
    where
        product_id IS NOT NULL



),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',NULL,'dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True','{"min_value": 1, "row_condition": "product_id IS NOT NULL", "strictly": true, "column_name": "product_id", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_column_values_to_be_between','dbt_expectations_expect_column_13b0887fde6ea84df52530caacf44573',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386','model.nexabrands_dbt.stg_orders','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders','order_placement_date','dbt_test','expectation',NULL,'[]','[]','






    with grouped_expression as (
    select




( 1=1 and order_placement_date >= ''2024-01-01'' and order_placement_date <= current_date
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',NULL,'dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_','{"min_value": "''2024-01-01''", "max_value": "current_date", "column_name": "order_placement_date", "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'expect_column_values_to_be_between','dbt_expectations_expect_column_409d93b693cbb12b199565006e77047a',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10','model.nexabrands_dbt.stg_products','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','category','dbt_test','expectation',NULL,'[]','[]','

with all_values as (

    select
        category as value_field

    from "raw"."staging"."stg_products"


),
set_values as (

    select
        cast(''Dairy'' as TEXT) as value_field
    union all
    select
        cast(''beverages'' as TEXT) as value_field
    union all
    select
        cast(''Food'' as TEXT) as value_field


),
validation_errors as (
    -- values from the model that are not in the set
    select
        v.value_field
    from
        all_values v
        left join
        set_values s on v.value_field = s.value_field
    where
        s.value_field is null

)

select *
from validation_errors

',NULL,'dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food','{"value_set": ["Dairy", "beverages", "Food"], "column_name": "category", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_column_values_to_be_in_set','dbt_expectations_expect_column_e007770c70acc1cacd84b4bc32225097',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0','model.nexabrands_dbt.stg_orders','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders','order_placement_date','dbt_test','expectation',NULL,'[]','[]','with relation_columns as (


        select
            cast(''ORDER_ID'' as TEXT) as relation_column,
            cast(''TEXT'' as TEXT) as relation_column_type
        union all

        select
            cast(''CUSTOMER_ID'' as TEXT) as relation_column,
            cast(''TEXT'' as TEXT) as relation_column_type
        union all

        select
            cast(''ORDER_PLACEMENT_DATE'' as TEXT) as relation_column,
            cast(''DATE'' as TEXT) as relation_column_type


    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = ''ORDER_PLACEMENT_DATE''
            and
            relation_column_type not in (''DATE'')

    )
    select *
    from test_data',NULL,'dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date','{"column_type": "date", "column_name": "order_placement_date", "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'expect_column_values_to_be_of_type','dbt_expectations_expect_column_3eed0db1b7cb49ee8c04627bc30b4059',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828','model.nexabrands_dbt.stg_customers','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','customer_name','dbt_test','expectation',NULL,'[]','[]','




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(customer_name, ''^[A-Za-z0-9\s\-\.]+$'', '''')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_','{"regex": "^[A-Za-z0-9\\s\\-\\.]+$", "column_name": "customer_name", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'expect_column_values_to_match_regex','dbt_expectations_expect_column_49aa95aecd296f28018254cac402e9da',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39','model.nexabrands_dbt.stg_customers','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','city','dbt_test','expectation',NULL,'[]','[]','




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(city, ''^[A-Za-z\s\-\.]+$'', '''')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_','{"regex": "^[A-Za-z\\s\\-\\.]+$", "column_name": "city", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'expect_column_values_to_match_regex','dbt_expectations_expect_column_37daf38b3f95e5561c473a8d803a9133',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86','model.nexabrands_dbt.stg_order_fulfillment','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','order_id','dbt_test','expectation',NULL,'[]','[]','




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(order_id, ''^[A-Za-z0-9\-_]+$'', '''')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_order_fulfillment"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___','{"regex": "^[A-Za-z0-9\\-_]+$", "column_name": "order_id", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'expect_column_values_to_match_regex','dbt_expectations_expect_column_f3be49ab72b7b434af26d1e21a87faef',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908','model.nexabrands_dbt.stg_products','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','product_name','dbt_test','expectation',NULL,'[]','[]','




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(product_name, ''^\\s*$'', '''')), 1), 0)


 = 0
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_','{"regex": "^\\\\s*$", "column_name": "product_name", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_column_values_to_not_match_regex','dbt_expectations_expect_column_cdb611b836b2688162293f0a40d06eeb',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419','test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419','model.nexabrands_dbt.stg_products','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products',NULL,'dbt_test','expectation',NULL,'[]','[]','



with validation_errors as (

    select
        product_name,category,
        count(*) as "n_records"
    from "raw"."staging"."stg_products"
    where
        1=1
        and
    not (
        product_name is null and
        category is null

    )



    group by
        product_name,category
    having count(*) > 1

)
select * from validation_errors
',NULL,'dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category','{"column_list": ["product_name", "category"], "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_compound_columns_to_be_unique','dbt_expectations_expect_compou_3e423aa6dd2c92095dc7c3d71b929a00',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a','test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a','model.nexabrands_dbt.stg_orders','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders',NULL,'dbt_test','expectation',NULL,'[]','[]','



with validation_errors as (

    select
        customer_id,order_placement_date,order_id,
        count(*) as "n_records"
    from "raw"."staging"."stg_orders"
    where
        1=1
        and
    not (
        customer_id is null and
        order_placement_date is null and
        order_id is null

    )



    group by
        customer_id,order_placement_date,order_id
    having count(*) > 1

)
select * from validation_errors
',NULL,'dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id','{"column_list": ["customer_id", "order_placement_date", "order_id"], "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'expect_compound_columns_to_be_unique','dbt_expectations_expect_compou_cc2740621c79336532fe5b448e893219',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404','model.nexabrands_dbt.stg_orders','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders',NULL,'dbt_test','expectation',NULL,'[]','[]','with relation_columns as (


        select
            1 as relation_column_idx,
            cast(''ORDER_ID'' as TEXT) as relation_column
        union all

        select
            2 as relation_column_idx,
            cast(''CUSTOMER_ID'' as TEXT) as relation_column
        union all

        select
            3 as relation_column_idx,
            cast(''ORDER_PLACEMENT_DATE'' as TEXT) as relation_column


    ),
    input_columns as (


        select
            1 as input_column_idx,
            cast(''ORDER_ID'' as TEXT) as input_column
        union all

        select
            2 as input_column_idx,
            cast(''CUSTOMER_ID'' as TEXT) as input_column
        union all

        select
            3 as input_column_idx,
            cast(''ORDER_PLACEMENT_DATE'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx
    where
        -- catch any column in input list that is not in the sequence of table columns
        -- or any table column that is not in the input sequence
        r.relation_column is null or
        i.input_column is null',NULL,'dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date','{"column_list": ["order_id", "customer_id", "order_placement_date"], "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'expect_table_columns_to_match_ordered_list','dbt_expectations_expect_table__90495e7a5a0a4bba36425a1a78f198be',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602','model.nexabrands_dbt.stg_products','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products',NULL,'dbt_test','expectation',NULL,'[]','[]','with relation_columns as (


        select
            1 as relation_column_idx,
            cast(''PRODUCT_ID'' as TEXT) as relation_column
        union all

        select
            2 as relation_column_idx,
            cast(''PRODUCT_NAME'' as TEXT) as relation_column
        union all

        select
            3 as relation_column_idx,
            cast(''CATEGORY'' as TEXT) as relation_column


    ),
    input_columns as (


        select
            1 as input_column_idx,
            cast(''PRODUCT_ID'' as TEXT) as input_column
        union all

        select
            2 as input_column_idx,
            cast(''PRODUCT_NAME'' as TEXT) as input_column
        union all

        select
            3 as input_column_idx,
            cast(''CATEGORY'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx
    where
        -- catch any column in input list that is not in the sequence of table columns
        -- or any table column that is not in the input sequence
        r.relation_column is null or
        i.input_column is null',NULL,'dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category','{"column_list": ["product_id", "product_name", "category"], "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_table_columns_to_match_ordered_list','dbt_expectations_expect_table__f7fdf9cc34bf79cb7f9015811d9e5b7c',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d','model.nexabrands_dbt.stg_customers','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers',NULL,'dbt_test','expectation',NULL,'[]','[]','with relation_columns as (


        select cast(''CUSTOMER_ID'' as TEXT) as relation_column
        union all

        select cast(''CUSTOMER_NAME'' as TEXT) as relation_column
        union all

        select cast(''CITY'' as TEXT) as relation_column


    ),
    input_columns as (


        select cast(''CUSTOMER_ID'' as TEXT) as input_column
        union all

        select cast(''CUSTOMER_NAME'' as TEXT) as input_column
        union all

        select cast(''CITY'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null',NULL,'dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city','{"column_list": ["customer_id", "customer_name", "city"], "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'expect_table_columns_to_match_set','dbt_expectations_expect_table__c671e6c8880679154e0c08b03b908b76',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06','model.nexabrands_dbt.stg_dates','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:48' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_dates',NULL,'dbt_test','expectation',NULL,'[]','[]','with relation_columns as (


        select cast(''DATE'' as TEXT) as relation_column


    ),
    input_columns as (


        select cast(''DATE'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null',NULL,'dbt_expectations_expect_table_columns_to_match_set_stg_dates_date','{"column_list": ["date"], "model": "{{ get_where_subquery(ref(''stg_dates'')) }}"}','warn','pass',0,'expect_table_columns_to_match_set','dbt_expectations_expect_table__7a72d20b0feff6046903efc48c05244a',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185','model.nexabrands_dbt.stg_order_fulfillment','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment',NULL,'dbt_test','expectation',NULL,'[]','[]','with relation_columns as (


        select cast(''ORDER_ID'' as TEXT) as relation_column
        union all

        select cast(''ON_TIME'' as TEXT) as relation_column
        union all

        select cast(''IN_FULL'' as TEXT) as relation_column
        union all

        select cast(''ONTIME_IN_FULL'' as TEXT) as relation_column


    ),
    input_columns as (


        select cast(''ORDER_ID'' as TEXT) as input_column
        union all

        select cast(''ON_TIME'' as TEXT) as input_column
        union all

        select cast(''IN_FULL'' as TEXT) as input_column
        union all

        select cast(''ONTIME_IN_FULL'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null',NULL,'dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full','{"column_list": ["order_id", "on_time", "in_full", "ontime_in_full"], "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'expect_table_columns_to_match_set','dbt_expectations_expect_table__a9b6ee92f6a580f2bedcd5ac7a609c6e',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a','model.nexabrands_dbt.stg_dates','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_dates',NULL,'dbt_test','expectation',NULL,'[]','[]','



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1
)
 as expression


    from "raw"."staging"."stg_dates"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',NULL,'dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1','{"min_value": 1, "model": "{{ get_where_subquery(ref(''stg_dates'')) }}"}','warn','pass',0,'expect_table_row_count_to_be_between','dbt_expectations_expect_table__2b508938b40be8d3bba14b6d451c1f36',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc','model.nexabrands_dbt.stg_customers','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers',NULL,'dbt_test','expectation',NULL,'[]','[]','



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 40
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',NULL,'dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1','{"min_value": 1, "max_value": 40, "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'expect_table_row_count_to_be_between','dbt_expectations_expect_table__5a69b43933dcbf22ebff9eb25f9435b0',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212','model.nexabrands_dbt.stg_order_fulfillment','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment',NULL,'dbt_test','expectation',NULL,'[]','[]','



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1
)
 as expression


    from "raw"."staging"."stg_order_fulfillment"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',NULL,'dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1','{"min_value": 1, "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'expect_table_row_count_to_be_between','dbt_expectations_expect_table__e1bf090b95002c3ef95b01b652a78e66',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3','model.nexabrands_dbt.stg_orders','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders',NULL,'dbt_test','expectation',NULL,'[]','[]','



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 10000000
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',NULL,'dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1','{"min_value": 1, "max_value": 10000000, "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'expect_table_row_count_to_be_between','dbt_expectations_expect_table__6c04b1a1efe7977e3189026354d032ef',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241','test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241','model.nexabrands_dbt.stg_customer_targets','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','customer_id','dbt_test','generic',NULL,'[]','[]','





select customer_id
from "raw"."staging"."stg_customer_targets"
where customer_id is null


',NULL,'not_null_stg_customer_targets_customer_id','{"column_name": "customer_id", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'not_null','not_null_stg_customer_targets_customer_id',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191','model.nexabrands_dbt.stg_products','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products',NULL,'dbt_test','expectation',NULL,'[]','[]','



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 100
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',NULL,'dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1','{"min_value": 1, "max_value": 100, "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'expect_table_row_count_to_be_between','dbt_expectations_expect_table__df878d5d68d5c994b7f7b419d288917e',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728','test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728','model.nexabrands_dbt.stg_customer_targets','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','infull_target','dbt_test','generic',NULL,'[]','[]','





select infull_target
from "raw"."staging"."stg_customer_targets"
where infull_target is null


',NULL,'not_null_stg_customer_targets_infull_target','{"column_name": "infull_target", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'not_null','not_null_stg_customer_targets_infull_target',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108','test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108','model.nexabrands_dbt.stg_customer_targets','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','ontime_target','dbt_test','generic',NULL,'[]','[]','





select ontime_target
from "raw"."staging"."stg_customer_targets"
where ontime_target is null


',NULL,'not_null_stg_customer_targets_ontime_target','{"column_name": "ontime_target", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'not_null','not_null_stg_customer_targets_ontime_target',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a','test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a','model.nexabrands_dbt.stg_customer_targets','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','otif_target','dbt_test','generic',NULL,'[]','[]','





select otif_target
from "raw"."staging"."stg_customer_targets"
where otif_target is null


',NULL,'not_null_stg_customer_targets_otif_target','{"column_name": "otif_target", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'not_null','not_null_stg_customer_targets_otif_target',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8','test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8','model.nexabrands_dbt.stg_customers','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','city','dbt_test','generic',NULL,'[]','[]','





select city
from "raw"."staging"."stg_customers"
where city is null


',NULL,'not_null_stg_customers_city','{"column_name": "city", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'not_null','not_null_stg_customers_city',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa','test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa','model.nexabrands_dbt.stg_customers','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','customer_id','dbt_test','generic',NULL,'[]','[]','





select customer_id
from "raw"."staging"."stg_customers"
where customer_id is null


',NULL,'not_null_stg_customers_customer_id','{"column_name": "customer_id", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'not_null','not_null_stg_customers_customer_id',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd','test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd','model.nexabrands_dbt.stg_dates','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_dates','date','dbt_test','generic',NULL,'[]','[]','





select date
from "raw"."staging"."stg_dates"
where date is null


',NULL,'not_null_stg_dates_date','{"column_name": "date", "model": "{{ get_where_subquery(ref(''stg_dates'')) }}"}','warn','pass',0,'not_null','not_null_stg_dates_date',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60','test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60','model.nexabrands_dbt.stg_customers','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','customer_name','dbt_test','generic',NULL,'[]','[]','





select customer_name
from "raw"."staging"."stg_customers"
where customer_name is null


',NULL,'not_null_stg_customers_customer_name','{"column_name": "customer_name", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'not_null','not_null_stg_customers_customer_name',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8','test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8','model.nexabrands_dbt.stg_order_fulfillment','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','in_full','dbt_test','generic',NULL,'[]','[]','





select in_full
from "raw"."staging"."stg_order_fulfillment"
where in_full is null


',NULL,'not_null_stg_order_fulfillment_in_full','{"column_name": "in_full", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'not_null','not_null_stg_order_fulfillment_in_full',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996','test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996','model.nexabrands_dbt.stg_order_fulfillment','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','on_time','dbt_test','generic',NULL,'[]','[]','





select on_time
from "raw"."staging"."stg_order_fulfillment"
where on_time is null


',NULL,'not_null_stg_order_fulfillment_on_time','{"column_name": "on_time", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'not_null','not_null_stg_order_fulfillment_on_time',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a','test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a','model.nexabrands_dbt.stg_order_fulfillment','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','ontime_in_full','dbt_test','generic',NULL,'[]','[]','





select ontime_in_full
from "raw"."staging"."stg_order_fulfillment"
where ontime_in_full is null


',NULL,'not_null_stg_order_fulfillment_ontime_in_full','{"column_name": "ontime_in_full", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'not_null','not_null_stg_order_fulfillment_ontime_in_full',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5','test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5','model.nexabrands_dbt.stg_orders','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders','customer_id','dbt_test','generic',NULL,'[]','[]','





select customer_id
from "raw"."staging"."stg_orders"
where customer_id is null


',NULL,'not_null_stg_orders_customer_id','{"column_name": "customer_id", "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'not_null','not_null_stg_orders_customer_id',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8','test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8','model.nexabrands_dbt.stg_orders','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders','order_placement_date','dbt_test','generic',NULL,'[]','[]','





select order_placement_date
from "raw"."staging"."stg_orders"
where order_placement_date is null


',NULL,'not_null_stg_orders_order_placement_date','{"column_name": "order_placement_date", "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','warn','pass',0,'not_null','not_null_stg_orders_order_placement_date',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1','test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1','model.nexabrands_dbt.stg_products','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','category','dbt_test','generic',NULL,'[]','[]','





select category
from "raw"."staging"."stg_products"
where category is null


',NULL,'not_null_stg_products_category','{"column_name": "category", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_products_category',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3','test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3','model.nexabrands_dbt.stg_products','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','product_id','dbt_test','generic',NULL,'[]','[]','





select product_id
from "raw"."staging"."stg_products"
where product_id is null


',NULL,'not_null_stg_products_product_id','{"column_name": "product_id", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_products_product_id',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939','test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939','model.nexabrands_dbt.stg_products','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','product_name','dbt_test','generic',NULL,'[]','[]','





select product_name
from "raw"."staging"."stg_products"
where product_name is null


',NULL,'not_null_stg_products_product_name','{"column_name": "product_name", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','warn','pass',0,'not_null','not_null_stg_products_product_name',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63','test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63','model.nexabrands_dbt.stg_order_fulfillment','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','order_id','dbt_test','generic',NULL,'[]','[]','

WITH validation AS (
	SELECT
		order_id AS primary_key,
		COUNT(1) AS occurrences

	FROM "raw"."staging"."stg_order_fulfillment"
	GROUP BY 1
)

SELECT *

FROM validation
WHERE primary_key IS NULL
	OR occurrences > 1

',NULL,'primary_key_stg_order_fulfillment_order_id','{"column_name": "order_id", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','error','pass',0,'primary_key','primary_key_stg_order_fulfillment_order_id',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6','test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6','model.nexabrands_dbt.stg_orders','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_orders','order_id','dbt_test','generic',NULL,'[]','[]','

WITH validation AS (
	SELECT
		order_id AS primary_key,
		COUNT(1) AS occurrences

	FROM "raw"."staging"."stg_orders"
	GROUP BY 1
)

SELECT *

FROM validation
WHERE primary_key IS NULL
	OR occurrences > 1

',NULL,'primary_key_stg_orders_order_id','{"column_name": "order_id", "model": "{{ get_where_subquery(ref(''stg_orders'')) }}"}','error','pass',0,'primary_key','primary_key_stg_orders_order_id',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada','test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada','model.nexabrands_dbt.stg_customers','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','customer_id','dbt_test','generic',NULL,'[]','[]','



select
    customer_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1


',NULL,'unique_stg_customers_customer_id','{"column_name": "customer_id", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'unique','unique_stg_customers_customer_id',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9','test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9','model.nexabrands_dbt.stg_customer_targets','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets','customer_id','dbt_test','generic',NULL,'[]','[]','



select
    customer_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_customer_targets"
where customer_id is not null
group by customer_id
having count(*) > 1


',NULL,'unique_stg_customer_targets_customer_id','{"column_name": "customer_id", "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'unique','unique_stg_customer_targets_customer_id',NULL,NULL),('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467',NULL,'65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae.test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467','test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467','model.nexabrands_dbt.stg_products','65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',cast('2025-02-10 10:16:49' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_products','product_id','dbt_test','generic',NULL,'[]','[]','



select
    product_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1


',NULL,'unique_stg_products_product_id','{"column_name": "product_id", "model": "{{ get_where_subquery(ref(''stg_products'')) }}"}','ERROR','pass',0,'unique','unique_stg_products_product_id',NULL,NULL)

[0m10:16:50.902498 [debug] [MainThread]: SQL status: INSERT 0 58 in 0.003 seconds
[0m10:16:50.904840 [debug] [MainThread]: On master: COMMIT
[0m10:16:50.905394 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:50.905896 [debug] [MainThread]: On master: COMMIT
[0m10:16:50.908152 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m10:16:50.909751 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m10:16:50.924863 [debug] [MainThread]: Elementary: Uploading dbt invocation.
[0m10:16:50.985676 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:50.986519 [debug] [MainThread]: On master: BEGIN
[0m10:16:50.987409 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:16:50.988096 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:50.993093 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_invocations'

        and table_schema = 'elementary'

      order by ordinal_position


[0m10:16:51.000701 [debug] [MainThread]: SQL status: SELECT 35 in 0.003 seconds
[0m10:16:51.008990 [debug] [MainThread]: Elementary: Inserting 1 rows to table "raw"."elementary"."dbt_invocations"
[0m10:16:51.028206 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m10:16:51.029543 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:51.030434 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */


       insert into "raw"."elementary"."dbt_invocations"
         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values
    ('65aa6193-7fb5-4df8-ad6f-2a4cf9cd33ae',NULL,NULL,NULL,'2025-02-10 10:16:41','2025-02-10 10:16:50','2025-02-10 10:16:50',
    current_timestamp::timestamp
,'test','1.9.2','0.16.4',False,'{}','{"dbt_date": {"time_zone": "UTC"}}','dev','raw','raw','nexabrands_dbt',4,'[]',NULL,'Ajay263/pyspark_practice-','nexabrands_dbt',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'{"user": "root"}')

[0m10:16:51.031602 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.000 seconds
[0m10:16:51.033624 [debug] [MainThread]: On master: COMMIT
[0m10:16:51.034152 [debug] [MainThread]: Using postgres connection "master"
[0m10:16:51.034644 [debug] [MainThread]: On master: COMMIT
[0m10:16:51.035863 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:16:51.037430 [debug] [MainThread]: Elementary: Uploaded dbt invocation successfully.
[0m10:16:51.044373 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m10:16:51.045434 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]
[0m10:16:51.046198 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-end.0 ........................................ [[32mOK[0m in 5.51s]
[0m10:16:51.046811 [debug] [MainThread]: On master: Close
[0m10:16:51.047478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:16:51.048094 [debug] [MainThread]: Connection 'test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m10:16:51.048776 [debug] [MainThread]: Connection 'test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6' was properly closed.
[0m10:16:51.049328 [debug] [MainThread]: Connection 'test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m10:16:51.049866 [debug] [MainThread]: Connection 'test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9' was properly closed.
[0m10:16:51.050561 [info ] [MainThread]:
[0m10:16:51.052064 [info ] [MainThread]: Finished running 2 project hooks, 58 data tests in 0 hours 0 minutes and 8.26 seconds (8.26s).
[0m10:16:51.062337 [debug] [MainThread]: Command end result
[0m10:16:51.155351 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m10:16:51.158103 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m10:16:51.166680 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m10:16:51.167221 [info ] [MainThread]:
[0m10:16:51.167847 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:16:51.168407 [info ] [MainThread]:
[0m10:16:51.168978 [info ] [MainThread]: Done. PASS=60 WARN=0 ERROR=0 SKIP=0 TOTAL=60
[0m10:16:51.170189 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.679406, "process_in_blocks": "0", "process_kernel_time": 1.383773, "process_mem_max_rss": "126532", "process_out_blocks": "10848", "process_user_time": 8.225333}
[0m10:16:51.170763 [debug] [MainThread]: Command `dbt test` succeeded at 10:16:51.170646 after 9.68 seconds
[0m10:16:51.171279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04c89db110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04c9a40f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04c41271a0>]}
[0m10:16:51.171796 [debug] [MainThread]: Flushing usage events
[0m10:16:52.942850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:25:07.187383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74976cc8a660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74976be77c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74976bb01a00>]}


============================== 10:25:07.190689 | a80cf11c-4976-4753-a00b-e74cd47169f1 ==============================
[0m10:25:07.190689 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:25:07.191461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'profiles_dir': '/home/codespace/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m10:25:07.481875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a80cf11c-4976-4753-a00b-e74cd47169f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74976b471250>]}
[0m10:25:07.574716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a80cf11c-4976-4753-a00b-e74cd47169f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74976b62bf80>]}
[0m10:25:07.576063 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:25:07.800154 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:25:08.174484 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading nexabrands_dbt: staging/stg_customer_targets_schema.yml - Runtime Error
    Syntax error near line 66
    ------------------------------
    63 |   - elementary.freshness_anomalies:
    64 |       timestamp_column: "modifieddate" # optional
    65 |   # Use tags to run elementary data tests on a dedicated run
    66 |   tags: ["elementary"]
    67 |   config: # optional
    68 |     severity: warn
    69 |   - elementary.volume_anomalies:

    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 61, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 66, column 3
[0m10:25:08.177452 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.0468404, "process_in_blocks": "0", "process_kernel_time": 0.201151, "process_mem_max_rss": "105420", "process_out_blocks": "8", "process_user_time": 2.045191}
[0m10:25:08.178417 [debug] [MainThread]: Command `dbt test` failed at 10:25:08.178259 after 1.05 seconds
[0m10:25:08.179222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74976bfb35c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749769de0710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74976b4ffd10>]}
[0m10:25:08.180075 [debug] [MainThread]: Flushing usage events
[0m10:25:08.976180 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:27:40.084983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e9e21f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e9c84e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e9d9e4710>]}


============================== 10:27:40.088267 | 82ad4d7a-24f0-44df-91c3-9581eb878934 ==============================
[0m10:27:40.088267 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:27:40.089134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/codespace/.dbt', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:27:40.303560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82ad4d7a-24f0-44df-91c3-9581eb878934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e9c96b710>]}
[0m10:27:40.377517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82ad4d7a-24f0-44df-91c3-9581eb878934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e9c96abd0>]}
[0m10:27:40.378480 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:27:40.511226 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:27:40.745644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:27:40.746846 [info ] [MainThread]: Unable to do partial parsing because an error occurred. Switching to full reparse.
[0m10:27:40.749576 [debug] [MainThread]: Partial parsing exception processing file nexabrands_dbt://models/staging/stg_customer_targets_schema.yml
[0m10:27:40.750168 [debug] [MainThread]: PP exception info: {'code': 'new_elements_by_name[element["name"]] = element', 'parse_file_type': 'schema', 'exception': "KeyError: 'name'", 'location': 'line 769 in get_diff_for', 'traceback': 'Traceback (most recent call last):\n  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 537, in safe_update_project_parser_files_partially\n    project_parser_files = self.partial_parser.get_parsing_files()\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/parser/partial.py", line 181, in get_parsing_files\n    self.change_schema_file(file_id)\n  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/parser/partial.py", line 626, in change_schema_file\n    self.handle_schema_file_changes(saved_schema_file, saved_yaml_dict, new_yaml_dict)\n  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/parser/partial.py", line 728, in handle_schema_file_changes\n    handle_change("data_tests", self.delete_schema_data_test_patch)\n  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/parser/partial.py", line 717, in handle_change\n    self._handle_element_change(\n  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/parser/partial.py", line 733, in _handle_element_change\n    element_diff = self.get_diff_for(dict_key, saved_yaml_dict, new_yaml_dict)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/parser/partial.py", line 769, in get_diff_for\n    new_elements_by_name[element["name"]] = element\n                         ~~~~~~~^^^^^^^^\nKeyError: \'name\'\n'}
[0m10:27:40.750805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82ad4d7a-24f0-44df-91c3-9581eb878934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e9b488fe0>]}
[0m10:27:46.652386 [warn ] [MainThread]: Unable to parse 'data_tests' section of file 'models/staging/stg_customer_targets_schema.yml'
Parsing Error
  Entry did not contain a name
[0m10:27:47.377699 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- data_tests.nexabrands_dbt.marts
[0m10:27:47.401937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82ad4d7a-24f0-44df-91c3-9581eb878934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e9a34d820>]}
[0m10:27:47.856381 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m10:27:47.862476 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m10:27:47.909254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82ad4d7a-24f0-44df-91c3-9581eb878934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e9b204d70>]}
[0m10:27:47.910230 [info ] [MainThread]: Found 45 models, 2 snapshots, 60 data tests, 2 operations, 7 sources, 1529 macros
[0m10:27:47.911031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82ad4d7a-24f0-44df-91c3-9581eb878934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e9a467560>]}
[0m10:27:47.919115 [info ] [MainThread]:
[0m10:27:47.919959 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:27:47.920805 [info ] [MainThread]:
[0m10:27:47.921863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:27:47.932907 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_marts'
[0m10:27:47.945619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m10:27:47.951250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_elementary'
[0m10:27:47.964868 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_intermediate'
[0m10:27:48.027704 [debug] [ThreadPool]: Using postgres connection "list_raw_marts"
[0m10:27:48.028543 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m10:27:48.029215 [debug] [ThreadPool]: Using postgres connection "list_raw_elementary"
[0m10:27:48.032069 [debug] [ThreadPool]: On list_raw_elementary: BEGIN
[0m10:27:48.031401 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m10:27:48.033460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:48.032756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:48.030730 [debug] [ThreadPool]: On list_raw_marts: BEGIN
[0m10:27:48.040002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:48.029939 [debug] [ThreadPool]: Using postgres connection "list_raw_intermediate"
[0m10:27:48.050170 [debug] [ThreadPool]: On list_raw_intermediate: BEGIN
[0m10:27:48.050832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:48.049259 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m10:27:48.060943 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m10:27:48.064950 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m10:27:48.066935 [debug] [ThreadPool]: Using postgres connection "list_raw_intermediate"
[0m10:27:48.067682 [debug] [ThreadPool]: On list_raw_intermediate: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_intermediate"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'intermediate'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'intermediate'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'intermediate'

[0m10:27:48.069645 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m10:27:48.071888 [debug] [ThreadPool]: Using postgres connection "list_raw_elementary"
[0m10:27:48.074244 [debug] [ThreadPool]: On list_raw_elementary: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_elementary"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'elementary'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'elementary'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'elementary'

[0m10:27:48.066114 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'

[0m10:27:48.081421 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.005 seconds
[0m10:27:48.082144 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.013 seconds
[0m10:27:48.086112 [debug] [ThreadPool]: On list_raw_elementary: ROLLBACK
[0m10:27:48.090518 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.008 seconds
[0m10:27:48.095925 [debug] [ThreadPool]: On list_raw_intermediate: ROLLBACK
[0m10:27:48.106142 [debug] [ThreadPool]: On list_raw_elementary: Close
[0m10:27:48.107972 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw_elementary, now list_raw_staging)
[0m10:27:48.113815 [debug] [ThreadPool]: Using postgres connection "list_raw_staging"
[0m10:27:48.148896 [debug] [ThreadPool]: On list_raw_staging: BEGIN
[0m10:27:48.114481 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m10:27:48.152131 [debug] [ThreadPool]: Using postgres connection "list_raw_marts"
[0m10:27:48.152867 [debug] [ThreadPool]: On list_raw_marts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_marts"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts'

[0m10:27:48.151380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:48.100102 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m10:27:48.154978 [debug] [ThreadPool]: On list_raw_raw: Close
[0m10:27:48.115091 [debug] [ThreadPool]: On list_raw_intermediate: Close
[0m10:27:48.168676 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.015 seconds
[0m10:27:48.179632 [debug] [ThreadPool]: On list_raw_marts: ROLLBACK
[0m10:27:48.189241 [debug] [ThreadPool]: On list_raw_marts: Close
[0m10:27:48.209935 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m10:27:48.210721 [debug] [ThreadPool]: Using postgres connection "list_raw_staging"
[0m10:27:48.212196 [debug] [ThreadPool]: On list_raw_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_staging"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging'

[0m10:27:48.217368 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m10:27:48.221942 [debug] [ThreadPool]: On list_raw_staging: ROLLBACK
[0m10:27:48.227219 [debug] [ThreadPool]: On list_raw_staging: Close
[0m10:27:48.262008 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:48.262749 [debug] [MainThread]: On master: BEGIN
[0m10:27:48.263424 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:48.273316 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m10:27:48.274506 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:48.275409 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:27:48.286518 [debug] [MainThread]: SQL status: SELECT 55 in 0.010 seconds
[0m10:27:48.305795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82ad4d7a-24f0-44df-91c3-9581eb878934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6e9a182d50>]}
[0m10:27:48.306736 [debug] [MainThread]: On master: ROLLBACK
[0m10:27:48.307587 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:48.308278 [debug] [MainThread]: On master: BEGIN
[0m10:27:48.312591 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:27:48.313307 [debug] [MainThread]: On master: COMMIT
[0m10:27:48.314012 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:48.314958 [debug] [MainThread]: On master: COMMIT
[0m10:27:48.315749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:27:48.347575 [info ] [MainThread]:
IMPORTANT - Starting from dbt 1.8, users must explicitly allow packages to override materializations.
Elementary requires this ability to support collection of samples and failed row count for dbt tests.
Please add the following flag to dbt_project.yml to allow it:

flags:
  require_explicit_package_overrides_for_builtin_materializations: false

Notes -
* This is a temporary measure that will result in a deprecation warning, please ignore it for now. Elementary is working with the dbt-core team on a more permanent solution.
* This message can be muted by setting the 'mute_ensure_materialization_override' var to true.

[0m10:27:48.410696 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:48.411652 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */

    select count(*) from pg_namespace where nspname = 'elementary__tests'

[0m10:27:48.413155 [debug] [MainThread]: SQL status: SELECT 1 in 0.001 seconds
[0m10:27:48.418155 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m10:27:48.424357 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]
[0m10:27:48.425510 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-start.0 ...................................... [[32mOK[0m in 0.11s]
[0m10:27:48.426341 [info ] [MainThread]:
[0m10:27:48.427173 [debug] [MainThread]: On master: Close
[0m10:27:48.434698 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e
[0m10:27:48.435616 [info ] [Thread-1 (]: 1 of 58 START test accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town  [RUN]
[0m10:27:48.436653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_staging, now test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e)
[0m10:27:48.437474 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630
[0m10:27:48.438209 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95
[0m10:27:48.441653 [info ] [Thread-3 (]: 3 of 58 START test accepted_values_stg_order_fulfillment_on_time__True__0__1 ... [RUN]
[0m10:27:48.442525 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_raw_intermediate, now test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95)
[0m10:27:48.443330 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95
[0m10:27:48.438980 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73
[0m10:27:48.450478 [info ] [Thread-4 (]: 4 of 58 START test accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1  [RUN]
[0m10:27:48.451374 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_raw_raw, now test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73)
[0m10:27:48.440716 [info ] [Thread-2 (]: 2 of 58 START test accepted_values_stg_order_fulfillment_in_full__True__0__1 ... [RUN]
[0m10:27:48.453123 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw_marts, now test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630)
[0m10:27:48.453918 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630
[0m10:27:48.439825 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e
[0m10:27:48.452167 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73
[0m10:27:48.463751 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95"
[0m10:27:48.486665 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95
[0m10:27:48.485496 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630"
[0m10:27:48.502327 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630
[0m10:27:48.472076 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e"
[0m10:27:48.522072 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e
[0m10:27:48.480370 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73"
[0m10:27:48.538460 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73
[0m10:27:48.616494 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95"
[0m10:27:48.624383 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630"
[0m10:27:48.638831 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630"
[0m10:27:48.639660 [debug] [Thread-2 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630: BEGIN
[0m10:27:48.627310 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e"
[0m10:27:48.641781 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e"
[0m10:27:48.642613 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e: BEGIN
[0m10:27:48.643419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:48.637712 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95"
[0m10:27:48.646010 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95: BEGIN
[0m10:27:48.646792 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:48.640420 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:48.636773 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73"
[0m10:27:48.651621 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73"
[0m10:27:48.653677 [debug] [Thread-4 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73: BEGIN
[0m10:27:48.654488 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:48.656714 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m10:27:48.657697 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95"
[0m10:27:48.658478 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




with all_values as (

    select
        on_time as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by on_time

)

select *
from all_values
where value_field not in (
    '0','1'
)




    ) dbt_internal_test
[0m10:27:48.659697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m10:27:48.662022 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e"
[0m10:27:48.663003 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




with all_values as (

    select
        city as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_customers"
    group by city

)

select *
from all_values
where value_field not in (
    'Klerksdorp','Polokwane','Stellenbosch','Paarl','East London','Grahamstown','George','Upington','Bloemfontein','Worcester','Pietermaritzburg','Pretoria','Nelspruit','Kimberley','Johannesburg','Cape Town'
)




    ) dbt_internal_test
[0m10:27:48.665758 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:27:48.679029 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.020 seconds
[0m10:27:48.680856 [debug] [Thread-2 (]: SQL status: BEGIN in 0.040 seconds
[0m10:27:48.686958 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630"
[0m10:27:48.687765 [debug] [Thread-2 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




with all_values as (

    select
        in_full as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by in_full

)

select *
from all_values
where value_field not in (
    '0','1'
)




    ) dbt_internal_test
[0m10:27:48.689020 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e: ROLLBACK
[0m10:27:48.692976 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e: Close
[0m10:27:48.698923 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:27:48.701312 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95: ROLLBACK
[0m10:27:48.711450 [debug] [Thread-4 (]: SQL status: BEGIN in 0.057 seconds
[0m10:27:48.712532 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73"
[0m10:27:48.713408 [debug] [Thread-4 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




with all_values as (

    select
        ontime_in_full as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by ontime_in_full

)

select *
from all_values
where value_field not in (
    '0','1'
)




    ) dbt_internal_test
[0m10:27:48.703601 [debug] [Thread-2 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630: ROLLBACK
[0m10:27:48.720729 [debug] [Thread-2 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630: Close
[0m10:27:48.714262 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95: Close
[0m10:27:48.719596 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:27:48.696412 [info ] [Thread-1 (]: 1 of 58 PASS accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town  [[32mPASS[0m in 0.26s]
[0m10:27:48.731806 [debug] [Thread-4 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73: ROLLBACK
[0m10:27:48.729192 [info ] [Thread-3 (]: 3 of 58 PASS accepted_values_stg_order_fulfillment_on_time__True__0__1 ......... [[32mPASS[0m in 0.29s]
[0m10:27:48.724547 [info ] [Thread-2 (]: 2 of 58 PASS accepted_values_stg_order_fulfillment_in_full__True__0__1 ......... [[32mPASS[0m in 0.27s]
[0m10:27:48.733140 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e
[0m10:27:48.734164 [debug] [Thread-4 (]: On test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73: Close
[0m10:27:48.741113 [info ] [Thread-4 (]: 4 of 58 PASS accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1 .. [[32mPASS[0m in 0.29s]
[0m10:27:48.736781 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630
[0m10:27:48.739915 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575
[0m10:27:48.735657 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95
[0m10:27:48.750465 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc
[0m10:27:48.747497 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478
[0m10:27:48.752386 [info ] [Thread-2 (]: 6 of 58 START test dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True  [RUN]
[0m10:27:48.749060 [info ] [Thread-1 (]: 5 of 58 START test accepted_values_stg_products_category__Dairy__beverages__Food  [RUN]
[0m10:27:48.754931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e, now test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575)
[0m10:27:48.745062 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73
[0m10:27:48.757241 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182
[0m10:27:48.751368 [info ] [Thread-3 (]: 7 of 58 START test dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True  [RUN]
[0m10:27:48.759168 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95, now test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc)
[0m10:27:48.753443 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630, now test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478)
[0m10:27:48.761017 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478
[0m10:27:48.758176 [info ] [Thread-4 (]: 8 of 58 START test dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2  [RUN]
[0m10:27:48.769363 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73, now test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182)
[0m10:27:48.770166 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182
[0m10:27:48.760146 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc
[0m10:27:48.756243 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575
[0m10:27:48.779350 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478"
[0m10:27:48.798988 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478
[0m10:27:48.790397 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182"
[0m10:27:48.805779 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182
[0m10:27:48.811142 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182"
[0m10:27:48.797815 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575"
[0m10:27:48.813047 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575
[0m10:27:48.789357 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc"
[0m10:27:48.819286 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc
[0m10:27:48.804726 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478"
[0m10:27:48.825887 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478"
[0m10:27:48.826701 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478: BEGIN
[0m10:27:48.827495 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:48.830015 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182"
[0m10:27:48.830877 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182: BEGIN
[0m10:27:48.831915 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:48.824216 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc"
[0m10:27:48.837826 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc"
[0m10:27:48.838692 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m10:27:48.841755 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478"
[0m10:27:48.844496 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select



  infull_target >= otif_target as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






    ) dbt_internal_test
[0m10:27:48.843042 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m10:27:48.845613 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182"
[0m10:27:48.847305 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select




( 1=1 and length(
        city
    ) >= 2 and length(
        city
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








    ) dbt_internal_test
[0m10:27:48.834804 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575"
[0m10:27:48.849097 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575"
[0m10:27:48.850683 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575: BEGIN
[0m10:27:48.851499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:48.849975 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:27:48.855273 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182: ROLLBACK
[0m10:27:48.846533 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:27:48.840858 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc: BEGIN
[0m10:27:48.858995 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:48.858104 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478: ROLLBACK
[0m10:27:48.860404 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478: Close
[0m10:27:48.874563 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m10:27:48.875492 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc"
[0m10:27:48.876489 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select



  ontime_target >= otif_target as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






    ) dbt_internal_test
[0m10:27:48.877448 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182: Close
[0m10:27:48.879054 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:27:48.862844 [info ] [Thread-2 (]: 6 of 58 PASS dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True  [[32mPASS[0m in 0.11s]
[0m10:27:48.885102 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478
[0m10:27:48.886046 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf
[0m10:27:48.881135 [info ] [Thread-4 (]: 8 of 58 PASS dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2  [[32mPASS[0m in 0.11s]
[0m10:27:48.888879 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182
[0m10:27:48.889762 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012
[0m10:27:48.883890 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc: ROLLBACK
[0m10:27:48.887205 [info ] [Thread-2 (]: 9 of 58 START test dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2  [RUN]
[0m10:27:48.892781 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478, now test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf)
[0m10:27:48.891977 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc: Close
[0m10:27:48.890713 [info ] [Thread-4 (]: 10 of 58 START test dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1  [RUN]
[0m10:27:48.903710 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182, now test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012)
[0m10:27:48.897010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m10:27:48.905510 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575"
[0m10:27:48.906385 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_products"
    group by category

)

select *
from all_values
where value_field not in (
    'Dairy','beverages','Food'
)




    ) dbt_internal_test
[0m10:27:48.894039 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf
[0m10:27:48.901489 [info ] [Thread-3 (]: 7 of 58 PASS dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True  [[32mPASS[0m in 0.14s]
[0m10:27:48.914556 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc
[0m10:27:48.913434 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:27:48.918213 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575: ROLLBACK
[0m10:27:48.904670 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012
[0m10:27:48.915516 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db
[0m10:27:48.931159 [info ] [Thread-3 (]: 11 of 58 START test dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1  [RUN]
[0m10:27:48.932062 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc, now test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db)
[0m10:27:48.932975 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db
[0m10:27:48.930234 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf"
[0m10:27:48.940944 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575: Close
[0m10:27:48.944735 [info ] [Thread-1 (]: 5 of 58 PASS accepted_values_stg_products_category__Dairy__beverages__Food ..... [[32mPASS[0m in 0.19s]
[0m10:27:48.945777 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575
[0m10:27:48.946916 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2
[0m10:27:48.948263 [info ] [Thread-1 (]: 12 of 58 START test dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2  [RUN]
[0m10:27:48.950836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575, now test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2)
[0m10:27:48.951710 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2
[0m10:27:48.949998 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf
[0m10:27:48.943299 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012"
[0m10:27:49.090642 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012
[0m10:27:48.956048 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db"
[0m10:27:49.096981 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db
[0m10:27:49.102029 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db"
[0m10:27:49.109739 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db"
[0m10:27:49.110551 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db: BEGIN
[0m10:27:49.111314 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:49.089439 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf"
[0m10:27:49.113614 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf"
[0m10:27:49.114402 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf: BEGIN
[0m10:27:49.115168 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:49.095902 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012"
[0m10:27:49.117528 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012"
[0m10:27:49.118306 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012: BEGIN
[0m10:27:49.119083 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:49.108678 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2"
[0m10:27:49.122575 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2
[0m10:27:49.132673 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m10:27:49.133478 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012"
[0m10:27:49.134325 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select




( 1=1 and length(
        customer_id
    ) >= 1 and length(
        customer_id
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








    ) dbt_internal_test
[0m10:27:49.140889 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m10:27:49.141679 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db"
[0m10:27:49.142521 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select




( 1=1 and length(
        order_id
    ) >= 1 and length(
        order_id
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








    ) dbt_internal_test
[0m10:27:49.143658 [debug] [Thread-2 (]: SQL status: BEGIN in 0.028 seconds
[0m10:27:49.144451 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf"
[0m10:27:49.147868 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select




( 1=1 and length(
        customer_name
    ) >= 2 and length(
        customer_name
    ) <= 100
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








    ) dbt_internal_test
[0m10:27:49.150055 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.015 seconds
[0m10:27:49.153017 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012: ROLLBACK
[0m10:27:49.154937 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012: Close
[0m10:27:49.129603 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2"
[0m10:27:49.155720 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:27:49.161248 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf: ROLLBACK
[0m10:27:49.162808 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2"
[0m10:27:49.164922 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2: BEGIN
[0m10:27:49.165767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:49.163998 [info ] [Thread-4 (]: 10 of 58 PASS dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1  [[32mPASS[0m in 0.26s]
[0m10:27:49.168492 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012
[0m10:27:49.170280 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710
[0m10:27:49.171793 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf: Close
[0m10:27:49.172584 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.029 seconds
[0m10:27:49.177892 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db: ROLLBACK
[0m10:27:49.180000 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m10:27:49.180881 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2"
[0m10:27:49.175469 [info ] [Thread-2 (]: 9 of 58 PASS dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2  [[32mPASS[0m in 0.28s]
[0m10:27:49.183542 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf
[0m10:27:49.184458 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63
[0m10:27:49.185555 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db: Close
[0m10:27:49.188292 [info ] [Thread-3 (]: 11 of 58 PASS dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1  [[32mPASS[0m in 0.26s]
[0m10:27:49.189877 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db
[0m10:27:49.186829 [info ] [Thread-2 (]: 14 of 58 START test dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10  [RUN]
[0m10:27:49.191744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf, now test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63)
[0m10:27:49.192678 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63
[0m10:27:49.190732 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5
[0m10:27:49.199762 [info ] [Thread-3 (]: 15 of 58 START test dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0  [RUN]
[0m10:27:49.200678 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5)
[0m10:27:49.201481 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5
[0m10:27:49.174541 [info ] [Thread-4 (]: 13 of 58 START test dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1  [RUN]
[0m10:27:49.182435 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select




( 1=1 and length(
        category
    ) >= 2 and length(
        category
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








    ) dbt_internal_test
[0m10:27:49.218370 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:27:49.216217 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012, now test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710)
[0m10:27:49.221775 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710
[0m10:27:49.220960 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2: ROLLBACK
[0m10:27:49.230114 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2: Close
[0m10:27:49.230781 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5"
[0m10:27:49.236246 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5
[0m10:27:49.234546 [info ] [Thread-1 (]: 12 of 58 PASS dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2  [[32mPASS[0m in 0.28s]
[0m10:27:49.243864 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2
[0m10:27:49.245018 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6
[0m10:27:49.215337 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63"
[0m10:27:49.248107 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63
[0m10:27:49.246024 [info ] [Thread-1 (]: 16 of 58 START test dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0  [RUN]
[0m10:27:49.256825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6)
[0m10:27:49.257668 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6
[0m10:27:49.247093 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710"
[0m10:27:49.242203 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5"
[0m10:27:49.266712 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710
[0m10:27:49.267645 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5"
[0m10:27:49.273969 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5: BEGIN
[0m10:27:49.274816 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:49.256364 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63"
[0m10:27:49.277954 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63"
[0m10:27:49.279258 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63: BEGIN
[0m10:27:49.280128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:49.286748 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m10:27:49.287659 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5"
[0m10:27:49.288618 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (







    with grouped_expression as (
    select




( 1=1 and infull_target >= 0 and infull_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors









    ) dbt_internal_test
[0m10:27:49.273119 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710"
[0m10:27:49.290297 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6"
[0m10:27:49.298056 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6
[0m10:27:49.295707 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m10:27:49.305332 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63"
[0m10:27:49.306186 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (





    with grouped_expression as (
    select





    length(
        date
    ) = 10 as expression


    from "raw"."staging"."stg_dates"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






    ) dbt_internal_test
[0m10:27:49.296582 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710"
[0m10:27:49.308135 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710: BEGIN
[0m10:27:49.308942 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:49.293283 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:27:49.312839 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5: ROLLBACK
[0m10:27:49.313682 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:27:49.316469 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63: ROLLBACK
[0m10:27:49.317379 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5: Close
[0m10:27:49.318744 [info ] [Thread-3 (]: 15 of 58 PASS dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0  [[32mPASS[0m in 0.12s]
[0m10:27:49.320090 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5
[0m10:27:49.328479 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69
[0m10:27:49.304378 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6"
[0m10:27:49.333048 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6"
[0m10:27:49.330453 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m10:27:49.334986 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710"
[0m10:27:49.331963 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63: Close
[0m10:27:49.336026 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






    with grouped_expression as (
    select




( 1=1 and length(
        product_name
    ) >= 1 and length(
        product_name
    ) <= 100
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








    ) dbt_internal_test
[0m10:27:49.340165 [info ] [Thread-2 (]: 14 of 58 PASS dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10  [[32mPASS[0m in 0.15s]
[0m10:27:49.341881 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63
[0m10:27:49.333824 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6: BEGIN
[0m10:27:49.331411 [info ] [Thread-3 (]: 17 of 58 START test dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0  [RUN]
[0m10:27:49.343618 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:27:49.348850 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710: ROLLBACK
[0m10:27:49.344417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:49.345322 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69)
[0m10:27:49.350941 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69
[0m10:27:49.342770 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386
[0m10:27:49.358216 [info ] [Thread-2 (]: 18 of 58 START test dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_  [RUN]
[0m10:27:49.359152 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386)
[0m10:27:49.359956 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386
[0m10:27:49.360832 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710: Close
[0m10:27:49.362742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m10:27:49.374416 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6"
[0m10:27:49.373514 [info ] [Thread-4 (]: 13 of 58 PASS dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1  [[32mPASS[0m in 0.16s]
[0m10:27:49.376329 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710
[0m10:27:49.375171 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (







    with grouped_expression as (
    select




( 1=1 and ontime_target >= 0 and ontime_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors









    ) dbt_internal_test
[0m10:27:49.377231 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed
[0m10:27:49.378208 [info ] [Thread-4 (]: 19 of 58 START test dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True  [RUN]
[0m10:27:49.379339 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed)
[0m10:27:49.380605 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:27:49.390370 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6: ROLLBACK
[0m10:27:49.387868 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed
[0m10:27:49.372263 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69"
[0m10:27:49.400676 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69
[0m10:27:49.399593 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6: Close
[0m10:27:49.406917 [info ] [Thread-1 (]: 16 of 58 PASS dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0  [[32mPASS[0m in 0.15s]
[0m10:27:49.407952 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6
[0m10:27:49.387029 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386"
[0m10:27:49.410636 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386
[0m10:27:49.408988 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10
[0m10:27:49.418018 [info ] [Thread-1 (]: 20 of 58 START test dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food  [RUN]
[0m10:27:49.419046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10)
[0m10:27:49.398821 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed"
[0m10:27:49.405745 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69"
[0m10:27:49.421670 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed
[0m10:27:49.419964 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10
[0m10:27:49.423036 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69"
[0m10:27:49.439920 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69: BEGIN
[0m10:27:49.440795 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:49.417088 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386"
[0m10:27:49.443698 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386"
[0m10:27:49.444625 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386: BEGIN
[0m10:27:49.445649 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:49.439067 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed"
[0m10:27:49.449042 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed"
[0m10:27:49.437161 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10"
[0m10:27:49.458766 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m10:27:49.465429 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69"
[0m10:27:49.466396 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (







    with grouped_expression as (
    select




( 1=1 and otif_target >= 0 and otif_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors









    ) dbt_internal_test
[0m10:27:49.464279 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m10:27:49.467757 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386"
[0m10:27:49.469268 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (







    with grouped_expression as (
    select




( 1=1 and order_placement_date >= '2024-01-01' and order_placement_date <= current_date
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors









    ) dbt_internal_test
[0m10:27:49.470195 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:27:49.457500 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed: BEGIN
[0m10:27:49.483538 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:49.482687 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10
[0m10:27:49.490997 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10"
[0m10:27:49.481400 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.010 seconds
[0m10:27:49.495892 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386: ROLLBACK
[0m10:27:49.480449 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69: ROLLBACK
[0m10:27:49.502495 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69: Close
[0m10:27:49.501086 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m10:27:49.505516 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed"
[0m10:27:49.506252 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386: Close
[0m10:27:49.504474 [info ] [Thread-3 (]: 17 of 58 PASS dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0  [[32mPASS[0m in 0.16s]
[0m10:27:49.507106 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (







    with grouped_expression as (
    select




( 1=1 and product_id > 1
)
 as expression


    from "raw"."staging"."stg_products"
    where
        product_id IS NOT NULL



),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors









    ) dbt_internal_test
[0m10:27:49.519999 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:27:49.510957 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10"
[0m10:27:49.518177 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69
[0m10:27:49.525217 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0
[0m10:27:49.516753 [info ] [Thread-2 (]: 18 of 58 PASS dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_  [[32mPASS[0m in 0.16s]
[0m10:27:49.527514 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386
[0m10:27:49.526212 [info ] [Thread-3 (]: 21 of 58 START test dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date  [RUN]
[0m10:27:49.529376 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0)
[0m10:27:49.530234 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0
[0m10:27:49.522748 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed: ROLLBACK
[0m10:27:49.537466 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed: Close
[0m10:27:49.528424 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39
[0m10:27:49.540972 [info ] [Thread-2 (]: 22 of 58 START test dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_  [RUN]
[0m10:27:49.541876 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39)
[0m10:27:49.542654 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39
[0m10:27:49.524261 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10: BEGIN
[0m10:27:49.561219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:49.560325 [info ] [Thread-4 (]: 19 of 58 PASS dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True  [[32mPASS[0m in 0.18s]
[0m10:27:49.565955 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed
[0m10:27:49.564866 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39"
[0m10:27:49.567033 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828
[0m10:27:49.568994 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39
[0m10:27:49.571508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m10:27:49.596821 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10"
[0m10:27:49.597661 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (


with all_values as (

    select
        category as value_field

    from "raw"."staging"."stg_products"


),
set_values as (

    select
        cast('Dairy' as TEXT) as value_field
    union all
    select
        cast('beverages' as TEXT) as value_field
    union all
    select
        cast('Food' as TEXT) as value_field


),
validation_errors as (
    -- values from the model that are not in the set
    select
        v.value_field
    from
        all_values v
        left join
        set_values s on v.value_field = s.value_field
    where
        s.value_field is null

)

select *
from validation_errors



    ) dbt_internal_test
[0m10:27:49.572257 [info ] [Thread-4 (]: 23 of 58 START test dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_  [RUN]
[0m10:27:49.598695 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828)
[0m10:27:49.599506 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828
[0m10:27:49.581850 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0"
[0m10:27:49.606187 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m10:27:49.609665 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10: ROLLBACK
[0m10:27:49.607042 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0: BEGIN
[0m10:27:49.611405 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:49.610676 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10: Close
[0m10:27:49.616884 [info ] [Thread-1 (]: 20 of 58 PASS dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food  [[32mPASS[0m in 0.20s]
[0m10:27:49.618087 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10
[0m10:27:49.588199 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39"
[0m10:27:49.624475 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39"
[0m10:27:49.626166 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39: BEGIN
[0m10:27:49.622509 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86
[0m10:27:49.625407 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m10:27:49.629648 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0"
[0m10:27:49.630516 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_orders'

        and table_schema = 'staging'

      order by ordinal_position


[0m10:27:49.628125 [info ] [Thread-1 (]: 24 of 58 START test dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___  [RUN]
[0m10:27:49.614116 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828"
[0m10:27:49.642435 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828
[0m10:27:49.640479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86)
[0m10:27:49.649724 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86
[0m10:27:49.626995 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:49.643335 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.012 seconds
[0m10:27:49.648900 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828"
[0m10:27:49.672959 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828"
[0m10:27:49.673781 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828: BEGIN
[0m10:27:49.674546 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:49.671481 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86"
[0m10:27:49.678216 [debug] [Thread-2 (]: SQL status: BEGIN in 0.051 seconds
[0m10:27:49.679020 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39"
[0m10:27:49.679856 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (





    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(city, '^[A-Za-z\s\-\.]+$', '')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






    ) dbt_internal_test
[0m10:27:49.681582 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86
[0m10:27:49.682394 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:27:49.693800 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39: ROLLBACK
[0m10:27:49.694750 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39: Close
[0m10:27:49.691203 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m10:27:49.695670 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828"
[0m10:27:49.696578 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (





    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(customer_name, '^[A-Za-z0-9\s\-\.]+$', '')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






    ) dbt_internal_test
[0m10:27:49.702146 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:27:49.669365 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0"
[0m10:27:49.712268 [info ] [Thread-2 (]: 22 of 58 PASS dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_  [[32mPASS[0m in 0.17s]
[0m10:27:49.715172 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39
[0m10:27:49.710525 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828: ROLLBACK
[0m10:27:49.689840 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86"
[0m10:27:49.716076 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908
[0m10:27:49.718166 [info ] [Thread-2 (]: 25 of 58 START test dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_  [RUN]
[0m10:27:49.723594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908)
[0m10:27:49.724489 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908
[0m10:27:49.721193 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828: Close
[0m10:27:49.735726 [info ] [Thread-4 (]: 23 of 58 PASS dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_  [[32mPASS[0m in 0.14s]
[0m10:27:49.736891 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828
[0m10:27:49.737733 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a
[0m10:27:49.726906 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0
[0m10:27:49.722785 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86"
[0m10:27:49.754044 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86: BEGIN
[0m10:27:49.738907 [info ] [Thread-4 (]: 26 of 58 START test dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id  [RUN]
[0m10:27:49.757552 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828, now test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a)
[0m10:27:49.748243 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0"
[0m10:27:49.752949 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908"
[0m10:27:49.756613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:49.760587 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0"
[0m10:27:49.758394 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a
[0m10:27:49.761446 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (


        select
            cast('ORDER_ID' as TEXT) as relation_column,
            cast('TEXT' as TEXT) as relation_column_type
        union all

        select
            cast('CUSTOMER_ID' as TEXT) as relation_column,
            cast('TEXT' as TEXT) as relation_column_type
        union all

        select
            cast('ORDER_PLACEMENT_DATE' as TEXT) as relation_column,
            cast('DATE' as TEXT) as relation_column_type


    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'ORDER_PLACEMENT_DATE'
            and
            relation_column_type not in ('DATE')

    )
    select *
    from test_data

    ) dbt_internal_test
[0m10:27:49.774186 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:27:49.773200 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908
[0m10:27:49.775655 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86"
[0m10:27:49.796939 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (





    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(order_id, '^[A-Za-z0-9\-_]+$', '')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_order_fulfillment"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






    ) dbt_internal_test
[0m10:27:49.791634 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.018 seconds
[0m10:27:49.799670 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0: ROLLBACK
[0m10:27:49.790824 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908"
[0m10:27:49.809010 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0: Close
[0m10:27:49.810542 [info ] [Thread-3 (]: 21 of 58 PASS dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date  [[32mPASS[0m in 0.28s]
[0m10:27:49.812181 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0
[0m10:27:49.813688 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419
[0m10:27:49.814491 [info ] [Thread-3 (]: 27 of 58 START test dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category  [RUN]
[0m10:27:49.808183 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a"
[0m10:27:49.817422 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908"
[0m10:27:49.815541 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0, now test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419)
[0m10:27:49.826137 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419
[0m10:27:49.818176 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908: BEGIN
[0m10:27:49.825277 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a
[0m10:27:49.837294 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:49.851376 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419"
[0m10:27:49.855038 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a"
[0m10:27:49.856661 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419
[0m10:27:49.858747 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a"
[0m10:27:49.879144 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419"
[0m10:27:49.886658 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a: BEGIN
[0m10:27:49.890305 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:49.889574 [debug] [Thread-2 (]: SQL status: BEGIN in 0.052 seconds
[0m10:27:49.888405 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419"
[0m10:27:49.894769 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908"
[0m10:27:49.896986 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (





    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(product_name, '^\\s*$', '')), 1), 0)


 = 0
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






    ) dbt_internal_test
[0m10:27:49.899108 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:27:49.901723 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908: ROLLBACK
[0m10:27:49.896127 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419: BEGIN
[0m10:27:49.909017 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:49.910230 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908: Close
[0m10:27:49.911311 [info ] [Thread-2 (]: 25 of 58 PASS dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_  [[32mPASS[0m in 0.19s]
[0m10:27:49.919579 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908
[0m10:27:49.920386 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m10:27:49.923246 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a"
[0m10:27:49.924144 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




with validation_errors as (

    select
        customer_id,order_placement_date,order_id,
        count(*) as "n_records"
    from "raw"."staging"."stg_orders"
    where
        1=1
        and
    not (
        customer_id is null and
        order_placement_date is null and
        order_id is null

    )



    group by
        customer_id,order_placement_date,order_id
    having count(*) > 1

)
select * from validation_errors


    ) dbt_internal_test
[0m10:27:49.927391 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.129 seconds
[0m10:27:49.930039 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86: ROLLBACK
[0m10:27:49.922245 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404
[0m10:27:49.938042 [info ] [Thread-2 (]: 28 of 58 START test dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date  [RUN]
[0m10:27:49.939068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908, now test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404)
[0m10:27:49.939862 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404
[0m10:27:49.944718 [debug] [Thread-3 (]: SQL status: BEGIN in 0.036 seconds
[0m10:27:49.955281 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419"
[0m10:27:49.956172 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




with validation_errors as (

    select
        product_name,category,
        count(*) as "n_records"
    from "raw"."staging"."stg_products"
    where
        1=1
        and
    not (
        product_name is null and
        category is null

    )



    group by
        product_name,category
    having count(*) > 1

)
select * from validation_errors


    ) dbt_internal_test
[0m10:27:49.945481 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86: Close
[0m10:27:49.958568 [info ] [Thread-1 (]: 24 of 58 PASS dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___  [[32mPASS[0m in 0.32s]
[0m10:27:49.960264 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86
[0m10:27:49.961126 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602
[0m10:27:49.963372 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:27:49.970357 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419: ROLLBACK
[0m10:27:49.965441 [info ] [Thread-1 (]: 29 of 58 START test dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category  [RUN]
[0m10:27:49.972540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86, now test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602)
[0m10:27:49.974750 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602
[0m10:27:49.992331 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.064 seconds
[0m10:27:49.994840 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a: ROLLBACK
[0m10:27:49.995721 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419: Close
[0m10:27:50.010830 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a: Close
[0m10:27:50.019902 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404"
[0m10:27:50.010197 [info ] [Thread-3 (]: 27 of 58 PASS dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category  [[32mPASS[0m in 0.19s]
[0m10:27:50.012025 [info ] [Thread-4 (]: 26 of 58 PASS dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id  [[32mPASS[0m in 0.25s]
[0m10:27:50.026956 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a
[0m10:27:50.025698 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419
[0m10:27:50.030191 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06
[0m10:27:50.027860 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d
[0m10:27:50.031455 [info ] [Thread-3 (]: 31 of 58 START test dbt_expectations_expect_table_columns_to_match_set_stg_dates_date  [RUN]
[0m10:27:50.033139 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419, now test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06)
[0m10:27:50.033921 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06
[0m10:27:50.024312 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404: BEGIN
[0m10:27:50.041730 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:50.032171 [info ] [Thread-4 (]: 30 of 58 START test dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city  [RUN]
[0m10:27:50.042765 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a, now test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d)
[0m10:27:50.043577 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d
[0m10:27:50.023310 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602"
[0m10:27:50.054072 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602: BEGIN
[0m10:27:50.054853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:50.056131 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m10:27:50.056939 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404"
[0m10:27:50.057766 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_orders'

        and table_schema = 'staging'

      order by ordinal_position


[0m10:27:50.087442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m10:27:50.093054 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602"
[0m10:27:50.096264 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_products'

        and table_schema = 'staging'

      order by ordinal_position


[0m10:27:50.114069 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.016 seconds
[0m10:27:50.132768 [debug] [Thread-2 (]: SQL status: SELECT 3 in 0.074 seconds
[0m10:27:50.144591 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06"
[0m10:27:50.150490 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06: BEGIN
[0m10:27:50.151298 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:50.148041 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404"
[0m10:27:50.152936 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404
[0m10:27:50.149629 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602"
[0m10:27:50.164534 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602
[0m10:27:50.163445 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d"
[0m10:27:50.173448 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d: BEGIN
[0m10:27:50.174261 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:50.172486 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m10:27:50.175561 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06"
[0m10:27:50.176767 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_dates'

        and table_schema = 'staging'

      order by ordinal_position


[0m10:27:50.158745 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404"
[0m10:27:50.185554 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404"
[0m10:27:50.186505 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (


        select
            1 as relation_column_idx,
            cast('ORDER_ID' as TEXT) as relation_column
        union all

        select
            2 as relation_column_idx,
            cast('CUSTOMER_ID' as TEXT) as relation_column
        union all

        select
            3 as relation_column_idx,
            cast('ORDER_PLACEMENT_DATE' as TEXT) as relation_column


    ),
    input_columns as (


        select
            1 as input_column_idx,
            cast('ORDER_ID' as TEXT) as input_column
        union all

        select
            2 as input_column_idx,
            cast('CUSTOMER_ID' as TEXT) as input_column
        union all

        select
            3 as input_column_idx,
            cast('ORDER_PLACEMENT_DATE' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx
    where
        -- catch any column in input list that is not in the sequence of table columns
        -- or any table column that is not in the input sequence
        r.relation_column is null or
        i.input_column is null

    ) dbt_internal_test
[0m10:27:50.189875 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m10:27:50.194902 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06"
[0m10:27:50.195967 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06
[0m10:27:50.198975 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m10:27:50.206594 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d"
[0m10:27:50.207486 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_customers'

        and table_schema = 'staging'

      order by ordinal_position


[0m10:27:50.170888 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602"
[0m10:27:50.217391 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602"
[0m10:27:50.218351 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (


        select
            1 as relation_column_idx,
            cast('PRODUCT_ID' as TEXT) as relation_column
        union all

        select
            2 as relation_column_idx,
            cast('PRODUCT_NAME' as TEXT) as relation_column
        union all

        select
            3 as relation_column_idx,
            cast('CATEGORY' as TEXT) as relation_column


    ),
    input_columns as (


        select
            1 as input_column_idx,
            cast('PRODUCT_ID' as TEXT) as input_column
        union all

        select
            2 as input_column_idx,
            cast('PRODUCT_NAME' as TEXT) as input_column
        union all

        select
            3 as input_column_idx,
            cast('CATEGORY' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx
    where
        -- catch any column in input list that is not in the sequence of table columns
        -- or any table column that is not in the input sequence
        r.relation_column is null or
        i.input_column is null

    ) dbt_internal_test
[0m10:27:50.200341 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m10:27:50.221439 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404: ROLLBACK
[0m10:27:50.223214 [debug] [Thread-4 (]: SQL status: SELECT 3 in 0.015 seconds
[0m10:27:50.227018 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d"
[0m10:27:50.227805 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m10:27:50.233557 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602: ROLLBACK
[0m10:27:50.228560 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404: Close
[0m10:27:50.238042 [info ] [Thread-2 (]: 28 of 58 PASS dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date  [[32mPASS[0m in 0.30s]
[0m10:27:50.239300 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404
[0m10:27:50.240186 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185
[0m10:27:50.241044 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602: Close
[0m10:27:50.241938 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d
[0m10:27:50.243057 [info ] [Thread-2 (]: 32 of 58 START test dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full  [RUN]
[0m10:27:50.254354 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404, now test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185)
[0m10:27:50.255234 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185
[0m10:27:50.230307 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06"
[0m10:27:50.262491 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06"
[0m10:27:50.263370 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (


        select cast('DATE' as TEXT) as relation_column


    ),
    input_columns as (


        select cast('DATE' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null

    ) dbt_internal_test
[0m10:27:50.247395 [info ] [Thread-1 (]: 29 of 58 PASS dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category  [[32mPASS[0m in 0.27s]
[0m10:27:50.265196 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602
[0m10:27:50.266048 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc
[0m10:27:50.266828 [info ] [Thread-1 (]: 33 of 58 START test dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1  [RUN]
[0m10:27:50.267822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602, now test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc)
[0m10:27:50.268679 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc
[0m10:27:50.269425 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m10:27:50.281870 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06: ROLLBACK
[0m10:27:50.253765 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d"
[0m10:27:50.283138 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d"
[0m10:27:50.284039 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (


        select cast('CUSTOMER_ID' as TEXT) as relation_column
        union all

        select cast('CUSTOMER_NAME' as TEXT) as relation_column
        union all

        select cast('CITY' as TEXT) as relation_column


    ),
    input_columns as (


        select cast('CUSTOMER_ID' as TEXT) as input_column
        union all

        select cast('CUSTOMER_NAME' as TEXT) as input_column
        union all

        select cast('CITY' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null

    ) dbt_internal_test
[0m10:27:50.429354 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc"
[0m10:27:50.430285 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.145 seconds
[0m10:27:50.433764 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d: ROLLBACK
[0m10:27:50.431054 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06: Close
[0m10:27:50.438321 [info ] [Thread-3 (]: 31 of 58 PASS dbt_expectations_expect_table_columns_to_match_set_stg_dates_date  [[32mPASS[0m in 0.41s]
[0m10:27:50.439472 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06
[0m10:27:50.440494 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a
[0m10:27:50.441533 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc
[0m10:27:50.442244 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d: Close
[0m10:27:50.453204 [info ] [Thread-4 (]: 30 of 58 PASS dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city  [[32mPASS[0m in 0.41s]
[0m10:27:50.454334 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d
[0m10:27:50.443069 [info ] [Thread-3 (]: 34 of 58 START test dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1  [RUN]
[0m10:27:50.456125 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06, now test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a)
[0m10:27:50.456943 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a
[0m10:27:50.455255 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212
[0m10:27:50.468260 [info ] [Thread-4 (]: 35 of 58 START test dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1  [RUN]
[0m10:27:50.469172 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d, now test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212)
[0m10:27:50.449177 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc"
[0m10:27:50.471095 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc"
[0m10:27:50.471880 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc: BEGIN
[0m10:27:50.469963 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212
[0m10:27:50.467321 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185"
[0m10:27:50.483444 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185: BEGIN
[0m10:27:50.484223 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:50.472747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:50.482573 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a"
[0m10:27:50.487681 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a
[0m10:27:50.494676 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212"
[0m10:27:50.495905 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m10:27:50.496746 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185"
[0m10:27:50.497604 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_fulfillment'

        and table_schema = 'staging'

      order by ordinal_position


[0m10:27:50.498658 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212
[0m10:27:50.503979 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212"
[0m10:27:50.506214 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212"
[0m10:27:50.505140 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a"
[0m10:27:50.507963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m10:27:50.508900 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc"
[0m10:27:50.509782 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 40
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







    ) dbt_internal_test
[0m10:27:50.510881 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a"
[0m10:27:50.511656 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a: BEGIN
[0m10:27:50.512428 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:50.506988 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212: BEGIN
[0m10:27:50.515504 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:50.518460 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m10:27:50.521247 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc: ROLLBACK
[0m10:27:50.523792 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m10:27:50.527554 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.029 seconds
[0m10:27:50.536819 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185"
[0m10:27:50.528684 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc: Close
[0m10:27:50.538874 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185
[0m10:27:50.529945 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a"
[0m10:27:50.549074 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




    with grouped_expression as (
    select




( 1=1 and count(*) >= 1
)
 as expression


    from "raw"."staging"."stg_dates"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







    ) dbt_internal_test
[0m10:27:50.548177 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m10:27:50.540733 [info ] [Thread-1 (]: 33 of 58 PASS dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1  [[32mPASS[0m in 0.27s]
[0m10:27:50.552255 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc
[0m10:27:50.550753 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212"
[0m10:27:50.554928 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




    with grouped_expression as (
    select




( 1=1 and count(*) >= 1
)
 as expression


    from "raw"."staging"."stg_order_fulfillment"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







    ) dbt_internal_test
[0m10:27:50.554039 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m10:27:50.561869 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a: ROLLBACK
[0m10:27:50.553227 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3
[0m10:27:50.562757 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:27:50.563999 [info ] [Thread-1 (]: 36 of 58 START test dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1  [RUN]
[0m10:27:50.568046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc, now test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3)
[0m10:27:50.568947 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a: Close
[0m10:27:50.573720 [info ] [Thread-3 (]: 34 of 58 PASS dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1  [[32mPASS[0m in 0.12s]
[0m10:27:50.574886 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a
[0m10:27:50.547393 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185"
[0m10:27:50.577394 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185"
[0m10:27:50.578347 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (


        select cast('ORDER_ID' as TEXT) as relation_column
        union all

        select cast('ON_TIME' as TEXT) as relation_column
        union all

        select cast('IN_FULL' as TEXT) as relation_column
        union all

        select cast('ONTIME_IN_FULL' as TEXT) as relation_column


    ),
    input_columns as (


        select cast('ORDER_ID' as TEXT) as input_column
        union all

        select cast('ON_TIME' as TEXT) as input_column
        union all

        select cast('IN_FULL' as TEXT) as input_column
        union all

        select cast('ONTIME_IN_FULL' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null

    ) dbt_internal_test
[0m10:27:50.567114 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212: ROLLBACK
[0m10:27:50.569694 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3
[0m10:27:50.575780 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191
[0m10:27:50.587915 [info ] [Thread-3 (]: 37 of 58 START test dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1  [RUN]
[0m10:27:50.588860 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a, now test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191)
[0m10:27:50.586309 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212: Close
[0m10:27:50.593420 [info ] [Thread-4 (]: 35 of 58 PASS dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1  [[32mPASS[0m in 0.12s]
[0m10:27:50.587068 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m10:27:50.594626 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212
[0m10:27:50.598956 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241
[0m10:27:50.599871 [info ] [Thread-4 (]: 38 of 58 START test not_null_stg_customer_targets_customer_id .................. [RUN]
[0m10:27:50.600804 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212, now test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241)
[0m10:27:50.605028 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241
[0m10:27:50.598036 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185: ROLLBACK
[0m10:27:50.614508 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185: Close
[0m10:27:50.589719 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191
[0m10:27:50.604266 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3"
[0m10:27:50.626193 [info ] [Thread-2 (]: 32 of 58 PASS dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full  [[32mPASS[0m in 0.37s]
[0m10:27:50.627756 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185
[0m10:27:50.628660 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728
[0m10:27:50.629779 [info ] [Thread-2 (]: 39 of 58 START test not_null_stg_customer_targets_infull_target ................ [RUN]
[0m10:27:50.630723 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3
[0m10:27:50.631490 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185, now test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728)
[0m10:27:50.641689 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728
[0m10:27:50.640337 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3"
[0m10:27:50.665371 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3"
[0m10:27:50.666184 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3: BEGIN
[0m10:27:50.666980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:50.669830 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728"
[0m10:27:50.663990 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191"
[0m10:27:50.676135 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191
[0m10:27:50.673040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m10:27:50.684101 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3"
[0m10:27:50.685003 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 10000000
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







    ) dbt_internal_test
[0m10:27:50.689365 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241"
[0m10:27:50.683260 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728
[0m10:27:50.696955 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728"
[0m10:27:50.682392 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191"
[0m10:27:50.697785 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241
[0m10:27:50.698536 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m10:27:50.706657 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3: ROLLBACK
[0m10:27:50.707622 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3: Close
[0m10:27:50.709060 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191"
[0m10:27:50.713866 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191: BEGIN
[0m10:27:50.714952 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:50.713143 [info ] [Thread-1 (]: 36 of 58 PASS dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1  [[32mPASS[0m in 0.14s]
[0m10:27:50.703986 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241"
[0m10:27:50.720707 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241"
[0m10:27:50.718938 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3
[0m10:27:50.725699 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108
[0m10:27:50.716355 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728"
[0m10:27:50.724740 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241: BEGIN
[0m10:27:50.723891 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m10:27:50.729848 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191"
[0m10:27:50.727803 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728: BEGIN
[0m10:27:50.732165 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:50.726711 [info ] [Thread-1 (]: 40 of 58 START test not_null_stg_customer_targets_ontime_target ................ [RUN]
[0m10:27:50.736427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3, now test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108)
[0m10:27:50.737492 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108
[0m10:27:50.730953 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 100
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







    ) dbt_internal_test
[0m10:27:50.728822 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:50.747241 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:27:50.755261 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191: ROLLBACK
[0m10:27:50.756356 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m10:27:50.760960 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728"
[0m10:27:50.761776 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select infull_target
from "raw"."staging"."stg_customer_targets"
where infull_target is null




    ) dbt_internal_test
[0m10:27:50.757421 [debug] [Thread-4 (]: SQL status: BEGIN in 0.029 seconds
[0m10:27:50.762731 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241"
[0m10:27:50.763569 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select customer_id
from "raw"."staging"."stg_customer_targets"
where customer_id is null




    ) dbt_internal_test
[0m10:27:50.766358 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:27:50.769672 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241: ROLLBACK
[0m10:27:50.767270 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191: Close
[0m10:27:50.764691 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:27:50.778363 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728: ROLLBACK
[0m10:27:50.779529 [info ] [Thread-3 (]: 37 of 58 PASS dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1  [[32mPASS[0m in 0.19s]
[0m10:27:50.780847 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191
[0m10:27:50.781913 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728: Close
[0m10:27:50.782718 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241: Close
[0m10:27:50.783744 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a
[0m10:27:50.785161 [info ] [Thread-2 (]: 39 of 58 PASS not_null_stg_customer_targets_infull_target ...................... [[32mPASS[0m in 0.15s]
[0m10:27:50.791620 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728
[0m10:27:50.790374 [info ] [Thread-3 (]: 41 of 58 START test not_null_stg_customer_targets_otif_target .................. [RUN]
[0m10:27:50.794805 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191, now test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a)
[0m10:27:50.795854 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a
[0m10:27:50.788899 [info ] [Thread-4 (]: 38 of 58 PASS not_null_stg_customer_targets_customer_id ........................ [[32mPASS[0m in 0.19s]
[0m10:27:50.802754 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241
[0m10:27:50.772692 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108"
[0m10:27:50.805166 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108
[0m10:27:50.793671 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8
[0m10:27:50.803659 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:27:50.819324 [info ] [Thread-2 (]: 42 of 58 START test not_null_stg_customers_city ................................ [RUN]
[0m10:27:50.821401 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728, now test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8)
[0m10:27:50.822273 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8
[0m10:27:50.832604 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a"
[0m10:27:50.810626 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108"
[0m10:27:50.820250 [info ] [Thread-4 (]: 43 of 58 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m10:27:50.835047 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241, now test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m10:27:50.835988 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:27:50.848221 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108"
[0m10:27:50.849201 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108: BEGIN
[0m10:27:50.850012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:50.880237 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a
[0m10:27:50.893505 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a"
[0m10:27:50.897440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m10:27:50.900645 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108"
[0m10:27:50.901463 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select ontime_target
from "raw"."staging"."stg_customer_targets"
where ontime_target is null




    ) dbt_internal_test
[0m10:27:50.899622 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:27:50.902975 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:27:50.903813 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:27:50.912615 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108: ROLLBACK
[0m10:27:50.898580 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8"
[0m10:27:50.914072 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8
[0m10:27:50.915199 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108: Close
[0m10:27:50.916333 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a"
[0m10:27:50.929326 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a: BEGIN
[0m10:27:50.930000 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:50.933408 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:27:50.928640 [info ] [Thread-1 (]: 40 of 58 PASS not_null_stg_customer_targets_ontime_target ...................... [[32mPASS[0m in 0.19s]
[0m10:27:50.941096 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108
[0m10:27:50.941999 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60
[0m10:27:50.939737 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m10:27:50.944943 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a"
[0m10:27:50.945836 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select otif_target
from "raw"."staging"."stg_customer_targets"
where otif_target is null




    ) dbt_internal_test
[0m10:27:50.944233 [info ] [Thread-1 (]: 44 of 58 START test not_null_stg_customers_customer_name ....................... [RUN]
[0m10:27:50.947821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108, now test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60)
[0m10:27:50.943465 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:27:50.950292 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m10:27:50.951106 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:50.948700 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:27:50.954733 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a: ROLLBACK
[0m10:27:50.949420 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60
[0m10:27:50.955754 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8"
[0m10:27:50.967735 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8"
[0m10:27:50.971650 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8: BEGIN
[0m10:27:50.974412 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:50.973570 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a: Close
[0m10:27:50.972855 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m10:27:50.980727 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m10:27:50.981624 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select customer_id
from "raw"."staging"."stg_customers"
where customer_id is null




    ) dbt_internal_test
[0m10:27:50.977342 [info ] [Thread-3 (]: 41 of 58 PASS not_null_stg_customer_targets_otif_target ........................ [[32mPASS[0m in 0.18s]
[0m10:27:50.985121 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a
[0m10:27:50.983425 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:27:50.993324 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m10:27:50.994187 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m10:27:50.997079 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8"
[0m10:27:50.998089 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select city
from "raw"."staging"."stg_customers"
where city is null




    ) dbt_internal_test
[0m10:27:50.987934 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd
[0m10:27:51.001269 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:27:51.003910 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8: ROLLBACK
[0m10:27:50.998932 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m10:27:51.000523 [info ] [Thread-3 (]: 45 of 58 START test not_null_stg_dates_date .................................... [RUN]
[0m10:27:51.006074 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a, now test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd)
[0m10:27:50.996074 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60"
[0m10:27:51.005272 [info ] [Thread-4 (]: 43 of 58 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.17s]
[0m10:27:51.009851 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m10:27:51.006911 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd
[0m10:27:51.008796 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60
[0m10:27:51.023104 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60"
[0m10:27:51.017856 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8: Close
[0m10:27:51.010763 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8
[0m10:27:51.026852 [info ] [Thread-4 (]: 46 of 58 START test not_null_stg_order_fulfillment_in_full ..................... [RUN]
[0m10:27:51.028899 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8)
[0m10:27:51.030014 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8
[0m10:27:51.028219 [info ] [Thread-2 (]: 42 of 58 PASS not_null_stg_customers_city ...................................... [[32mPASS[0m in 0.21s]
[0m10:27:51.037732 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8
[0m10:27:51.038598 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996
[0m10:27:51.041816 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd"
[0m10:27:51.042699 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60"
[0m10:27:51.039388 [info ] [Thread-2 (]: 47 of 58 START test not_null_stg_order_fulfillment_on_time ..................... [RUN]
[0m10:27:51.045097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8, now test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996)
[0m10:27:51.046042 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996
[0m10:27:51.044126 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60: BEGIN
[0m10:27:51.054161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:51.056031 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd
[0m10:27:51.061324 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd"
[0m10:27:51.063069 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8"
[0m10:27:51.064816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m10:27:51.070919 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60"
[0m10:27:51.072734 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select customer_name
from "raw"."staging"."stg_customers"
where customer_name is null




    ) dbt_internal_test
[0m10:27:51.071942 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8
[0m10:27:51.078336 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8"
[0m10:27:51.079121 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m10:27:51.087398 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60: ROLLBACK
[0m10:27:51.084481 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd"
[0m10:27:51.088494 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd: BEGIN
[0m10:27:51.090107 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:51.089352 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60: Close
[0m10:27:51.083566 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996"
[0m10:27:51.094454 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8"
[0m10:27:51.105497 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8: BEGIN
[0m10:27:51.106397 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:51.092898 [info ] [Thread-1 (]: 44 of 58 PASS not_null_stg_customers_customer_name ............................. [[32mPASS[0m in 0.15s]
[0m10:27:51.096423 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996
[0m10:27:51.098571 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m10:27:51.115668 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd"
[0m10:27:51.116603 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select date
from "raw"."staging"."stg_dates"
where date is null




    ) dbt_internal_test
[0m10:27:51.108958 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60
[0m10:27:51.118616 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a
[0m10:27:51.120390 [info ] [Thread-1 (]: 48 of 58 START test not_null_stg_order_fulfillment_ontime_in_full .............. [RUN]
[0m10:27:51.119568 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:27:51.121644 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m10:27:51.132000 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8"
[0m10:27:51.128249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60, now test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a)
[0m10:27:51.134185 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a
[0m10:27:51.132906 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select in_full
from "raw"."staging"."stg_order_fulfillment"
where in_full is null




    ) dbt_internal_test
[0m10:27:51.131103 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd: ROLLBACK
[0m10:27:51.144651 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd: Close
[0m10:27:51.148362 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m10:27:51.143459 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996"
[0m10:27:51.153738 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996"
[0m10:27:51.149505 [info ] [Thread-3 (]: 45 of 58 PASS not_null_stg_dates_date .......................................... [[32mPASS[0m in 0.14s]
[0m10:27:51.156256 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd
[0m10:27:51.154827 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996: BEGIN
[0m10:27:51.158157 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:51.152070 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8: ROLLBACK
[0m10:27:51.160922 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8: Close
[0m10:27:51.157236 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:27:51.163851 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m10:27:51.170963 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996"
[0m10:27:51.172748 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select on_time
from "raw"."staging"."stg_order_fulfillment"
where on_time is null




    ) dbt_internal_test
[0m10:27:51.170336 [info ] [Thread-3 (]: 49 of 58 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m10:27:51.176443 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd, now test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5)
[0m10:27:51.177444 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:27:51.169500 [info ] [Thread-4 (]: 46 of 58 PASS not_null_stg_order_fulfillment_in_full ........................... [[32mPASS[0m in 0.14s]
[0m10:27:51.142443 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a"
[0m10:27:51.186785 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a
[0m10:27:51.185232 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8
[0m10:27:51.193659 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8
[0m10:27:51.187618 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.014 seconds
[0m10:27:51.192758 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a"
[0m10:27:51.194578 [info ] [Thread-4 (]: 50 of 58 START test not_null_stg_orders_order_placement_date ................... [RUN]
[0m10:27:51.198712 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8, now test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8)
[0m10:27:51.200366 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8
[0m10:27:51.197044 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996: ROLLBACK
[0m10:27:51.199610 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a"
[0m10:27:51.212638 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a: BEGIN
[0m10:27:51.213488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:51.215617 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996: Close
[0m10:27:51.216765 [info ] [Thread-2 (]: 47 of 58 PASS not_null_stg_order_fulfillment_on_time ........................... [[32mPASS[0m in 0.17s]
[0m10:27:51.217924 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996
[0m10:27:51.218642 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1
[0m10:27:51.231430 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:27:51.232477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m10:27:51.243520 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a"
[0m10:27:51.244600 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select ontime_in_full
from "raw"."staging"."stg_order_fulfillment"
where ontime_in_full is null




    ) dbt_internal_test
[0m10:27:51.248545 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m10:27:51.251160 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a: ROLLBACK
[0m10:27:51.219331 [info ] [Thread-2 (]: 51 of 58 START test not_null_stg_products_category ............................. [RUN]
[0m10:27:51.242025 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8"
[0m10:27:51.254796 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8
[0m10:27:51.252694 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:27:51.253763 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996, now test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1)
[0m10:27:51.269727 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1
[0m10:27:51.295200 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:27:51.303917 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8"
[0m10:27:51.308178 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a: Close
[0m10:27:51.310494 [info ] [Thread-1 (]: 48 of 58 PASS not_null_stg_order_fulfillment_ontime_in_full .................... [[32mPASS[0m in 0.19s]
[0m10:27:51.311543 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a
[0m10:27:51.309243 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:27:51.312250 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3
[0m10:27:51.313215 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8"
[0m10:27:51.318084 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m10:27:51.321424 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:51.320572 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8: BEGIN
[0m10:27:51.319304 [info ] [Thread-1 (]: 52 of 58 START test not_null_stg_products_product_id ........................... [RUN]
[0m10:27:51.327366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a, now test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3)
[0m10:27:51.323895 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:51.317098 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1"
[0m10:27:51.337616 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1
[0m10:27:51.343487 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1"
[0m10:27:51.333523 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3
[0m10:27:51.334683 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m10:27:51.351359 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m10:27:51.352179 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select customer_id
from "raw"."staging"."stg_orders"
where customer_id is null




    ) dbt_internal_test
[0m10:27:51.357549 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m10:27:51.362370 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8"
[0m10:27:51.778720 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select order_placement_date
from "raw"."staging"."stg_orders"
where order_placement_date is null




    ) dbt_internal_test
[0m10:27:51.364466 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m10:27:51.781778 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m10:27:51.782803 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m10:27:51.783853 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m10:27:51.787502 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8: ROLLBACK
[0m10:27:51.785235 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1"
[0m10:27:51.366723 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m10:27:51.789298 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1: BEGIN
[0m10:27:51.788615 [info ] [Thread-3 (]: 49 of 58 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.61s]
[0m10:27:51.789923 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8: Close
[0m10:27:51.790755 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3
[0m10:27:51.791257 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:51.791978 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m10:27:51.799366 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939
[0m10:27:51.798300 [info ] [Thread-4 (]: 50 of 58 PASS not_null_stg_orders_order_placement_date ......................... [[32mPASS[0m in 0.60s]
[0m10:27:51.797622 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m10:27:51.801304 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8
[0m10:27:51.800121 [info ] [Thread-3 (]: 53 of 58 START test not_null_stg_products_product_name ......................... [RUN]
[0m10:27:51.802599 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63
[0m10:27:51.804651 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5, now test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939)
[0m10:27:51.805335 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m10:27:51.805996 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m10:27:51.806861 [info ] [Thread-4 (]: 54 of 58 START test primary_key_stg_order_fulfillment_order_id ................. [RUN]
[0m10:27:51.807550 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939
[0m10:27:51.808092 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1"
[0m10:27:51.808695 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m10:27:51.809283 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8, now test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63)
[0m10:27:51.816546 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939"
[0m10:27:51.817179 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select category
from "raw"."staging"."stg_products"
where category is null




    ) dbt_internal_test
[0m10:27:51.817741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:51.818287 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63
[0m10:27:51.819159 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939
[0m10:27:51.826047 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63"
[0m10:27:51.826821 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m10:27:51.829341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m10:27:51.834426 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939"
[0m10:27:51.836338 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1: ROLLBACK
[0m10:27:51.837028 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3"
[0m10:27:51.837646 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63
[0m10:27:51.838449 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select product_id
from "raw"."staging"."stg_products"
where product_id is null




    ) dbt_internal_test
[0m10:27:51.839063 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1: Close
[0m10:27:51.843649 [info ] [Thread-2 (]: 51 of 58 PASS not_null_stg_products_category ................................... [[32mPASS[0m in 0.59s]
[0m10:27:51.844810 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1
[0m10:27:51.845560 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6
[0m10:27:51.839724 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939"
[0m10:27:51.842626 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63"
[0m10:27:51.846984 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m10:27:51.846288 [info ] [Thread-2 (]: 55 of 58 START test primary_key_stg_orders_order_id ............................ [RUN]
[0m10:27:51.847722 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939: BEGIN
[0m10:27:51.849632 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m10:27:51.850372 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63"
[0m10:27:51.851318 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1, now test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6)
[0m10:27:51.851890 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:51.852586 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3: Close
[0m10:27:51.854693 [info ] [Thread-1 (]: 52 of 58 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.53s]
[0m10:27:51.856161 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3
[0m10:27:51.857011 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9
[0m10:27:51.853080 [debug] [Thread-4 (]: On test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63: BEGIN
[0m10:27:51.858821 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:51.857881 [info ] [Thread-1 (]: 56 of 58 START test unique_stg_customer_targets_customer_id .................... [RUN]
[0m10:27:51.860137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3, now test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9)
[0m10:27:51.853616 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6
[0m10:27:51.861037 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9
[0m10:27:51.872576 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6"
[0m10:27:51.874304 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m10:27:51.873428 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m10:27:51.882778 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9"
[0m10:27:51.883557 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63"
[0m10:27:51.884211 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939"
[0m10:27:51.884883 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6
[0m10:27:51.885564 [debug] [Thread-4 (]: On test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (


WITH validation AS (
	SELECT
		order_id AS primary_key,
		COUNT(1) AS occurrences

	FROM "raw"."staging"."stg_order_fulfillment"
	GROUP BY 1
)

SELECT *

FROM validation
WHERE primary_key IS NULL
	OR occurrences > 1



    ) dbt_internal_test
[0m10:27:51.886253 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (






select product_name
from "raw"."staging"."stg_products"
where product_name is null




    ) dbt_internal_test
[0m10:27:51.889470 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6"
[0m10:27:51.891581 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:27:51.894200 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939: ROLLBACK
[0m10:27:51.895225 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6"
[0m10:27:51.896784 [debug] [Thread-2 (]: On test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6: BEGIN
[0m10:27:51.895928 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939: Close
[0m10:27:51.898717 [info ] [Thread-3 (]: 53 of 58 PASS not_null_stg_products_product_name ............................... [[32mPASS[0m in 0.10s]
[0m10:27:51.899822 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939
[0m10:27:51.890074 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9
[0m10:27:51.905856 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9"
[0m10:27:51.900719 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada
[0m10:27:51.906806 [info ] [Thread-3 (]: 57 of 58 START test unique_stg_customers_customer_id ........................... [RUN]
[0m10:27:51.907684 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939, now test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada)
[0m10:27:51.897596 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:27:51.908429 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada
[0m10:27:51.909254 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.019 seconds
[0m10:27:51.910150 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9"
[0m10:27:51.921568 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m10:27:51.924405 [debug] [Thread-1 (]: On test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9: BEGIN
[0m10:27:51.923572 [debug] [Thread-4 (]: On test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63: ROLLBACK
[0m10:27:51.921205 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada"
[0m10:27:51.925252 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6"
[0m10:27:51.925844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:51.926539 [debug] [Thread-4 (]: On test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63: Close
[0m10:27:51.927248 [debug] [Thread-2 (]: On test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (


WITH validation AS (
	SELECT
		order_id AS primary_key,
		COUNT(1) AS occurrences

	FROM "raw"."staging"."stg_orders"
	GROUP BY 1
)

SELECT *

FROM validation
WHERE primary_key IS NULL
	OR occurrences > 1



    ) dbt_internal_test
[0m10:27:51.932174 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada
[0m10:27:51.928638 [info ] [Thread-4 (]: 54 of 58 PASS primary_key_stg_order_fulfillment_order_id ....................... [[32mPASS[0m in 0.12s]
[0m10:27:52.023918 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada"
[0m10:27:52.024591 [debug] [Thread-1 (]: SQL status: BEGIN in 0.099 seconds
[0m10:27:52.026904 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9"
[0m10:27:52.027719 [debug] [Thread-1 (]: On test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




select
    customer_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_customer_targets"
where customer_id is not null
group by customer_id
having count(*) > 1




    ) dbt_internal_test
[0m10:27:52.025105 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.096 seconds
[0m10:27:52.026050 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63
[0m10:27:52.030240 [debug] [Thread-2 (]: On test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6: ROLLBACK
[0m10:27:52.030802 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m10:27:52.031569 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada"
[0m10:27:52.032132 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467
[0m10:27:52.034330 [debug] [Thread-1 (]: On test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9: ROLLBACK
[0m10:27:52.034823 [debug] [Thread-2 (]: On test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6: Close
[0m10:27:52.037271 [debug] [Thread-1 (]: On test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9: Close
[0m10:27:52.036393 [info ] [Thread-4 (]: 58 of 58 START test unique_stg_products_product_id ............................. [RUN]
[0m10:27:52.038183 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63, now test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467)
[0m10:27:52.038895 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467
[0m10:27:52.035427 [debug] [Thread-3 (]: On test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m10:27:52.047904 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467"
[0m10:27:52.045777 [info ] [Thread-1 (]: 56 of 58 PASS unique_stg_customer_targets_customer_id .......................... [[32mPASS[0m in 0.19s]
[0m10:27:52.048693 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:27:52.046421 [info ] [Thread-2 (]: 55 of 58 PASS primary_key_stg_orders_order_id .................................. [[32mPASS[0m in 0.20s]
[0m10:27:52.049852 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9
[0m10:27:52.050949 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6
[0m10:27:52.053749 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467
[0m10:27:52.059273 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467"
[0m10:27:52.059864 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m10:27:52.060790 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada"
[0m10:27:52.061464 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467"
[0m10:27:52.062412 [debug] [Thread-3 (]: On test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




select
    customer_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1




    ) dbt_internal_test
[0m10:27:52.063080 [debug] [Thread-4 (]: On test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467: BEGIN
[0m10:27:52.063828 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:27:52.065080 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:27:52.067544 [debug] [Thread-3 (]: On test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m10:27:52.069018 [debug] [Thread-3 (]: On test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada: Close
[0m10:27:52.072937 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m10:27:52.073693 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467"
[0m10:27:52.074452 [debug] [Thread-4 (]: On test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (




select
    product_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1




    ) dbt_internal_test
[0m10:27:52.076174 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m10:27:52.079654 [debug] [Thread-4 (]: On test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m10:27:52.080329 [info ] [Thread-3 (]: 57 of 58 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.17s]
[0m10:27:52.081156 [debug] [Thread-4 (]: On test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467: Close
[0m10:27:52.082765 [info ] [Thread-4 (]: 58 of 58 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.04s]
[0m10:27:52.084269 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467
[0m10:27:52.081904 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada
[0m10:27:52.086463 [info ] [MainThread]:
[0m10:27:52.087092 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:52.087565 [debug] [MainThread]: On master: BEGIN
[0m10:27:52.088400 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:27:52.092099 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m10:27:52.094192 [debug] [MainThread]: On master: COMMIT
[0m10:27:52.094986 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:52.095743 [debug] [MainThread]: On master: COMMIT
[0m10:27:52.096441 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:27:52.129490 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:52.130164 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */


    select artifacts_model, metadata_hash from "raw"."elementary"."dbt_artifacts_hashes"
    order by metadata_hash


[0m10:27:52.132673 [debug] [MainThread]: SQL status: SELECT 201 in 0.002 seconds
[0m10:27:52.138517 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m10:27:52.169006 [debug] [MainThread]: Elementary: [dbt_models] Flattening the artifacts.
[0m10:27:52.253158 [debug] [MainThread]: Elementary: [dbt_models] Flattened 45 artifacts.
[0m10:27:52.263156 [debug] [MainThread]: Elementary: [dbt_models] Comparing the artifacts state.
[0m10:27:52.264998 [debug] [MainThread]: Elementary: [dbt_models] Artifacts did not change.
[0m10:27:52.267104 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:
[0m10:27:52.268733 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.082712 (1 runs)
[0m10:27:52.270591 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.097990 (1 runs)
[0m10:27:52.274563 [debug] [MainThread]: Elementary: [dbt_tests] Flattening the artifacts.
[0m10:27:52.611913 [debug] [MainThread]: Elementary: [dbt_tests] Flattened 60 artifacts.
[0m10:27:52.613588 [debug] [MainThread]: Elementary: [dbt_tests] Comparing the artifacts state.
[0m10:27:52.614660 [debug] [MainThread]: Elementary: [dbt_tests] Artifacts did not change.
[0m10:27:52.615998 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:
[0m10:27:52.617033 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.335438 (1 runs)
[0m10:27:52.618133 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.341827 (1 runs)
[0m10:27:52.620290 [debug] [MainThread]: Elementary: [dbt_sources] Flattening the artifacts.
[0m10:27:52.643708 [debug] [MainThread]: Elementary: [dbt_sources] Flattened 7 artifacts.
[0m10:27:52.645152 [debug] [MainThread]: Elementary: [dbt_sources] Comparing the artifacts state.
[0m10:27:52.646101 [debug] [MainThread]: Elementary: [dbt_sources] Artifacts did not change.
[0m10:27:52.647483 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:
[0m10:27:52.648493 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.022263 (1 runs)
[0m10:27:52.649519 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.027052 (1 runs)
[0m10:27:52.651475 [debug] [MainThread]: Elementary: [dbt_snapshots] Flattening the artifacts.
[0m10:27:52.654772 [debug] [MainThread]: Elementary: [dbt_snapshots] Flattened 2 artifacts.
[0m10:27:52.656111 [debug] [MainThread]: Elementary: [dbt_snapshots] Comparing the artifacts state.
[0m10:27:52.657071 [debug] [MainThread]: Elementary: [dbt_snapshots] Artifacts did not change.
[0m10:27:52.658438 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:
[0m10:27:52.659431 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.002189 (1 runs)
[0m10:27:52.660438 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.006906 (1 runs)
[0m10:27:52.662528 [debug] [MainThread]: Elementary: [dbt_metrics] Flattening the artifacts.
[0m10:27:52.664042 [debug] [MainThread]: Elementary: [dbt_metrics] Flattened 0 artifacts.
[0m10:27:52.665366 [debug] [MainThread]: Elementary: [dbt_metrics] Comparing the artifacts state.
[0m10:27:52.666269 [debug] [MainThread]: Elementary: [dbt_metrics] Artifacts did not change.
[0m10:27:52.667623 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:
[0m10:27:52.668710 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00.000307 (1 runs)
[0m10:27:52.669698 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.005047 (1 runs)
[0m10:27:52.671773 [debug] [MainThread]: Elementary: [dbt_exposures] Flattening the artifacts.
[0m10:27:52.673221 [debug] [MainThread]: Elementary: [dbt_exposures] Flattened 0 artifacts.
[0m10:27:52.674514 [debug] [MainThread]: Elementary: [dbt_exposures] Comparing the artifacts state.
[0m10:27:52.675519 [debug] [MainThread]: Elementary: [dbt_exposures] Artifacts did not change.
[0m10:27:52.676886 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:
[0m10:27:52.677910 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00.000309 (1 runs)
[0m10:27:52.678890 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.005057 (1 runs)
[0m10:27:52.680944 [debug] [MainThread]: Elementary: [dbt_seeds] Flattening the artifacts.
[0m10:27:52.682571 [debug] [MainThread]: Elementary: [dbt_seeds] Flattened 0 artifacts.
[0m10:27:52.684552 [debug] [MainThread]: Elementary: [dbt_seeds] Comparing the artifacts state.
[0m10:27:52.685482 [debug] [MainThread]: Elementary: [dbt_seeds] Artifacts did not change.
[0m10:27:52.686767 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:
[0m10:27:52.688076 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00.000418 (1 runs)
[0m10:27:52.689624 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.005753 (1 runs)
[0m10:27:52.694365 [debug] [MainThread]: Elementary: [dbt_columns] Flattening the artifacts.
[0m10:27:52.937143 [debug] [MainThread]: Elementary: [dbt_columns] Flattened 87 artifacts.
[0m10:27:52.938714 [debug] [MainThread]: Elementary: [dbt_columns] Comparing the artifacts state.
[0m10:27:52.939804 [debug] [MainThread]: Elementary: [dbt_columns] Artifacts did not change.
[0m10:27:52.941137 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:
[0m10:27:52.942214 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.239233 (1 runs)
[0m10:27:52.943157 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.246822 (1 runs)
[0m10:27:52.944169 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m10:27:52.948442 [debug] [MainThread]: Elementary: Uploading run results.
[0m10:27:52.949477 [debug] [MainThread]: Elementary: [dbt_run_results] Flattening the artifacts.
[0m10:27:53.035693 [debug] [MainThread]: Elementary: [dbt_run_results] Flattened 58 artifacts.
[0m10:27:53.053161 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:53.053720 [debug] [MainThread]: On master: BEGIN
[0m10:27:53.054387 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:27:53.054902 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:53.055419 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_run_results'

        and table_schema = 'elementary'

      order by ordinal_position


[0m10:27:53.061956 [debug] [MainThread]: SQL status: SELECT 22 in 0.006 seconds
[0m10:27:53.065136 [debug] [MainThread]: Elementary: Inserting 58 rows to table "raw"."elementary"."dbt_run_results"
[0m10:27:53.993886 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m10:27:53.995594 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:53.998354 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */


       insert into "raw"."elementary"."dbt_run_results"
         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values
    ('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e','test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:52',
    current_timestamp::timestamp
,'accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town',NULL,'pass','test',0.2597537040710449,'2025-02-10T10:27:48.522761Z','2025-02-10T10:27:48.688775Z','2025-02-10T10:27:48.464449Z','2025-02-10T10:27:48.521811Z',1,False,'



with all_values as (

    select
        city as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_customers"
    group by city

)

select *
from all_values
where value_field not in (
    ''Klerksdorp'',''Polokwane'',''Stellenbosch'',''Paarl'',''East London'',''Grahamstown'',''George'',''Upington'',''Bloemfontein'',''Worcester'',''Pietermaritzburg'',''Pretoria'',''Nelspruit'',''Kimberley'',''Johannesburg'',''Cape Town''
)


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:52',
    current_timestamp::timestamp
,'accepted_values_stg_order_fulfillment_in_full__True__0__1',NULL,'pass','test',0.27126479148864746,'2025-02-10T10:27:48.502975Z','2025-02-10T10:27:48.703411Z','2025-02-10T10:27:48.454553Z','2025-02-10T10:27:48.502118Z',1,False,'



with all_values as (

    select
        in_full as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by in_full

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:52',
    current_timestamp::timestamp
,'accepted_values_stg_order_fulfillment_on_time__True__0__1',NULL,'pass','test',0.28659772872924805,'2025-02-10T10:27:48.487444Z','2025-02-10T10:27:48.701123Z','2025-02-10T10:27:48.443947Z','2025-02-10T10:27:48.486470Z',1,False,'



with all_values as (

    select
        on_time as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by on_time

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:52',
    current_timestamp::timestamp
,'accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1',NULL,'pass','test',0.28966450691223145,'2025-02-10T10:27:48.539115Z','2025-02-10T10:27:48.731619Z','2025-02-10T10:27:48.473282Z','2025-02-10T10:27:48.538233Z',1,False,'



with all_values as (

    select
        ontime_in_full as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by ontime_in_full

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478','test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:52',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True',NULL,'pass','test',0.109344482421875,'2025-02-10T10:27:48.799653Z','2025-02-10T10:27:48.857900Z','2025-02-10T10:27:48.761676Z','2025-02-10T10:27:48.798764Z',1,False,'





    with grouped_expression as (
    select



  infull_target >= otif_target as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:52',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2',NULL,'pass','test',0.1111760139465332,'2025-02-10T10:27:48.806402Z','2025-02-10T10:27:48.855075Z','2025-02-10T10:27:48.770766Z','2025-02-10T10:27:48.805589Z',1,False,'





    with grouped_expression as (
    select




( 1=1 and length(
        city
    ) >= 2 and length(
        city
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc','test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:52',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True',NULL,'pass','test',0.14183425903320312,'2025-02-10T10:27:48.819933Z','2025-02-10T10:27:48.883694Z','2025-02-10T10:27:48.780023Z','2025-02-10T10:27:48.819090Z',1,False,'





    with grouped_expression as (
    select



  ontime_target >= otif_target as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575','test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:52',
    current_timestamp::timestamp
,'accepted_values_stg_products_category__Dairy__beverages__Food',NULL,'pass','test',0.18972349166870117,'2025-02-10T10:27:48.813733Z','2025-02-10T10:27:48.918018Z','2025-02-10T10:27:48.791097Z','2025-02-10T10:27:48.812862Z',1,False,'



with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_products"
    group by category

)

select *
from all_values
where value_field not in (
    ''Dairy'',''beverages'',''Food''
)


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:52',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1',NULL,'pass','test',0.2604026794433594,'2025-02-10T10:27:49.091256Z','2025-02-10T10:27:49.152804Z','2025-02-10T10:27:48.919039Z','2025-02-10T10:27:49.090431Z',1,False,'





    with grouped_expression as (
    select




( 1=1 and length(
        customer_id
    ) >= 1 and length(
        customer_id
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:52',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2',NULL,'pass','test',0.2826368808746338,'2025-02-10T10:27:49.084721Z','2025-02-10T10:27:49.161044Z','2025-02-10T10:27:48.907285Z','2025-02-10T10:27:48.949805Z',1,False,'





    with grouped_expression as (
    select




( 1=1 and length(
        customer_name
    ) >= 2 and length(
        customer_name
    ) <= 100
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:52',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1',NULL,'pass','test',0.2561795711517334,'2025-02-10T10:27:49.097607Z','2025-02-10T10:27:49.177476Z','2025-02-10T10:27:48.933582Z','2025-02-10T10:27:49.096758Z',1,False,'





    with grouped_expression as (
    select




( 1=1 and length(
        order_id
    ) >= 1 and length(
        order_id
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:52',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2',NULL,'pass','test',0.2836189270019531,'2025-02-10T10:27:49.123333Z','2025-02-10T10:27:49.220760Z','2025-02-10T10:27:48.959007Z','2025-02-10T10:27:49.122310Z',1,False,'





    with grouped_expression as (
    select




( 1=1 and length(
        category
    ) >= 2 and length(
        category
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:52',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0',NULL,'pass','test',0.11799120903015137,'2025-02-10T10:27:49.236961Z','2025-02-10T10:27:49.312632Z','2025-02-10T10:27:49.202084Z','2025-02-10T10:27:49.236047Z',1,False,'






    with grouped_expression as (
    select




( 1=1 and infull_target >= 0 and infull_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:52',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10',NULL,'pass','test',0.14839839935302734,'2025-02-10T10:27:49.249017Z','2025-02-10T10:27:49.316270Z','2025-02-10T10:27:49.193352Z','2025-02-10T10:27:49.247916Z',1,False,'




    with grouped_expression as (
    select





    length(
        date
    ) = 10 as expression


    from "raw"."staging"."stg_dates"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1',NULL,'pass','test',0.15723133087158203,'2025-02-10T10:27:49.268635Z','2025-02-10T10:27:49.348656Z','2025-02-10T10:27:49.222405Z','2025-02-10T10:27:49.266523Z',1,False,'





    with grouped_expression as (
    select




( 1=1 and length(
        product_name
    ) >= 1 and length(
        product_name
    ) <= 100
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0',NULL,'pass','test',0.1500401496887207,'2025-02-10T10:27:49.298747Z','2025-02-10T10:27:49.390170Z','2025-02-10T10:27:49.258253Z','2025-02-10T10:27:49.297853Z',1,False,'






    with grouped_expression as (
    select




( 1=1 and ontime_target >= 0 and ontime_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0',NULL,'pass','test',0.15906167030334473,'2025-02-10T10:27:49.401305Z','2025-02-10T10:27:49.480243Z','2025-02-10T10:27:49.351588Z','2025-02-10T10:27:49.400452Z',1,False,'






    with grouped_expression as (
    select




( 1=1 and otif_target >= 0 and otif_target <= 100
)
 as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_',NULL,'pass','test',0.1574704647064209,'2025-02-10T10:27:49.411512Z','2025-02-10T10:27:49.495685Z','2025-02-10T10:27:49.363410Z','2025-02-10T10:27:49.410429Z',1,False,'






    with grouped_expression as (
    select




( 1=1 and order_placement_date >= ''2024-01-01'' and order_placement_date <= current_date
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True',NULL,'pass','test',0.18090009689331055,'2025-02-10T10:27:49.423730Z','2025-02-10T10:27:49.522555Z','2025-02-10T10:27:49.391118Z','2025-02-10T10:27:49.421481Z',1,False,'






    with grouped_expression as (
    select




( 1=1 and product_id > 1
)
 as expression


    from "raw"."staging"."stg_products"
    where
        product_id IS NOT NULL



),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors







',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food',NULL,'pass','test',0.19777393341064453,'2025-02-10T10:27:49.485912Z','2025-02-10T10:27:49.609458Z','2025-02-10T10:27:49.429241Z','2025-02-10T10:27:49.482460Z',1,False,'

with all_values as (

    select
        category as value_field

    from "raw"."staging"."stg_products"


),
set_values as (

    select
        cast(''Dairy'' as TEXT) as value_field
    union all
    select
        cast(''beverages'' as TEXT) as value_field
    union all
    select
        cast(''Food'' as TEXT) as value_field


),
validation_errors as (
    -- values from the model that are not in the set
    select
        v.value_field
    from
        all_values v
        left join
        set_values s on v.value_field = s.value_field
    where
        s.value_field is null

)

select *
from validation_errors

',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_.0423a3db39','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_match_regex_stg_customers_city___A_Za_z_s_',NULL,'pass','test',0.17029690742492676,'2025-02-10T10:27:49.583701Z','2025-02-10T10:27:49.693592Z','2025-02-10T10:27:49.543242Z','2025-02-10T10:27:49.568805Z',1,False,'




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(city, ''^[A-Za-z\s\-\.]+$'', '''')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_.96dd2aa828','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_match_regex_stg_customers_customer_name___A_Za_z0_9_s_',NULL,'pass','test',0.136976957321167,'2025-02-10T10:27:49.643932Z','2025-02-10T10:27:49.704388Z','2025-02-10T10:27:49.600106Z','2025-02-10T10:27:49.642237Z',1,False,'




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(customer_name, ''^[A-Za-z0-9\s\-\.]+$'', '''')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date',NULL,'pass','test',0.280942440032959,'2025-02-10T10:27:49.739396Z','2025-02-10T10:27:49.799470Z','2025-02-10T10:27:49.530901Z','2025-02-10T10:27:49.726720Z',1,False,'with relation_columns as (


        select
            cast(''ORDER_ID'' as TEXT) as relation_column,
            cast(''TEXT'' as TEXT) as relation_column_type
        union all

        select
            cast(''CUSTOMER_ID'' as TEXT) as relation_column,
            cast(''TEXT'' as TEXT) as relation_column_type
        union all

        select
            cast(''ORDER_PLACEMENT_DATE'' as TEXT) as relation_column,
            cast(''DATE'' as TEXT) as relation_column_type


    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = ''ORDER_PLACEMENT_DATE''
            and
            relation_column_type not in (''DATE'')

    )
    select *
    from test_data',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_',NULL,'pass','test',0.18764185905456543,'2025-02-10T10:27:49.776316Z','2025-02-10T10:27:49.901522Z','2025-02-10T10:27:49.727488Z','2025-02-10T10:27:49.772997Z',1,False,'




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(product_name, ''^\\s*$'', '''')), 1), 0)


 = 0
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86','test.nexabrands_dbt.dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___.2da099af86','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_column_values_to_match_regex_stg_order_fulfillment_order_id___A_Za_z0_9___',NULL,'pass','test',0.31804466247558594,'2025-02-10T10:27:49.683553Z','2025-02-10T10:27:49.929842Z','2025-02-10T10:27:49.650329Z','2025-02-10T10:27:49.681376Z',1,False,'




    with grouped_expression as (
    select








coalesce(array_length((select regexp_matches(order_id, ''^[A-Za-z0-9\-_]+$'', '''')), 1), 0)


 > 0
 as expression


    from "raw"."staging"."stg_order_fulfillment"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a','test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id',NULL,'pass','test',0.25441765785217285,'2025-02-10T10:27:49.845424Z','2025-02-10T10:27:49.994635Z','2025-02-10T10:27:49.764651Z','2025-02-10T10:27:49.825063Z',1,False,'



with validation_errors as (

    select
        customer_id,order_placement_date,order_id,
        count(*) as "n_records"
    from "raw"."staging"."stg_orders"
    where
        1=1
        and
    not (
        customer_id is null and
        order_placement_date is null and
        order_id is null

    )



    group by
        customer_id,order_placement_date,order_id
    having count(*) > 1

)
select * from validation_errors
',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419','test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category',NULL,'pass','test',0.19458389282226562,'2025-02-10T10:27:49.862240Z','2025-02-10T10:27:49.968382Z','2025-02-10T10:27:49.826777Z','2025-02-10T10:27:49.856462Z',1,False,'



with validation_errors as (

    select
        product_name,category,
        count(*) as "n_records"
    from "raw"."staging"."stg_products"
    where
        1=1
        and
    not (
        product_name is null and
        category is null

    )



    group by
        product_name,category
    having count(*) > 1

)
select * from validation_errors
',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date',NULL,'pass','test',0.29889893531799316,'2025-02-10T10:27:50.153934Z','2025-02-10T10:27:50.221223Z','2025-02-10T10:27:49.946106Z','2025-02-10T10:27:50.152736Z',1,False,'with relation_columns as (


        select
            1 as relation_column_idx,
            cast(''ORDER_ID'' as TEXT) as relation_column
        union all

        select
            2 as relation_column_idx,
            cast(''CUSTOMER_ID'' as TEXT) as relation_column
        union all

        select
            3 as relation_column_idx,
            cast(''ORDER_PLACEMENT_DATE'' as TEXT) as relation_column


    ),
    input_columns as (


        select
            1 as input_column_idx,
            cast(''ORDER_ID'' as TEXT) as input_column
        union all

        select
            2 as input_column_idx,
            cast(''CUSTOMER_ID'' as TEXT) as input_column
        union all

        select
            3 as input_column_idx,
            cast(''ORDER_PLACEMENT_DATE'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx
    where
        -- catch any column in input list that is not in the sequence of table columns
        -- or any table column that is not in the input sequence
        r.relation_column is null or
        i.input_column is null',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category',NULL,'pass','test',0.27484130859375,'2025-02-10T10:27:50.165165Z','2025-02-10T10:27:50.232685Z','2025-02-10T10:27:49.975305Z','2025-02-10T10:27:50.164316Z',1,False,'with relation_columns as (


        select
            1 as relation_column_idx,
            cast(''PRODUCT_ID'' as TEXT) as relation_column
        union all

        select
            2 as relation_column_idx,
            cast(''PRODUCT_NAME'' as TEXT) as relation_column
        union all

        select
            3 as relation_column_idx,
            cast(''CATEGORY'' as TEXT) as relation_column


    ),
    input_columns as (


        select
            1 as input_column_idx,
            cast(''PRODUCT_ID'' as TEXT) as input_column
        union all

        select
            2 as input_column_idx,
            cast(''PRODUCT_NAME'' as TEXT) as input_column
        union all

        select
            3 as input_column_idx,
            cast(''CATEGORY'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx
    where
        -- catch any column in input list that is not in the sequence of table columns
        -- or any table column that is not in the input sequence
        r.relation_column is null or
        i.input_column is null',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_columns_to_match_set_stg_dates_date',NULL,'pass','test',0.40509557723999023,'2025-02-10T10:27:50.201247Z','2025-02-10T10:27:50.281660Z','2025-02-10T10:27:50.034552Z','2025-02-10T10:27:50.195761Z',1,False,'with relation_columns as (


        select cast(''DATE'' as TEXT) as relation_column


    ),
    input_columns as (


        select cast(''DATE'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city',NULL,'pass','test',0.4103844165802002,'2025-02-10T10:27:50.248382Z','2025-02-10T10:27:50.433555Z','2025-02-10T10:27:50.044183Z','2025-02-10T10:27:50.241754Z',1,False,'with relation_columns as (


        select cast(''CUSTOMER_ID'' as TEXT) as relation_column
        union all

        select cast(''CUSTOMER_NAME'' as TEXT) as relation_column
        union all

        select cast(''CITY'' as TEXT) as relation_column


    ),
    input_columns as (


        select cast(''CUSTOMER_ID'' as TEXT) as input_column
        union all

        select cast(''CUSTOMER_NAME'' as TEXT) as input_column
        union all

        select cast(''CITY'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1.c99103eefc','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_row_count_to_be_between_stg_customers_40__1',NULL,'pass','test',0.2727952003479004,'2025-02-10T10:27:50.443832Z','2025-02-10T10:27:50.521040Z','2025-02-10T10:27:50.270304Z','2025-02-10T10:27:50.441353Z',1,False,'



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 40
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1',NULL,'pass','test',0.11752891540527344,'2025-02-10T10:27:50.488336Z','2025-02-10T10:27:50.561681Z','2025-02-10T10:27:50.457554Z','2025-02-10T10:27:50.487487Z',1,False,'



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1
)
 as expression


    from "raw"."staging"."stg_dates"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1',NULL,'pass','test',0.12416219711303711,'2025-02-10T10:27:50.499244Z','2025-02-10T10:27:50.566775Z','2025-02-10T10:27:50.473380Z','2025-02-10T10:27:50.498467Z',1,False,'



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1
)
 as expression


    from "raw"."staging"."stg_order_fulfillment"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185','test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full',NULL,'pass','test',0.37175679206848145,'2025-02-10T10:27:50.541955Z','2025-02-10T10:27:50.597837Z','2025-02-10T10:27:50.255849Z','2025-02-10T10:27:50.538668Z',1,False,'with relation_columns as (


        select cast(''ORDER_ID'' as TEXT) as relation_column
        union all

        select cast(''ON_TIME'' as TEXT) as relation_column
        union all

        select cast(''IN_FULL'' as TEXT) as relation_column
        union all

        select cast(''ONTIME_IN_FULL'' as TEXT) as relation_column


    ),
    input_columns as (


        select cast(''ORDER_ID'' as TEXT) as input_column
        union all

        select cast(''ON_TIME'' as TEXT) as input_column
        union all

        select cast(''IN_FULL'' as TEXT) as input_column
        union all

        select cast(''ONTIME_IN_FULL'' as TEXT) as input_column


    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column
    where
        -- catch any column in input list that is not in the list of table columns
        -- or any table column that is not in the input list
        r.relation_column is null or
        i.input_column is null',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1',NULL,'pass','test',0.1449904441833496,'2025-02-10T10:27:50.632384Z','2025-02-10T10:27:50.706448Z','2025-02-10T10:27:50.580199Z','2025-02-10T10:27:50.630540Z',1,False,'



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 10000000
)
 as expression


    from "raw"."staging"."stg_orders"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191','test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1',NULL,'pass','test',0.19055867195129395,'2025-02-10T10:27:50.677042Z','2025-02-10T10:27:50.755048Z','2025-02-10T10:27:50.618476Z','2025-02-10T10:27:50.675927Z',1,False,'



    with grouped_expression as (
    select




( 1=1 and count(*) >= 1 and count(*) <= 100
)
 as expression


    from "raw"."staging"."stg_products"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728','test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_customer_targets_infull_target',NULL,'pass','test',0.15362215042114258,'2025-02-10T10:27:50.690489Z','2025-02-10T10:27:50.778178Z','2025-02-10T10:27:50.642295Z','2025-02-10T10:27:50.683073Z',1,False,'





select infull_target
from "raw"."staging"."stg_customer_targets"
where infull_target is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241','test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_customer_targets_customer_id',NULL,'pass','test',0.18804144859313965,'2025-02-10T10:27:50.699515Z','2025-02-10T10:27:50.769485Z','2025-02-10T10:27:50.605702Z','2025-02-10T10:27:50.697598Z',1,False,'





select customer_id
from "raw"."staging"."stg_customer_targets"
where customer_id is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108','test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_customer_targets_ontime_target',NULL,'pass','test',0.1921253204345703,'2025-02-10T10:27:50.805859Z','2025-02-10T10:27:50.912346Z','2025-02-10T10:27:50.738215Z','2025-02-10T10:27:50.804991Z',1,False,'





select ontime_target
from "raw"."staging"."stg_customer_targets"
where ontime_target is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a','test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_customer_targets_otif_target',NULL,'pass','test',0.18242859840393066,'2025-02-10T10:27:50.884836Z','2025-02-10T10:27:50.954549Z','2025-02-10T10:27:50.796848Z','2025-02-10T10:27:50.879971Z',1,False,'





select otif_target
from "raw"."staging"."stg_customer_targets"
where otif_target is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa','test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_customers_customer_id',NULL,'pass','test',0.1702277660369873,'2025-02-10T10:27:50.904359Z','2025-02-10T10:27:50.993145Z','2025-02-10T10:27:50.836658Z','2025-02-10T10:27:50.902786Z',1,False,'





select customer_id
from "raw"."staging"."stg_customers"
where customer_id is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8','test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_customers_city',NULL,'pass','test',0.20683979988098145,'2025-02-10T10:27:50.916932Z','2025-02-10T10:27:51.003721Z','2025-02-10T10:27:50.823097Z','2025-02-10T10:27:50.913907Z',1,False,'





select city
from "raw"."staging"."stg_customers"
where city is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60','test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_customers_customer_name',NULL,'pass','test',0.14502263069152832,'2025-02-10T10:27:51.018529Z','2025-02-10T10:27:51.087198Z','2025-02-10T10:27:50.958108Z','2025-02-10T10:27:51.008604Z',1,False,'





select customer_name
from "raw"."staging"."stg_customers"
where customer_name is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd','test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_dates_date',NULL,'pass','test',0.14334964752197266,'2025-02-10T10:27:51.056681Z','2025-02-10T10:27:51.130908Z','2025-02-10T10:27:51.011632Z','2025-02-10T10:27:51.055845Z',1,False,'





select date
from "raw"."staging"."stg_dates"
where date is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8','test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_order_fulfillment_in_full',NULL,'pass','test',0.1405189037322998,'2025-02-10T10:27:51.073629Z','2025-02-10T10:27:51.151709Z','2025-02-10T10:27:51.030685Z','2025-02-10T10:27:51.071758Z',1,False,'





select in_full
from "raw"."staging"."stg_order_fulfillment"
where in_full is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996','test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_order_fulfillment_on_time',NULL,'pass','test',0.17156529426574707,'2025-02-10T10:27:51.109816Z','2025-02-10T10:27:51.196846Z','2025-02-10T10:27:51.047104Z','2025-02-10T10:27:51.096232Z',1,False,'





select on_time
from "raw"."staging"."stg_order_fulfillment"
where on_time is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a','test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_order_fulfillment_ontime_in_full',NULL,'pass','test',0.18784809112548828,'2025-02-10T10:27:51.188193Z','2025-02-10T10:27:51.250974Z','2025-02-10T10:27:51.134978Z','2025-02-10T10:27:51.186594Z',1,False,'





select ontime_in_full
from "raw"."staging"."stg_order_fulfillment"
where ontime_in_full is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5','test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_orders_customer_id',NULL,'pass','test',0.6120848655700684,'2025-02-10T10:27:51.264131Z','2025-02-10T10:27:51.781583Z','2025-02-10T10:27:51.178141Z','2025-02-10T10:27:51.252450Z',1,False,'





select customer_id
from "raw"."staging"."stg_orders"
where customer_id is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8','test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_orders_order_placement_date',NULL,'pass','test',0.5997917652130127,'2025-02-10T10:27:51.255438Z','2025-02-10T10:27:51.787336Z','2025-02-10T10:27:51.201043Z','2025-02-10T10:27:51.254611Z',1,False,'





select order_placement_date
from "raw"."staging"."stg_orders"
where order_placement_date is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1','test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_products_category',NULL,'pass','test',0.589853048324585,'2025-02-10T10:27:51.338661Z','2025-02-10T10:27:51.836211Z','2025-02-10T10:27:51.270385Z','2025-02-10T10:27:51.337436Z',1,False,'





select category
from "raw"."staging"."stg_products"
where category is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3','test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_products_product_id',NULL,'pass','test',0.5273163318634033,'2025-02-10T10:27:51.792617Z','2025-02-10T10:27:51.849510Z','2025-02-10T10:27:51.344666Z','2025-02-10T10:27:51.790570Z',1,False,'





select product_id
from "raw"."staging"."stg_products"
where product_id is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939','test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'not_null_stg_products_product_name',NULL,'pass','test',0.09503722190856934,'2025-02-10T10:27:51.830508Z','2025-02-10T10:27:51.894021Z','2025-02-10T10:27:51.809732Z','2025-02-10T10:27:51.818996Z',1,False,'





select product_name
from "raw"."staging"."stg_products"
where product_name is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63','test.nexabrands_dbt.primary_key_stg_order_fulfillment_order_id.bfcd37ee63','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'primary_key_stg_order_fulfillment_order_id',NULL,'pass','test',0.11922979354858398,'2025-02-10T10:27:51.840086Z','2025-02-10T10:27:51.923435Z','2025-02-10T10:27:51.820153Z','2025-02-10T10:27:51.837504Z',1,False,'

WITH validation AS (
	SELECT
		order_id AS primary_key,
		COUNT(1) AS occurrences

	FROM "raw"."staging"."stg_order_fulfillment"
	GROUP BY 1
)

SELECT *

FROM validation
WHERE primary_key IS NULL
	OR occurrences > 1

',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9','test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'unique_stg_customer_targets_customer_id',NULL,'pass','test',0.18565654754638672,'2025-02-10T10:27:51.901448Z','2025-02-10T10:27:52.034028Z','2025-02-10T10:27:51.874878Z','2025-02-10T10:27:51.889928Z',1,False,'



select
    customer_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_customer_targets"
where customer_id is not null
group by customer_id
having count(*) > 1


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6','test.nexabrands_dbt.primary_key_stg_orders_order_id.ff02ba6ab6','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'primary_key_stg_orders_order_id',NULL,'pass','test',0.19508647918701172,'2025-02-10T10:27:51.886719Z','2025-02-10T10:27:52.030112Z','2025-02-10T10:27:51.861749Z','2025-02-10T10:27:51.884715Z',1,False,'

WITH validation AS (
	SELECT
		order_id AS primary_key,
		COUNT(1) AS occurrences

	FROM "raw"."staging"."stg_orders"
	GROUP BY 1
)

SELECT *

FROM validation
WHERE primary_key IS NULL
	OR occurrences > 1

',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467','test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'unique_stg_products_product_id',NULL,'pass','test',0.04453253746032715,'2025-02-10T10:27:52.054352Z','2025-02-10T10:27:52.079531Z','2025-02-10T10:27:52.039437Z','2025-02-10T10:27:52.052369Z',1,False,'



select
    product_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada','test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada','82ad4d7a-24f0-44df-91c3-9581eb878934','2025-02-10 10:27:53',
    current_timestamp::timestamp
,'unique_stg_customers_customer_id',NULL,'pass','test',0.17264866828918457,'2025-02-10T10:27:51.932888Z','2025-02-10T10:27:52.067352Z','2025-02-10T10:27:51.910937Z','2025-02-10T10:27:51.931998Z',1,False,'



select
    customer_id as unique_field,
    count(*) as n_records

from "raw"."staging"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}')

[0m10:27:54.004812 [debug] [MainThread]: SQL status: INSERT 0 58 in 0.004 seconds
[0m10:27:54.007057 [debug] [MainThread]: On master: COMMIT
[0m10:27:54.007596 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:54.008103 [debug] [MainThread]: On master: COMMIT
[0m10:27:54.011226 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m10:27:54.013949 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:
[0m10:27:54.014953 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.085096 (1 runs)
[0m10:27:54.015861 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.014721 (1 runs)
[0m10:27:54.016807 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.000756 (1 runs)
[0m10:27:54.017702 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.863109 (58 runs)
[0m10:27:54.019005 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.906203 (1 runs)
[0m10:27:54.020585 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.011501 (1 runs)
[0m10:27:54.021999 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.commit: 0:00:00.005286 (1 runs)
[0m10:27:54.023349 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:00.962845 (1 runs)
[0m10:27:54.024662 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:01.064232 (1 runs)
[0m10:27:54.026102 [debug] [MainThread]: Elementary: Uploaded run results successfully.
[0m10:27:54.040712 [debug] [MainThread]: Elementary: Handling test results.
[0m10:27:54.308135 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:54.309014 [debug] [MainThread]: On master: BEGIN
[0m10:27:54.309876 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:27:54.310572 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:54.315484 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "raw".INFORMATION_SCHEMA.columns
      where table_name = 'elementary_test_results'

        and table_schema = 'elementary'

      order by ordinal_position


[0m10:27:54.323302 [debug] [MainThread]: SQL status: SELECT 28 in 0.003 seconds
[0m10:27:54.331309 [debug] [MainThread]: Elementary: Inserting 58 rows to table "raw"."elementary"."elementary_test_results"
[0m10:27:55.187268 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m10:27:55.188809 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:55.192086 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */


       insert into "raw"."elementary"."elementary_test_results"
         (id,data_issue_id,test_execution_id,test_unique_id,model_unique_id,invocation_id,detected_at,created_at,database_name,schema_name,table_name,column_name,test_type,test_sub_type,test_results_description,owners,tags,test_results_query,other,test_name,test_params,severity,status,failures,test_short_name,test_alias,result_rows,failed_row_count) values
    ('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e',NULL,'82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e','test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e','model.nexabrands_dbt.stg_customers','82ad4d7a-24f0-44df-91c3-9581eb878934',cast('2025-02-10 10:27:54' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','city','dbt_test','generic',NULL,'[]','[]','



with all_values as (

    select
        city as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_customers"
    group by city

)

select *
from all_values
where value_field not in (
    ''Klerksdorp'',''Polokwane'',''Stellenbosch'',''Paarl'',''East London'',''Grahamstown'',''George'',''Upington'',''Bloemfontein'',''Worcester'',''Pietermaritzburg'',''Pretoria'',''Nelspruit'',''Kimberley'',''Johannesburg'',''Cape Town''
)


',NULL,'accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town','{"values": ["Klerksdorp", "Polokwane", "Stellenbosch", "Paarl", "East London", "Grahamstown", "George", "Upington", "Bloemfontein", "Worcester", "Pietermaritzburg", "Pretoria", "Nelspruit", "Kimberley", "Johannesburg", "Cape Town"], "quote": true, "column_name": "city", "model": "{{ get_where_subquery(ref(''stg_customers'')) }}"}','warn','pass',0,'accepted_values','accepted_values_stg_customers_a11ae74a9713a9aa51bccac4422d6868',NULL,NULL),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630',NULL,'82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630','model.nexabrands_dbt.stg_order_fulfillment','82ad4d7a-24f0-44df-91c3-9581eb878934',cast('2025-02-10 10:27:54' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','in_full','dbt_test','generic',NULL,'[]','[]','



with all_values as (

    select
        in_full as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by in_full

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',NULL,'accepted_values_stg_order_fulfillment_in_full__True__0__1','{"values": [0, 1], "quote": true, "column_name": "in_full", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'accepted_values','accepted_values_stg_order_fulfillment_in_full__True__0__1',NULL,NULL),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95',NULL,'82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95','model.nexabrands_dbt.stg_order_fulfillment','82ad4d7a-24f0-44df-91c3-9581eb878934',cast('2025-02-10 10:27:54' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','on_time','dbt_test','generic',NULL,'[]','[]','



with all_values as (

    select
        on_time as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by on_time

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',NULL,'accepted_values_stg_order_fulfillment_on_time__True__0__1','{"values": [0, 1], "quote": true, "column_name": "on_time", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'accepted_values','accepted_values_stg_order_fulfillment_on_time__True__0__1',NULL,NULL),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73',NULL,'82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73','test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73','model.nexabrands_dbt.stg_order_fulfillment','82ad4d7a-24f0-44df-91c3-9581eb878934',cast('2025-02-10 10:27:54' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_order_fulfillment','ontime_in_full','dbt_test','generic',NULL,'[]','[]','



with all_values as (

    select
        ontime_in_full as value_field,
        count(*) as n_records

    from "raw"."staging"."stg_order_fulfillment"
    group by ontime_in_full

)

select *
from all_values
where value_field not in (
    ''0'',''1''
)


',NULL,'accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1','{"values": [0, 1], "quote": true, "column_name": "ontime_in_full", "model": "{{ get_where_subquery(ref(''stg_order_fulfillment'')) }}"}','warn','pass',0,'accepted_values','accepted_values_stg_order_fulf_04ff2bb97b4eb37802ca1fb38147b18b',NULL,NULL),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478',NULL,'82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478','test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478','model.nexabrands_dbt.stg_customer_targets','82ad4d7a-24f0-44df-91c3-9581eb878934',cast('2025-02-10 10:27:54' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customer_targets',NULL,'dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select



  infull_target >= otif_target as expression


    from "raw"."staging"."stg_customer_targets"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors




',NULL,'dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True','{"column_A": "infull_target", "column_B": "otif_target", "or_equal": true, "model": "{{ get_where_subquery(ref(''stg_customer_targets'')) }}"}','warn','pass',0,'expect_column_pair_values_A_to_be_greater_than_B','dbt_expectations_expect_column_9b169ad9eac85f6a49ea6c376dd6e4ec',NULL,NULL),('82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182',NULL,'82ad4d7a-24f0-44df-91c3-9581eb878934.test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182','test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182','model.nexabrands_dbt.stg_customers','82ad4d7a-24f0-44df-91c3-9581eb878934',cast('2025-02-10 10:27:54' as timestamp),
    current_timestamp::timestamp
,'raw','staging','stg_customers','city','dbt_test','expectation',NULL,'[]','[]','





    with grouped_expression as (
    select




( 1=1 and length(
        city
    ) >= 2 and length(
        city
    ) <= 50
)
 as expression


    from "raw"."staging"."stg_customers"


),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_err
