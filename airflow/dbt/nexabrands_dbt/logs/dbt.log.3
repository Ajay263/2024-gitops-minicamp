[0m12:27:30.111436 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select otif_variance
from "raw"."raw"."fct_order_fulfillment_lines"
where otif_variance is null



      
    ) dbt_internal_test
[0m12:27:30.119550 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select otif_target
from "raw"."raw"."fct_order_fulfillment_lines"
where otif_target is null



      
    ) dbt_internal_test
[0m12:27:30.121710 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m12:27:30.125149 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b: ROLLBACK
[0m12:27:30.122533 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:27:30.115257 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe)
[0m12:27:30.128798 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe
[0m12:27:30.127773 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e: ROLLBACK
[0m12:27:30.129606 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b: Close
[0m12:27:30.114549 [info ] [Thread-3 (]: 34 of 34 START test unique_fct_order_fulfillment_lines_order_fulfillment_id .... [RUN]
[0m12:27:30.141074 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d, now test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae)
[0m12:27:30.140305 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e: Close
[0m12:27:30.139636 [info ] [Thread-4 (]: 32 of 34 PASS not_null_fct_order_fulfillment_lines_otif_variance ............... [[32mPASS[0m in 0.09s]
[0m12:27:30.142048 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae
[0m12:27:30.145633 [info ] [Thread-1 (]: 31 of 34 PASS not_null_fct_order_fulfillment_lines_otif_target ................. [[32mPASS[0m in 0.11s]
[0m12:27:30.158130 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e
[0m12:27:30.147586 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b
[0m12:27:30.161167 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae"
[0m12:27:30.162475 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae
[0m12:27:30.146552 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe"
[0m12:27:30.173468 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe
[0m12:27:30.180117 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe"
[0m12:27:30.181605 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe"
[0m12:27:30.182489 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe: BEGIN
[0m12:27:30.183330 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:27:30.172414 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae"
[0m12:27:30.185368 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae"
[0m12:27:30.186205 [debug] [Thread-3 (]: On test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae: BEGIN
[0m12:27:30.187046 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:27:30.206621 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m12:27:30.207970 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe"
[0m12:27:30.209578 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "raw"."raw"."fct_order_fulfillment_lines"
where product_id is null



      
    ) dbt_internal_test
[0m12:27:30.212263 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:27:30.214965 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe: ROLLBACK
[0m12:27:30.217045 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe: Close
[0m12:27:30.217891 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m12:27:30.220211 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae"
[0m12:27:30.220990 [debug] [Thread-3 (]: On test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_fulfillment_id as unique_field,
    count(*) as n_records

from "raw"."raw"."fct_order_fulfillment_lines"
where order_fulfillment_id is not null
group by order_fulfillment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:27:30.219162 [info ] [Thread-2 (]: 33 of 34 PASS not_null_fct_order_fulfillment_lines_product_id .................. [[32mPASS[0m in 0.10s]
[0m12:27:30.222246 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe
[0m12:27:30.223692 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:27:30.227102 [debug] [Thread-3 (]: On test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae: ROLLBACK
[0m12:27:30.229659 [debug] [Thread-3 (]: On test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae: Close
[0m12:27:30.230834 [info ] [Thread-3 (]: 34 of 34 PASS unique_fct_order_fulfillment_lines_order_fulfillment_id .......... [[32mPASS[0m in 0.09s]
[0m12:27:30.235053 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae
[0m12:27:30.238408 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:30.239227 [debug] [MainThread]: On master: BEGIN
[0m12:27:30.240250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:27:30.246662 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:27:30.247406 [debug] [MainThread]: On master: COMMIT
[0m12:27:30.248165 [debug] [MainThread]: Using postgres connection "master"
[0m12:27:30.248863 [debug] [MainThread]: On master: COMMIT
[0m12:27:30.249659 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:27:30.250392 [debug] [MainThread]: On master: Close
[0m12:27:30.259354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:30.259857 [debug] [MainThread]: Connection 'test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e' was properly closed.
[0m12:27:30.260362 [debug] [MainThread]: Connection 'test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe' was properly closed.
[0m12:27:30.260797 [debug] [MainThread]: Connection 'test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae' was properly closed.
[0m12:27:30.261223 [debug] [MainThread]: Connection 'test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b' was properly closed.
[0m12:27:30.261891 [info ] [MainThread]: 
[0m12:27:30.262507 [info ] [MainThread]: Finished running 34 data tests in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m12:27:30.268279 [debug] [MainThread]: Command end result
[0m12:27:30.377858 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m12:27:30.379861 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m12:27:30.387735 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m12:27:30.388273 [info ] [MainThread]: 
[0m12:27:30.388872 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:27:30.389409 [info ] [MainThread]: 
[0m12:27:30.390043 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000000000000000__1 (models/schema.yml)[0m
[0m12:27:30.390661 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:27:30.391158 [info ] [MainThread]: 
[0m12:27:30.391796 [info ] [MainThread]:   compiled code at target/compiled/nexabrands_dbt/models/schema.yml/dbt_expectations_expect_table__3a6cc2080e7fdbfe9afe4c877c17e1f2.sql
[0m12:27:30.392400 [info ] [MainThread]: 
[0m12:27:30.392967 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=1 SKIP=0 TOTAL=34
[0m12:27:30.394221 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.7206612, "process_in_blocks": "0", "process_kernel_time": 0.345819, "process_mem_max_rss": "120272", "process_out_blocks": "6792", "process_user_time": 3.577445}
[0m12:27:30.395010 [debug] [MainThread]: Command `dbt test` failed at 12:27:30.394849 after 2.72 seconds
[0m12:27:30.396627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f6b5f5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f6bcbeea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f6bcbf740>]}
[0m12:27:30.397205 [debug] [MainThread]: Flushing usage events
[0m12:27:31.257419 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:30:18.971526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1cff37ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1cffc8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1cffca600>]}


============================== 12:30:18.975555 | 72da1d98-df1d-4741-8062-d79ecac8ae46 ==============================
[0m12:30:18.975555 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:30:18.976713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'profiles_dir': '/home/codespace/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:30:19.162355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72da1d98-df1d-4741-8062-d79ecac8ae46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1cfa78b30>]}
[0m12:30:19.229032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72da1d98-df1d-4741-8062-d79ecac8ae46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1cfe76ba0>]}
[0m12:30:19.230110 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:30:19.360154 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:30:19.556248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:30:19.558070 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/schema.yml
[0m12:30:20.675008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72da1d98-df1d-4741-8062-d79ecac8ae46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1ceb252e0>]}
[0m12:30:20.901398 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m12:30:20.905901 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m12:30:21.107518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72da1d98-df1d-4741-8062-d79ecac8ae46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1cd1def90>]}
[0m12:30:21.108568 [info ] [MainThread]: Found 10 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m12:30:21.109524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72da1d98-df1d-4741-8062-d79ecac8ae46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1cd218ce0>]}
[0m12:30:21.116276 [info ] [MainThread]: 
[0m12:30:21.117230 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:30:21.118114 [info ] [MainThread]: 
[0m12:30:21.119190 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:30:21.126631 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m12:30:21.186416 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m12:30:21.187217 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m12:30:21.188026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:30:21.193596 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:30:21.194319 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m12:30:21.195043 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:30:21.201219 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m12:30:21.205220 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m12:30:21.206550 [debug] [ThreadPool]: On list_raw_raw: Close
[0m12:30:21.222630 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:21.223387 [debug] [MainThread]: On master: BEGIN
[0m12:30:21.224128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:30:21.229074 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:30:21.230030 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:21.231154 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:30:21.258031 [debug] [MainThread]: SQL status: SELECT 3 in 0.026 seconds
[0m12:30:21.261368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72da1d98-df1d-4741-8062-d79ecac8ae46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1cd7e4a10>]}
[0m12:30:21.262345 [debug] [MainThread]: On master: ROLLBACK
[0m12:30:21.263230 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:21.264005 [debug] [MainThread]: On master: BEGIN
[0m12:30:21.265493 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:30:21.266689 [debug] [MainThread]: On master: COMMIT
[0m12:30:21.267456 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:21.268243 [debug] [MainThread]: On master: COMMIT
[0m12:30:21.269103 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:30:21.269865 [debug] [MainThread]: On master: Close
[0m12:30:21.277151 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993
[0m12:30:21.278022 [info ] [Thread-1 (]: 1 of 34 START test accepted_values_fct_order_fulfillment_lines_in_full__0__1 ... [RUN]
[0m12:30:21.278930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993)
[0m12:30:21.279729 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993
[0m12:30:21.292806 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed
[0m12:30:21.294206 [info ] [Thread-2 (]: 2 of 34 START test accepted_values_fct_order_fulfillment_lines_on_time__0__1 ... [RUN]
[0m12:30:21.295950 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed'
[0m12:30:21.296756 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed
[0m12:30:21.305987 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64
[0m12:30:21.321078 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e
[0m12:30:21.324122 [info ] [Thread-4 (]: 4 of 34 START test dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_  [RUN]
[0m12:30:21.325209 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e'
[0m12:30:21.326000 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e
[0m12:30:21.321935 [info ] [Thread-3 (]: 3 of 34 START test accepted_values_fct_order_fulfillment_lines_otif__0__1 ...... [RUN]
[0m12:30:21.333992 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64'
[0m12:30:21.334788 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64
[0m12:30:21.323257 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed"
[0m12:30:21.320265 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993"
[0m12:30:21.342271 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993
[0m12:30:21.351793 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e"
[0m12:30:21.354293 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed
[0m12:30:21.353202 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64"
[0m12:30:21.378653 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64
[0m12:30:21.366962 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e
[0m12:30:21.411349 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e"
[0m12:30:21.412790 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64"
[0m12:30:21.419970 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64"
[0m12:30:21.420765 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64: BEGIN
[0m12:30:21.421528 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:30:21.418678 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993"
[0m12:30:21.423395 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993"
[0m12:30:21.425554 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993: BEGIN
[0m12:30:21.424764 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e"
[0m12:30:21.417835 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed"
[0m12:30:21.431077 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed"
[0m12:30:21.431951 [debug] [Thread-2 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed: BEGIN
[0m12:30:21.429806 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m12:30:21.434020 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64"
[0m12:30:21.435401 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        otif as value_field,
        count(*) as n_records

    from "raw"."raw"."fct_order_fulfillment_lines"
    group by otif

)

select *
from all_values
where value_field not in (
    '0','1'
)



      
    ) dbt_internal_test
[0m12:30:21.427355 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e: BEGIN
[0m12:30:21.436461 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:30:21.426357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:21.432764 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:30:21.442545 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:30:21.456503 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m12:30:21.459028 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993"
[0m12:30:21.461510 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        in_full as value_field,
        count(*) as n_records

    from "raw"."raw"."fct_order_fulfillment_lines"
    group by in_full

)

select *
from all_values
where value_field not in (
    '0','1'
)



      
    ) dbt_internal_test
[0m12:30:21.457606 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m12:30:21.463233 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed"
[0m12:30:21.464476 [debug] [Thread-2 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        on_time as value_field,
        count(*) as n_records

    from "raw"."raw"."fct_order_fulfillment_lines"
    group by on_time

)

select *
from all_values
where value_field not in (
    '0','1'
)



      
    ) dbt_internal_test
[0m12:30:21.465753 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:30:21.468746 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993: ROLLBACK
[0m12:30:21.469608 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:30:21.472432 [debug] [Thread-2 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed: ROLLBACK
[0m12:30:21.453011 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64: ROLLBACK
[0m12:30:21.460574 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m12:30:21.474507 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e"
[0m12:30:21.478625 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and actual_delivery_date >= '2020-01-01' and actual_delivery_date <= current_date + interval '30 days'
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:30:21.473472 [debug] [Thread-2 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed: Close
[0m12:30:21.476322 [debug] [Thread-1 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993: Close
[0m12:30:21.475304 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64: Close
[0m12:30:21.480552 [info ] [Thread-2 (]: 2 of 34 PASS accepted_values_fct_order_fulfillment_lines_on_time__0__1 ......... [[32mPASS[0m in 0.18s]
[0m12:30:21.491574 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed
[0m12:30:21.481758 [info ] [Thread-1 (]: 1 of 34 PASS accepted_values_fct_order_fulfillment_lines_in_full__0__1 ......... [[32mPASS[0m in 0.20s]
[0m12:30:21.485350 [info ] [Thread-3 (]: 3 of 34 PASS accepted_values_fct_order_fulfillment_lines_otif__0__1 ............ [[32mPASS[0m in 0.15s]
[0m12:30:21.501052 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64
[0m12:30:21.488825 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:30:21.504781 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e: ROLLBACK
[0m12:30:21.499874 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993
[0m12:30:21.505893 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932
[0m12:30:21.506802 [info ] [Thread-1 (]: 7 of 34 START test dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False  [RUN]
[0m12:30:21.501951 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4
[0m12:30:21.508665 [info ] [Thread-3 (]: 6 of 34 START test dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False  [RUN]
[0m12:30:21.495177 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae
[0m12:30:21.510778 [info ] [Thread-2 (]: 5 of 34 START test dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False  [RUN]
[0m12:30:21.511907 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae)
[0m12:30:21.512742 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae
[0m12:30:21.509576 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4)
[0m12:30:21.522339 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4
[0m12:30:21.507743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932)
[0m12:30:21.531031 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932
[0m12:30:21.521345 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e: Close
[0m12:30:21.543593 [info ] [Thread-4 (]: 4 of 34 PASS dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_  [[32mPASS[0m in 0.22s]
[0m12:30:21.544820 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e
[0m12:30:21.546656 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e
[0m12:30:21.547593 [info ] [Thread-4 (]: 8 of 34 START test dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False  [RUN]
[0m12:30:21.548573 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e)
[0m12:30:21.549405 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e
[0m12:30:21.538283 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae"
[0m12:30:21.567481 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae
[0m12:30:21.566327 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932"
[0m12:30:21.573168 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932
[0m12:30:21.563574 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4"
[0m12:30:21.579240 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4
[0m12:30:21.572135 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae"
[0m12:30:21.585299 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae"
[0m12:30:21.586176 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae: BEGIN
[0m12:30:21.578141 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932"
[0m12:30:21.590011 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932"
[0m12:30:21.590798 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932: BEGIN
[0m12:30:21.588919 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e"
[0m12:30:21.592664 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e
[0m12:30:21.586969 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:30:21.584079 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4"
[0m12:30:21.591613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:21.598768 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4"
[0m12:30:21.604782 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4: BEGIN
[0m12:30:21.605491 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:30:21.603504 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m12:30:21.606688 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae"
[0m12:30:21.607569 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and delivery_qty >= 0
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:30:21.610204 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m12:30:21.597169 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e"
[0m12:30:21.619148 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e"
[0m12:30:21.620031 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e: BEGIN
[0m12:30:21.620833 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:30:21.617738 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m12:30:21.622226 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4"
[0m12:30:21.623068 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and infull_target >= 0 and infull_target <= 100
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:30:21.615237 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae: ROLLBACK
[0m12:30:21.631729 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae: Close
[0m12:30:21.630757 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m12:30:21.637531 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932"
[0m12:30:21.638435 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and infull_variance >= -100 and infull_variance <= 100
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:30:21.627900 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:30:21.646151 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4: ROLLBACK
[0m12:30:21.647119 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m12:30:21.652769 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932: ROLLBACK
[0m12:30:21.648005 [debug] [Thread-4 (]: SQL status: BEGIN in 0.027 seconds
[0m12:30:21.649906 [info ] [Thread-2 (]: 5 of 34 PASS dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False  [[32mPASS[0m in 0.14s]
[0m12:30:21.656639 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae
[0m12:30:21.655426 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e"
[0m12:30:21.658787 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and ontime_target >= 0 and ontime_target <= 100
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:30:21.653826 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932: Close
[0m12:30:21.662389 [info ] [Thread-1 (]: 7 of 34 PASS dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False  [[32mPASS[0m in 0.15s]
[0m12:30:21.663490 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932
[0m12:30:21.664275 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:30:21.664896 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4: Close
[0m12:30:21.657634 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31
[0m12:30:21.674087 [info ] [Thread-2 (]: 9 of 34 START test dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False  [RUN]
[0m12:30:21.676511 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31)
[0m12:30:21.677436 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31
[0m12:30:21.665788 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b
[0m12:30:21.675535 [info ] [Thread-3 (]: 6 of 34 PASS dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False  [[32mPASS[0m in 0.17s]
[0m12:30:21.690902 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4
[0m12:30:21.691785 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3
[0m12:30:21.669371 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e: ROLLBACK
[0m12:30:21.693638 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e: Close
[0m12:30:21.689687 [info ] [Thread-1 (]: 10 of 34 START test dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_  [RUN]
[0m12:30:21.698499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b)
[0m12:30:21.699322 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b
[0m12:30:21.688646 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31"
[0m12:30:21.692626 [info ] [Thread-3 (]: 11 of 34 START test dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True  [RUN]
[0m12:30:21.697820 [info ] [Thread-4 (]: 8 of 34 PASS dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False  [[32mPASS[0m in 0.15s]
[0m12:30:21.708661 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e
[0m12:30:21.709606 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7
[0m12:30:21.710430 [info ] [Thread-4 (]: 12 of 34 START test dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False  [RUN]
[0m12:30:21.711354 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7)
[0m12:30:21.707348 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3)
[0m12:30:21.714872 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3
[0m12:30:21.713014 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31
[0m12:30:21.713889 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7
[0m12:30:21.730415 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31"
[0m12:30:21.751028 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31"
[0m12:30:21.751895 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31: BEGIN
[0m12:30:21.765151 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:30:21.749393 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b"
[0m12:30:21.723658 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3"
[0m12:30:21.770315 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3
[0m12:30:21.768760 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b
[0m12:30:21.782383 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b"
[0m12:30:21.775248 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3"
[0m12:30:21.788944 [debug] [Thread-2 (]: SQL status: BEGIN in 0.024 seconds
[0m12:30:21.757670 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7"
[0m12:30:21.793683 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7
[0m12:30:21.791347 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31"
[0m12:30:21.801009 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and ontime_variance >= -100 and ontime_variance <= 100
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:30:21.803910 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:30:21.808501 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31: ROLLBACK
[0m12:30:21.805549 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3"
[0m12:30:21.814117 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3: BEGIN
[0m12:30:21.814975 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:30:21.809564 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b"
[0m12:30:21.817245 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b: BEGIN
[0m12:30:21.818085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:21.798734 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7"
[0m12:30:21.821216 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7"
[0m12:30:21.823011 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7: BEGIN
[0m12:30:21.823953 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:30:21.822223 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31: Close
[0m12:30:21.831605 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m12:30:21.842695 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3"
[0m12:30:21.840217 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m12:30:21.847191 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b"
[0m12:30:21.848373 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and order_placement_date >= '2024-01-01' and order_placement_date <= current_date
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:30:21.841836 [info ] [Thread-2 (]: 9 of 34 PASS dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False  [[32mPASS[0m in 0.17s]
[0m12:30:21.850947 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31
[0m12:30:21.843996 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and order_qty > 0
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:30:21.853548 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:30:21.851917 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b
[0m12:30:21.862548 [info ] [Thread-2 (]: 13 of 34 START test dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False  [RUN]
[0m12:30:21.864152 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b)
[0m12:30:21.866134 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b
[0m12:30:21.860438 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b: ROLLBACK
[0m12:30:21.882347 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b: Close
[0m12:30:21.890308 [info ] [Thread-1 (]: 10 of 34 PASS dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_  [[32mPASS[0m in 0.19s]
[0m12:30:21.892720 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b
[0m12:30:21.894437 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9
[0m12:30:21.898985 [info ] [Thread-1 (]: 14 of 34 START test dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date  [RUN]
[0m12:30:21.909842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b, now test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9)
[0m12:30:21.910756 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9
[0m12:30:21.897393 [debug] [Thread-4 (]: SQL status: BEGIN in 0.073 seconds
[0m12:30:21.896069 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.042 seconds
[0m12:30:21.921580 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3: ROLLBACK
[0m12:30:21.918073 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7"
[0m12:30:21.923997 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and otif_target >= 0 and otif_target <= 100
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:30:21.928188 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:30:21.929570 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3: Close
[0m12:30:21.940677 [info ] [Thread-3 (]: 11 of 34 PASS dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True  [[32mPASS[0m in 0.23s]
[0m12:30:21.958160 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3
[0m12:30:21.909098 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b"
[0m12:30:21.933565 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7: ROLLBACK
[0m12:30:21.968152 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b
[0m12:30:21.965919 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0
[0m12:30:21.984383 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7: Close
[0m12:30:21.992627 [info ] [Thread-4 (]: 12 of 34 PASS dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False  [[32mPASS[0m in 0.28s]
[0m12:30:21.986293 [info ] [Thread-3 (]: 15 of 34 START test dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0  [RUN]
[0m12:30:21.981846 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9"
[0m12:30:22.025131 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9
[0m12:30:22.021470 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7
[0m12:30:22.041556 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be
[0m12:30:22.042473 [info ] [Thread-4 (]: 16 of 34 START test not_null_fct_order_fulfillment_lines_agreed_delivery_date .. [RUN]
[0m12:30:21.997709 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b"
[0m12:30:22.054431 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b"
[0m12:30:22.019087 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3, now test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0)
[0m12:30:22.063032 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0
[0m12:30:22.043481 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be)
[0m12:30:22.096667 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be
[0m12:30:22.068800 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9"
[0m12:30:22.105141 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9"
[0m12:30:22.105960 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9: BEGIN
[0m12:30:22.106709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:22.055547 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b: BEGIN
[0m12:30:22.109990 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:30:22.141519 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m12:30:22.143445 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b"
[0m12:30:22.145404 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and otif_variance >= -100 and otif_variance <= 100
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








      
    ) dbt_internal_test
[0m12:30:22.148979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m12:30:22.153418 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:30:22.159789 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b: ROLLBACK
[0m12:30:22.156664 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9"
[0m12:30:22.126938 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0"
[0m12:30:22.168448 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



with validation_errors as (

    select
        order_id,product_id,customer_id,order_placement_date,agreed_delivery_date,
        count(*) as "n_records"
    from "raw"."raw"."fct_order_fulfillment_lines"
    where
        1=1
        and 
    not (
        order_id is null and 
        product_id is null and 
        customer_id is null and 
        order_placement_date is null and 
        agreed_delivery_date is null
        
    )


    
    group by
        order_id,product_id,customer_id,order_placement_date,agreed_delivery_date
    having count(*) > 1

)
select * from validation_errors

      
    ) dbt_internal_test
[0m12:30:22.170916 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0
[0m12:30:22.186053 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m12:30:22.193396 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9: ROLLBACK
[0m12:30:22.190066 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be"
[0m12:30:22.197087 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b: Close
[0m12:30:22.203553 [info ] [Thread-2 (]: 13 of 34 PASS dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False  [[32mPASS[0m in 0.34s]
[0m12:30:22.207034 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b
[0m12:30:22.202362 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be
[0m12:30:22.218754 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be"
[0m12:30:22.200289 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0"
[0m12:30:22.210054 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9: Close
[0m12:30:22.229000 [info ] [Thread-1 (]: 14 of 34 PASS dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date  [[32mPASS[0m in 0.32s]
[0m12:30:22.234240 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9
[0m12:30:22.212363 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b
[0m12:30:22.239485 [info ] [Thread-2 (]: 17 of 34 START test not_null_fct_order_fulfillment_lines_customer_id ........... [RUN]
[0m12:30:22.241907 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b)
[0m12:30:22.232210 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0"
[0m12:30:22.245790 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0: BEGIN
[0m12:30:22.247759 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:30:22.244774 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b
[0m12:30:22.236793 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2
[0m12:30:22.249542 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be"
[0m12:30:22.258200 [info ] [Thread-1 (]: 18 of 34 START test not_null_fct_order_fulfillment_lines_delivery_qty .......... [RUN]
[0m12:30:22.259450 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be: BEGIN
[0m12:30:22.270228 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m12:30:22.271426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2)
[0m12:30:22.272750 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:30:22.274354 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0"
[0m12:30:22.276051 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2
[0m12:30:22.278855 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



    with grouped_expression as (
    select
        
        
    
  
( 1=1 and count(*) >= 0 and count(*) <= 10000
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






      
    ) dbt_internal_test
[0m12:30:22.301455 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m12:30:22.302757 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m12:30:22.308030 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be"
[0m12:30:22.309331 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select agreed_delivery_date
from "raw"."raw"."fct_order_fulfillment_lines"
where agreed_delivery_date is null



      
    ) dbt_internal_test
[0m12:30:22.312059 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m12:30:22.306417 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0: ROLLBACK
[0m12:30:22.315717 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be: ROLLBACK
[0m12:30:22.321193 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0: Close
[0m12:30:22.326031 [info ] [Thread-3 (]: 15 of 34 PASS dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0  [[32mPASS[0m in 0.31s]
[0m12:30:22.327878 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0
[0m12:30:22.327028 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be: Close
[0m12:30:22.324201 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2"
[0m12:30:22.320110 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b"
[0m12:30:22.338929 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b
[0m12:30:22.339775 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2
[0m12:30:22.350019 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2"
[0m12:30:22.328982 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183
[0m12:30:22.351015 [info ] [Thread-3 (]: 19 of 34 START test not_null_fct_order_fulfillment_lines_in_full ............... [RUN]
[0m12:30:22.351915 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__0.3b0db0f6e0, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183)
[0m12:30:22.352764 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183
[0m12:30:22.336243 [info ] [Thread-4 (]: 16 of 34 PASS not_null_fct_order_fulfillment_lines_agreed_delivery_date ........ [[32mPASS[0m in 0.29s]
[0m12:30:22.361120 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be
[0m12:30:22.361958 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf
[0m12:30:22.362725 [info ] [Thread-4 (]: 20 of 34 START test not_null_fct_order_fulfillment_lines_infull_target ......... [RUN]
[0m12:30:22.345664 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b"
[0m12:30:22.364919 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2"
[0m12:30:22.367025 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2: BEGIN
[0m12:30:22.366244 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b"
[0m12:30:22.368632 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b: BEGIN
[0m12:30:22.363588 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf)
[0m12:30:22.367817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:22.369420 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:30:22.370196 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf
[0m12:30:22.359998 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183"
[0m12:30:22.385534 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183
[0m12:30:22.389785 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183"
[0m12:30:22.390620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m12:30:22.391628 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2"
[0m12:30:22.392496 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select delivery_qty
from "raw"."raw"."fct_order_fulfillment_lines"
where delivery_qty is null



      
    ) dbt_internal_test
[0m12:30:22.394302 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m12:30:22.395070 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b"
[0m12:30:22.395872 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "raw"."raw"."fct_order_fulfillment_lines"
where customer_id is null



      
    ) dbt_internal_test
[0m12:30:22.398221 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:30:22.400829 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2: ROLLBACK
[0m12:30:22.401743 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:30:22.404971 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b: ROLLBACK
[0m12:30:22.385031 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf"
[0m12:30:22.406669 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf
[0m12:30:22.413237 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b: Close
[0m12:30:22.414346 [info ] [Thread-2 (]: 17 of 34 PASS not_null_fct_order_fulfillment_lines_customer_id ................. [[32mPASS[0m in 0.17s]
[0m12:30:22.415374 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b
[0m12:30:22.416200 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371
[0m12:30:22.416960 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2: Close
[0m12:30:22.417891 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183"
[0m12:30:22.423016 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183: BEGIN
[0m12:30:22.423768 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:30:22.418704 [info ] [Thread-2 (]: 21 of 34 START test not_null_fct_order_fulfillment_lines_infull_variance ....... [RUN]
[0m12:30:22.422363 [info ] [Thread-1 (]: 18 of 34 PASS not_null_fct_order_fulfillment_lines_delivery_qty ................ [[32mPASS[0m in 0.15s]
[0m12:30:22.427918 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2
[0m12:30:22.428822 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2
[0m12:30:22.429784 [info ] [Thread-1 (]: 22 of 34 START test not_null_fct_order_fulfillment_lines_last_updated_at ....... [RUN]
[0m12:30:22.432555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2)
[0m12:30:22.433358 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2
[0m12:30:22.426768 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371)
[0m12:30:22.444721 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371
[0m12:30:22.443677 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m12:30:22.453695 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183"
[0m12:30:22.454517 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select in_full
from "raw"."raw"."fct_order_fulfillment_lines"
where in_full is null



      
    ) dbt_internal_test
[0m12:30:22.457555 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:30:22.446174 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf"
[0m12:30:22.465129 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf"
[0m12:30:22.465941 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf: BEGIN
[0m12:30:22.466728 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:30:22.462384 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183: ROLLBACK
[0m12:30:22.485692 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183: Close
[0m12:30:22.486876 [info ] [Thread-3 (]: 19 of 34 PASS not_null_fct_order_fulfillment_lines_in_full ..................... [[32mPASS[0m in 0.13s]
[0m12:30:22.489892 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183
[0m12:30:22.481417 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371"
[0m12:30:22.497942 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371
[0m12:30:22.496901 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m12:30:22.503915 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf"
[0m12:30:22.504788 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select infull_target
from "raw"."raw"."fct_order_fulfillment_lines"
where infull_target is null



      
    ) dbt_internal_test
[0m12:30:22.493898 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2"
[0m12:30:22.505916 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2
[0m12:30:22.490888 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83
[0m12:30:22.511467 [info ] [Thread-3 (]: 23 of 34 START test not_null_fct_order_fulfillment_lines_on_time ............... [RUN]
[0m12:30:22.512414 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83)
[0m12:30:22.513220 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83
[0m12:30:22.514075 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.008 seconds
[0m12:30:22.522569 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf: ROLLBACK
[0m12:30:22.510600 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2"
[0m12:30:22.523771 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2"
[0m12:30:22.524610 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2: BEGIN
[0m12:30:22.525394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:22.527610 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf: Close
[0m12:30:22.528716 [info ] [Thread-4 (]: 20 of 34 PASS not_null_fct_order_fulfillment_lines_infull_target ............... [[32mPASS[0m in 0.17s]
[0m12:30:22.529744 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf
[0m12:30:22.503590 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371"
[0m12:30:22.530473 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1
[0m12:30:22.533443 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371"
[0m12:30:22.539264 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371: BEGIN
[0m12:30:22.540131 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:30:22.542822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m12:30:22.546047 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2"
[0m12:30:22.546835 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select last_updated_at
from "raw"."raw"."fct_order_fulfillment_lines"
where last_updated_at is null



      
    ) dbt_internal_test
[0m12:30:22.538079 [info ] [Thread-4 (]: 24 of 34 START test not_null_fct_order_fulfillment_lines_ontime_target ......... [RUN]
[0m12:30:22.549481 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1)
[0m12:30:22.548389 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m12:30:22.535662 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83"
[0m12:30:22.551662 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1
[0m12:30:22.552633 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371"
[0m12:30:22.562493 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select infull_variance
from "raw"."raw"."fct_order_fulfillment_lines"
where infull_variance is null



      
    ) dbt_internal_test
[0m12:30:22.553599 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m12:30:22.564621 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83
[0m12:30:22.570258 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:30:22.568601 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2: ROLLBACK
[0m12:30:22.582165 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2: Close
[0m12:30:22.579601 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371: ROLLBACK
[0m12:30:22.587816 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371: Close
[0m12:30:22.594917 [info ] [Thread-2 (]: 21 of 34 PASS not_null_fct_order_fulfillment_lines_infull_variance ............. [[32mPASS[0m in 0.17s]
[0m12:30:22.596049 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371
[0m12:30:22.589646 [info ] [Thread-1 (]: 22 of 34 PASS not_null_fct_order_fulfillment_lines_last_updated_at ............. [[32mPASS[0m in 0.16s]
[0m12:30:22.575761 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83"
[0m12:30:22.601860 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83"
[0m12:30:22.598901 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2
[0m12:30:22.604632 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090
[0m12:30:22.606042 [info ] [Thread-1 (]: 26 of 34 START test not_null_fct_order_fulfillment_lines_order_fulfillment_id .. [RUN]
[0m12:30:22.593297 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1"
[0m12:30:22.609814 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1
[0m12:30:22.596857 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1
[0m12:30:22.603284 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83: BEGIN
[0m12:30:22.619387 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:30:22.617534 [info ] [Thread-2 (]: 25 of 34 START test not_null_fct_order_fulfillment_lines_ontime_variance ....... [RUN]
[0m12:30:22.621079 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1)
[0m12:30:22.607565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090)
[0m12:30:22.629064 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090
[0m12:30:22.622005 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1
[0m12:30:22.638468 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m12:30:22.655053 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83"
[0m12:30:22.656713 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select on_time
from "raw"."raw"."fct_order_fulfillment_lines"
where on_time is null



      
    ) dbt_internal_test
[0m12:30:22.626602 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1"
[0m12:30:22.663365 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:30:22.661744 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1"
[0m12:30:22.670627 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1"
[0m12:30:22.672734 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1: BEGIN
[0m12:30:22.674787 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:30:22.667704 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83: ROLLBACK
[0m12:30:22.654290 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090"
[0m12:30:22.676811 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1
[0m12:30:22.681267 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83: Close
[0m12:30:22.694930 [info ] [Thread-3 (]: 23 of 34 PASS not_null_fct_order_fulfillment_lines_on_time ..................... [[32mPASS[0m in 0.18s]
[0m12:30:22.686407 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090
[0m12:30:22.698645 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m12:30:22.707703 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1"
[0m12:30:22.708679 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ontime_target
from "raw"."raw"."fct_order_fulfillment_lines"
where ontime_target is null



      
    ) dbt_internal_test
[0m12:30:22.697876 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83
[0m12:30:22.709673 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd
[0m12:30:22.711131 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:30:22.713881 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1: ROLLBACK
[0m12:30:22.706864 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090"
[0m12:30:22.691702 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1"
[0m12:30:22.718091 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1"
[0m12:30:22.718962 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1: BEGIN
[0m12:30:22.720088 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:30:22.715892 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090"
[0m12:30:22.722243 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090: BEGIN
[0m12:30:22.710474 [info ] [Thread-3 (]: 27 of 34 START test not_null_fct_order_fulfillment_lines_order_id .............. [RUN]
[0m12:30:22.727355 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd)
[0m12:30:22.729045 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd
[0m12:30:22.725517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:22.747876 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1: Close
[0m12:30:22.751374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m12:30:22.753317 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090"
[0m12:30:22.754880 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_fulfillment_id
from "raw"."raw"."fct_order_fulfillment_lines"
where order_fulfillment_id is null



      
    ) dbt_internal_test
[0m12:30:22.757696 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m12:30:22.768292 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m12:30:22.776660 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1"
[0m12:30:22.769336 [info ] [Thread-4 (]: 24 of 34 PASS not_null_fct_order_fulfillment_lines_ontime_target ............... [[32mPASS[0m in 0.22s]
[0m12:30:22.778188 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ontime_variance
from "raw"."raw"."fct_order_fulfillment_lines"
where ontime_variance is null



      
    ) dbt_internal_test
[0m12:30:22.779427 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1
[0m12:30:22.784784 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8
[0m12:30:22.787029 [info ] [Thread-4 (]: 28 of 34 START test not_null_fct_order_fulfillment_lines_order_placement_date .. [RUN]
[0m12:30:22.789125 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8)
[0m12:30:22.775169 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090: ROLLBACK
[0m12:30:22.783231 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd"
[0m12:30:22.801375 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd
[0m12:30:22.781975 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m12:30:22.791086 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090: Close
[0m12:30:22.790035 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8
[0m12:30:22.820380 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1: ROLLBACK
[0m12:30:22.811419 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd"
[0m12:30:22.838783 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd"
[0m12:30:22.839632 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd: BEGIN
[0m12:30:22.843781 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:30:22.844560 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1: Close
[0m12:30:22.853040 [info ] [Thread-2 (]: 25 of 34 PASS not_null_fct_order_fulfillment_lines_ontime_variance ............. [[32mPASS[0m in 0.23s]
[0m12:30:22.854229 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1
[0m12:30:22.822536 [info ] [Thread-1 (]: 26 of 34 PASS not_null_fct_order_fulfillment_lines_order_fulfillment_id ........ [[32mPASS[0m in 0.22s]
[0m12:30:22.860186 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090
[0m12:30:22.862743 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d
[0m12:30:22.857754 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b
[0m12:30:22.876083 [info ] [Thread-2 (]: 29 of 34 START test not_null_fct_order_fulfillment_lines_order_qty ............. [RUN]
[0m12:30:22.871917 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m12:30:22.880358 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd"
[0m12:30:22.881225 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "raw"."raw"."fct_order_fulfillment_lines"
where order_id is null



      
    ) dbt_internal_test
[0m12:30:22.869480 [info ] [Thread-1 (]: 30 of 34 START test not_null_fct_order_fulfillment_lines_otif .................. [RUN]
[0m12:30:22.878548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b)
[0m12:30:22.899913 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b
[0m12:30:22.882551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d)
[0m12:30:22.911970 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d
[0m12:30:22.899032 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m12:30:22.934927 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd: ROLLBACK
[0m12:30:22.937839 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd: Close
[0m12:30:22.922854 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8"
[0m12:30:22.940916 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8
[0m12:30:22.939087 [info ] [Thread-3 (]: 27 of 34 PASS not_null_fct_order_fulfillment_lines_order_id .................... [[32mPASS[0m in 0.21s]
[0m12:30:22.964771 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd
[0m12:30:22.965666 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e
[0m12:30:22.927325 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b"
[0m12:30:22.967999 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b
[0m12:30:22.949003 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d"
[0m12:30:22.966500 [info ] [Thread-3 (]: 31 of 34 START test not_null_fct_order_fulfillment_lines_otif_target ........... [RUN]
[0m12:30:22.983115 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e)
[0m12:30:22.984683 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e
[0m12:30:22.979836 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d
[0m12:30:22.981333 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8"
[0m12:30:23.007400 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8"
[0m12:30:23.009369 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8: BEGIN
[0m12:30:23.010993 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:30:22.990588 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b"
[0m12:30:23.014091 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b"
[0m12:30:23.003732 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d"
[0m12:30:23.043213 [debug] [Thread-4 (]: SQL status: BEGIN in 0.032 seconds
[0m12:30:23.056332 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8"
[0m12:30:23.060691 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_placement_date
from "raw"."raw"."fct_order_fulfillment_lines"
where order_placement_date is null



      
    ) dbt_internal_test
[0m12:30:23.017907 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b: BEGIN
[0m12:30:23.062169 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:30:23.046317 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d"
[0m12:30:23.064486 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d: BEGIN
[0m12:30:23.069842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:23.059779 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e"
[0m12:30:23.074001 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m12:30:23.092198 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m12:30:23.095794 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b"
[0m12:30:23.097488 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_qty
from "raw"."raw"."fct_order_fulfillment_lines"
where order_qty is null



      
    ) dbt_internal_test
[0m12:30:23.108637 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m12:30:23.112707 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d"
[0m12:30:23.111345 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e
[0m12:30:23.115606 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:30:23.118072 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select otif
from "raw"."raw"."fct_order_fulfillment_lines"
where otif is null



      
    ) dbt_internal_test
[0m12:30:23.091603 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8: ROLLBACK
[0m12:30:23.130303 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b: ROLLBACK
[0m12:30:23.134292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m12:30:23.138157 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d: ROLLBACK
[0m12:30:23.132698 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8: Close
[0m12:30:23.145119 [info ] [Thread-4 (]: 28 of 34 PASS not_null_fct_order_fulfillment_lines_order_placement_date ........ [[32mPASS[0m in 0.36s]
[0m12:30:23.146288 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8
[0m12:30:23.140960 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b: Close
[0m12:30:23.151298 [info ] [Thread-2 (]: 29 of 34 PASS not_null_fct_order_fulfillment_lines_order_qty ................... [[32mPASS[0m in 0.27s]
[0m12:30:23.152565 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b
[0m12:30:23.146990 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d: Close
[0m12:30:23.142962 [debug] [Thread-3 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e"
[0m12:30:23.158143 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e"
[0m12:30:23.148725 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b
[0m12:30:23.156587 [info ] [Thread-1 (]: 30 of 34 PASS not_null_fct_order_fulfillment_lines_otif ........................ [[32mPASS[0m in 0.27s]
[0m12:30:23.163123 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d
[0m12:30:23.159224 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e: BEGIN
[0m12:30:23.153391 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe
[0m12:30:23.161616 [info ] [Thread-4 (]: 32 of 34 START test not_null_fct_order_fulfillment_lines_otif_variance ......... [RUN]
[0m12:30:23.170637 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b)
[0m12:30:23.172557 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b
[0m12:30:23.169419 [info ] [Thread-2 (]: 33 of 34 START test not_null_fct_order_fulfillment_lines_product_id ............ [RUN]
[0m12:30:23.167412 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:30:23.165419 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae
[0m12:30:23.184562 [info ] [Thread-1 (]: 34 of 34 START test unique_fct_order_fulfillment_lines_order_fulfillment_id .... [RUN]
[0m12:30:23.185880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d, now test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae)
[0m12:30:23.186887 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae
[0m12:30:23.180918 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe)
[0m12:30:23.204321 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe
[0m12:30:23.207354 [debug] [Thread-3 (]: SQL status: BEGIN in 0.039 seconds
[0m12:30:23.237883 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e"
[0m12:30:23.240087 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select otif_target
from "raw"."raw"."fct_order_fulfillment_lines"
where otif_target is null



      
    ) dbt_internal_test
[0m12:30:23.235873 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe"
[0m12:30:23.248592 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m12:30:23.253110 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e: ROLLBACK
[0m12:30:23.256878 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe
[0m12:30:23.225643 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b"
[0m12:30:23.247080 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae"
[0m12:30:23.264895 [debug] [Thread-2 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe"
[0m12:30:23.266156 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e: Close
[0m12:30:23.267445 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b
[0m12:30:23.268064 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae
[0m12:30:23.278377 [info ] [Thread-3 (]: 31 of 34 PASS not_null_fct_order_fulfillment_lines_otif_target ................. [[32mPASS[0m in 0.30s]
[0m12:30:23.280238 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe"
[0m12:30:23.277732 [debug] [Thread-4 (]: Writing runtime sql for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b"
[0m12:30:23.286668 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e
[0m12:30:23.285732 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe: BEGIN
[0m12:30:23.288270 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:30:23.289760 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b"
[0m12:30:23.290995 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b: BEGIN
[0m12:30:23.293891 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:30:23.295404 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m12:30:23.296648 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe"
[0m12:30:23.300517 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "raw"."raw"."fct_order_fulfillment_lines"
where product_id is null



      
    ) dbt_internal_test
[0m12:30:23.284963 [debug] [Thread-1 (]: Writing runtime sql for node "test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae"
[0m12:30:23.302715 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae"
[0m12:30:23.303554 [debug] [Thread-1 (]: On test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae: BEGIN
[0m12:30:23.304624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:30:23.305885 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m12:30:23.306623 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b"
[0m12:30:23.307458 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select otif_variance
from "raw"."raw"."fct_order_fulfillment_lines"
where otif_variance is null



      
    ) dbt_internal_test
[0m12:30:23.309606 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m12:30:23.312399 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe: ROLLBACK
[0m12:30:23.313361 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:30:23.315863 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b: ROLLBACK
[0m12:30:23.319134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m12:30:23.320951 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae"
[0m12:30:23.321815 [debug] [Thread-1 (]: On test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_fulfillment_id as unique_field,
    count(*) as n_records

from "raw"."raw"."fct_order_fulfillment_lines"
where order_fulfillment_id is not null
group by order_fulfillment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:30:23.319870 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe: Close
[0m12:30:23.327393 [info ] [Thread-2 (]: 33 of 34 PASS not_null_fct_order_fulfillment_lines_product_id .................. [[32mPASS[0m in 0.15s]
[0m12:30:23.328671 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe
[0m12:30:23.332442 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b: Close
[0m12:30:23.336148 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m12:30:23.340750 [debug] [Thread-1 (]: On test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae: ROLLBACK
[0m12:30:23.341835 [info ] [Thread-4 (]: 32 of 34 PASS not_null_fct_order_fulfillment_lines_otif_variance ............... [[32mPASS[0m in 0.17s]
[0m12:30:23.343325 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b
[0m12:30:23.344246 [debug] [Thread-1 (]: On test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae: Close
[0m12:30:23.345642 [info ] [Thread-1 (]: 34 of 34 PASS unique_fct_order_fulfillment_lines_order_fulfillment_id .......... [[32mPASS[0m in 0.16s]
[0m12:30:23.346976 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae
[0m12:30:23.356206 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:23.357710 [debug] [MainThread]: On master: BEGIN
[0m12:30:23.359400 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:30:23.365239 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:30:23.366007 [debug] [MainThread]: On master: COMMIT
[0m12:30:23.368021 [debug] [MainThread]: Using postgres connection "master"
[0m12:30:23.368737 [debug] [MainThread]: On master: COMMIT
[0m12:30:23.369561 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:30:23.370278 [debug] [MainThread]: On master: Close
[0m12:30:23.373958 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:30:23.374680 [debug] [MainThread]: Connection 'test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae' was properly closed.
[0m12:30:23.375370 [debug] [MainThread]: Connection 'test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe' was properly closed.
[0m12:30:23.376096 [debug] [MainThread]: Connection 'test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b' was properly closed.
[0m12:30:23.376766 [debug] [MainThread]: Connection 'test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e' was properly closed.
[0m12:30:23.377556 [info ] [MainThread]: 
[0m12:30:23.378335 [info ] [MainThread]: Finished running 34 data tests in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m12:30:23.388007 [debug] [MainThread]: Command end result
[0m12:30:23.557617 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m12:30:23.560756 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m12:30:23.574111 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m12:30:23.574932 [info ] [MainThread]: 
[0m12:30:23.575772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:30:23.576608 [info ] [MainThread]: 
[0m12:30:23.577406 [info ] [MainThread]: Done. PASS=34 WARN=0 ERROR=0 SKIP=0 TOTAL=34
[0m12:30:23.579172 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.7099595, "process_in_blocks": "0", "process_kernel_time": 0.390914, "process_mem_max_rss": "121424", "process_out_blocks": "6792", "process_user_time": 4.675343}
[0m12:30:23.580137 [debug] [MainThread]: Command `dbt test` succeeded at 12:30:23.579967 after 4.71 seconds
[0m12:30:23.580949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1d0670b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1cc6f0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1d0503bf0>]}
[0m12:30:23.581749 [debug] [MainThread]: Flushing usage events
[0m12:30:24.426511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:32.564101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74409b30da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74409cd04290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74409b30fc20>]}


============================== 12:31:32.567574 | 42eb5a6e-b034-4a8d-a8b5-f42e9f0c93c4 ==============================
[0m12:31:32.567574 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:31:32.568375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:31:32.785413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42eb5a6e-b034-4a8d-a8b5-f42e9f0c93c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74409ca770b0>]}
[0m12:31:32.873443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42eb5a6e-b034-4a8d-a8b5-f42e9f0c93c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74409ad2e540>]}
[0m12:31:32.874552 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:31:32.997186 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:31:33.173377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:31:33.174032 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:31:33.265058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42eb5a6e-b034-4a8d-a8b5-f42e9f0c93c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74409a3b8c20>]}
[0m12:31:33.416046 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m12:31:33.418724 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m12:31:33.433917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42eb5a6e-b034-4a8d-a8b5-f42e9f0c93c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744099a949e0>]}
[0m12:31:33.434518 [info ] [MainThread]: Found 10 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m12:31:33.435091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42eb5a6e-b034-4a8d-a8b5-f42e9f0c93c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744098f7f1a0>]}
[0m12:31:33.437688 [info ] [MainThread]: 
[0m12:31:33.438248 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:31:33.438758 [info ] [MainThread]: 
[0m12:31:33.439563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:31:33.444077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m12:31:33.479106 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m12:31:33.479658 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m12:31:33.480240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:33.484535 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m12:31:33.485893 [debug] [ThreadPool]: On list_raw: Close
[0m12:31:33.488146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m12:31:33.494594 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m12:31:33.495097 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m12:31:33.495547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:33.498544 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m12:31:33.500856 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m12:31:33.502661 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m12:31:33.507273 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m12:31:33.510334 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m12:31:33.511317 [debug] [ThreadPool]: On list_raw_raw: Close
[0m12:31:33.527311 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:33.528328 [debug] [MainThread]: On master: BEGIN
[0m12:31:33.529122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:31:33.537295 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:31:33.538076 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:33.538883 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:31:33.559049 [debug] [MainThread]: SQL status: SELECT 3 in 0.019 seconds
[0m12:31:33.561212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42eb5a6e-b034-4a8d-a8b5-f42e9f0c93c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744097cfba40>]}
[0m12:31:33.561806 [debug] [MainThread]: On master: ROLLBACK
[0m12:31:33.562396 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:33.562877 [debug] [MainThread]: On master: BEGIN
[0m12:31:33.564917 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:31:33.565408 [debug] [MainThread]: On master: COMMIT
[0m12:31:33.565880 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:33.566314 [debug] [MainThread]: On master: COMMIT
[0m12:31:33.566840 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:31:33.567323 [debug] [MainThread]: On master: Close
[0m12:31:33.570286 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.check_current_date
[0m12:31:33.571075 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m12:31:33.572221 [info ] [Thread-1 (]: 1 of 4 START sql view model raw.check_current_date ............................. [RUN]
[0m12:31:33.572932 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_customers
[0m12:31:33.573521 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_customer_targets'
[0m12:31:33.573981 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m12:31:33.574588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.check_current_date)
[0m12:31:33.575205 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_customers'
[0m12:31:33.575728 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m12:31:33.576382 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order_lines'
[0m12:31:33.576910 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.check_current_date
[0m12:31:33.577437 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_customers
[0m12:31:33.585877 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m12:31:33.586444 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m12:31:33.588579 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.check_current_date"
[0m12:31:33.591961 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customers"
[0m12:31:33.595428 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m12:31:33.596409 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m12:31:33.597470 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_customers
[0m12:31:33.598260 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.check_current_date
[0m12:31:33.598768 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_orders
[0m12:31:33.599510 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_products
[0m12:31:33.600317 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m12:31:33.612097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer_targets, now model.nexabrands_dbt.stg_orders)
[0m12:31:33.627417 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customers, now model.nexabrands_dbt.stg_products)
[0m12:31:33.638739 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.check_current_date"
[0m12:31:33.639545 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_orders
[0m12:31:33.640159 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.order_delivery_metrics
[0m12:31:33.640692 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_products
[0m12:31:33.641600 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m12:31:33.644588 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_orders"
[0m12:31:33.645252 [info ] [Thread-4 (]: 2 of 4 START sql view model raw.order_delivery_metrics ......................... [RUN]
[0m12:31:33.649504 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_products"
[0m12:31:33.650091 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: BEGIN
[0m12:31:33.650992 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_order_lines, now model.nexabrands_dbt.order_delivery_metrics)
[0m12:31:33.651860 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_orders
[0m12:31:33.653183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:33.653976 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_products
[0m12:31:33.654461 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.order_delivery_metrics
[0m12:31:33.667867 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.order_delivery_metrics"
[0m12:31:33.668451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m12:31:33.669307 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.order_delivery_metrics
[0m12:31:33.669953 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m12:31:33.675405 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.order_delivery_metrics"
[0m12:31:33.676028 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.check_current_date"} */

  create view "raw"."raw"."check_current_date__dbt_tmp"
    
    
  as (
    select 
    current_date as current_date_value,
    current_timestamp as current_timestamp_value,
    current_timestamp::timestamp at time zone 'UTC' as current_utc_timestamp
  );
[0m12:31:33.676922 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m12:31:33.677548 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: BEGIN
[0m12:31:33.678312 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:31:33.679490 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m12:31:33.687158 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m12:31:33.687789 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.check_current_date"} */
alter table "raw"."raw"."check_current_date" rename to "check_current_date__dbt_backup"
[0m12:31:33.690863 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m12:31:33.692618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:31:33.693399 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m12:31:33.697103 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m12:31:33.697717 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */

  create view "raw"."raw"."order_delivery_metrics__dbt_tmp"
    
    
  as (
    

WITH  __dbt__cte__stg_order_lines as (
-- models/staging/stg_order_lines.sql
WITH order_lines AS (
    SELECT * FROM   "raw"."raw"."order_lines" 

)

SELECT
    order_id,
    product_id,
    order_qty,
    agreed_delivery_date,
    actual_delivery_date,
    delivery_qty 
   
FROM order_lines
), order_lines AS (
    SELECT * FROM __dbt__cte__stg_order_lines
),

delivery_metrics AS (
    SELECT
        order_id,
        product_id,
        order_qty,
        delivery_qty,
        agreed_delivery_date,
        actual_delivery_date,
        -- Calculating  delivery metrics
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date THEN 1 
            ELSE 0 
        END as is_on_time,
        CASE 
            WHEN delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_in_full,
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date 
            AND delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_otif
    FROM order_lines
)

SELECT * FROM delivery_metrics
  );
[0m12:31:33.698318 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.check_current_date"} */
alter table "raw"."raw"."check_current_date__dbt_tmp" rename to "check_current_date"
[0m12:31:33.699378 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:31:33.708350 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:31:33.719795 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m12:31:33.729723 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics" rename to "order_delivery_metrics__dbt_backup"
[0m12:31:33.733092 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: COMMIT
[0m12:31:33.733857 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m12:31:33.734464 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:31:33.735004 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: COMMIT
[0m12:31:33.740249 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m12:31:33.741172 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics__dbt_tmp" rename to "order_delivery_metrics"
[0m12:31:33.742267 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:31:33.742884 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:31:33.749655 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."check_current_date__dbt_backup"
[0m12:31:33.752140 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m12:31:33.758899 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m12:31:33.759470 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m12:31:33.760088 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.check_current_date"} */
drop view if exists "raw"."raw"."check_current_date__dbt_backup" cascade
[0m12:31:33.760640 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m12:31:33.762137 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m12:31:33.762843 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:31:33.765807 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."order_delivery_metrics__dbt_backup"
[0m12:31:33.768448 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: Close
[0m12:31:33.769575 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m12:31:33.772799 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
drop view if exists "raw"."raw"."order_delivery_metrics__dbt_backup" cascade
[0m12:31:33.772122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42eb5a6e-b034-4a8d-a8b5-f42e9f0c93c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74409ca763c0>]}
[0m12:31:33.774049 [info ] [Thread-1 (]: 1 of 4 OK created sql view model raw.check_current_date ........................ [[32mCREATE VIEW[0m in 0.20s]
[0m12:31:33.775718 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.check_current_date
[0m12:31:33.776366 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:31:33.778008 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: Close
[0m12:31:33.778876 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42eb5a6e-b034-4a8d-a8b5-f42e9f0c93c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74409c186900>]}
[0m12:31:33.780292 [info ] [Thread-4 (]: 2 of 4 OK created sql view model raw.order_delivery_metrics .................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:31:33.781753 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.order_delivery_metrics
[0m12:31:33.782906 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.customer_performance
[0m12:31:33.783395 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m12:31:33.784090 [info ] [Thread-2 (]: 3 of 4 START sql view model raw.customer_performance ........................... [RUN]
[0m12:31:33.784800 [info ] [Thread-3 (]: 4 of 4 START sql incremental model raw.fct_order_fulfillment_lines ............. [RUN]
[0m12:31:33.785534 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_orders, now model.nexabrands_dbt.customer_performance)
[0m12:31:33.786093 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_products, now model.nexabrands_dbt.fct_order_fulfillment_lines)
[0m12:31:33.786911 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.customer_performance
[0m12:31:33.787559 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m12:31:33.795618 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.customer_performance"
[0m12:31:33.828612 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.customer_performance
[0m12:31:33.841516 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.customer_performance"
[0m12:31:33.849915 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m12:31:33.850848 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: BEGIN
[0m12:31:33.851694 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:31:33.849013 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m12:31:33.854916 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m12:31:33.870334 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m12:31:33.871252 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m12:31:33.872297 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */

  create view "raw"."raw"."customer_performance__dbt_tmp"
    
    
  as (
    


WITH  __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
), delivery_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

customer_orders AS (
    SELECT * FROM __dbt__cte__stg_orders
),

customer_metrics AS (
    SELECT
        co.customer_id,
        COUNT(*) as total_orders,
        AVG(dm.is_on_time) as ontime_rate,
        AVG(dm.is_in_full) as infull_rate,
        AVG(dm.is_otif) as otif_rate
    FROM delivery_metrics dm
    JOIN customer_orders co ON dm.order_id = co.order_id
    GROUP BY co.customer_id
)

SELECT * FROM customer_metrics
  );
[0m12:31:33.881781 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:31:33.887150 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m12:31:33.903033 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
alter table "raw"."raw"."customer_performance__dbt_tmp" rename to "customer_performance"
[0m12:31:33.914522 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:31:33.923495 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m12:31:33.925271 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m12:31:33.926151 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m12:31:33.926620 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m12:31:33.927885 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: BEGIN
[0m12:31:33.928489 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m12:31:33.929022 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:31:33.930478 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m12:31:33.934410 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."customer_performance__dbt_backup"
[0m12:31:33.937833 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m12:31:33.938307 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m12:31:33.938835 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
drop view if exists "raw"."raw"."customer_performance__dbt_backup" cascade
[0m12:31:33.939391 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m12:31:33.940253 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */

      
  
    

  create  table "raw"."raw"."fct_order_fulfillment_lines__dbt_tmp"
  
  
    as
  
  (
    

WITH  __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
),  __dbt__cte__stg_customer_targets as (
-- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM  "raw"."raw"."customer_targets"

)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
), order_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

orders AS (
    SELECT * FROM __dbt__cte__stg_orders
),

customers AS (
    SELECT * FROM __dbt__cte__stg_customers
),

customer_targets AS (
    SELECT * FROM __dbt__cte__stg_customer_targets
)

SELECT
md5(cast(coalesce(cast(om.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(om.product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o.order_placement_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(om.agreed_delivery_date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_fulfillment_id,
    om.order_id,
    om.product_id,
    o.customer_id,
    o.order_placement_date,
    om.agreed_delivery_date,
    om.actual_delivery_date,
    om.order_qty,
    om.delivery_qty,
    om.is_on_time as on_time,
    om.is_in_full as in_full,
    om.is_otif as otif,
    -- Add target comparisons
    ct.ontime_target,
    ct.infull_target,
    ct.otif_target,
    -- Add variance from targets
    (om.is_on_time * 100) - ct.ontime_target as ontime_variance,
    (om.is_in_full * 100) - ct.infull_target as infull_variance,
    (om.is_otif * 100) - ct.otif_target as otif_variance,
    current_timestamp as last_updated_at
FROM order_metrics om
JOIN orders o ON om.order_id = o.order_id
JOIN customers c ON o.customer_id = c.customer_id
LEFT JOIN customer_targets ct ON c.customer_id = ct.customer_id


  );
  
  
[0m12:31:33.941088 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:31:33.943382 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: Close
[0m12:31:33.948711 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42eb5a6e-b034-4a8d-a8b5-f42e9f0c93c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744094aa8da0>]}
[0m12:31:33.951678 [info ] [Thread-2 (]: 3 of 4 OK created sql view model raw.customer_performance ...................... [[32mCREATE VIEW[0m in 0.16s]
[0m12:31:33.953400 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.customer_performance
[0m12:31:33.954184 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.012 seconds
[0m12:31:33.958481 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m12:31:33.959116 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */
alter table "raw"."raw"."fct_order_fulfillment_lines" rename to "fct_order_fulfillment_lines__dbt_backup"
[0m12:31:33.960222 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:31:33.963312 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m12:31:33.963838 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */
alter table "raw"."raw"."fct_order_fulfillment_lines__dbt_tmp" rename to "fct_order_fulfillment_lines"
[0m12:31:33.964611 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:31:33.970464 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: COMMIT
[0m12:31:33.970997 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m12:31:33.971493 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: COMMIT
[0m12:31:33.973453 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m12:31:33.976132 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."fct_order_fulfillment_lines__dbt_backup"
[0m12:31:33.979596 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m12:31:33.980152 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */
drop table if exists "raw"."raw"."fct_order_fulfillment_lines__dbt_backup" cascade
[0m12:31:33.982220 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m12:31:33.983617 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: Close
[0m12:31:33.984489 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42eb5a6e-b034-4a8d-a8b5-f42e9f0c93c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744097bf5d00>]}
[0m12:31:33.985533 [info ] [Thread-3 (]: 4 of 4 OK created sql incremental model raw.fct_order_fulfillment_lines ........ [[32mSELECT 0[0m in 0.20s]
[0m12:31:33.986692 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m12:31:33.988962 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:33.989458 [debug] [MainThread]: On master: BEGIN
[0m12:31:33.989899 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:31:33.994812 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:31:33.995725 [debug] [MainThread]: On master: COMMIT
[0m12:31:33.996298 [debug] [MainThread]: Using postgres connection "master"
[0m12:31:33.996743 [debug] [MainThread]: On master: COMMIT
[0m12:31:33.997266 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:31:33.997752 [debug] [MainThread]: On master: Close
[0m12:31:33.998412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:33.999075 [debug] [MainThread]: Connection 'model.nexabrands_dbt.check_current_date' was properly closed.
[0m12:31:33.999864 [debug] [MainThread]: Connection 'model.nexabrands_dbt.customer_performance' was properly closed.
[0m12:31:34.000805 [debug] [MainThread]: Connection 'model.nexabrands_dbt.fct_order_fulfillment_lines' was properly closed.
[0m12:31:34.001684 [debug] [MainThread]: Connection 'model.nexabrands_dbt.order_delivery_metrics' was properly closed.
[0m12:31:34.002279 [info ] [MainThread]: 
[0m12:31:34.002860 [info ] [MainThread]: Finished running 1 incremental model, 3 view models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m12:31:34.004296 [debug] [MainThread]: Command end result
[0m12:31:34.102375 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m12:31:34.104474 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m12:31:34.110461 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m12:31:34.110945 [info ] [MainThread]: 
[0m12:31:34.111555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:31:34.112101 [info ] [MainThread]: 
[0m12:31:34.112658 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:31:34.113799 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6488054, "process_in_blocks": "0", "process_kernel_time": 0.31889, "process_mem_max_rss": "113064", "process_out_blocks": "4192", "process_user_time": 2.606931}
[0m12:31:34.114368 [debug] [MainThread]: Command `dbt run` succeeded at 12:31:34.114256 after 1.65 seconds
[0m12:31:34.114877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744097c11550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744097c12990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744097c129c0>]}
[0m12:31:34.115391 [debug] [MainThread]: Flushing usage events
[0m12:31:35.174487 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:22.662622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae0cbf5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae0cd38f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae0cff8170>]}


============================== 13:49:22.665964 | 3cec821a-deec-47fe-96a4-96fd60c226a4 ==============================
[0m13:49:22.665964 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:49:22.666743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/codespace/.dbt', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:49:22.838859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cec821a-deec-47fe-96a4-96fd60c226a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae0e17b7a0>]}
[0m13:49:22.902299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cec821a-deec-47fe-96a4-96fd60c226a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae0c4eb8f0>]}
[0m13:49:22.903187 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:49:23.028512 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:49:23.207070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:49:23.208225 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/schema.yml
[0m13:49:23.950999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cec821a-deec-47fe-96a4-96fd60c226a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae09b338c0>]}
[0m13:49:24.077643 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m13:49:24.080068 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m13:49:24.146945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cec821a-deec-47fe-96a4-96fd60c226a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae0c6b3e90>]}
[0m13:49:24.147604 [info ] [MainThread]: Found 10 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m13:49:24.148267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cec821a-deec-47fe-96a4-96fd60c226a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae0fafe150>]}
[0m13:49:24.150816 [info ] [MainThread]: 
[0m13:49:24.151375 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:49:24.151994 [info ] [MainThread]: 
[0m13:49:24.152757 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:49:24.157335 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m13:49:24.191223 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m13:49:24.191728 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m13:49:24.192277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:24.196598 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m13:49:24.197926 [debug] [ThreadPool]: On list_raw: Close
[0m13:49:24.200026 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m13:49:24.206416 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m13:49:24.206892 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m13:49:24.207336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:24.211485 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m13:49:24.212232 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m13:49:24.212993 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m13:49:24.216017 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m13:49:24.217968 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m13:49:24.218508 [debug] [ThreadPool]: On list_raw_raw: Close
[0m13:49:24.226180 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:24.226681 [debug] [MainThread]: On master: BEGIN
[0m13:49:24.227123 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:24.231186 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:49:24.232005 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:24.232962 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:49:24.247027 [debug] [MainThread]: SQL status: SELECT 3 in 0.013 seconds
[0m13:49:24.248952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cec821a-deec-47fe-96a4-96fd60c226a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae0e228710>]}
[0m13:49:24.249520 [debug] [MainThread]: On master: ROLLBACK
[0m13:49:24.250090 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:24.250571 [debug] [MainThread]: On master: BEGIN
[0m13:49:24.252172 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:49:24.253810 [debug] [MainThread]: On master: COMMIT
[0m13:49:24.254279 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:24.254721 [debug] [MainThread]: On master: COMMIT
[0m13:49:24.255240 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:49:24.255720 [debug] [MainThread]: On master: Close
[0m13:49:24.259062 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.check_current_date
[0m13:49:24.259724 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m13:49:24.260383 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_customers
[0m13:49:24.261373 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m13:49:24.260963 [info ] [Thread-1 (]: 1 of 4 START sql view model raw.check_current_date ............................. [RUN]
[0m13:49:24.262140 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m13:49:24.262762 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_customers'
[0m13:49:24.263397 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order_lines'
[0m13:49:24.263973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.check_current_date)
[0m13:49:24.264510 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m13:49:24.265032 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_customers
[0m13:49:24.265547 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m13:49:24.266078 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.check_current_date
[0m13:49:24.274503 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m13:49:24.277341 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customers"
[0m13:49:24.280185 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m13:49:24.282259 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.check_current_date"
[0m13:49:24.283395 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m13:49:24.284670 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_customers
[0m13:49:24.285475 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.check_current_date
[0m13:49:24.286147 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m13:49:24.286646 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_orders
[0m13:49:24.287298 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_products
[0m13:49:24.314823 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer_targets, now model.nexabrands_dbt.stg_orders)
[0m13:49:24.315333 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.order_delivery_metrics
[0m13:49:24.324706 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.check_current_date"
[0m13:49:24.325300 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customers, now model.nexabrands_dbt.stg_products)
[0m13:49:24.325843 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_orders
[0m13:49:24.326487 [info ] [Thread-4 (]: 2 of 4 START sql view model raw.order_delivery_metrics ......................... [RUN]
[0m13:49:24.327312 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_products
[0m13:49:24.331204 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_orders"
[0m13:49:24.331832 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m13:49:24.332473 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_order_lines, now model.nexabrands_dbt.order_delivery_metrics)
[0m13:49:24.335523 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_products"
[0m13:49:24.336560 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_orders
[0m13:49:24.337105 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: BEGIN
[0m13:49:24.337661 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.order_delivery_metrics
[0m13:49:24.338694 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_products
[0m13:49:24.339319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:49:24.348015 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.order_delivery_metrics"
[0m13:49:24.349473 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.order_delivery_metrics
[0m13:49:24.355080 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.order_delivery_metrics"
[0m13:49:24.357474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:49:24.357987 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m13:49:24.358512 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m13:49:24.359057 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: BEGIN
[0m13:49:24.359603 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.check_current_date"} */

  create view "raw"."raw"."check_current_date__dbt_tmp"
    
    
  as (
    select 
    current_date as current_date_value,
    current_timestamp as current_timestamp_value,
    current_timestamp::timestamp at time zone 'UTC' as current_utc_timestamp
  );
[0m13:49:24.360179 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:49:24.362564 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:49:24.370007 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m13:49:24.371750 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m13:49:24.372339 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.check_current_date"} */
alter table "raw"."raw"."check_current_date" rename to "check_current_date__dbt_backup"
[0m13:49:24.372882 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m13:49:24.373682 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */

  create view "raw"."raw"."order_delivery_metrics__dbt_tmp"
    
    
  as (
    

WITH  __dbt__cte__stg_order_lines as (
-- models/staging/stg_order_lines.sql
WITH order_lines AS (
    SELECT * FROM   "raw"."raw"."order_lines" 

)

SELECT
    order_id,
    product_id,
    order_qty,
    agreed_delivery_date,
    actual_delivery_date,
    delivery_qty 
   
FROM order_lines
), order_lines AS (
    SELECT * FROM __dbt__cte__stg_order_lines
),

delivery_metrics AS (
    SELECT
        order_id,
        product_id,
        order_qty,
        delivery_qty,
        agreed_delivery_date,
        actual_delivery_date,
        -- Calculating  delivery metrics
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date THEN 1 
            ELSE 0 
        END as is_on_time,
        CASE 
            WHEN delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_in_full,
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date 
            AND delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_otif
    FROM order_lines
)

SELECT * FROM delivery_metrics
  );
[0m13:49:24.374182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:24.381830 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m13:49:24.382497 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.check_current_date"} */
alter table "raw"."raw"."check_current_date__dbt_tmp" rename to "check_current_date"
[0m13:49:24.383686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:24.392221 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m13:49:24.404205 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m13:49:24.409892 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics" rename to "order_delivery_metrics__dbt_backup"
[0m13:49:24.412848 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: COMMIT
[0m13:49:24.413603 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m13:49:24.414152 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:24.414683 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: COMMIT
[0m13:49:24.419802 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m13:49:24.420907 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics__dbt_tmp" rename to "order_delivery_metrics"
[0m13:49:24.421877 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:49:24.427906 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:49:24.429230 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."check_current_date__dbt_backup"
[0m13:49:24.431130 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m13:49:24.437410 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m13:49:24.437989 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m13:49:24.438539 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.check_current_date"} */
drop view if exists "raw"."raw"."check_current_date__dbt_backup" cascade
[0m13:49:24.439080 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m13:49:24.440719 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:49:24.441504 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:49:24.444248 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."order_delivery_metrics__dbt_backup"
[0m13:49:24.446698 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: Close
[0m13:49:24.447782 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m13:49:24.448630 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
drop view if exists "raw"."raw"."order_delivery_metrics__dbt_backup" cascade
[0m13:49:24.450991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cec821a-deec-47fe-96a4-96fd60c226a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae0e17a870>]}
[0m13:49:24.452205 [info ] [Thread-1 (]: 1 of 4 OK created sql view model raw.check_current_date ........................ [[32mCREATE VIEW[0m in 0.19s]
[0m13:49:24.453579 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.check_current_date
[0m13:49:24.454151 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m13:49:24.455725 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: Close
[0m13:49:24.456500 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cec821a-deec-47fe-96a4-96fd60c226a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae09208e90>]}
[0m13:49:24.457486 [info ] [Thread-4 (]: 2 of 4 OK created sql view model raw.order_delivery_metrics .................... [[32mCREATE VIEW[0m in 0.12s]
[0m13:49:24.458461 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.order_delivery_metrics
[0m13:49:24.459633 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.customer_performance
[0m13:49:24.460153 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m13:49:24.461224 [info ] [Thread-2 (]: 3 of 4 START sql view model raw.customer_performance ........................... [RUN]
[0m13:49:24.461955 [info ] [Thread-3 (]: 4 of 4 START sql incremental model raw.fct_order_fulfillment_lines ............. [RUN]
[0m13:49:24.462609 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_orders, now model.nexabrands_dbt.customer_performance)
[0m13:49:24.463160 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_products, now model.nexabrands_dbt.fct_order_fulfillment_lines)
[0m13:49:24.463726 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.customer_performance
[0m13:49:24.464302 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m13:49:24.472134 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.customer_performance"
[0m13:49:24.493771 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:49:24.494632 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m13:49:24.495214 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.customer_performance
[0m13:49:24.511284 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.customer_performance"
[0m13:49:24.526255 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m13:49:24.527087 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: BEGIN
[0m13:49:24.527888 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:49:24.537693 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m13:49:24.539523 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m13:49:24.540415 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */

  create view "raw"."raw"."customer_performance__dbt_tmp"
    
    
  as (
    


WITH  __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
), delivery_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

customer_orders AS (
    SELECT * FROM __dbt__cte__stg_orders
),

customer_metrics AS (
    SELECT
        co.customer_id,
        COUNT(*) as total_orders,
        AVG(dm.is_on_time) as ontime_rate,
        AVG(dm.is_in_full) as infull_rate,
        AVG(dm.is_otif) as otif_rate
    FROM delivery_metrics dm
    JOIN customer_orders co ON dm.order_id = co.order_id
    GROUP BY co.customer_id
)

SELECT * FROM customer_metrics
  );
[0m13:49:24.552346 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m13:49:24.560750 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m13:49:24.566424 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
alter table "raw"."raw"."customer_performance__dbt_tmp" rename to "customer_performance"
[0m13:49:24.574900 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:49:24.575475 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:49:24.577360 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m13:49:24.578004 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m13:49:24.578552 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m13:49:24.579073 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:49:24.579878 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: BEGIN
[0m13:49:24.580787 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:49:24.581437 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m13:49:24.586310 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."customer_performance__dbt_backup"
[0m13:49:24.588679 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m13:49:24.589152 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m13:49:24.589698 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
drop view if exists "raw"."raw"."customer_performance__dbt_backup" cascade
[0m13:49:24.590256 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:49:24.591031 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */

      
  
    

  create  table "raw"."raw"."fct_order_fulfillment_lines__dbt_tmp"
  
  
    as
  
  (
    

WITH  __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
),  __dbt__cte__stg_customer_targets as (
-- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM  "raw"."raw"."customer_targets"

)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
), order_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

orders AS (
    SELECT * FROM __dbt__cte__stg_orders
),

customers AS (
    SELECT * FROM __dbt__cte__stg_customers
),

customer_targets AS (
    SELECT * FROM __dbt__cte__stg_customer_targets
)

SELECT
md5(cast(coalesce(cast(om.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(om.product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o.order_placement_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(om.agreed_delivery_date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_fulfillment_id,
    om.order_id,
    om.product_id,
    o.customer_id,
    o.order_placement_date,
    om.agreed_delivery_date,
    om.actual_delivery_date,
    om.order_qty,
    om.delivery_qty,
    om.is_on_time as on_time,
    om.is_in_full as in_full,
    om.is_otif as otif,
    -- Add target comparisons
    ct.ontime_target,
    ct.infull_target,
    ct.otif_target,
    -- Add variance from targets
    (om.is_on_time * 100) - ct.ontime_target as ontime_variance,
    (om.is_in_full * 100) - ct.infull_target as infull_variance,
    (om.is_otif * 100) - ct.otif_target as otif_variance,
    current_timestamp as last_updated_at
FROM order_metrics om
JOIN orders o ON om.order_id = o.order_id
JOIN customers c ON o.customer_id = c.customer_id
LEFT JOIN customer_targets ct ON c.customer_id = ct.customer_id


  );
  
  
[0m13:49:24.591584 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:49:24.595129 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: Close
[0m13:49:24.596237 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cec821a-deec-47fe-96a4-96fd60c226a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae080bb710>]}
[0m13:49:24.597285 [info ] [Thread-2 (]: 3 of 4 OK created sql view model raw.customer_performance ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m13:49:24.598418 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.customer_performance
[0m13:49:24.602999 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.011 seconds
[0m13:49:24.606454 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:49:24.606992 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */
alter table "raw"."raw"."fct_order_fulfillment_lines" rename to "fct_order_fulfillment_lines__dbt_backup"
[0m13:49:24.607717 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:24.610974 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:49:24.611654 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */
alter table "raw"."raw"."fct_order_fulfillment_lines__dbt_tmp" rename to "fct_order_fulfillment_lines"
[0m13:49:24.613217 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:24.623164 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: COMMIT
[0m13:49:24.624026 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:49:24.625299 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: COMMIT
[0m13:49:24.626944 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:49:24.632101 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."fct_order_fulfillment_lines__dbt_backup"
[0m13:49:24.637646 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:49:24.638477 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */
drop table if exists "raw"."raw"."fct_order_fulfillment_lines__dbt_backup" cascade
[0m13:49:24.640914 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:49:24.642367 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: Close
[0m13:49:24.643189 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cec821a-deec-47fe-96a4-96fd60c226a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae080bbfe0>]}
[0m13:49:24.644556 [info ] [Thread-3 (]: 4 of 4 OK created sql incremental model raw.fct_order_fulfillment_lines ........ [[32mSELECT 0[0m in 0.18s]
[0m13:49:24.646388 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m13:49:24.648437 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:24.648943 [debug] [MainThread]: On master: BEGIN
[0m13:49:24.649398 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:24.653333 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:49:24.654113 [debug] [MainThread]: On master: COMMIT
[0m13:49:24.654855 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:24.655579 [debug] [MainThread]: On master: COMMIT
[0m13:49:24.656428 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:49:24.656950 [debug] [MainThread]: On master: Close
[0m13:49:24.657597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:24.658274 [debug] [MainThread]: Connection 'model.nexabrands_dbt.customer_performance' was properly closed.
[0m13:49:24.659197 [debug] [MainThread]: Connection 'model.nexabrands_dbt.check_current_date' was properly closed.
[0m13:49:24.659781 [debug] [MainThread]: Connection 'model.nexabrands_dbt.fct_order_fulfillment_lines' was properly closed.
[0m13:49:24.660609 [debug] [MainThread]: Connection 'model.nexabrands_dbt.order_delivery_metrics' was properly closed.
[0m13:49:24.661177 [info ] [MainThread]: 
[0m13:49:24.661711 [info ] [MainThread]: Finished running 1 incremental model, 3 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m13:49:24.662965 [debug] [MainThread]: Command end result
[0m13:49:24.710801 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m13:49:24.712607 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m13:49:24.718298 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m13:49:24.718755 [info ] [MainThread]: 
[0m13:49:24.719335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:24.719844 [info ] [MainThread]: 
[0m13:49:24.720428 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:49:24.721507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1736228, "process_in_blocks": "0", "process_kernel_time": 0.292488, "process_mem_max_rss": "119236", "process_out_blocks": "6104", "process_user_time": 3.217376}
[0m13:49:24.722074 [debug] [MainThread]: Command `dbt run` succeeded at 13:49:24.721962 after 2.17 seconds
[0m13:49:24.722575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae0805d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae08080110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ae080806b0>]}
[0m13:49:24.723094 [debug] [MainThread]: Flushing usage events
[0m13:49:25.774252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:04.911949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359419abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3594165d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35941650a0>]}


============================== 13:51:04.915339 | e5d9bb9f-3c47-4c3e-8543-287bf5b95830 ==============================
[0m13:51:04.915339 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:51:04.916127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:51:05.095706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5d9bb9f-3c47-4c3e-8543-287bf5b95830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3593b46ea0>]}
[0m13:51:05.190896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5d9bb9f-3c47-4c3e-8543-287bf5b95830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3595923a10>]}
[0m13:51:05.192276 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:51:05.381354 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:51:05.560704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:51:05.561649 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/marts/fct_order_fulfillment_lines.sql
[0m13:51:05.814313 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_order_fulfillment_lines (models/marts/fct_order_fulfillment_lines.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m13:51:05.815581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.99589884, "process_in_blocks": "0", "process_kernel_time": 0.201786, "process_mem_max_rss": "103268", "process_out_blocks": "16", "process_user_time": 2.11282}
[0m13:51:05.816204 [debug] [MainThread]: Command `dbt run` failed at 13:51:05.816081 after 1.00 seconds
[0m13:51:05.816726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35940a0470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3591df0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35935cfb60>]}
[0m13:51:05.817245 [debug] [MainThread]: Flushing usage events
[0m13:51:06.676138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:30.202340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2cd86060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2b18a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2ccf4050>]}


============================== 13:51:30.205774 | 0d8dacc4-44af-4039-9755-5f82cdd1fdf5 ==============================
[0m13:51:30.205774 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:51:30.206545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:51:30.406857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d8dacc4-44af-4039-9755-5f82cdd1fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2ae07ad0>]}
[0m13:51:30.471055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d8dacc4-44af-4039-9755-5f82cdd1fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2b13be00>]}
[0m13:51:30.472009 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:51:30.595041 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:51:30.840921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:51:30.842000 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/marts/fct_order_fulfillment_lines.sql
[0m13:51:31.477816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d8dacc4-44af-4039-9755-5f82cdd1fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d28dc49b0>]}
[0m13:51:31.605249 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m13:51:31.608055 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m13:51:31.673962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d8dacc4-44af-4039-9755-5f82cdd1fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d289b76e0>]}
[0m13:51:31.674689 [info ] [MainThread]: Found 10 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m13:51:31.675279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d8dacc4-44af-4039-9755-5f82cdd1fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2b895b50>]}
[0m13:51:31.678081 [info ] [MainThread]: 
[0m13:51:31.678647 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:51:31.679156 [info ] [MainThread]: 
[0m13:51:31.679871 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:51:31.684931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m13:51:31.719087 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m13:51:31.719683 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m13:51:31.720239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:31.724680 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m13:51:31.726074 [debug] [ThreadPool]: On list_raw: Close
[0m13:51:31.728367 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m13:51:31.735475 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m13:51:31.736448 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m13:51:31.737020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:31.741664 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m13:51:31.742471 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m13:51:31.743273 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m13:51:31.747137 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m13:51:31.749229 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m13:51:31.749819 [debug] [ThreadPool]: On list_raw_raw: Close
[0m13:51:31.758302 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:31.758783 [debug] [MainThread]: On master: BEGIN
[0m13:51:31.759222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:31.762243 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:51:31.766883 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:31.767446 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:51:31.781465 [debug] [MainThread]: SQL status: SELECT 3 in 0.013 seconds
[0m13:51:31.783522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d8dacc4-44af-4039-9755-5f82cdd1fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d289f0c50>]}
[0m13:51:31.784148 [debug] [MainThread]: On master: ROLLBACK
[0m13:51:31.784719 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:31.785202 [debug] [MainThread]: On master: BEGIN
[0m13:51:31.785925 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:51:31.786870 [debug] [MainThread]: On master: COMMIT
[0m13:51:31.787842 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:31.788802 [debug] [MainThread]: On master: COMMIT
[0m13:51:31.789851 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:51:31.790462 [debug] [MainThread]: On master: Close
[0m13:51:31.793277 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.check_current_date
[0m13:51:31.794167 [info ] [Thread-1 (]: 1 of 4 START sql view model raw.check_current_date ............................. [RUN]
[0m13:51:31.794764 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m13:51:31.795336 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_customers
[0m13:51:31.796042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.check_current_date)
[0m13:51:31.796793 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m13:51:31.797563 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw, now model.nexabrands_dbt.stg_customer_targets)
[0m13:51:31.798210 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_customers'
[0m13:51:31.798755 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.check_current_date
[0m13:51:31.799458 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order_lines'
[0m13:51:31.800025 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m13:51:31.800568 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_customers
[0m13:51:31.807805 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.check_current_date"
[0m13:51:31.808426 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m13:51:31.811437 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m13:51:31.814271 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customers"
[0m13:51:31.815166 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.check_current_date
[0m13:51:31.817976 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m13:51:31.819012 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m13:51:31.820035 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_customers
[0m13:51:31.843395 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_orders
[0m13:51:31.850072 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_products
[0m13:51:31.858502 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.check_current_date"
[0m13:51:31.859401 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m13:51:31.859893 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer_targets, now model.nexabrands_dbt.stg_orders)
[0m13:51:31.860489 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customers, now model.nexabrands_dbt.stg_products)
[0m13:51:31.861565 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.order_delivery_metrics
[0m13:51:31.862161 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_orders
[0m13:51:31.862656 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m13:51:31.863181 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_products
[0m13:51:31.867772 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_orders"
[0m13:51:31.863815 [info ] [Thread-4 (]: 2 of 4 START sql view model raw.order_delivery_metrics ......................... [RUN]
[0m13:51:31.868528 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: BEGIN
[0m13:51:31.871753 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_products"
[0m13:51:31.872565 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_order_lines, now model.nexabrands_dbt.order_delivery_metrics)
[0m13:51:31.873443 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_orders
[0m13:51:31.873898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:31.874849 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_products
[0m13:51:31.875377 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.order_delivery_metrics
[0m13:51:31.888181 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m13:51:31.890695 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.order_delivery_metrics"
[0m13:51:31.891177 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m13:51:31.892026 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.order_delivery_metrics
[0m13:51:31.892507 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.check_current_date"} */

  create view "raw"."raw"."check_current_date__dbt_tmp"
    
    
  as (
    select 
    current_date as current_date_value,
    current_timestamp as current_timestamp_value,
    current_timestamp::timestamp at time zone 'UTC' as current_utc_timestamp
  );
[0m13:51:31.897108 [debug] [Thread-4 (]: Writing runtime sql for node "model.nexabrands_dbt.order_delivery_metrics"
[0m13:51:31.898155 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m13:51:31.898963 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: BEGIN
[0m13:51:31.899691 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:51:31.900180 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:51:31.906677 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m13:51:31.907528 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.check_current_date"} */
alter table "raw"."raw"."check_current_date" rename to "check_current_date__dbt_backup"
[0m13:51:31.908607 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:51:31.912661 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m13:51:31.913414 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.check_current_date"} */
alter table "raw"."raw"."check_current_date__dbt_tmp" rename to "check_current_date"
[0m13:51:31.918768 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m13:51:31.919434 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m13:51:31.920493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:31.921002 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */

  create view "raw"."raw"."order_delivery_metrics__dbt_tmp"
    
    
  as (
    

WITH  __dbt__cte__stg_order_lines as (
-- models/staging/stg_order_lines.sql
WITH order_lines AS (
    SELECT * FROM   "raw"."raw"."order_lines" 

)

SELECT
    order_id,
    product_id,
    order_qty,
    agreed_delivery_date,
    actual_delivery_date,
    delivery_qty 
   
FROM order_lines
), order_lines AS (
    SELECT * FROM __dbt__cte__stg_order_lines
),

delivery_metrics AS (
    SELECT
        order_id,
        product_id,
        order_qty,
        delivery_qty,
        agreed_delivery_date,
        actual_delivery_date,
        -- Calculating  delivery metrics
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date THEN 1 
            ELSE 0 
        END as is_on_time,
        CASE 
            WHEN delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_in_full,
        CASE 
            WHEN actual_delivery_date <= agreed_delivery_date 
            AND delivery_qty >= order_qty THEN 1 
            ELSE 0 
        END as is_otif
    FROM order_lines
)

SELECT * FROM delivery_metrics
  );
[0m13:51:31.943331 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: COMMIT
[0m13:51:31.944180 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:51:31.951230 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m13:51:31.952094 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics" rename to "order_delivery_metrics__dbt_backup"
[0m13:51:31.945014 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m13:51:31.953390 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: COMMIT
[0m13:51:31.954254 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:31.960965 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m13:51:31.961525 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m13:51:31.962036 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
alter table "raw"."raw"."order_delivery_metrics__dbt_tmp" rename to "order_delivery_metrics"
[0m13:51:31.968708 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."check_current_date__dbt_backup"
[0m13:51:31.974857 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:51:31.975882 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.check_current_date"
[0m13:51:31.977963 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m13:51:31.978544 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.check_current_date"} */
drop view if exists "raw"."raw"."check_current_date__dbt_backup" cascade
[0m13:51:31.979103 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m13:51:31.979826 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: COMMIT
[0m13:51:31.981274 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:51:31.981842 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:51:31.984772 [debug] [Thread-1 (]: On model.nexabrands_dbt.check_current_date: Close
[0m13:51:31.988001 [debug] [Thread-4 (]: Applying DROP to: "raw"."raw"."order_delivery_metrics__dbt_backup"
[0m13:51:31.990260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8dacc4-44af-4039-9755-5f82cdd1fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2ca6a390>]}
[0m13:51:31.991863 [debug] [Thread-4 (]: Using postgres connection "model.nexabrands_dbt.order_delivery_metrics"
[0m13:51:31.992688 [info ] [Thread-1 (]: 1 of 4 OK created sql view model raw.check_current_date ........................ [[32mCREATE VIEW[0m in 0.19s]
[0m13:51:31.993371 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.order_delivery_metrics"} */
drop view if exists "raw"."raw"."order_delivery_metrics__dbt_backup" cascade
[0m13:51:31.994096 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.check_current_date
[0m13:51:31.996042 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:51:31.997473 [debug] [Thread-4 (]: On model.nexabrands_dbt.order_delivery_metrics: Close
[0m13:51:31.998345 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8dacc4-44af-4039-9755-5f82cdd1fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d27a72330>]}
[0m13:51:31.999334 [info ] [Thread-4 (]: 2 of 4 OK created sql view model raw.order_delivery_metrics .................... [[32mCREATE VIEW[0m in 0.13s]
[0m13:51:32.000404 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.order_delivery_metrics
[0m13:51:32.001675 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.customer_performance
[0m13:51:32.002167 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m13:51:32.002963 [info ] [Thread-2 (]: 3 of 4 START sql view model raw.customer_performance ........................... [RUN]
[0m13:51:32.004492 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_orders, now model.nexabrands_dbt.customer_performance)
[0m13:51:32.003716 [info ] [Thread-3 (]: 4 of 4 START sql table model raw.fct_order_fulfillment_lines ................... [RUN]
[0m13:51:32.005187 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.customer_performance
[0m13:51:32.005736 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_products, now model.nexabrands_dbt.fct_order_fulfillment_lines)
[0m13:51:32.013881 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.customer_performance"
[0m13:51:32.014452 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m13:51:32.015295 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.customer_performance
[0m13:51:32.034574 [debug] [Thread-2 (]: Writing runtime sql for node "model.nexabrands_dbt.customer_performance"
[0m13:51:32.037132 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:51:32.038006 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m13:51:32.038663 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: BEGIN
[0m13:51:32.039256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:51:32.040018 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m13:51:32.055651 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m13:51:32.056406 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m13:51:32.067178 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */

  create view "raw"."raw"."customer_performance__dbt_tmp"
    
    
  as (
    


WITH  __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
), delivery_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

customer_orders AS (
    SELECT * FROM __dbt__cte__stg_orders
),

customer_metrics AS (
    SELECT
        co.customer_id,
        COUNT(*) as total_orders,
        AVG(dm.is_on_time) as ontime_rate,
        AVG(dm.is_in_full) as infull_rate,
        AVG(dm.is_otif) as otif_rate
    FROM delivery_metrics dm
    JOIN customer_orders co ON dm.order_id = co.order_id
    GROUP BY co.customer_id
)

SELECT * FROM customer_metrics
  );
[0m13:51:32.069949 [debug] [Thread-3 (]: Writing runtime sql for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:51:32.071196 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:51:32.072571 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: BEGIN
[0m13:51:32.073342 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:51:32.073993 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:51:32.078943 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m13:51:32.079795 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
alter table "raw"."raw"."customer_performance__dbt_tmp" rename to "customer_performance"
[0m13:51:32.081409 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m13:51:32.082126 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:51:32.082635 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:32.083240 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */

  
    

  create  table "raw"."raw"."fct_order_fulfillment_lines__dbt_tmp"
  
  
    as
  
  (
    

WITH  __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
),  __dbt__cte__stg_customer_targets as (
-- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM  "raw"."raw"."customer_targets"

)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
), order_metrics AS (
    SELECT * FROM "raw"."raw"."order_delivery_metrics"
),

orders AS (
    SELECT * FROM __dbt__cte__stg_orders
),

customers AS (
    SELECT * FROM __dbt__cte__stg_customers
),

customer_targets AS (
    SELECT * FROM __dbt__cte__stg_customer_targets
)

SELECT
md5(cast(coalesce(cast(om.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(om.product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o.order_placement_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(om.agreed_delivery_date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_fulfillment_id,
    om.order_id,
    om.product_id,
    o.customer_id,
    o.order_placement_date,
    om.agreed_delivery_date,
    om.actual_delivery_date,
    om.order_qty,
    om.delivery_qty,
    om.is_on_time as on_time,
    om.is_in_full as in_full,
    om.is_otif as otif,
    -- Add target comparisons
    ct.ontime_target,
    ct.infull_target,
    ct.otif_target,
    -- Add variance from targets
    (om.is_on_time * 100) - ct.ontime_target as ontime_variance,
    (om.is_in_full * 100) - ct.infull_target as infull_variance,
    (om.is_otif * 100) - ct.otif_target as otif_variance,
    current_timestamp as last_updated_at
FROM order_metrics om
JOIN orders o ON om.order_id = o.order_id
JOIN customers c ON o.customer_id = c.customer_id
LEFT JOIN customer_targets ct ON c.customer_id = ct.customer_id
  );
  
[0m13:51:32.085037 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m13:51:32.085772 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m13:51:32.086558 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: COMMIT
[0m13:51:32.088840 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m13:51:32.095256 [debug] [Thread-2 (]: Applying DROP to: "raw"."raw"."customer_performance__dbt_backup"
[0m13:51:32.095732 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.010 seconds
[0m13:51:32.096886 [debug] [Thread-2 (]: Using postgres connection "model.nexabrands_dbt.customer_performance"
[0m13:51:32.100106 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:51:32.100680 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.customer_performance"} */
drop view if exists "raw"."raw"."customer_performance__dbt_backup" cascade
[0m13:51:32.101242 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */
alter table "raw"."raw"."fct_order_fulfillment_lines" rename to "fct_order_fulfillment_lines__dbt_backup"
[0m13:51:32.102106 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:51:32.102574 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:32.103962 [debug] [Thread-2 (]: On model.nexabrands_dbt.customer_performance: Close
[0m13:51:32.107176 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:51:32.108838 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */
alter table "raw"."raw"."fct_order_fulfillment_lines__dbt_tmp" rename to "fct_order_fulfillment_lines"
[0m13:51:32.108071 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8dacc4-44af-4039-9755-5f82cdd1fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d249ab0b0>]}
[0m13:51:32.110071 [info ] [Thread-2 (]: 3 of 4 OK created sql view model raw.customer_performance ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m13:51:32.110927 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:32.111559 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.customer_performance
[0m13:51:32.117465 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: COMMIT
[0m13:51:32.118367 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:51:32.118901 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: COMMIT
[0m13:51:32.120344 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:51:32.123032 [debug] [Thread-3 (]: Applying DROP to: "raw"."raw"."fct_order_fulfillment_lines__dbt_backup"
[0m13:51:32.126823 [debug] [Thread-3 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m13:51:32.127360 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */
drop table if exists "raw"."raw"."fct_order_fulfillment_lines__dbt_backup" cascade
[0m13:51:32.129212 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:51:32.130576 [debug] [Thread-3 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: Close
[0m13:51:32.131328 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d8dacc4-44af-4039-9755-5f82cdd1fdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d24985eb0>]}
[0m13:51:32.132338 [info ] [Thread-3 (]: 4 of 4 OK created sql table model raw.fct_order_fulfillment_lines .............. [[32mSELECT 0[0m in 0.13s]
[0m13:51:32.133327 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m13:51:32.135022 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:32.135493 [debug] [MainThread]: On master: BEGIN
[0m13:51:32.135973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:51:32.139704 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:51:32.142427 [debug] [MainThread]: On master: COMMIT
[0m13:51:32.144849 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:32.145546 [debug] [MainThread]: On master: COMMIT
[0m13:51:32.146468 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:51:32.146969 [debug] [MainThread]: On master: Close
[0m13:51:32.148408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:32.149071 [debug] [MainThread]: Connection 'model.nexabrands_dbt.customer_performance' was properly closed.
[0m13:51:32.149908 [debug] [MainThread]: Connection 'model.nexabrands_dbt.check_current_date' was properly closed.
[0m13:51:32.150645 [debug] [MainThread]: Connection 'model.nexabrands_dbt.fct_order_fulfillment_lines' was properly closed.
[0m13:51:32.151151 [debug] [MainThread]: Connection 'model.nexabrands_dbt.order_delivery_metrics' was properly closed.
[0m13:51:32.151716 [info ] [MainThread]: 
[0m13:51:32.152293 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m13:51:32.153572 [debug] [MainThread]: Command end result
[0m13:51:32.201373 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m13:51:32.203464 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m13:51:32.209342 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m13:51:32.209813 [info ] [MainThread]: 
[0m13:51:32.210427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:51:32.210936 [info ] [MainThread]: 
[0m13:51:32.211483 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:51:32.212657 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1068392, "process_in_blocks": "0", "process_kernel_time": 0.363055, "process_mem_max_rss": "117432", "process_out_blocks": "6088", "process_user_time": 3.044077}
[0m13:51:32.213258 [debug] [MainThread]: Command `dbt run` succeeded at 13:51:32.213141 after 2.11 seconds
[0m13:51:32.213773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2b44e480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d299e5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d249aa8d0>]}
[0m13:51:32.214375 [debug] [MainThread]: Flushing usage events
[0m13:51:33.209139 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:59.171054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79620d1af530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79620d1ade80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79620d8c9a00>]}


============================== 15:13:59.178619 | 3e907f9b-f4f3-4e6d-8b3b-c531187697a9 ==============================
[0m15:13:59.178619 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:13:59.179691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:13:59.200040 [info ] [MainThread]: dbt version: 1.9.2
[0m15:13:59.201087 [info ] [MainThread]: python version: 3.12.1
[0m15:13:59.201907 [info ] [MainThread]: python path: /workspaces/pyspark_practice-/venv/bin/python
[0m15:13:59.202564 [info ] [MainThread]: os info: Linux-6.5.0-1025-azure-x86_64-with-glibc2.31
[0m15:13:59.473962 [info ] [MainThread]: Using profiles dir at /home/codespace/.dbt
[0m15:13:59.475146 [info ] [MainThread]: Using profiles.yml file at /home/codespace/.dbt/profiles.yml
[0m15:13:59.476157 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/pyspark_practice-/nexabrands_dbt/dbt_project.yml
[0m15:13:59.484331 [info ] [MainThread]: adapter type: postgres
[0m15:13:59.485252 [info ] [MainThread]: adapter version: 1.9.0
[0m15:13:59.669231 [info ] [MainThread]: Configuration:
[0m15:13:59.670163 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:13:59.670922 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:13:59.671615 [info ] [MainThread]: Required dependencies:
[0m15:13:59.672318 [debug] [MainThread]: Executing "git --help"
[0m15:13:59.676693 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:13:59.677596 [debug] [MainThread]: STDERR: "b''"
[0m15:13:59.678349 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:13:59.679102 [info ] [MainThread]: Connection:
[0m15:13:59.679826 [info ] [MainThread]:   host: 172.19.0.2
[0m15:13:59.680341 [info ] [MainThread]:   port: 5432
[0m15:13:59.680977 [info ] [MainThread]:   user: root
[0m15:13:59.681654 [info ] [MainThread]:   database: raw
[0m15:13:59.682350 [info ] [MainThread]:   schema: raw
[0m15:13:59.683036 [info ] [MainThread]:   connect_timeout: 10
[0m15:13:59.683725 [info ] [MainThread]:   role: None
[0m15:13:59.684374 [info ] [MainThread]:   search_path: None
[0m15:13:59.685866 [info ] [MainThread]:   keepalives_idle: 0
[0m15:13:59.686743 [info ] [MainThread]:   sslmode: None
[0m15:13:59.687265 [info ] [MainThread]:   sslcert: None
[0m15:13:59.687889 [info ] [MainThread]:   sslkey: None
[0m15:13:59.688415 [info ] [MainThread]:   sslrootcert: None
[0m15:13:59.688909 [info ] [MainThread]:   application_name: dbt
[0m15:13:59.689394 [info ] [MainThread]:   retries: 1
[0m15:13:59.690043 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:13:59.826108 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:14:00.365562 [debug] [MainThread]: Using postgres connection "debug"
[0m15:14:00.366132 [debug] [MainThread]: On debug: select 1 as id
[0m15:14:00.366836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:00.368204 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "172.19.0.2", port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m15:14:00.369778 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m15:14:00.370529 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m15:14:00.371214 [debug] [MainThread]: On debug: No close available on handle
[0m15:14:00.371957 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:14:00.372691 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:14:00.373396 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "172.19.0.2", port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:14:00.375603 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.6606131, "process_in_blocks": "87208", "process_kernel_time": 0.511289, "process_mem_max_rss": "98696", "process_out_blocks": "24", "process_user_time": 2.001558}
[0m15:14:00.377484 [debug] [MainThread]: Command `dbt debug` failed at 15:14:00.377176 after 1.66 seconds
[0m15:14:00.379933 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:14:00.380764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79620d77ec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79620d1af530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79620d1ade80>]}
[0m15:14:00.381566 [debug] [MainThread]: Flushing usage events
[0m15:14:01.217235 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:32:03.648732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718af55b4440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718af3c189e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718af574daf0>]}


============================== 15:32:03.652044 | b88d882a-11ab-4ecf-859b-14685338ad6f ==============================
[0m15:32:03.652044 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:32:03.652861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/codespace/.dbt', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:32:03.661306 [info ] [MainThread]: dbt version: 1.9.2
[0m15:32:03.661891 [info ] [MainThread]: python version: 3.12.1
[0m15:32:03.662459 [info ] [MainThread]: python path: /workspaces/pyspark_practice-/venv/bin/python
[0m15:32:03.662982 [info ] [MainThread]: os info: Linux-6.5.0-1025-azure-x86_64-with-glibc2.31
[0m15:32:03.719032 [info ] [MainThread]: Using profiles dir at /home/codespace/.dbt
[0m15:32:03.719633 [info ] [MainThread]: Using profiles.yml file at /home/codespace/.dbt/profiles.yml
[0m15:32:03.720188 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/pyspark_practice-/nexabrands_dbt/dbt_project.yml
[0m15:32:03.720862 [info ] [MainThread]: adapter type: postgres
[0m15:32:03.721407 [info ] [MainThread]: adapter version: 1.9.0
[0m15:32:03.830963 [info ] [MainThread]: Configuration:
[0m15:32:03.831583 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:32:03.832126 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:32:03.832649 [info ] [MainThread]: Required dependencies:
[0m15:32:03.833194 [debug] [MainThread]: Executing "git --help"
[0m15:32:03.835829 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:32:03.836396 [debug] [MainThread]: STDERR: "b''"
[0m15:32:03.836865 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:32:03.837568 [info ] [MainThread]: Connection:
[0m15:32:03.838105 [info ] [MainThread]:   host: 172.19.0.2
[0m15:32:03.838823 [info ] [MainThread]:   port: 5432
[0m15:32:03.839532 [info ] [MainThread]:   user: root
[0m15:32:03.840046 [info ] [MainThread]:   database: raw
[0m15:32:03.840587 [info ] [MainThread]:   schema: raw
[0m15:32:03.841098 [info ] [MainThread]:   connect_timeout: 10
[0m15:32:03.841613 [info ] [MainThread]:   role: None
[0m15:32:03.842119 [info ] [MainThread]:   search_path: None
[0m15:32:03.842748 [info ] [MainThread]:   keepalives_idle: 0
[0m15:32:03.843269 [info ] [MainThread]:   sslmode: None
[0m15:32:03.843879 [info ] [MainThread]:   sslcert: None
[0m15:32:03.844662 [info ] [MainThread]:   sslkey: None
[0m15:32:03.845246 [info ] [MainThread]:   sslrootcert: None
[0m15:32:03.845760 [info ] [MainThread]:   application_name: dbt
[0m15:32:03.846314 [info ] [MainThread]:   retries: 1
[0m15:32:03.846948 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:32:03.946890 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:32:03.970087 [debug] [MainThread]: Using postgres connection "debug"
[0m15:32:03.970669 [debug] [MainThread]: On debug: select 1 as id
[0m15:32:03.971163 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:32:03.972014 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "172.19.0.2", port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m15:32:03.972882 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m15:32:03.973529 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m15:32:03.974074 [debug] [MainThread]: On debug: No close available on handle
[0m15:32:03.974598 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:32:03.975399 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:32:03.976071 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "172.19.0.2", port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:32:03.977191 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.41643357, "process_in_blocks": "0", "process_kernel_time": 0.21154, "process_mem_max_rss": "98596", "process_out_blocks": "24", "process_user_time": 1.568592}
[0m15:32:03.977798 [debug] [MainThread]: Command `dbt debug` failed at 15:32:03.977684 after 0.42 seconds
[0m15:32:03.978375 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:32:03.978883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718af365a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718af365ba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718af3519970>]}
[0m15:32:03.979448 [debug] [MainThread]: Flushing usage events
[0m15:32:04.912955 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:32:59.967451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70178307b7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701781f36ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7017817fbc80>]}


============================== 15:32:59.970725 | 72898ee9-f39c-484f-ab54-a342fcca00c6 ==============================
[0m15:32:59.970725 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:32:59.971596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:32:59.984257 [info ] [MainThread]: dbt version: 1.9.2
[0m15:32:59.985052 [info ] [MainThread]: python version: 3.12.1
[0m15:32:59.985627 [info ] [MainThread]: python path: /workspaces/pyspark_practice-/venv/bin/python
[0m15:32:59.986219 [info ] [MainThread]: os info: Linux-6.5.0-1025-azure-x86_64-with-glibc2.31
[0m15:33:00.042999 [info ] [MainThread]: Using profiles dir at /home/codespace/.dbt
[0m15:33:00.043546 [info ] [MainThread]: Using profiles.yml file at /home/codespace/.dbt/profiles.yml
[0m15:33:00.044066 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/pyspark_practice-/nexabrands_dbt/dbt_project.yml
[0m15:33:00.044714 [info ] [MainThread]: adapter type: postgres
[0m15:33:00.045214 [info ] [MainThread]: adapter version: 1.9.0
[0m15:33:00.153976 [info ] [MainThread]: Configuration:
[0m15:33:00.154557 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:33:00.155089 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:33:00.155609 [info ] [MainThread]: Required dependencies:
[0m15:33:00.156154 [debug] [MainThread]: Executing "git --help"
[0m15:33:00.158598 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:33:00.159124 [debug] [MainThread]: STDERR: "b''"
[0m15:33:00.159568 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:33:00.160156 [info ] [MainThread]: Connection:
[0m15:33:00.160755 [info ] [MainThread]:   host: 172.19.0.3
[0m15:33:00.161467 [info ] [MainThread]:   port: 5432
[0m15:33:00.162148 [info ] [MainThread]:   user: root
[0m15:33:00.162883 [info ] [MainThread]:   database: raw
[0m15:33:00.163616 [info ] [MainThread]:   schema: raw
[0m15:33:00.164314 [info ] [MainThread]:   connect_timeout: 10
[0m15:33:00.164951 [info ] [MainThread]:   role: None
[0m15:33:00.165540 [info ] [MainThread]:   search_path: None
[0m15:33:00.166048 [info ] [MainThread]:   keepalives_idle: 0
[0m15:33:00.166666 [info ] [MainThread]:   sslmode: None
[0m15:33:00.167345 [info ] [MainThread]:   sslcert: None
[0m15:33:00.167955 [info ] [MainThread]:   sslkey: None
[0m15:33:00.168451 [info ] [MainThread]:   sslrootcert: None
[0m15:33:00.168962 [info ] [MainThread]:   application_name: dbt
[0m15:33:00.169458 [info ] [MainThread]:   retries: 1
[0m15:33:00.170068 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:33:00.267005 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:33:00.290541 [debug] [MainThread]: Using postgres connection "debug"
[0m15:33:00.291055 [debug] [MainThread]: On debug: select 1 as id
[0m15:33:00.291555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:00.326661 [debug] [MainThread]: SQL status: SELECT 1 in 0.035 seconds
[0m15:33:00.327916 [debug] [MainThread]: On debug: Close
[0m15:33:00.328574 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:33:00.329530 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:33:00.331149 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.45043308, "process_in_blocks": "2904", "process_kernel_time": 0.235879, "process_mem_max_rss": "100344", "process_out_blocks": "24", "process_user_time": 1.475248}
[0m15:33:00.331776 [debug] [MainThread]: Command `dbt debug` succeeded at 15:33:00.331657 after 0.45 seconds
[0m15:33:00.332268 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:33:00.332793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70177ff6bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701784a63b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701780b3ff80>]}
[0m15:33:00.333365 [debug] [MainThread]: Flushing usage events
[0m15:33:01.133058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:41.683149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baa211479e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baa22b5c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baa21146b10>]}


============================== 15:37:41.688226 | 1623fe9e-02cb-4870-bb78-c677c9df8614 ==============================
[0m15:37:41.688226 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:37:41.689503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:37:41.971972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1623fe9e-02cb-4870-bb78-c677c9df8614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baa20bd5070>]}
[0m15:37:42.077938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1623fe9e-02cb-4870-bb78-c677c9df8614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baa20e28470>]}
[0m15:37:42.079269 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:37:42.317242 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:37:42.567491 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:37:42.568567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1623fe9e-02cb-4870-bb78-c677c9df8614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baa21147350>]}
[0m15:37:46.042094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1623fe9e-02cb-4870-bb78-c677c9df8614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baa21dce0f0>]}
[0m15:37:46.249321 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:37:46.254670 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:37:46.277459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1623fe9e-02cb-4870-bb78-c677c9df8614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baa1e9edaf0>]}
[0m15:37:46.278467 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:37:46.279343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1623fe9e-02cb-4870-bb78-c677c9df8614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baa1df34140>]}
[0m15:37:46.289607 [info ] [MainThread]: 
[0m15:37:46.290552 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:37:46.292461 [info ] [MainThread]: 
[0m15:37:46.295909 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:37:46.304925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:37:46.357880 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:37:46.358809 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:37:46.359882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:46.366466 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:37:46.367242 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:37:46.368796 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:37:46.372948 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m15:37:46.376819 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:37:46.380713 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:37:46.401886 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:46.402725 [debug] [MainThread]: On master: BEGIN
[0m15:37:46.403496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:37:46.413758 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:37:46.414488 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:46.415325 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:37:46.448274 [debug] [MainThread]: SQL status: SELECT 3 in 0.032 seconds
[0m15:37:46.451700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1623fe9e-02cb-4870-bb78-c677c9df8614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baa1de52fc0>]}
[0m15:37:46.452574 [debug] [MainThread]: On master: ROLLBACK
[0m15:37:46.453402 [debug] [MainThread]: On master: Close
[0m15:37:46.461703 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.check_current_date
[0m15:37:46.462266 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_customer_targets
[0m15:37:46.462892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.check_current_date)
[0m15:37:46.463470 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_customers
[0m15:37:46.465642 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_customers'
[0m15:37:46.464509 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.stg_order_lines
[0m15:37:46.465036 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.check_current_date
[0m15:37:46.464039 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_customer_targets'
[0m15:37:46.466196 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_customers
[0m15:37:46.466850 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.nexabrands_dbt.stg_order_lines'
[0m15:37:46.473800 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.check_current_date"
[0m15:37:46.474382 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_customer_targets
[0m15:37:46.477430 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customers"
[0m15:37:46.478042 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.stg_order_lines
[0m15:37:46.481095 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_customer_targets"
[0m15:37:46.485144 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_order_lines"
[0m15:37:46.486389 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_customer_targets
[0m15:37:46.486902 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.check_current_date
[0m15:37:46.487779 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_customers
[0m15:37:46.488434 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.stg_orders
[0m15:37:46.489397 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.check_current_date
[0m15:37:46.490174 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.stg_order_lines
[0m15:37:46.490705 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.stg_products
[0m15:37:46.491262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customer_targets, now model.nexabrands_dbt.stg_orders)
[0m15:37:46.491871 [debug] [Thread-1 (]: Began running node snapshot.nexabrands_dbt.scd_customers
[0m15:37:46.492445 [debug] [Thread-4 (]: Began running node snapshot.nexabrands_dbt.scd_orders
[0m15:37:46.493014 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_customers, now model.nexabrands_dbt.stg_products)
[0m15:37:46.493611 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.stg_orders
[0m15:37:46.494291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.check_current_date, now snapshot.nexabrands_dbt.scd_customers)
[0m15:37:46.494837 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_order_lines, now snapshot.nexabrands_dbt.scd_orders)
[0m15:37:46.495399 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.stg_products
[0m15:37:46.498085 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_orders"
[0m15:37:46.498713 [debug] [Thread-1 (]: Began compiling node snapshot.nexabrands_dbt.scd_customers
[0m15:37:46.499245 [debug] [Thread-4 (]: Began compiling node snapshot.nexabrands_dbt.scd_orders
[0m15:37:46.501982 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.stg_products"
[0m15:37:46.505482 [debug] [Thread-1 (]: Began executing node snapshot.nexabrands_dbt.scd_customers
[0m15:37:46.508878 [debug] [Thread-4 (]: Began executing node snapshot.nexabrands_dbt.scd_orders
[0m15:37:46.509685 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.stg_orders
[0m15:37:46.510619 [debug] [Thread-1 (]: Finished running node snapshot.nexabrands_dbt.scd_customers
[0m15:37:46.511474 [debug] [Thread-4 (]: Finished running node snapshot.nexabrands_dbt.scd_orders
[0m15:37:46.512231 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.stg_products
[0m15:37:46.512723 [debug] [Thread-2 (]: Began running node model.nexabrands_dbt.order_delivery_metrics
[0m15:37:46.513773 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_orders, now model.nexabrands_dbt.order_delivery_metrics)
[0m15:37:46.514331 [debug] [Thread-2 (]: Began compiling node model.nexabrands_dbt.order_delivery_metrics
[0m15:37:46.522986 [debug] [Thread-2 (]: Writing injected SQL for node "model.nexabrands_dbt.order_delivery_metrics"
[0m15:37:46.523778 [debug] [Thread-2 (]: Began executing node model.nexabrands_dbt.order_delivery_metrics
[0m15:37:46.524604 [debug] [Thread-2 (]: Finished running node model.nexabrands_dbt.order_delivery_metrics
[0m15:37:46.525456 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.customer_performance
[0m15:37:46.525929 [debug] [Thread-4 (]: Began running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m15:37:46.526481 [debug] [Thread-3 (]: Began running node model.nexabrands_dbt.your_model
[0m15:37:46.527101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.nexabrands_dbt.scd_customers, now model.nexabrands_dbt.customer_performance)
[0m15:37:46.527674 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly snapshot.nexabrands_dbt.scd_orders, now model.nexabrands_dbt.fct_order_fulfillment_lines)
[0m15:37:46.528222 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.stg_products, now model.nexabrands_dbt.your_model)
[0m15:37:46.528757 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.customer_performance
[0m15:37:46.529293 [debug] [Thread-4 (]: Began compiling node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m15:37:46.529823 [debug] [Thread-3 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:37:46.537220 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.customer_performance"
[0m15:37:46.557427 [debug] [Thread-3 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:37:46.561212 [debug] [Thread-4 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:37:46.561969 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.customer_performance
[0m15:37:46.562789 [debug] [Thread-3 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:37:46.563717 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.customer_performance
[0m15:37:46.564599 [debug] [Thread-3 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:37:46.565268 [debug] [Thread-4 (]: Began executing node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m15:37:46.566285 [debug] [Thread-4 (]: Finished running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m15:37:46.567586 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993
[0m15:37:46.568139 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed
[0m15:37:46.568635 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.order_delivery_metrics, now test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993)
[0m15:37:46.569112 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64
[0m15:37:46.569594 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e
[0m15:37:46.570138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.customer_performance, now test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed)
[0m15:37:46.570724 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993
[0m15:37:46.571296 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.your_model, now test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64)
[0m15:37:46.571850 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.fct_order_fulfillment_lines, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e)
[0m15:37:46.572390 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed
[0m15:37:46.576572 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993"
[0m15:37:46.577134 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64
[0m15:37:46.577700 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e
[0m15:37:46.581812 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed"
[0m15:37:46.582677 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993
[0m15:37:46.586761 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64"
[0m15:37:46.591495 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e"
[0m15:37:46.592520 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993
[0m15:37:46.593372 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64
[0m15:37:46.593987 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed
[0m15:37:46.594714 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae
[0m15:37:46.595616 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64
[0m15:37:46.596499 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed
[0m15:37:46.597081 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e
[0m15:37:46.597575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae)
[0m15:37:46.598147 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4
[0m15:37:46.598786 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932
[0m15:37:46.599635 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e
[0m15:37:46.600189 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae
[0m15:37:46.600766 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4)
[0m15:37:46.601336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932)
[0m15:37:46.601924 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e
[0m15:37:46.608013 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae"
[0m15:37:46.608589 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4
[0m15:37:46.609142 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932
[0m15:37:46.609710 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e)
[0m15:37:46.614538 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4"
[0m15:37:46.619268 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932"
[0m15:37:46.619834 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae
[0m15:37:46.620386 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e
[0m15:37:46.621243 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4
[0m15:37:46.622258 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae
[0m15:37:46.627012 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e"
[0m15:37:46.627923 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4
[0m15:37:46.628525 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31
[0m15:37:46.629137 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932
[0m15:37:46.629828 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b
[0m15:37:46.630530 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31)
[0m15:37:46.631393 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932
[0m15:37:46.631852 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e
[0m15:37:46.632414 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b)
[0m15:37:46.632991 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31
[0m15:37:46.633592 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3
[0m15:37:46.634486 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e
[0m15:37:46.635043 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b
[0m15:37:46.639875 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31"
[0m15:37:46.640461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3)
[0m15:37:46.641093 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7
[0m15:37:46.645741 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b"
[0m15:37:46.646616 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31
[0m15:37:46.647149 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3
[0m15:37:46.647719 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7)
[0m15:37:46.648550 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b
[0m15:37:46.649350 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31
[0m15:37:46.654040 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3"
[0m15:37:46.654661 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7
[0m15:37:46.655508 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b
[0m15:37:46.656111 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b
[0m15:37:46.656960 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3
[0m15:37:46.663044 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7"
[0m15:37:46.663640 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9
[0m15:37:46.664254 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b)
[0m15:37:46.665097 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3
[0m15:37:46.665901 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7
[0m15:37:46.666477 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b, now test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9)
[0m15:37:46.667046 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b
[0m15:37:46.667653 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953
[0m15:37:46.668556 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7
[0m15:37:46.669114 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9
[0m15:37:46.673691 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b"
[0m15:37:46.674317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3, now test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953)
[0m15:37:46.674926 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be
[0m15:37:46.679535 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9"
[0m15:37:46.680307 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953
[0m15:37:46.680976 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be)
[0m15:37:46.681589 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b
[0m15:37:46.686658 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953"
[0m15:37:46.687277 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be
[0m15:37:46.688152 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b
[0m15:37:46.688615 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9
[0m15:37:46.694778 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b
[0m15:37:46.698373 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be"
[0m15:37:46.699337 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9
[0m15:37:46.699831 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953
[0m15:37:46.700393 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b)
[0m15:37:46.701224 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be
[0m15:37:46.701770 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2
[0m15:37:46.702647 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953
[0m15:37:46.703192 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b
[0m15:37:46.704013 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be
[0m15:37:46.704575 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2)
[0m15:37:46.705164 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183
[0m15:37:46.709393 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b"
[0m15:37:46.710005 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf
[0m15:37:46.710643 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2
[0m15:37:46.711225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183)
[0m15:37:46.712073 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b
[0m15:37:46.712568 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf)
[0m15:37:46.716754 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2"
[0m15:37:46.717342 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183
[0m15:37:46.718196 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b
[0m15:37:46.718794 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf
[0m15:37:46.723058 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183"
[0m15:37:46.723729 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371
[0m15:37:46.724328 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2
[0m15:37:46.729787 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf"
[0m15:37:46.730606 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183
[0m15:37:46.731191 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371)
[0m15:37:46.732028 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2
[0m15:37:46.732850 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf
[0m15:37:46.733608 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183
[0m15:37:46.734145 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371
[0m15:37:46.734793 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2
[0m15:37:46.735668 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf
[0m15:37:46.736256 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83
[0m15:37:46.740319 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371"
[0m15:37:46.740918 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2)
[0m15:37:46.741521 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1
[0m15:37:46.742132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83)
[0m15:37:46.743027 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371
[0m15:37:46.743520 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2
[0m15:37:46.744076 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1)
[0m15:37:46.744626 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83
[0m15:37:46.745565 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371
[0m15:37:46.749632 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2"
[0m15:37:46.756865 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2
[0m15:37:46.754394 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83"
[0m15:37:46.755002 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1
[0m15:37:46.760291 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1)
[0m15:37:46.761095 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1
[0m15:37:46.759327 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2
[0m15:37:46.750218 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1
[0m15:37:46.767716 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1"
[0m15:37:46.768399 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090
[0m15:37:46.772702 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1"
[0m15:37:46.773186 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83
[0m15:37:46.773937 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090)
[0m15:37:46.774660 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1
[0m15:37:46.775636 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83
[0m15:37:46.776235 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090
[0m15:37:46.776828 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1
[0m15:37:46.777561 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1
[0m15:37:46.778149 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd
[0m15:37:46.782300 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090"
[0m15:37:46.783180 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1
[0m15:37:46.783764 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8
[0m15:37:46.784479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd)
[0m15:37:46.785257 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090
[0m15:37:46.785844 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b
[0m15:37:46.786502 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8)
[0m15:37:46.787071 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd
[0m15:37:46.787901 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090
[0m15:37:46.788478 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b)
[0m15:37:46.789040 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8
[0m15:37:46.794412 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd"
[0m15:37:46.795094 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d
[0m15:37:46.795691 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b
[0m15:37:46.799831 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8"
[0m15:37:46.800705 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd
[0m15:37:46.801214 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d)
[0m15:37:46.805228 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b"
[0m15:37:46.806084 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8
[0m15:37:46.806897 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd
[0m15:37:46.807426 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d
[0m15:37:46.808245 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b
[0m15:37:46.809004 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8
[0m15:37:46.809574 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e
[0m15:37:46.813703 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d"
[0m15:37:46.814582 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b
[0m15:37:46.815183 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b
[0m15:37:46.815804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e)
[0m15:37:46.816636 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d
[0m15:37:46.817148 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe
[0m15:37:46.817736 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b)
[0m15:37:46.818319 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e
[0m15:37:46.819151 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d
[0m15:37:46.819720 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe)
[0m15:37:46.820266 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b
[0m15:37:46.824492 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e"
[0m15:37:46.825119 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae
[0m15:37:46.825717 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe
[0m15:37:46.829761 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b"
[0m15:37:46.830535 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d, now test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae)
[0m15:37:46.834824 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe"
[0m15:37:46.835425 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e
[0m15:37:46.836074 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae
[0m15:37:46.836861 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe
[0m15:37:46.837721 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e
[0m15:37:46.838299 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b
[0m15:37:46.845994 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae"
[0m15:37:46.846875 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe
[0m15:37:46.847853 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b
[0m15:37:46.848646 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae
[0m15:37:46.849729 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae
[0m15:37:46.850986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:46.851452 [debug] [MainThread]: Connection 'test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e' was properly closed.
[0m15:37:46.851897 [debug] [MainThread]: Connection 'test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b' was properly closed.
[0m15:37:46.852332 [debug] [MainThread]: Connection 'test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae' was properly closed.
[0m15:37:46.852758 [debug] [MainThread]: Connection 'test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe' was properly closed.
[0m15:37:46.858369 [debug] [MainThread]: Command end result
[0m15:37:46.904755 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:37:46.906786 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:37:46.914654 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:37:46.915729 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.3661466, "process_in_blocks": "5656", "process_kernel_time": 0.406079, "process_mem_max_rss": "119060", "process_out_blocks": "6488", "process_user_time": 6.708274}
[0m15:37:46.916308 [debug] [MainThread]: Command `dbt compile` succeeded at 15:37:46.916193 after 5.37 seconds
[0m15:37:46.916810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baa2134c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baa20cbafc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7baa20cb9490>]}
[0m15:37:46.917327 [debug] [MainThread]: Flushing usage events
[0m15:37:47.770953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:38:17.132989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b98382f7da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9839c58770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b983831b6e0>]}


============================== 15:38:17.138176 | 616d8cf4-512e-46f2-9109-a026888cce69 ==============================
[0m15:38:17.138176 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:38:17.139447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'profiles_dir': '/home/codespace/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:38:17.148986 [info ] [MainThread]: dbt version: 1.9.2
[0m15:38:17.149534 [info ] [MainThread]: python version: 3.12.1
[0m15:38:17.150048 [info ] [MainThread]: python path: /workspaces/pyspark_practice-/venv/bin/python
[0m15:38:17.150799 [info ] [MainThread]: os info: Linux-6.5.0-1025-azure-x86_64-with-glibc2.31
[0m15:38:17.243617 [info ] [MainThread]: Using profiles dir at /home/codespace/.dbt
[0m15:38:17.244451 [info ] [MainThread]: Using profiles.yml file at /home/codespace/.dbt/profiles.yml
[0m15:38:17.245165 [info ] [MainThread]: Using dbt_project.yml file at /workspaces/pyspark_practice-/nexabrands_dbt/dbt_project.yml
[0m15:38:17.246628 [info ] [MainThread]: adapter type: postgres
[0m15:38:17.247832 [info ] [MainThread]: adapter version: 1.9.0
[0m15:38:17.399546 [info ] [MainThread]: Configuration:
[0m15:38:17.400240 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:38:17.400826 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:38:17.401378 [info ] [MainThread]: Required dependencies:
[0m15:38:17.401942 [debug] [MainThread]: Executing "git --help"
[0m15:38:17.404581 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:38:17.405231 [debug] [MainThread]: STDERR: "b''"
[0m15:38:17.405679 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:38:17.406271 [info ] [MainThread]: Connection:
[0m15:38:17.407081 [info ] [MainThread]:   host: 172.19.0.3
[0m15:38:17.407570 [info ] [MainThread]:   port: 5432
[0m15:38:17.408067 [info ] [MainThread]:   user: root
[0m15:38:17.408596 [info ] [MainThread]:   database: raw
[0m15:38:17.409088 [info ] [MainThread]:   schema: raw
[0m15:38:17.409575 [info ] [MainThread]:   connect_timeout: 10
[0m15:38:17.410052 [info ] [MainThread]:   role: None
[0m15:38:17.410646 [info ] [MainThread]:   search_path: None
[0m15:38:17.411136 [info ] [MainThread]:   keepalives_idle: 0
[0m15:38:17.411711 [info ] [MainThread]:   sslmode: None
[0m15:38:17.412490 [info ] [MainThread]:   sslcert: None
[0m15:38:17.412979 [info ] [MainThread]:   sslkey: None
[0m15:38:17.413463 [info ] [MainThread]:   sslrootcert: None
[0m15:38:17.413950 [info ] [MainThread]:   application_name: dbt
[0m15:38:17.414457 [info ] [MainThread]:   retries: 1
[0m15:38:17.415099 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:38:17.512054 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:38:17.535226 [debug] [MainThread]: Using postgres connection "debug"
[0m15:38:17.535722 [debug] [MainThread]: On debug: select 1 as id
[0m15:38:17.536181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:38:17.540113 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m15:38:17.541224 [debug] [MainThread]: On debug: Close
[0m15:38:17.541780 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:38:17.542552 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:38:17.543921 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.53244203, "process_in_blocks": "0", "process_kernel_time": 0.275172, "process_mem_max_rss": "100484", "process_out_blocks": "24", "process_user_time": 1.567286}
[0m15:38:17.544958 [debug] [MainThread]: Command `dbt debug` succeeded at 15:38:17.544584 after 0.53 seconds
[0m15:38:17.545429 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:38:17.545916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b98387b1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9837c81520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9837d30920>]}
[0m15:38:17.546601 [debug] [MainThread]: Flushing usage events
[0m15:38:18.348052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:39:12.203532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb4f920110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb4fa3f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb50052f30>]}


============================== 15:39:12.206790 | 62e67b30-2029-44de-a950-46c7a61e655d ==============================
[0m15:39:12.206790 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:39:12.207551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select your_model', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:39:12.410263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62e67b30-2029-44de-a950-46c7a61e655d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb4f5daa50>]}
[0m15:39:12.484890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62e67b30-2029-44de-a950-46c7a61e655d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb516892b0>]}
[0m15:39:12.485751 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:39:12.629966 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:39:12.797329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:39:12.797835 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:39:12.862167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62e67b30-2029-44de-a950-46c7a61e655d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb4ef97290>]}
[0m15:39:12.991312 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:39:12.993732 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:39:13.008421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62e67b30-2029-44de-a950-46c7a61e655d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb4db87f80>]}
[0m15:39:13.009018 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:39:13.009621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62e67b30-2029-44de-a950-46c7a61e655d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb4ebfcf50>]}
[0m15:39:13.011582 [info ] [MainThread]: 
[0m15:39:13.012177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:39:13.012713 [info ] [MainThread]: 
[0m15:39:13.013422 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:39:13.014420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:39:13.049655 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:39:13.050160 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:39:13.050705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:13.054968 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m15:39:13.056295 [debug] [ThreadPool]: On list_raw: Close
[0m15:39:13.061490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:39:13.067547 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:39:13.068032 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:39:13.068561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:13.071517 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:39:13.072493 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:39:13.073501 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:39:13.076570 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m15:39:13.078427 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:39:13.079179 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:39:13.086074 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:13.086588 [debug] [MainThread]: On master: BEGIN
[0m15:39:13.087026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:13.090496 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:39:13.090991 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:13.091531 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:39:13.104215 [debug] [MainThread]: SQL status: SELECT 3 in 0.012 seconds
[0m15:39:13.106073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62e67b30-2029-44de-a950-46c7a61e655d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb4efa6c00>]}
[0m15:39:13.106662 [debug] [MainThread]: On master: ROLLBACK
[0m15:39:13.107224 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:13.107698 [debug] [MainThread]: On master: BEGIN
[0m15:39:13.108727 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:39:13.109328 [debug] [MainThread]: On master: COMMIT
[0m15:39:13.109781 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:13.110245 [debug] [MainThread]: On master: COMMIT
[0m15:39:13.110768 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:39:13.111257 [debug] [MainThread]: On master: Close
[0m15:39:13.113575 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:39:13.114525 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.your_model ..................................... [RUN]
[0m15:39:13.116535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:39:13.117086 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:39:13.127907 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:39:13.130894 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:39:13.133831 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:39:13.136480 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:39:13.137205 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:39:13.173465 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.your_model"
[0m15:39:13.174252 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:39:13.174773 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: BEGIN
[0m15:39:13.175265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:13.179375 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:39:13.181033 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:39:13.181575 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  create view "raw"."raw"."your_model__dbt_tmp"
    
    
  as (
    with __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
),  __dbt__cte__stg_customer_targets as (
-- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM  "raw"."raw"."customer_targets"

)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
) SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics";
  );
[0m15:39:13.190002 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 49: ) SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics";
                                                                    ^

[0m15:39:13.192766 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: ROLLBACK
[0m15:39:13.195557 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:39:13.232543 [debug] [Thread-1 (]: Database Error in model your_model (models/your_model.sql)
  syntax error at or near ";"
  LINE 49: ) SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics";
                                                                      ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql
[0m15:39:13.235145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62e67b30-2029-44de-a950-46c7a61e655d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb4eff2090>]}
[0m15:39:13.237184 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.your_model ............................ [[31mERROR[0m in 0.12s]
[0m15:39:13.238033 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:39:13.238768 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.your_model' to be skipped because of status 'error'.  Reason: Database Error in model your_model (models/your_model.sql)
  syntax error at or near ";"
  LINE 49: ) SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics";
                                                                      ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql.
[0m15:39:13.240887 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:13.241375 [debug] [MainThread]: On master: BEGIN
[0m15:39:13.241828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:13.245872 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:39:13.246447 [debug] [MainThread]: On master: COMMIT
[0m15:39:13.246913 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:13.247359 [debug] [MainThread]: On master: COMMIT
[0m15:39:13.247893 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:39:13.248385 [debug] [MainThread]: On master: Close
[0m15:39:13.249026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:13.249692 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:39:13.250413 [info ] [MainThread]: 
[0m15:39:13.251230 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m15:39:13.252216 [debug] [MainThread]: Command end result
[0m15:39:13.298170 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:39:13.300159 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:39:13.305768 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:39:13.306241 [info ] [MainThread]: 
[0m15:39:13.306850 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:39:13.307368 [info ] [MainThread]: 
[0m15:39:13.307965 [error] [MainThread]:   Database Error in model your_model (models/your_model.sql)
  syntax error at or near ";"
  LINE 49: ) SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics";
                                                                      ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql
[0m15:39:13.308464 [info ] [MainThread]: 
[0m15:39:13.309020 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:39:13.310089 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2051779, "process_in_blocks": "376", "process_kernel_time": 0.273152, "process_mem_max_rss": "110964", "process_out_blocks": "4072", "process_user_time": 2.232727}
[0m15:39:13.310693 [debug] [MainThread]: Command `dbt run` failed at 15:39:13.310579 after 1.21 seconds
[0m15:39:13.311203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb4f88e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb508f49b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ccb508f44d0>]}
[0m15:39:13.311830 [debug] [MainThread]: Flushing usage events
[0m15:39:14.132190 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:39:41.567920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137ae1530b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137affb4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137ae647740>]}


============================== 15:39:41.571139 | b9201d67-1312-41a5-875f-7fd59d1f6547 ==============================
[0m15:39:41.571139 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:39:41.571911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/codespace/.dbt', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select your_model', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:39:41.745485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9201d67-1312-41a5-875f-7fd59d1f6547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137adfdd610>]}
[0m15:39:41.814604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9201d67-1312-41a5-875f-7fd59d1f6547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137aeb4bb30>]}
[0m15:39:41.815402 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:39:41.983865 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:39:42.152970 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:39:42.153776 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/your_model.sql
[0m15:39:42.502439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9201d67-1312-41a5-875f-7fd59d1f6547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137ad5f9bb0>]}
[0m15:39:42.630729 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:39:42.634180 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:39:42.649768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9201d67-1312-41a5-875f-7fd59d1f6547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137ac5a4980>]}
[0m15:39:42.650378 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:39:42.650951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9201d67-1312-41a5-875f-7fd59d1f6547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137ad5f98b0>]}
[0m15:39:42.652878 [info ] [MainThread]: 
[0m15:39:42.653442 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:39:42.653944 [info ] [MainThread]: 
[0m15:39:42.654645 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:39:42.655688 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:39:42.689715 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:39:42.690373 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:39:42.690866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:42.695168 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m15:39:42.696537 [debug] [ThreadPool]: On list_raw: Close
[0m15:39:42.701749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:39:42.708096 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:39:42.708608 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:39:42.709069 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:42.712119 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:39:42.712901 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:39:42.713717 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:39:42.716778 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m15:39:42.718627 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:39:42.719392 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:39:42.727417 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:42.727931 [debug] [MainThread]: On master: BEGIN
[0m15:39:42.728405 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:42.731929 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:39:42.732451 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:42.733055 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:39:42.745831 [debug] [MainThread]: SQL status: SELECT 3 in 0.012 seconds
[0m15:39:42.747757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9201d67-1312-41a5-875f-7fd59d1f6547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137afdd4440>]}
[0m15:39:42.748301 [debug] [MainThread]: On master: ROLLBACK
[0m15:39:42.748862 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:42.749339 [debug] [MainThread]: On master: BEGIN
[0m15:39:42.750621 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:39:42.751110 [debug] [MainThread]: On master: COMMIT
[0m15:39:42.751572 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:42.752010 [debug] [MainThread]: On master: COMMIT
[0m15:39:42.752543 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:39:42.753028 [debug] [MainThread]: On master: Close
[0m15:39:42.755765 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:39:42.756734 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.your_model ..................................... [RUN]
[0m15:39:42.757518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:39:42.758044 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:39:42.768986 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:39:42.771972 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:39:42.774962 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:39:42.777232 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:39:42.777956 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:39:42.816054 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.your_model"
[0m15:39:42.817108 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:39:42.817855 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: BEGIN
[0m15:39:42.818617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:42.823603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:39:42.824387 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:39:42.825224 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  create view "raw"."raw"."your_model__dbt_tmp"
    
    
  as (
    with __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
),  __dbt__cte__stg_customer_targets as (
-- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM  "raw"."raw"."customer_targets"

)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
) SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics"
SELECT COUNT(*) FROM __dbt__cte__stg_orders
SELECT COUNT(*) FROM __dbt__cte__stg_customers
SELECT COUNT(*) FROM __dbt__cte__stg_customer_targets
  );
[0m15:39:42.826447 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "SELECT"
LINE 50: SELECT COUNT(*) FROM __dbt__cte__stg_orders
         ^

[0m15:39:42.830325 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: ROLLBACK
[0m15:39:42.839287 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:39:42.850358 [debug] [Thread-1 (]: Database Error in model your_model (models/your_model.sql)
  syntax error at or near "SELECT"
  LINE 50: SELECT COUNT(*) FROM __dbt__cte__stg_orders
           ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql
[0m15:39:42.854021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9201d67-1312-41a5-875f-7fd59d1f6547', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137a803cd10>]}
[0m15:39:42.860323 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.your_model ............................ [[31mERROR[0m in 0.09s]
[0m15:39:42.862717 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:39:42.863804 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.your_model' to be skipped because of status 'error'.  Reason: Database Error in model your_model (models/your_model.sql)
  syntax error at or near "SELECT"
  LINE 50: SELECT COUNT(*) FROM __dbt__cte__stg_orders
           ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql.
[0m15:39:42.868412 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:42.869174 [debug] [MainThread]: On master: BEGIN
[0m15:39:42.869884 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:42.878820 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:39:42.879580 [debug] [MainThread]: On master: COMMIT
[0m15:39:42.880293 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:42.880987 [debug] [MainThread]: On master: COMMIT
[0m15:39:42.881760 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:39:42.882648 [debug] [MainThread]: On master: Close
[0m15:39:42.890570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:42.891259 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:39:42.892067 [info ] [MainThread]: 
[0m15:39:42.892839 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m15:39:42.894148 [debug] [MainThread]: Command end result
[0m15:39:43.069015 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:39:43.071706 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:39:43.081500 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:39:43.082167 [info ] [MainThread]: 
[0m15:39:43.083050 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:39:43.083833 [info ] [MainThread]: 
[0m15:39:43.084705 [error] [MainThread]:   Database Error in model your_model (models/your_model.sql)
  syntax error at or near "SELECT"
  LINE 50: SELECT COUNT(*) FROM __dbt__cte__stg_orders
           ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql
[0m15:39:43.085676 [info ] [MainThread]: 
[0m15:39:43.086534 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:39:43.088255 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6048411, "process_in_blocks": "0", "process_kernel_time": 0.311586, "process_mem_max_rss": "114440", "process_out_blocks": "6008", "process_user_time": 2.46217}
[0m15:39:43.089084 [debug] [MainThread]: Command `dbt run` failed at 15:39:43.088938 after 1.61 seconds
[0m15:39:43.090472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137ae6468d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137abd3f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7137abd3ddf0>]}
[0m15:39:43.091233 [debug] [MainThread]: Flushing usage events
[0m15:39:43.887078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:39:52.983095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e18be6f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e18bd42900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e18d8c7bf0>]}


============================== 15:39:52.986305 | ab0e94e5-f79b-4419-925a-02f86288c3a2 ==============================
[0m15:39:52.986305 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:39:52.987079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select your_model', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:39:53.170891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab0e94e5-f79b-4419-925a-02f86288c3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e18d86b050>]}
[0m15:39:53.234397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab0e94e5-f79b-4419-925a-02f86288c3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e18bef2690>]}
[0m15:39:53.235187 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:39:53.354554 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:39:53.521893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:39:53.522964 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/your_model.sql
[0m15:39:53.824226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab0e94e5-f79b-4419-925a-02f86288c3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e189fff980>]}
[0m15:39:53.954936 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:39:53.957345 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:39:53.972054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab0e94e5-f79b-4419-925a-02f86288c3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e18abc4b60>]}
[0m15:39:53.972625 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:39:53.973187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab0e94e5-f79b-4419-925a-02f86288c3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e18b3f4b00>]}
[0m15:39:53.975130 [info ] [MainThread]: 
[0m15:39:53.975693 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:39:53.976189 [info ] [MainThread]: 
[0m15:39:53.976875 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:39:53.977900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:39:54.011464 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:39:54.011970 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:39:54.012436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:54.016591 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m15:39:54.017915 [debug] [ThreadPool]: On list_raw: Close
[0m15:39:54.023215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:39:54.029231 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:39:54.029715 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:39:54.030153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:54.033042 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:39:54.034109 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:39:54.034627 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:39:54.037057 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.002 seconds
[0m15:39:54.038557 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:39:54.039255 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:39:54.047382 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:54.047853 [debug] [MainThread]: On master: BEGIN
[0m15:39:54.048290 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:54.051297 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:39:54.052789 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:54.053628 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:39:54.066240 [debug] [MainThread]: SQL status: SELECT 3 in 0.012 seconds
[0m15:39:54.068128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab0e94e5-f79b-4419-925a-02f86288c3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e18847c980>]}
[0m15:39:54.068683 [debug] [MainThread]: On master: ROLLBACK
[0m15:39:54.069244 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:54.069722 [debug] [MainThread]: On master: BEGIN
[0m15:39:54.070980 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:39:54.071468 [debug] [MainThread]: On master: COMMIT
[0m15:39:54.071920 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:54.072357 [debug] [MainThread]: On master: COMMIT
[0m15:39:54.072890 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:39:54.073370 [debug] [MainThread]: On master: Close
[0m15:39:54.075942 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:39:54.076803 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.your_model ..................................... [RUN]
[0m15:39:54.077536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:39:54.078306 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:39:54.086559 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:39:54.087332 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:39:54.122812 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.your_model"
[0m15:39:54.123599 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:39:54.124105 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: BEGIN
[0m15:39:54.124589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:54.127709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:39:54.129335 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:39:54.130326 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  create view "raw"."raw"."your_model__dbt_tmp"
    
    
  as (
    SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics"
  );
[0m15:39:54.143941 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m15:39:54.157318 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:39:54.158941 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
alter table "raw"."raw"."your_model__dbt_tmp" rename to "your_model"
[0m15:39:54.160698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:39:54.175762 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: COMMIT
[0m15:39:54.176297 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:39:54.176794 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: COMMIT
[0m15:39:54.178970 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:39:54.185598 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."your_model__dbt_backup"
[0m15:39:54.191547 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:39:54.192076 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
drop view if exists "raw"."raw"."your_model__dbt_backup" cascade
[0m15:39:54.192734 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m15:39:54.195189 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:39:54.197478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab0e94e5-f79b-4419-925a-02f86288c3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e18d86a1b0>]}
[0m15:39:54.198549 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.your_model ................................ [[32mCREATE VIEW[0m in 0.12s]
[0m15:39:54.199371 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:39:54.200920 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:54.201390 [debug] [MainThread]: On master: BEGIN
[0m15:39:54.201837 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:54.205554 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:39:54.206407 [debug] [MainThread]: On master: COMMIT
[0m15:39:54.206913 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:54.207364 [debug] [MainThread]: On master: COMMIT
[0m15:39:54.207890 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:39:54.208371 [debug] [MainThread]: On master: Close
[0m15:39:54.209040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:54.209747 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:39:54.210499 [info ] [MainThread]: 
[0m15:39:54.211301 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m15:39:54.212230 [debug] [MainThread]: Command end result
[0m15:39:54.301179 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:39:54.303208 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:39:54.308901 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:39:54.309357 [info ] [MainThread]: 
[0m15:39:54.309973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:54.310494 [info ] [MainThread]: 
[0m15:39:54.311038 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:39:54.312122 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4201853, "process_in_blocks": "0", "process_kernel_time": 0.342825, "process_mem_max_rss": "113996", "process_out_blocks": "5976", "process_user_time": 2.479508}
[0m15:39:54.312678 [debug] [MainThread]: Command `dbt run` succeeded at 15:39:54.312561 after 1.42 seconds
[0m15:39:54.313166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e18833e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e18833e4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e18833e450>]}
[0m15:39:54.313666 [debug] [MainThread]: Flushing usage events
[0m15:39:55.112696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:40:46.707723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b675b1b380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b67515f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b67515fe90>]}


============================== 15:40:46.710917 | 47f7f94e-da9b-4ae3-acf8-0a60d9418ff6 ==============================
[0m15:40:46.710917 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:40:46.711704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt show --select your_model', 'send_anonymous_usage_stats': 'True'}
[0m15:40:46.883136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47f7f94e-da9b-4ae3-acf8-0a60d9418ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b676b73410>]}
[0m15:40:46.945972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47f7f94e-da9b-4ae3-acf8-0a60d9418ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b674dab6b0>]}
[0m15:40:46.959460 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:40:47.083859 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:40:47.247286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:40:47.247800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:40:47.316284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47f7f94e-da9b-4ae3-acf8-0a60d9418ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b6747059d0>]}
[0m15:40:47.461607 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:40:47.464027 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:40:47.468696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47f7f94e-da9b-4ae3-acf8-0a60d9418ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b67277fc80>]}
[0m15:40:47.469262 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:40:47.469840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47f7f94e-da9b-4ae3-acf8-0a60d9418ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b67277f560>]}
[0m15:40:47.471760 [info ] [MainThread]: 
[0m15:40:47.472308 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:40:47.472800 [info ] [MainThread]: 
[0m15:40:47.473483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:40:47.478120 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:40:47.513244 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:40:47.513739 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:40:47.514219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:47.518273 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:40:47.520681 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:40:47.522302 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:40:47.526989 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.004 seconds
[0m15:40:47.529819 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:40:47.530806 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:40:47.539051 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:47.539551 [debug] [MainThread]: On master: BEGIN
[0m15:40:47.540002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:40:47.543033 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:40:47.543769 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:47.544677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:40:47.558502 [debug] [MainThread]: SQL status: SELECT 4 in 0.013 seconds
[0m15:40:47.560572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47f7f94e-da9b-4ae3-acf8-0a60d9418ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b676c203b0>]}
[0m15:40:47.561112 [debug] [MainThread]: On master: ROLLBACK
[0m15:40:47.561683 [debug] [MainThread]: On master: Close
[0m15:40:47.564396 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:40:47.565110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:40:47.565646 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:40:47.574107 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:40:47.574926 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:40:47.582912 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:40:47.583453 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  
  SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics"
  
  limit 5

[0m15:40:47.583962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:47.587596 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:40:47.589907 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:40:47.591020 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:40:47.592665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:47.593231 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:40:47.594025 [debug] [MainThread]: Command end result
[0m15:40:47.636989 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:40:47.638684 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:40:47.645050 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:40:47.645601 [info ] [MainThread]: Previewing node 'your_model':
| count |
| ----- |
|   672 |

[0m15:40:47.646746 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.0264429, "process_in_blocks": "32", "process_kernel_time": 0.266946, "process_mem_max_rss": "111024", "process_out_blocks": "4024", "process_user_time": 2.071821}
[0m15:40:47.647325 [debug] [MainThread]: Command `dbt show` succeeded at 15:40:47.647207 after 1.03 seconds
[0m15:40:47.647821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b675981ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b6737e9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b6737e99a0>]}
[0m15:40:47.648332 [debug] [MainThread]: Flushing usage events
[0m15:40:48.481936 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:52.376732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c0d1ed3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c0d1bc7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c0d19b0980>]}


============================== 15:41:52.380127 | 0c80fd6c-6c29-4d67-9953-f779f1a39cee ==============================
[0m15:41:52.380127 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:41:52.380902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/codespace/.dbt', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt show --select your_model', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:41:52.552644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c80fd6c-6c29-4d67-9953-f779f1a39cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c0d133c170>]}
[0m15:41:52.616490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c80fd6c-6c29-4d67-9953-f779f1a39cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c0d12be3c0>]}
[0m15:41:52.629968 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:41:52.752166 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:41:52.923582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:41:52.924380 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/your_model.sql
[0m15:41:53.288207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c80fd6c-6c29-4d67-9953-f779f1a39cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c0cfdda870>]}
[0m15:41:53.417417 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:41:53.420122 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:41:53.424952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c80fd6c-6c29-4d67-9953-f779f1a39cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c0cfd69250>]}
[0m15:41:53.425528 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:41:53.426088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c80fd6c-6c29-4d67-9953-f779f1a39cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c0d0cb4620>]}
[0m15:41:53.428054 [info ] [MainThread]: 
[0m15:41:53.428601 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:41:53.429100 [info ] [MainThread]: 
[0m15:41:53.429770 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:41:53.434280 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:41:53.467862 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:41:53.468394 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:41:53.468852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:53.473102 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:41:53.473632 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:41:53.474121 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:41:53.476752 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m15:41:53.478532 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:41:53.479103 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:41:53.487340 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:53.487836 [debug] [MainThread]: On master: BEGIN
[0m15:41:53.488283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:41:53.491378 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:41:53.492124 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:53.492669 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:41:53.508312 [debug] [MainThread]: SQL status: SELECT 4 in 0.015 seconds
[0m15:41:53.510464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c80fd6c-6c29-4d67-9953-f779f1a39cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c0d3188110>]}
[0m15:41:53.511000 [debug] [MainThread]: On master: ROLLBACK
[0m15:41:53.511547 [debug] [MainThread]: On master: Close
[0m15:41:53.514069 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:41:53.514889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:41:53.515404 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:41:53.525830 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:41:53.528862 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:41:53.531916 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:41:53.533381 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:41:53.534147 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:41:53.542267 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:41:53.542881 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  
  with __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
),  __dbt__cte__stg_customer_targets as (
-- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM  "raw"."raw"."customer_targets"

)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
) -- SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics"


SELECT COUNT(*) FROM __dbt__cte__stg_orders
-- SELECT COUNT(*) FROM __dbt__cte__stg_customers
-- SELECT COUNT(*) FROM __dbt__cte__stg_customer_targets
  
  limit 5

[0m15:41:53.543463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:53.546841 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:41:53.549136 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:41:53.550356 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:41:53.552046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:53.552502 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:41:53.553293 [debug] [MainThread]: Command end result
[0m15:41:53.641466 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:41:53.643248 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:41:53.649645 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:41:53.650188 [info ] [MainThread]: Previewing node 'your_model':
| count |
| ----- |
|  2100 |

[0m15:41:53.651358 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.3594655, "process_in_blocks": "0", "process_kernel_time": 0.266755, "process_mem_max_rss": "113852", "process_out_blocks": "6000", "process_user_time": 2.456542}
[0m15:41:53.651923 [debug] [MainThread]: Command `dbt show` succeeded at 15:41:53.651804 after 1.36 seconds
[0m15:41:53.652418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c0d2040170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c0d1520fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75c0cdd28e00>]}
[0m15:41:53.652915 [debug] [MainThread]: Flushing usage events
[0m15:41:54.468722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:16.504834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c712eac1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c712ee660c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c71310615e0>]}


============================== 15:42:16.509315 | e5a32ee5-4bab-4293-90c7-ac989a87b9a7 ==============================
[0m15:42:16.509315 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:42:16.510120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt show --select your_model', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:42:16.683258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5a32ee5-4bab-4293-90c7-ac989a87b9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7130073320>]}
[0m15:42:16.747466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5a32ee5-4bab-4293-90c7-ac989a87b9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c712e2bbb30>]}
[0m15:42:16.761114 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:42:16.895928 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:42:17.080699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:17.081260 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:17.173407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5a32ee5-4bab-4293-90c7-ac989a87b9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c712d79c890>]}
[0m15:42:17.303989 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:42:17.306399 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:42:17.311146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5a32ee5-4bab-4293-90c7-ac989a87b9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c712bf1ff20>]}
[0m15:42:17.311720 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:42:17.312299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5a32ee5-4bab-4293-90c7-ac989a87b9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c712db42510>]}
[0m15:42:17.315021 [info ] [MainThread]: 
[0m15:42:17.315776 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:42:17.316459 [info ] [MainThread]: 
[0m15:42:17.317425 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:42:17.329530 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:42:17.377416 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:42:17.377943 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:42:17.378441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:17.382681 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:42:17.384595 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:42:17.385286 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:42:17.387932 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m15:42:17.389867 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:42:17.390661 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:42:17.397990 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:17.398496 [debug] [MainThread]: On master: BEGIN
[0m15:42:17.398940 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:17.401925 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:42:17.402702 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:17.403599 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:42:17.417876 [debug] [MainThread]: SQL status: SELECT 4 in 0.013 seconds
[0m15:42:17.419946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5a32ee5-4bab-4293-90c7-ac989a87b9a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c712bf1e120>]}
[0m15:42:17.420484 [debug] [MainThread]: On master: ROLLBACK
[0m15:42:17.421034 [debug] [MainThread]: On master: Close
[0m15:42:17.423579 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:42:17.424334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:42:17.424866 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:42:17.436121 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:42:17.439179 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:42:17.442173 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:42:17.443644 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:42:17.444362 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:42:17.452427 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:42:17.452990 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  
  with __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
),  __dbt__cte__stg_customer_targets as (
-- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM  "raw"."raw"."customer_targets"

)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
) -- SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics"


SELECT COUNT(*) FROM __dbt__cte__stg_orders
-- SELECT COUNT(*) FROM __dbt__cte__stg_customers
-- SELECT COUNT(*) FROM __dbt__cte__stg_customer_targets
  
  limit 5

[0m15:42:17.453523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:17.456916 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:42:17.459206 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:42:17.460386 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:42:17.461839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:17.462408 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:42:17.463191 [debug] [MainThread]: Command end result
[0m15:42:17.509031 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:42:17.510727 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:42:17.517144 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:42:17.517861 [info ] [MainThread]: Previewing node 'your_model':
| count |
| ----- |
|  2100 |

[0m15:42:17.519512 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.1261702, "process_in_blocks": "0", "process_kernel_time": 0.337297, "process_mem_max_rss": "110296", "process_out_blocks": "4056", "process_user_time": 2.031724}
[0m15:42:17.520382 [debug] [MainThread]: Command `dbt show` succeeded at 15:42:17.520220 after 1.13 seconds
[0m15:42:17.521168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c712e38d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c713038e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c712e2bb3e0>]}
[0m15:42:17.521951 [debug] [MainThread]: Flushing usage events
[0m15:42:18.341784 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:33.234250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d500f1c1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d500ee944a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5010b7c5c0>]}


============================== 15:42:33.239234 | fab3216e-3f85-4fb6-958b-5c03bb8c91c5 ==============================
[0m15:42:33.239234 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:42:33.240488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/codespace/.dbt', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt show --select your_model', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:42:33.429037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fab3216e-3f85-4fb6-958b-5c03bb8c91c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d500f168b00>]}
[0m15:42:33.509212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fab3216e-3f85-4fb6-958b-5c03bb8c91c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d500f356960>]}
[0m15:42:33.524669 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:42:33.699015 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:42:33.898457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:42:33.899273 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/your_model.sql
[0m15:42:34.201500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fab3216e-3f85-4fb6-958b-5c03bb8c91c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d500c5b74d0>]}
[0m15:42:34.335110 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:42:34.337477 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:42:34.342265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fab3216e-3f85-4fb6-958b-5c03bb8c91c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d500d57db80>]}
[0m15:42:34.342851 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:42:34.343410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fab3216e-3f85-4fb6-958b-5c03bb8c91c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d500d57d340>]}
[0m15:42:34.345479 [info ] [MainThread]: 
[0m15:42:34.346544 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:42:34.347510 [info ] [MainThread]: 
[0m15:42:34.348823 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:42:34.354181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:42:34.387730 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:42:34.388222 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:42:34.388679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:34.393689 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:42:34.394223 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:42:34.394721 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:42:34.397312 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m15:42:34.399099 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:42:34.400011 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:42:34.407876 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:34.408349 [debug] [MainThread]: On master: BEGIN
[0m15:42:34.408795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:34.411780 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:42:34.412679 [debug] [MainThread]: Using postgres connection "master"
[0m15:42:34.413583 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:42:34.427754 [debug] [MainThread]: SQL status: SELECT 4 in 0.013 seconds
[0m15:42:34.429815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fab3216e-3f85-4fb6-958b-5c03bb8c91c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d500d57c500>]}
[0m15:42:34.430371 [debug] [MainThread]: On master: ROLLBACK
[0m15:42:34.430933 [debug] [MainThread]: On master: Close
[0m15:42:34.433433 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:42:34.434230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:42:34.434808 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:42:34.445132 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:42:34.448165 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:42:34.451242 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:42:34.452659 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:42:34.453392 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:42:34.461643 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:42:34.462240 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  
  with __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
),  __dbt__cte__stg_customer_targets as (
-- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM  "raw"."raw"."customer_targets"

)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
) -- SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics"


-- SELECT COUNT(*) FROM __dbt__cte__stg_orders
-- SELECT COUNT(*) FROM __dbt__cte__stg_customers
SELECT COUNT(*) FROM __dbt__cte__stg_customer_targets
  
  limit 5

[0m15:42:34.462781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:34.466040 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:42:34.468328 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:42:34.469471 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:42:34.470968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:34.471532 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:42:34.472333 [debug] [MainThread]: Command end result
[0m15:42:34.567058 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:42:34.568807 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:42:34.575263 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:42:34.575801 [info ] [MainThread]: Previewing node 'your_model':
| count |
| ----- |
|    20 |

[0m15:42:34.576933 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.4461243, "process_in_blocks": "0", "process_kernel_time": 0.280012, "process_mem_max_rss": "113596", "process_out_blocks": "5992", "process_user_time": 2.476114}
[0m15:42:34.577499 [debug] [MainThread]: Command `dbt show` succeeded at 15:42:34.577381 after 1.45 seconds
[0m15:42:34.578000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d500f4c6ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d500f0c7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d5007455550>]}
[0m15:42:34.578537 [debug] [MainThread]: Flushing usage events
[0m15:42:35.373502 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:43:02.395248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079dd1bfc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079dd759d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079dd759ca0>]}


============================== 15:43:02.398495 | cb314b76-2ec3-48ca-a13a-ac71968700a3 ==============================
[0m15:43:02.398495 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:43:02.399295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt show --select your_model', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:43:02.576114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb314b76-2ec3-48ca-a13a-ac71968700a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079dd92f650>]}
[0m15:43:02.639234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb314b76-2ec3-48ca-a13a-ac71968700a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079dccd50a0>]}
[0m15:43:02.652423 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:43:02.776150 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:43:02.938657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:43:02.939131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:43:03.006077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb314b76-2ec3-48ca-a13a-ac71968700a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079dc14be00>]}
[0m15:43:03.138640 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:43:03.142063 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:43:03.149686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb314b76-2ec3-48ca-a13a-ac71968700a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079db507fe0>]}
[0m15:43:03.150543 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:43:03.151325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb314b76-2ec3-48ca-a13a-ac71968700a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079db5077d0>]}
[0m15:43:03.154122 [info ] [MainThread]: 
[0m15:43:03.154872 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:43:03.155830 [info ] [MainThread]: 
[0m15:43:03.157045 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:43:03.164348 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:43:03.217171 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:43:03.217956 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:43:03.218690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:03.224466 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m15:43:03.226157 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:43:03.226937 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:43:03.233130 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.005 seconds
[0m15:43:03.236035 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:43:03.236862 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:43:03.250599 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:03.251292 [debug] [MainThread]: On master: BEGIN
[0m15:43:03.251987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:03.257302 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:43:03.258472 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:03.263326 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:43:03.288038 [debug] [MainThread]: SQL status: SELECT 4 in 0.024 seconds
[0m15:43:03.290425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb314b76-2ec3-48ca-a13a-ac71968700a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079dea04410>]}
[0m15:43:03.291030 [debug] [MainThread]: On master: ROLLBACK
[0m15:43:03.291591 [debug] [MainThread]: On master: Close
[0m15:43:03.294428 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:43:03.295235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:43:03.295777 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:43:03.316892 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:43:03.321934 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:43:03.326856 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:43:03.329399 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:43:03.330827 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:43:03.343935 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:43:03.344761 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  
  with __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
),  __dbt__cte__stg_customer_targets as (
-- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM  "raw"."raw"."customer_targets"

)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
) -- SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics"


-- SELECT COUNT(*) FROM __dbt__cte__stg_orders
-- SELECT COUNT(*) FROM __dbt__cte__stg_customers
SELECT COUNT(*) FROM __dbt__cte__stg_customer_targets
  
  limit 5

[0m15:43:03.345590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:03.351393 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m15:43:03.355329 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:43:03.356807 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:43:03.360936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:03.361605 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:43:03.362825 [debug] [MainThread]: Command end result
[0m15:43:03.428074 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:43:03.429849 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:43:03.436386 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:43:03.436941 [info ] [MainThread]: Previewing node 'your_model':
| count |
| ----- |
|    20 |

[0m15:43:03.438068 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.129964, "process_in_blocks": "0", "process_kernel_time": 0.25467, "process_mem_max_rss": "110320", "process_out_blocks": "4056", "process_user_time": 2.180619}
[0m15:43:03.438674 [debug] [MainThread]: Command `dbt show` succeeded at 15:43:03.438557 after 1.13 seconds
[0m15:43:03.439178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079dccabfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079dd758230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7079dea04410>]}
[0m15:43:03.439690 [debug] [MainThread]: Flushing usage events
[0m15:43:04.255892 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:43:27.546971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74985fbcd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74985f4abfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74985f4abec0>]}


============================== 15:43:27.550153 | ae66f9d3-97bf-4f17-aaa0-d24d965c907f ==============================
[0m15:43:27.550153 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:43:27.551000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select your_model', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:43:27.727355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae66f9d3-97bf-4f17-aaa0-d24d965c907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74985f03d550>]}
[0m15:43:27.815366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae66f9d3-97bf-4f17-aaa0-d24d965c907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74985fa0ad50>]}
[0m15:43:27.817324 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:43:27.940869 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:43:28.123018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:43:28.123809 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/your_model.sql
[0m15:43:28.454476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae66f9d3-97bf-4f17-aaa0-d24d965c907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74985cff19a0>]}
[0m15:43:28.579411 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:43:28.582440 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:43:28.597005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae66f9d3-97bf-4f17-aaa0-d24d965c907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74985dfdc680>]}
[0m15:43:28.597590 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:43:28.598147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae66f9d3-97bf-4f17-aaa0-d24d965c907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74985d79e8a0>]}
[0m15:43:28.600087 [info ] [MainThread]: 
[0m15:43:28.600648 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:43:28.601143 [info ] [MainThread]: 
[0m15:43:28.601814 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:43:28.602861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:43:28.636745 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:43:28.637281 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:43:28.637752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:28.642035 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m15:43:28.643423 [debug] [ThreadPool]: On list_raw: Close
[0m15:43:28.648631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:43:28.654702 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:43:28.655179 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:43:28.655621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:28.658584 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:43:28.659374 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:43:28.660204 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:43:28.663527 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m15:43:28.665201 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:43:28.665869 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:43:28.673939 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:28.674444 [debug] [MainThread]: On master: BEGIN
[0m15:43:28.674883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:28.677858 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:43:28.680481 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:28.681031 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:43:28.694648 [debug] [MainThread]: SQL status: SELECT 4 in 0.013 seconds
[0m15:43:28.696723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae66f9d3-97bf-4f17-aaa0-d24d965c907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74985ee83140>]}
[0m15:43:28.697267 [debug] [MainThread]: On master: ROLLBACK
[0m15:43:28.697826 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:28.698324 [debug] [MainThread]: On master: BEGIN
[0m15:43:28.699191 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:43:28.701769 [debug] [MainThread]: On master: COMMIT
[0m15:43:28.702269 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:28.702718 [debug] [MainThread]: On master: COMMIT
[0m15:43:28.703240 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:43:28.703797 [debug] [MainThread]: On master: Close
[0m15:43:28.707271 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:43:28.707923 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.your_model ..................................... [RUN]
[0m15:43:28.708567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:43:28.709079 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:43:28.720229 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:43:28.723206 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:43:28.727164 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:43:28.728106 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:43:28.773187 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.your_model"
[0m15:43:28.774253 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:43:28.774995 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: BEGIN
[0m15:43:28.775820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:28.779791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:43:28.780334 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:43:28.780901 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  create view "raw"."raw"."your_model__dbt_tmp"
    
    
  as (
    with __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
) SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics";
  );
[0m15:43:28.790482 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 35: ) SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics";
                                                                    ^

[0m15:43:28.805571 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: ROLLBACK
[0m15:43:28.807682 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:43:28.817374 [debug] [Thread-1 (]: Database Error in model your_model (models/your_model.sql)
  syntax error at or near ";"
  LINE 35: ) SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics";
                                                                      ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql
[0m15:43:28.820115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae66f9d3-97bf-4f17-aaa0-d24d965c907f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74985e7fc560>]}
[0m15:43:28.821352 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.your_model ............................ [[31mERROR[0m in 0.11s]
[0m15:43:28.822656 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:43:28.823880 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.your_model' to be skipped because of status 'error'.  Reason: Database Error in model your_model (models/your_model.sql)
  syntax error at or near ";"
  LINE 35: ) SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics";
                                                                      ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql.
[0m15:43:28.830691 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:28.831421 [debug] [MainThread]: On master: BEGIN
[0m15:43:28.832134 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:28.835728 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:43:28.837077 [debug] [MainThread]: On master: COMMIT
[0m15:43:28.837691 [debug] [MainThread]: Using postgres connection "master"
[0m15:43:28.838144 [debug] [MainThread]: On master: COMMIT
[0m15:43:28.838732 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:43:28.839216 [debug] [MainThread]: On master: Close
[0m15:43:28.839857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:28.840524 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:43:28.841202 [info ] [MainThread]: 
[0m15:43:28.841965 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m15:43:28.842933 [debug] [MainThread]: Command end result
[0m15:43:28.933142 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:43:28.934931 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:43:28.940551 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:43:28.941006 [info ] [MainThread]: 
[0m15:43:28.941641 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:43:28.942153 [info ] [MainThread]: 
[0m15:43:28.942772 [error] [MainThread]:   Database Error in model your_model (models/your_model.sql)
  syntax error at or near ";"
  LINE 35: ) SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics";
                                                                      ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql
[0m15:43:28.943259 [info ] [MainThread]: 
[0m15:43:28.943799 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:43:28.944898 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4829595, "process_in_blocks": "0", "process_kernel_time": 0.303256, "process_mem_max_rss": "114520", "process_out_blocks": "5992", "process_user_time": 2.414078}
[0m15:43:28.945451 [debug] [MainThread]: Command `dbt run` failed at 15:43:28.945336 after 1.48 seconds
[0m15:43:28.945944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74985f41e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74985cb39c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74985cb38590>]}
[0m15:43:28.946480 [debug] [MainThread]: Flushing usage events
[0m15:43:29.740695 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:08.740588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8bd272330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8bd10fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8be9f3b30>]}


============================== 15:44:08.745727 | 378eca9b-86c9-4a01-9d88-7b782d723ec1 ==============================
[0m15:44:08.745727 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:44:08.747047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select your_model', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:44:09.031167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '378eca9b-86c9-4a01-9d88-7b782d723ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8bc72ef60>]}
[0m15:44:09.133607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '378eca9b-86c9-4a01-9d88-7b782d723ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8bcde2e40>]}
[0m15:44:09.134918 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:44:09.350084 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:44:09.638719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:44:09.640031 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/your_model.sql
[0m15:44:10.132759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '378eca9b-86c9-4a01-9d88-7b782d723ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8bb774560>]}
[0m15:44:10.350802 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:44:10.354586 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:44:10.377728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '378eca9b-86c9-4a01-9d88-7b782d723ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8bba9d0d0>]}
[0m15:44:10.378684 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:44:10.379634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '378eca9b-86c9-4a01-9d88-7b782d723ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8bab84950>]}
[0m15:44:10.382704 [info ] [MainThread]: 
[0m15:44:10.383585 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:44:10.384689 [info ] [MainThread]: 
[0m15:44:10.385986 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:44:10.387536 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:44:10.444866 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:44:10.445677 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:44:10.446468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:10.452512 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.006 seconds
[0m15:44:10.454689 [debug] [ThreadPool]: On list_raw: Close
[0m15:44:10.465618 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:44:10.476053 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:44:10.476824 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:44:10.477554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:10.481758 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:44:10.482481 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:44:10.483207 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:44:10.492903 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.009 seconds
[0m15:44:10.496122 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:44:10.497226 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:44:10.515880 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:10.516717 [debug] [MainThread]: On master: BEGIN
[0m15:44:10.517472 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:44:10.521665 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:44:10.522386 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:10.523224 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:44:10.554149 [debug] [MainThread]: SQL status: SELECT 4 in 0.030 seconds
[0m15:44:10.557641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '378eca9b-86c9-4a01-9d88-7b782d723ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8b9675070>]}
[0m15:44:10.558583 [debug] [MainThread]: On master: ROLLBACK
[0m15:44:10.561230 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:10.562331 [debug] [MainThread]: On master: BEGIN
[0m15:44:10.563280 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:44:10.564569 [debug] [MainThread]: On master: COMMIT
[0m15:44:10.565306 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:10.566025 [debug] [MainThread]: On master: COMMIT
[0m15:44:10.566977 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:44:10.567706 [debug] [MainThread]: On master: Close
[0m15:44:10.574528 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:44:10.575483 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.your_model ..................................... [RUN]
[0m15:44:10.576370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:44:10.577133 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:44:10.599809 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:44:10.606094 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:44:10.613389 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:44:10.616264 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:44:10.691630 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.your_model"
[0m15:44:10.695104 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:44:10.696499 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: BEGIN
[0m15:44:10.697307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:10.701870 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:44:10.704264 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:44:10.707162 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  create view "raw"."raw"."your_model__dbt_tmp"
    
    
  as (
    with __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
) SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics"
SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics" om JOIN __dbt__cte__stg_orders o ON om.order_id = o.order_id;
  );
[0m15:44:10.710160 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "SELECT"
LINE 36: SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics" om...
         ^

[0m15:44:10.740789 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: ROLLBACK
[0m15:44:10.745792 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:44:10.774774 [debug] [Thread-1 (]: Database Error in model your_model (models/your_model.sql)
  syntax error at or near "SELECT"
  LINE 36: SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics" om...
           ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql
[0m15:44:10.800726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '378eca9b-86c9-4a01-9d88-7b782d723ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8bbaf4a70>]}
[0m15:44:10.801961 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.your_model ............................ [[31mERROR[0m in 0.22s]
[0m15:44:10.803334 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:44:10.804599 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.your_model' to be skipped because of status 'error'.  Reason: Database Error in model your_model (models/your_model.sql)
  syntax error at or near "SELECT"
  LINE 36: SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics" om...
           ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql.
[0m15:44:10.807654 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:10.808378 [debug] [MainThread]: On master: BEGIN
[0m15:44:10.809089 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:44:10.814076 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:44:10.816073 [debug] [MainThread]: On master: COMMIT
[0m15:44:10.816827 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:10.817565 [debug] [MainThread]: On master: COMMIT
[0m15:44:10.818498 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:44:10.819263 [debug] [MainThread]: On master: Close
[0m15:44:10.822718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:10.823435 [debug] [MainThread]: Connection 'list_raw' was properly closed.
[0m15:44:10.824131 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:44:10.824861 [info ] [MainThread]: 
[0m15:44:10.825669 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m15:44:10.827111 [debug] [MainThread]: Command end result
[0m15:44:10.997209 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:44:11.000181 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:44:11.009536 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:44:11.010280 [info ] [MainThread]: 
[0m15:44:11.011181 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:44:11.011990 [info ] [MainThread]: 
[0m15:44:11.012966 [error] [MainThread]:   Database Error in model your_model (models/your_model.sql)
  syntax error at or near "SELECT"
  LINE 36: SELECT COUNT(*) FROM "raw"."raw"."order_delivery_metrics" om...
           ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql
[0m15:44:11.013788 [info ] [MainThread]: 
[0m15:44:11.014643 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:44:11.016234 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4087973, "process_in_blocks": "0", "process_kernel_time": 0.290145, "process_mem_max_rss": "114328", "process_out_blocks": "6000", "process_user_time": 3.673875}
[0m15:44:11.017121 [debug] [MainThread]: Command `dbt run` failed at 15:44:11.016965 after 2.41 seconds
[0m15:44:11.018043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8bd10fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8ba1e84a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b8ba1e91c0>]}
[0m15:44:11.018879 [debug] [MainThread]: Flushing usage events
[0m15:44:11.853658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:16.363142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76227a5cfc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76227a400c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76227a35ef60>]}


============================== 15:45:16.371927 | 01d18885-f5bd-4e33-b078-520e46ef8ee9 ==============================
[0m15:45:16.371927 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:45:16.373141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select your_model', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:45:16.742834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01d18885-f5bd-4e33-b078-520e46ef8ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762279fc4fb0>]}
[0m15:45:16.849450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01d18885-f5bd-4e33-b078-520e46ef8ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76227a59b2f0>]}
[0m15:45:16.850831 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:45:17.058010 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:45:17.325125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:45:17.326344 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/your_model.sql
[0m15:45:17.825878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01d18885-f5bd-4e33-b078-520e46ef8ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622791ed760>]}
[0m15:45:18.041972 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:45:18.047607 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:45:18.071661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01d18885-f5bd-4e33-b078-520e46ef8ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622791e6150>]}
[0m15:45:18.072629 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:45:18.073544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d18885-f5bd-4e33-b078-520e46ef8ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7622791ef200>]}
[0m15:45:18.076507 [info ] [MainThread]: 
[0m15:45:18.077425 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:45:18.078604 [info ] [MainThread]: 
[0m15:45:18.080239 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:45:18.081800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:45:18.149188 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:45:18.150052 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:45:18.150867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:18.156521 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.006 seconds
[0m15:45:18.158733 [debug] [ThreadPool]: On list_raw: Close
[0m15:45:18.169576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:45:18.179891 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:45:18.180632 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:45:18.181351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:18.185464 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:45:18.186246 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:45:18.187074 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:45:18.191074 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m15:45:18.193526 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:45:18.194410 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:45:18.208627 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:18.209435 [debug] [MainThread]: On master: BEGIN
[0m15:45:18.210151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:45:18.214539 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:45:18.215320 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:18.216255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:45:18.238439 [debug] [MainThread]: SQL status: SELECT 4 in 0.021 seconds
[0m15:45:18.241798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d18885-f5bd-4e33-b078-520e46ef8ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76227bdf0290>]}
[0m15:45:18.242717 [debug] [MainThread]: On master: ROLLBACK
[0m15:45:18.243563 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:18.244308 [debug] [MainThread]: On master: BEGIN
[0m15:45:18.245234 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:45:18.245993 [debug] [MainThread]: On master: COMMIT
[0m15:45:18.246786 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:18.247556 [debug] [MainThread]: On master: COMMIT
[0m15:45:18.248435 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:45:18.249165 [debug] [MainThread]: On master: Close
[0m15:45:18.263385 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:45:18.264330 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.your_model ..................................... [RUN]
[0m15:45:18.265204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:45:18.265965 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:45:18.284276 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:45:18.289284 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:45:18.299048 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:45:18.300324 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:45:18.373122 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.your_model"
[0m15:45:18.374519 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:45:18.375351 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: BEGIN
[0m15:45:18.376165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:18.380534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:45:18.381399 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:45:18.382426 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  create view "raw"."raw"."your_model__dbt_tmp"
    
    
  as (
    WITH 
 __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
), total_delivery_metrics AS (
    SELECT COUNT(*) as total_delivery_metrics_count 
    FROM "raw"."raw"."order_delivery_metrics"
),
delivery_metrics_with_orders AS (
    SELECT COUNT(*) as delivery_metrics_orders_count
    FROM "raw"."raw"."order_delivery_metrics" om 
    JOIN __dbt__cte__stg_orders o ON om.order_id = o.order_id
),
delivery_metrics_with_customers AS (
    SELECT COUNT(*) as delivery_metrics_customers_count
    FROM "raw"."raw"."order_delivery_metrics" om 
    JOIN __dbt__cte__stg_orders o ON om.order_id = o.order_id
    JOIN __dbt__cte__stg_customers c ON o.customer_id = c.customer_id
)
SELECT 
    total_delivery_metrics_count,
    delivery_metrics_orders_count,
    delivery_metrics_customers_count
FROM 
    total_delivery_metrics, 
    delivery_metrics_with_orders, 
    delivery_metrics_with_customers
  );
[0m15:45:18.394332 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m15:45:18.415765 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:45:18.416638 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
alter table "raw"."raw"."your_model" rename to "your_model__dbt_backup"
[0m15:45:18.420517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:45:18.432969 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:45:18.439085 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
alter table "raw"."raw"."your_model__dbt_tmp" rename to "your_model"
[0m15:45:18.440394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:45:18.493916 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: COMMIT
[0m15:45:18.494832 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:45:18.495674 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: COMMIT
[0m15:45:18.498626 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:45:18.510718 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."your_model__dbt_backup"
[0m15:45:18.519374 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:45:18.520157 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
drop view if exists "raw"."raw"."your_model__dbt_backup" cascade
[0m15:45:18.523251 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:45:18.527131 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:45:18.533414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d18885-f5bd-4e33-b078-520e46ef8ee9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762274039610>]}
[0m15:45:18.534546 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.your_model ................................ [[32mCREATE VIEW[0m in 0.27s]
[0m15:45:18.535700 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:45:18.537550 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:18.538308 [debug] [MainThread]: On master: BEGIN
[0m15:45:18.538982 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:45:18.543478 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:45:18.544960 [debug] [MainThread]: On master: COMMIT
[0m15:45:18.545926 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:18.547004 [debug] [MainThread]: On master: COMMIT
[0m15:45:18.548110 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:45:18.549050 [debug] [MainThread]: On master: Close
[0m15:45:18.552177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:18.552881 [debug] [MainThread]: Connection 'list_raw' was properly closed.
[0m15:45:18.553583 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:45:18.554380 [info ] [MainThread]: 
[0m15:45:18.555164 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m15:45:18.556400 [debug] [MainThread]: Command end result
[0m15:45:18.721310 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:45:18.723983 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:45:18.732947 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:45:18.733672 [info ] [MainThread]: 
[0m15:45:18.734560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:45:18.735321 [info ] [MainThread]: 
[0m15:45:18.736098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:45:18.737634 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5385058, "process_in_blocks": "0", "process_kernel_time": 0.370661, "process_mem_max_rss": "113740", "process_out_blocks": "6008", "process_user_time": 3.648092}
[0m15:45:18.738525 [debug] [MainThread]: Command `dbt run` succeeded at 15:45:18.738370 after 2.54 seconds
[0m15:45:18.739329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762276ae5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x762276ae4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76227ad1f0e0>]}
[0m15:45:18.740126 [debug] [MainThread]: Flushing usage events
[0m15:45:19.551457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:28.616404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9653fadeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9653fadf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a96554be3f0>]}


============================== 15:45:28.619604 | 3638cf28-2fb9-4a11-b184-0794935e18c5 ==============================
[0m15:45:28.619604 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:45:28.620407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt show --select your_model', 'send_anonymous_usage_stats': 'True'}
[0m15:45:28.798617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3638cf28-2fb9-4a11-b184-0794935e18c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9653440b60>]}
[0m15:45:28.861921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3638cf28-2fb9-4a11-b184-0794935e18c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9653417920>]}
[0m15:45:28.875231 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:45:28.996839 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:45:29.162822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:45:29.163341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:45:29.227346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3638cf28-2fb9-4a11-b184-0794935e18c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9650d37ef0>]}
[0m15:45:29.356441 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:45:29.358808 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:45:29.363557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3638cf28-2fb9-4a11-b184-0794935e18c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9650d7f530>]}
[0m15:45:29.364122 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:45:29.364676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3638cf28-2fb9-4a11-b184-0794935e18c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9650d7f650>]}
[0m15:45:29.366588 [info ] [MainThread]: 
[0m15:45:29.367143 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:45:29.367633 [info ] [MainThread]: 
[0m15:45:29.368310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:45:29.372825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:45:29.407552 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:45:29.408051 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:45:29.408508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:29.412434 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:45:29.413180 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:45:29.413933 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:45:29.417371 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m15:45:29.419062 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:45:29.419784 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:45:29.427317 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:29.427809 [debug] [MainThread]: On master: BEGIN
[0m15:45:29.428250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:45:29.431233 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:45:29.431987 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:29.432866 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:45:29.447052 [debug] [MainThread]: SQL status: SELECT 6 in 0.013 seconds
[0m15:45:29.449479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3638cf28-2fb9-4a11-b184-0794935e18c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9653faf0e0>]}
[0m15:45:29.450003 [debug] [MainThread]: On master: ROLLBACK
[0m15:45:29.450571 [debug] [MainThread]: On master: Close
[0m15:45:29.453047 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:45:29.453808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:45:29.454376 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:45:29.466280 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:45:29.469269 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:45:29.474662 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:45:29.475386 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:45:29.483367 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:45:29.483945 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  
  WITH 
 __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
), total_delivery_metrics AS (
    SELECT COUNT(*) as total_delivery_metrics_count 
    FROM "raw"."raw"."order_delivery_metrics"
),
delivery_metrics_with_orders AS (
    SELECT COUNT(*) as delivery_metrics_orders_count
    FROM "raw"."raw"."order_delivery_metrics" om 
    JOIN __dbt__cte__stg_orders o ON om.order_id = o.order_id
),
delivery_metrics_with_customers AS (
    SELECT COUNT(*) as delivery_metrics_customers_count
    FROM "raw"."raw"."order_delivery_metrics" om 
    JOIN __dbt__cte__stg_orders o ON om.order_id = o.order_id
    JOIN __dbt__cte__stg_customers c ON o.customer_id = c.customer_id
)
SELECT 
    total_delivery_metrics_count,
    delivery_metrics_orders_count,
    delivery_metrics_customers_count
FROM 
    total_delivery_metrics, 
    delivery_metrics_with_orders, 
    delivery_metrics_with_customers
  
  limit 5

[0m15:45:29.484483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:29.490291 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m15:45:29.492618 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:45:29.493763 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:45:29.495255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:29.495845 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:45:29.496666 [debug] [MainThread]: Command end result
[0m15:45:29.540784 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:45:29.542448 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:45:29.548847 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:45:29.549405 [info ] [MainThread]: Previewing node 'your_model':
| total_delivery_me... | delivery_metrics_... | delivery_metrics_... |
| -------------------- | -------------------- | -------------------- |
|                  672 |                   43 |                    0 |

[0m15:45:29.550531 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.0212741, "process_in_blocks": "0", "process_kernel_time": 0.26229, "process_mem_max_rss": "110112", "process_out_blocks": "4040", "process_user_time": 2.134088}
[0m15:45:29.551106 [debug] [MainThread]: Command `dbt show` succeeded at 15:45:29.550988 after 1.02 seconds
[0m15:45:29.551593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9653e08830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a965295aea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a965038f0b0>]}
[0m15:45:29.552093 [debug] [MainThread]: Flushing usage events
[0m15:45:30.347483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:07.573539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3933bb9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa394de04a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa392f38680>]}


============================== 15:48:07.576710 | c7b42786-3dfc-4110-95f9-9762a5cb441e ==============================
[0m15:48:07.576710 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:48:07.577476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select your_model', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:07.750296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7b42786-3dfc-4110-95f9-9762a5cb441e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa392bc8380>]}
[0m15:48:07.813265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7b42786-3dfc-4110-95f9-9762a5cb441e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa392f160c0>]}
[0m15:48:07.814043 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:48:07.933316 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:48:08.106458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:48:08.107261 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/your_model.sql
[0m15:48:08.412570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7b42786-3dfc-4110-95f9-9762a5cb441e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa391fe9820>]}
[0m15:48:08.537239 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:48:08.539760 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:48:08.554715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7b42786-3dfc-4110-95f9-9762a5cb441e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa391b69850>]}
[0m15:48:08.555291 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:48:08.555854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7b42786-3dfc-4110-95f9-9762a5cb441e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa391bad070>]}
[0m15:48:08.557766 [info ] [MainThread]: 
[0m15:48:08.558351 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:48:08.558857 [info ] [MainThread]: 
[0m15:48:08.559530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:48:08.560471 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:48:08.595883 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:48:08.596398 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:48:08.596857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:08.601143 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m15:48:08.602564 [debug] [ThreadPool]: On list_raw: Close
[0m15:48:08.607719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:48:08.613838 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:48:08.614341 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:48:08.614781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:08.617748 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:48:08.618898 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:48:08.619735 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:48:08.622654 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m15:48:08.624668 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:48:08.625257 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:48:08.633176 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:08.633653 [debug] [MainThread]: On master: BEGIN
[0m15:48:08.634091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:08.636896 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:48:08.637612 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:08.638508 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:48:08.652074 [debug] [MainThread]: SQL status: SELECT 6 in 0.013 seconds
[0m15:48:08.654682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7b42786-3dfc-4110-95f9-9762a5cb441e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa38b738680>]}
[0m15:48:08.655229 [debug] [MainThread]: On master: ROLLBACK
[0m15:48:08.655784 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:08.656264 [debug] [MainThread]: On master: BEGIN
[0m15:48:08.657003 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:48:08.657735 [debug] [MainThread]: On master: COMMIT
[0m15:48:08.658472 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:08.659179 [debug] [MainThread]: On master: COMMIT
[0m15:48:08.659986 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:08.660689 [debug] [MainThread]: On master: Close
[0m15:48:08.663881 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:48:08.664542 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.your_model ..................................... [RUN]
[0m15:48:08.665171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:48:08.665681 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:48:08.675977 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:48:08.678968 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:48:08.679707 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:48:08.715650 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.your_model"
[0m15:48:08.716430 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:48:08.716947 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: BEGIN
[0m15:48:08.717440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:08.720868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:48:08.721409 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:48:08.721937 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  create view "raw"."raw"."your_model__dbt_tmp"
    
    
  as (
    with __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
) -- Check matching records with detailed join diagnostic
SELECT 
    COUNT(*) as matched_records,
    COUNT(DISTINCT om.order_id) as distinct_delivery_metric_orders,
    COUNT(DISTINCT o.order_id) as distinct_orders
FROM "raw"."raw"."order_delivery_metrics" om
LEFT JOIN __dbt__cte__stg_orders o ON om.order_id = o.order_id
  );
[0m15:48:08.725980 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:48:08.738913 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:48:08.739808 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
alter table "raw"."raw"."your_model" rename to "your_model__dbt_backup"
[0m15:48:08.742645 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:48:08.746698 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:48:08.747241 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
alter table "raw"."raw"."your_model__dbt_tmp" rename to "your_model"
[0m15:48:08.748005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:48:08.764846 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: COMMIT
[0m15:48:08.765390 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:48:08.765895 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: COMMIT
[0m15:48:08.767885 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:48:08.775474 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."your_model__dbt_backup"
[0m15:48:08.781531 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:48:08.782063 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
drop view if exists "raw"."raw"."your_model__dbt_backup" cascade
[0m15:48:08.783822 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:48:08.786173 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:48:08.788387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7b42786-3dfc-4110-95f9-9762a5cb441e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa393930c80>]}
[0m15:48:08.789373 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.your_model ................................ [[32mCREATE VIEW[0m in 0.12s]
[0m15:48:08.790298 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:48:08.791799 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:08.792268 [debug] [MainThread]: On master: BEGIN
[0m15:48:08.792708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:48:08.795788 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:48:08.796712 [debug] [MainThread]: On master: COMMIT
[0m15:48:08.797441 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:08.798166 [debug] [MainThread]: On master: COMMIT
[0m15:48:08.799020 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:08.799716 [debug] [MainThread]: On master: Close
[0m15:48:08.800387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:08.801284 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:48:08.802494 [info ] [MainThread]: 
[0m15:48:08.803038 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m15:48:08.803946 [debug] [MainThread]: Command end result
[0m15:48:08.893424 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:48:08.895190 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:48:08.900904 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:48:08.901360 [info ] [MainThread]: 
[0m15:48:08.901970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:48:08.902491 [info ] [MainThread]: 
[0m15:48:08.903043 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:48:08.904123 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.415604, "process_in_blocks": "0", "process_kernel_time": 0.270952, "process_mem_max_rss": "113920", "process_out_blocks": "5992", "process_user_time": 2.442553}
[0m15:48:08.904675 [debug] [MainThread]: Command `dbt run` succeeded at 15:48:08.904559 after 1.42 seconds
[0m15:48:08.905159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3934646e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa393933ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa393932ea0>]}
[0m15:48:08.905650 [debug] [MainThread]: Flushing usage events
[0m15:48:09.739533 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:13.816636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d97962a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d98a9e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d974d4980>]}


============================== 15:48:13.819798 | d565c891-dc46-4ad0-a41a-9d495c074f9d ==============================
[0m15:48:13.819798 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:48:13.820578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt show --select your_model', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:13.994138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd565c891-dc46-4ad0-a41a-9d495c074f9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d9898b2c0>]}
[0m15:48:14.057744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd565c891-dc46-4ad0-a41a-9d495c074f9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d966b7b00>]}
[0m15:48:14.070997 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:48:14.201395 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:48:14.383201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:14.384000 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:14.503530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd565c891-dc46-4ad0-a41a-9d495c074f9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d95788bc0>]}
[0m15:48:14.645031 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:48:14.647474 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:48:14.652187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd565c891-dc46-4ad0-a41a-9d495c074f9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d9470ffe0>]}
[0m15:48:14.652759 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:48:14.653312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd565c891-dc46-4ad0-a41a-9d495c074f9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d9470f7a0>]}
[0m15:48:14.655264 [info ] [MainThread]: 
[0m15:48:14.655819 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:48:14.656323 [info ] [MainThread]: 
[0m15:48:14.657006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:48:14.661503 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:48:14.696556 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:48:14.697059 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:48:14.697513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:14.701590 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:48:14.703643 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:48:14.704160 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:48:14.706996 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m15:48:14.708964 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:48:14.709578 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:48:14.716856 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:14.717358 [debug] [MainThread]: On master: BEGIN
[0m15:48:14.717802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:14.720767 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:48:14.721799 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:14.723044 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:48:14.737084 [debug] [MainThread]: SQL status: SELECT 5 in 0.013 seconds
[0m15:48:14.739415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd565c891-dc46-4ad0-a41a-9d495c074f9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d957895b0>]}
[0m15:48:14.739950 [debug] [MainThread]: On master: ROLLBACK
[0m15:48:14.740500 [debug] [MainThread]: On master: Close
[0m15:48:14.743006 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:48:14.743759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:48:14.744295 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:48:14.755210 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:48:14.758123 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:48:14.758908 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:48:14.766969 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:48:14.767527 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  
  with __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
) -- Check matching records with detailed join diagnostic
SELECT 
    COUNT(*) as matched_records,
    COUNT(DISTINCT om.order_id) as distinct_delivery_metric_orders,
    COUNT(DISTINCT o.order_id) as distinct_orders
FROM "raw"."raw"."order_delivery_metrics" om
LEFT JOIN __dbt__cte__stg_orders o ON om.order_id = o.order_id
  
  limit 5

[0m15:48:14.768046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:14.773327 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m15:48:14.775668 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:48:14.776800 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:48:14.778326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:14.778886 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:48:14.779756 [debug] [MainThread]: Command end result
[0m15:48:14.823138 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:48:14.824768 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:48:14.831171 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:48:14.831731 [info ] [MainThread]: Previewing node 'your_model':
| matched_records | distinct_delivery... | distinct_orders |
| --------------- | -------------------- | --------------- |
|             673 |                  661 |              41 |

[0m15:48:14.832838 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.1038116, "process_in_blocks": "0", "process_kernel_time": 0.271951, "process_mem_max_rss": "110268", "process_out_blocks": "4024", "process_user_time": 2.099625}
[0m15:48:14.833421 [debug] [MainThread]: Command `dbt show` succeeded at 15:48:14.833303 after 1.10 seconds
[0m15:48:14.833920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d96f78f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d98a9e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2d976068a0>]}
[0m15:48:14.834453 [debug] [MainThread]: Flushing usage events
[0m15:48:15.625987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:10.010601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3e431cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3e2ebeea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3e3b4e630>]}


============================== 15:50:10.013831 | 07cabff4-a74f-48ec-9f62-8d0c13f6de6f ==============================
[0m15:50:10.013831 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:50:10.014638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select your_model', 'send_anonymous_usage_stats': 'True'}
[0m15:50:10.233262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07cabff4-a74f-48ec-9f62-8d0c13f6de6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3e2573800>]}
[0m15:50:10.297141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07cabff4-a74f-48ec-9f62-8d0c13f6de6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3e2e699d0>]}
[0m15:50:10.298009 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:50:10.444531 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:50:10.686177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:10.687042 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/your_model.sql
[0m15:50:11.038602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07cabff4-a74f-48ec-9f62-8d0c13f6de6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3e03e9820>]}
[0m15:50:11.165727 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:50:11.168439 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:50:11.182978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07cabff4-a74f-48ec-9f62-8d0c13f6de6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3e13ed0a0>]}
[0m15:50:11.183554 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:50:11.184149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07cabff4-a74f-48ec-9f62-8d0c13f6de6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3e03ebe00>]}
[0m15:50:11.186052 [info ] [MainThread]: 
[0m15:50:11.186644 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:50:11.187148 [info ] [MainThread]: 
[0m15:50:11.187820 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:11.188828 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:50:11.228860 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:50:11.229380 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:50:11.229848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:11.234069 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m15:50:11.235448 [debug] [ThreadPool]: On list_raw: Close
[0m15:50:11.240768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:50:11.246953 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:50:11.247434 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:50:11.247880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:11.250866 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:50:11.251936 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:50:11.252421 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:50:11.254977 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m15:50:11.256621 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:50:11.257626 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:50:11.265641 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:11.266114 [debug] [MainThread]: On master: BEGIN
[0m15:50:11.266589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:11.269835 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:50:11.270482 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:11.271023 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:11.284364 [debug] [MainThread]: SQL status: SELECT 5 in 0.013 seconds
[0m15:50:11.286725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07cabff4-a74f-48ec-9f62-8d0c13f6de6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3deba8800>]}
[0m15:50:11.287275 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:11.287832 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:11.288313 [debug] [MainThread]: On master: BEGIN
[0m15:50:11.289539 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:50:11.290042 [debug] [MainThread]: On master: COMMIT
[0m15:50:11.290532 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:11.290972 [debug] [MainThread]: On master: COMMIT
[0m15:50:11.291514 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:50:11.291992 [debug] [MainThread]: On master: Close
[0m15:50:11.294919 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:50:11.295918 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.your_model ..................................... [RUN]
[0m15:50:11.296560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:50:11.297083 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:50:11.307437 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:50:11.309949 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:50:11.310719 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:50:11.346839 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.your_model"
[0m15:50:11.347626 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:50:11.348137 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: BEGIN
[0m15:50:11.348616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:11.351573 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:50:11.352392 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:50:11.353251 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  create view "raw"."raw"."your_model__dbt_tmp"
    
    
  as (
    with __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
) SELECT 
    o.order_id, 
    COUNT(DISTINCT om.order_id) as delivery_metric_count
FROM __dbt__cte__stg_orders o
LEFT JOIN "raw"."raw"."order_delivery_metrics" om ON o.order_id = om.order_id
GROUP BY o.order_id
HAVING delivery_metric_count > 1
  );
[0m15:50:11.355275 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "delivery_metric_count" does not exist
LINE 28: HAVING delivery_metric_count > 1
                ^

[0m15:50:11.356103 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: ROLLBACK
[0m15:50:11.357236 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:50:11.365946 [debug] [Thread-1 (]: Database Error in model your_model (models/your_model.sql)
  column "delivery_metric_count" does not exist
  LINE 28: HAVING delivery_metric_count > 1
                  ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql
[0m15:50:11.368761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07cabff4-a74f-48ec-9f62-8d0c13f6de6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3e2cf9490>]}
[0m15:50:11.369906 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.your_model ............................ [[31mERROR[0m in 0.07s]
[0m15:50:11.371396 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:50:11.373569 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.your_model' to be skipped because of status 'error'.  Reason: Database Error in model your_model (models/your_model.sql)
  column "delivery_metric_count" does not exist
  LINE 28: HAVING delivery_metric_count > 1
                  ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql.
[0m15:50:11.380112 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:11.380839 [debug] [MainThread]: On master: BEGIN
[0m15:50:11.381573 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:11.392724 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m15:50:11.393914 [debug] [MainThread]: On master: COMMIT
[0m15:50:11.395470 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:11.396078 [debug] [MainThread]: On master: COMMIT
[0m15:50:11.396625 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:50:11.397556 [debug] [MainThread]: On master: Close
[0m15:50:11.398841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:11.399534 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:50:11.400209 [info ] [MainThread]: 
[0m15:50:11.400843 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m15:50:11.401715 [debug] [MainThread]: Command end result
[0m15:50:11.496424 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:50:11.498265 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:50:11.503955 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:50:11.504415 [info ] [MainThread]: 
[0m15:50:11.505053 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:50:11.505570 [info ] [MainThread]: 
[0m15:50:11.506164 [error] [MainThread]:   Database Error in model your_model (models/your_model.sql)
  column "delivery_metric_count" does not exist
  LINE 28: HAVING delivery_metric_count > 1
                  ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql
[0m15:50:11.506705 [info ] [MainThread]: 
[0m15:50:11.507254 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:50:11.508359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5831485, "process_in_blocks": "0", "process_kernel_time": 0.340821, "process_mem_max_rss": "115324", "process_out_blocks": "5992", "process_user_time": 2.457087}
[0m15:50:11.508923 [debug] [MainThread]: Command `dbt run` failed at 15:50:11.508807 after 1.58 seconds
[0m15:50:11.509427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3e59c7b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3e249b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f3e2498230>]}
[0m15:50:11.510061 [debug] [MainThread]: Flushing usage events
[0m15:50:12.324667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:36.469872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f541eec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f55f69670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f541ef200>]}


============================== 15:50:36.473071 | bed6702c-a253-49ff-860b-028b049553fb ==============================
[0m15:50:36.473071 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:50:36.473825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/codespace/.dbt', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select your_model', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:50:36.644606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bed6702c-a253-49ff-860b-028b049553fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f5482c470>]}
[0m15:50:36.707751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bed6702c-a253-49ff-860b-028b049553fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f54913530>]}
[0m15:50:36.708517 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:50:36.827370 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:50:36.989899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:36.990687 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/your_model.sql
[0m15:50:37.298706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bed6702c-a253-49ff-860b-028b049553fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f51df1820>]}
[0m15:50:37.454711 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:50:37.458294 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:50:37.474260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bed6702c-a253-49ff-860b-028b049553fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f52de8d40>]}
[0m15:50:37.474853 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:50:37.475420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed6702c-a253-49ff-860b-028b049553fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f535ff440>]}
[0m15:50:37.477327 [info ] [MainThread]: 
[0m15:50:37.477883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:50:37.478470 [info ] [MainThread]: 
[0m15:50:37.479224 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:37.480300 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:50:37.513858 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:50:37.514392 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:50:37.514857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:37.519031 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m15:50:37.520365 [debug] [ThreadPool]: On list_raw: Close
[0m15:50:37.526407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:50:37.540554 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:50:37.541335 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:50:37.542072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:37.546451 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:50:37.547617 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:50:37.548707 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:50:37.552934 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m15:50:37.555687 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:50:37.556745 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:50:37.568781 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:37.569252 [debug] [MainThread]: On master: BEGIN
[0m15:50:37.569693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:37.572671 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:50:37.573668 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:37.574917 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:37.588651 [debug] [MainThread]: SQL status: SELECT 5 in 0.013 seconds
[0m15:50:37.590947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed6702c-a253-49ff-860b-028b049553fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f55a24290>]}
[0m15:50:37.591497 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:37.592061 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:37.592535 [debug] [MainThread]: On master: BEGIN
[0m15:50:37.593884 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:50:37.594793 [debug] [MainThread]: On master: COMMIT
[0m15:50:37.595254 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:37.595695 [debug] [MainThread]: On master: COMMIT
[0m15:50:37.596220 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:50:37.596701 [debug] [MainThread]: On master: Close
[0m15:50:37.599707 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:50:37.600768 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.your_model ..................................... [RUN]
[0m15:50:37.601424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:50:37.601951 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:50:37.612356 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:50:37.615088 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:50:37.615820 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:50:37.652068 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.your_model"
[0m15:50:37.652885 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:50:37.653389 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: BEGIN
[0m15:50:37.653874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:37.657767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:50:37.658313 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:50:37.658830 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  create view "raw"."raw"."your_model__dbt_tmp"
    
    
  as (
    with __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
) SELECT 
    o.order_id, 
    COUNT(om.order_id) as delivery_metric_count
FROM __dbt__cte__stg_orders o
LEFT JOIN "raw"."raw"."order_delivery_metrics" om ON o.order_id = om.order_id
GROUP BY o.order_id
HAVING COUNT(om.order_id) > 1
  );
[0m15:50:37.788355 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.129 seconds
[0m15:50:37.801358 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:50:37.802263 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
alter table "raw"."raw"."your_model" rename to "your_model__dbt_backup"
[0m15:50:37.803600 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:50:37.808623 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:50:37.809149 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
alter table "raw"."raw"."your_model__dbt_tmp" rename to "your_model"
[0m15:50:37.809902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:50:37.827024 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: COMMIT
[0m15:50:37.827564 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:50:37.828069 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: COMMIT
[0m15:50:37.829337 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:50:37.837063 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."your_model__dbt_backup"
[0m15:50:37.843101 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:50:37.843627 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
drop view if exists "raw"."raw"."your_model__dbt_backup" cascade
[0m15:50:37.845117 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:50:37.847513 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:50:37.849805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed6702c-a253-49ff-860b-028b049553fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f5597a2d0>]}
[0m15:50:37.850908 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.your_model ................................ [[32mCREATE VIEW[0m in 0.25s]
[0m15:50:37.851723 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:50:37.853312 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:37.853778 [debug] [MainThread]: On master: BEGIN
[0m15:50:37.854252 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:37.858158 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:50:37.858993 [debug] [MainThread]: On master: COMMIT
[0m15:50:37.859452 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:37.859889 [debug] [MainThread]: On master: COMMIT
[0m15:50:37.860430 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:50:37.860970 [debug] [MainThread]: On master: Close
[0m15:50:37.861644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:37.862397 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:50:37.863085 [info ] [MainThread]: 
[0m15:50:37.863897 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m15:50:37.864859 [debug] [MainThread]: Command end result
[0m15:50:37.953585 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:50:37.955347 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:50:37.960967 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:50:37.961421 [info ] [MainThread]: 
[0m15:50:37.962042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:37.962583 [info ] [MainThread]: 
[0m15:50:37.963157 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:50:37.964265 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5834924, "process_in_blocks": "0", "process_kernel_time": 0.286185, "process_mem_max_rss": "115636", "process_out_blocks": "5984", "process_user_time": 2.523993}
[0m15:50:37.964826 [debug] [MainThread]: Command `dbt run` succeeded at 15:50:37.964707 after 1.58 seconds
[0m15:50:37.965317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f50597ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f54370200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f5192cfe0>]}
[0m15:50:37.965819 [debug] [MainThread]: Flushing usage events
[0m15:50:38.770729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:50:43.569593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc08606330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc06b23830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc06b20860>]}


============================== 15:50:43.572795 | e3bf688a-9300-4a65-a28e-f84bd3f13a1b ==============================
[0m15:50:43.572795 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:50:43.573580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'profiles_dir': '/home/codespace/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt show --select your_model', 'send_anonymous_usage_stats': 'True'}
[0m15:50:43.747061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3bf688a-9300-4a65-a28e-f84bd3f13a1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc06613b30>]}
[0m15:50:43.810379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3bf688a-9300-4a65-a28e-f84bd3f13a1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc06637170>]}
[0m15:50:43.823480 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:50:43.944803 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:50:44.108845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:44.109327 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:44.174062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3bf688a-9300-4a65-a28e-f84bd3f13a1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc05f77ec0>]}
[0m15:50:44.303936 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:50:44.306269 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:50:44.310948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3bf688a-9300-4a65-a28e-f84bd3f13a1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc03f53350>]}
[0m15:50:44.311516 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:50:44.312066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3bf688a-9300-4a65-a28e-f84bd3f13a1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc06636c00>]}
[0m15:50:44.313948 [info ] [MainThread]: 
[0m15:50:44.314516 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:50:44.315013 [info ] [MainThread]: 
[0m15:50:44.315696 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:44.320320 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:50:44.355168 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:50:44.355671 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:50:44.356130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:44.360551 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:50:44.361034 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:50:44.361522 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:50:44.364099 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m15:50:44.365718 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:50:44.366349 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:50:44.374328 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:44.374800 [debug] [MainThread]: On master: BEGIN
[0m15:50:44.375246 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:44.378605 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:50:44.379077 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:44.379621 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:44.392775 [debug] [MainThread]: SQL status: SELECT 5 in 0.013 seconds
[0m15:50:44.395073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3bf688a-9300-4a65-a28e-f84bd3f13a1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc05b61c70>]}
[0m15:50:44.395611 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:44.396146 [debug] [MainThread]: On master: Close
[0m15:50:44.398792 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:50:44.399619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:50:44.400331 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:50:44.418274 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:50:44.422740 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:50:44.423759 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:50:44.433553 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:50:44.434120 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  
  with __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
) SELECT 
    o.order_id, 
    COUNT(om.order_id) as delivery_metric_count
FROM __dbt__cte__stg_orders o
LEFT JOIN "raw"."raw"."order_delivery_metrics" om ON o.order_id = om.order_id
GROUP BY o.order_id
HAVING COUNT(om.order_id) > 1
  
  limit 5

[0m15:50:44.434696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:44.439837 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m15:50:44.442110 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:50:44.443233 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:50:44.444792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:44.445444 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:50:44.446295 [debug] [MainThread]: Command end result
[0m15:50:44.490088 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:50:44.491804 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:50:44.498252 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:50:44.498814 [info ] [MainThread]: Previewing node 'your_model':
| order_id     | delivery_metric_c... |
| ------------ | -------------------- |
| NULL         |                    2 |
| FJUN67320602 |                    2 |

[0m15:50:44.499925 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.0198499, "process_in_blocks": "0", "process_kernel_time": 0.269905, "process_mem_max_rss": "111092", "process_out_blocks": "4032", "process_user_time": 2.147338}
[0m15:50:44.500502 [debug] [MainThread]: Command `dbt show` succeeded at 15:50:44.500386 after 1.02 seconds
[0m15:50:44.501006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc06edd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc047d0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cfc070f0170>]}
[0m15:50:44.501524 [debug] [MainThread]: Flushing usage events
[0m15:50:45.294602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:51:28.923324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac65297350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac64768530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac64709730>]}


============================== 15:51:28.926593 | 85e92e91-11b4-4c6e-9dd6-2335b91ec6ea ==============================
[0m15:51:28.926593 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:51:28.927382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select your_model', 'send_anonymous_usage_stats': 'True'}
[0m15:51:29.137597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85e92e91-11b4-4c6e-9dd6-2335b91ec6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac645776b0>]}
[0m15:51:29.211602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85e92e91-11b4-4c6e-9dd6-2335b91ec6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac66a4d190>]}
[0m15:51:29.212485 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:51:29.353880 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:51:29.617113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:29.618404 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/your_model.sql
[0m15:51:30.118183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85e92e91-11b4-4c6e-9dd6-2335b91ec6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac627f3d40>]}
[0m15:51:30.338773 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:51:30.342651 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:51:30.365559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85e92e91-11b4-4c6e-9dd6-2335b91ec6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac6338d8e0>]}
[0m15:51:30.366496 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:51:30.367334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85e92e91-11b4-4c6e-9dd6-2335b91ec6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac63fc9880>]}
[0m15:51:30.370387 [info ] [MainThread]: 
[0m15:51:30.371237 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:51:30.372198 [info ] [MainThread]: 
[0m15:51:30.373518 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:51:30.375020 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:51:30.432765 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:51:30.433587 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:51:30.434446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:30.440459 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.006 seconds
[0m15:51:30.442678 [debug] [ThreadPool]: On list_raw: Close
[0m15:51:30.446355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:30.447043 [debug] [MainThread]: Connection 'list_raw' was properly closed.
[0m15:51:30.447784 [info ] [MainThread]: 
[0m15:51:30.448668 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.07 seconds (0.07s).
[0m15:51:30.449639 [error] [MainThread]: Encountered an error:

[0m15:51:30.456143 [error] [MainThread]: Traceback (most recent call last):
  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 588, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 526, in execute_with_hooks
    before_run_status = self.before_run(adapter, selected_uids)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/task/run.py", line 994, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/workspaces/pyspark_practice-/venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 694, in create_schemas
    for ls_future in as_completed(list_futures):
  File "/home/codespace/.python/current/lib/python3.12/concurrent/futures/_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "/home/codespace/.python/current/lib/python3.12/threading.py", line 655, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/codespace/.python/current/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m15:51:30.457960 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6238122, "process_in_blocks": "224", "process_kernel_time": 0.28266, "process_mem_max_rss": "111952", "process_out_blocks": "4032", "process_user_time": 2.583752}
[0m15:51:30.458914 [debug] [MainThread]: Command `dbt run` failed at 15:51:30.458760 after 1.62 seconds
[0m15:51:30.459708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac64d1de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac6279ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac637e7980>]}
[0m15:51:30.460526 [debug] [MainThread]: Flushing usage events
[0m15:51:36.001610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f1017920c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f0ffd15850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f1000482c0>]}


============================== 15:51:36.004831 | 4a5d94c0-a91d-42ab-afa4-873a2444e6e8 ==============================
[0m15:51:36.004831 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:51:36.005595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/codespace/.dbt', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select your_model', 'send_anonymous_usage_stats': 'True'}
[0m15:51:36.176889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a5d94c0-a91d-42ab-afa4-873a2444e6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f1014771a0>]}
[0m15:51:36.240561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a5d94c0-a91d-42ab-afa4-873a2444e6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f0ff8ac890>]}
[0m15:51:36.241338 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:51:36.373256 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:51:36.588214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:51:36.588716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:51:36.658586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a5d94c0-a91d-42ab-afa4-873a2444e6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f0fe9b89b0>]}
[0m15:51:36.787921 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:51:36.790297 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:51:36.804575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a5d94c0-a91d-42ab-afa4-873a2444e6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f0fd993ef0>]}
[0m15:51:36.805148 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:51:36.805707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5d94c0-a91d-42ab-afa4-873a2444e6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f0fd948da0>]}
[0m15:51:36.807628 [info ] [MainThread]: 
[0m15:51:36.808195 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:51:36.808701 [info ] [MainThread]: 
[0m15:51:36.809396 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:51:36.810380 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:51:36.845192 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:51:36.845723 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:51:36.846185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:36.851464 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.005 seconds
[0m15:51:36.853588 [debug] [ThreadPool]: On list_raw: Close
[0m15:51:36.863458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:51:36.872952 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:51:36.873455 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:51:36.873982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:36.877429 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:51:36.878288 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:51:36.879048 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:51:36.883532 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m15:51:36.886140 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:51:36.887055 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:51:36.900126 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:36.900897 [debug] [MainThread]: On master: BEGIN
[0m15:51:36.901631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:36.909480 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:51:36.910244 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:36.911303 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:51:36.933345 [debug] [MainThread]: SQL status: SELECT 5 in 0.021 seconds
[0m15:51:36.937328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5d94c0-a91d-42ab-afa4-873a2444e6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f0ff86f5f0>]}
[0m15:51:36.938282 [debug] [MainThread]: On master: ROLLBACK
[0m15:51:36.939149 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:36.939891 [debug] [MainThread]: On master: BEGIN
[0m15:51:36.944420 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:51:36.945181 [debug] [MainThread]: On master: COMMIT
[0m15:51:36.946183 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:36.947290 [debug] [MainThread]: On master: COMMIT
[0m15:51:36.948139 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:51:36.948924 [debug] [MainThread]: On master: Close
[0m15:51:36.954411 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:51:36.955378 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.your_model ..................................... [RUN]
[0m15:51:36.958365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:51:36.959219 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:51:36.972120 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:51:36.973460 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:51:37.023312 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.your_model"
[0m15:51:37.024157 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:51:37.024665 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: BEGIN
[0m15:51:37.025155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:37.028868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:51:37.029744 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:51:37.030311 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  create view "raw"."raw"."your_model__dbt_tmp"
    
    
  as (
    -- Check NULL and duplicate entries
SELECT 
    order_id, 
    COUNT(*) as entry_count,
    COUNT(DISTINCT product_id) as unique_products
FROM "raw"."raw"."order_delivery_metrics"
GROUP BY order_id
HAVING order_id IS NULL OR entry_count > 1
  );
[0m15:51:37.032295 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "entry_count" does not exist
LINE 14: HAVING order_id IS NULL OR entry_count > 1
                                    ^

[0m15:51:37.034768 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: ROLLBACK
[0m15:51:37.040572 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:51:37.050007 [debug] [Thread-1 (]: Database Error in model your_model (models/your_model.sql)
  column "entry_count" does not exist
  LINE 14: HAVING order_id IS NULL OR entry_count > 1
                                      ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql
[0m15:51:37.053153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5d94c0-a91d-42ab-afa4-873a2444e6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f0fc6dd430>]}
[0m15:51:37.054330 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model raw.your_model ............................ [[31mERROR[0m in 0.10s]
[0m15:51:37.055546 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:51:37.056655 [debug] [Thread-7 (]: Marking all children of 'model.nexabrands_dbt.your_model' to be skipped because of status 'error'.  Reason: Database Error in model your_model (models/your_model.sql)
  column "entry_count" does not exist
  LINE 14: HAVING order_id IS NULL OR entry_count > 1
                                      ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql.
[0m15:51:37.061048 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:37.061949 [debug] [MainThread]: On master: BEGIN
[0m15:51:37.062705 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:37.066777 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:51:37.067653 [debug] [MainThread]: On master: COMMIT
[0m15:51:37.068154 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:37.068602 [debug] [MainThread]: On master: COMMIT
[0m15:51:37.069143 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:51:37.069624 [debug] [MainThread]: On master: Close
[0m15:51:37.070369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:37.071045 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:51:37.071716 [info ] [MainThread]: 
[0m15:51:37.072505 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m15:51:37.073411 [debug] [MainThread]: Command end result
[0m15:51:37.118317 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:51:37.120019 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:51:37.125710 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:51:37.126163 [info ] [MainThread]: 
[0m15:51:37.126806 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:51:37.127318 [info ] [MainThread]: 
[0m15:51:37.127901 [error] [MainThread]:   Database Error in model your_model (models/your_model.sql)
  column "entry_count" does not exist
  LINE 14: HAVING order_id IS NULL OR entry_count > 1
                                      ^
  compiled code at target/run/nexabrands_dbt/models/your_model.sql
[0m15:51:37.128393 [info ] [MainThread]: 
[0m15:51:37.128929 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:51:37.130004 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2173741, "process_in_blocks": "0", "process_kernel_time": 0.26296, "process_mem_max_rss": "111528", "process_out_blocks": "4032", "process_user_time": 2.17473}
[0m15:51:37.130613 [debug] [MainThread]: Command `dbt run` failed at 15:51:37.130501 after 1.22 seconds
[0m15:51:37.131112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f0ffd930b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f0ffd92cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74f0fe436d80>]}
[0m15:51:37.131722 [debug] [MainThread]: Flushing usage events
[0m15:51:37.924601 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:03.870863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714fc9b77b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714fc8426150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714fc8cc39b0>]}


============================== 15:52:03.874084 | 84d5ebd3-c36f-4028-bc9c-ccc089e8744d ==============================
[0m15:52:03.874084 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:52:03.874886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select your_model', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:52:04.045951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84d5ebd3-c36f-4028-bc9c-ccc089e8744d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714fc81b7c20>]}
[0m15:52:04.109351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84d5ebd3-c36f-4028-bc9c-ccc089e8744d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714fc81e0290>]}
[0m15:52:04.110124 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:52:04.231598 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:52:04.424405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:52:04.425578 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/your_model.sql
[0m15:52:04.752494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84d5ebd3-c36f-4028-bc9c-ccc089e8744d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714fc63e95b0>]}
[0m15:52:04.910926 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:52:04.913340 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:52:04.928049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84d5ebd3-c36f-4028-bc9c-ccc089e8744d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714fc7399bb0>]}
[0m15:52:04.928632 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:52:04.929188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84d5ebd3-c36f-4028-bc9c-ccc089e8744d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714fc8172e10>]}
[0m15:52:04.931124 [info ] [MainThread]: 
[0m15:52:04.931694 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:52:04.932204 [info ] [MainThread]: 
[0m15:52:04.932896 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:52:04.933919 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:52:04.987629 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:52:04.988249 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:52:04.988723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:04.992923 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m15:52:04.994317 [debug] [ThreadPool]: On list_raw: Close
[0m15:52:05.000443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:52:05.011974 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:52:05.012665 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:52:05.013618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:05.017777 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:52:05.018571 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:52:05.019445 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:52:05.023749 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m15:52:05.026991 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:52:05.027856 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:52:05.042192 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:05.042959 [debug] [MainThread]: On master: BEGIN
[0m15:52:05.043715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:52:05.048386 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:52:05.049075 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:05.049899 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:52:05.074876 [debug] [MainThread]: SQL status: SELECT 5 in 0.024 seconds
[0m15:52:05.077257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84d5ebd3-c36f-4028-bc9c-ccc089e8744d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714fc4b992e0>]}
[0m15:52:05.077835 [debug] [MainThread]: On master: ROLLBACK
[0m15:52:05.078422 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:05.078904 [debug] [MainThread]: On master: BEGIN
[0m15:52:05.080528 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:52:05.081996 [debug] [MainThread]: On master: COMMIT
[0m15:52:05.082683 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:05.083318 [debug] [MainThread]: On master: COMMIT
[0m15:52:05.084085 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:52:05.084911 [debug] [MainThread]: On master: Close
[0m15:52:05.091949 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:52:05.093354 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.your_model ..................................... [RUN]
[0m15:52:05.094337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:52:05.095106 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:52:05.108060 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:52:05.109106 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:52:05.173187 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.your_model"
[0m15:52:05.174218 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:52:05.174798 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: BEGIN
[0m15:52:05.175316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:05.180086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:52:05.181197 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:52:05.181742 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  create view "raw"."raw"."your_model__dbt_tmp"
    
    
  as (
    SELECT 
    COALESCE(order_id, 'NULL') as order_id, 
    COUNT(*) as entry_count,
    COUNT(DISTINCT product_id) as unique_products
FROM "raw"."raw"."order_delivery_metrics"
GROUP BY COALESCE(order_id, 'NULL')
HAVING COALESCE(order_id, 'NULL') = 'NULL' OR COUNT(*) > 1
  );
[0m15:52:05.185001 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:52:05.211581 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:52:05.212138 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
alter table "raw"."raw"."your_model" rename to "your_model__dbt_backup"
[0m15:52:05.212963 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:52:05.216461 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:52:05.217003 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
alter table "raw"."raw"."your_model__dbt_tmp" rename to "your_model"
[0m15:52:05.217736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:52:05.234666 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: COMMIT
[0m15:52:05.235220 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:52:05.235725 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: COMMIT
[0m15:52:05.236953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:52:05.244248 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."your_model__dbt_backup"
[0m15:52:05.250144 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:52:05.250708 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
drop view if exists "raw"."raw"."your_model__dbt_backup" cascade
[0m15:52:05.252212 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:52:05.254645 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:52:05.256945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84d5ebd3-c36f-4028-bc9c-ccc089e8744d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714fc9f1e810>]}
[0m15:52:05.258028 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.your_model ................................ [[32mCREATE VIEW[0m in 0.16s]
[0m15:52:05.259310 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:52:05.261248 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:05.261942 [debug] [MainThread]: On master: BEGIN
[0m15:52:05.262664 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:52:05.270251 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:52:05.271158 [debug] [MainThread]: On master: COMMIT
[0m15:52:05.271904 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:05.272927 [debug] [MainThread]: On master: COMMIT
[0m15:52:05.273750 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:52:05.274602 [debug] [MainThread]: On master: Close
[0m15:52:05.276619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:05.277216 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:52:05.277809 [info ] [MainThread]: 
[0m15:52:05.278578 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:52:05.280084 [debug] [MainThread]: Command end result
[0m15:52:05.420818 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:52:05.423441 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:52:05.431858 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:52:05.432547 [info ] [MainThread]: 
[0m15:52:05.433493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:52:05.435503 [info ] [MainThread]: 
[0m15:52:05.436599 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:52:05.438381 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6518407, "process_in_blocks": "0", "process_kernel_time": 0.297799, "process_mem_max_rss": "115112", "process_out_blocks": "5984", "process_user_time": 2.525342}
[0m15:52:05.440398 [debug] [MainThread]: Command `dbt run` succeeded at 15:52:05.440244 after 1.65 seconds
[0m15:52:05.442128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714fc63eb440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714fc63e9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714fc4a56420>]}
[0m15:52:05.443094 [debug] [MainThread]: Flushing usage events
[0m15:52:06.240452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:10.230917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff983dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff8377f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff813a330>]}


============================== 15:52:10.234013 | b03aca7a-21d6-4ad0-8761-732b3488c3db ==============================
[0m15:52:10.234013 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:52:10.234810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt show --select your_model', 'send_anonymous_usage_stats': 'True'}
[0m15:52:10.443013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b03aca7a-21d6-4ad0-8761-732b3488c3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff7f3d670>]}
[0m15:52:10.516925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b03aca7a-21d6-4ad0-8761-732b3488c3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff8092930>]}
[0m15:52:10.530654 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:52:10.652302 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:52:10.822959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:52:10.823487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:52:10.887976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b03aca7a-21d6-4ad0-8761-732b3488c3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff87ced80>]}
[0m15:52:11.016984 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:52:11.019403 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:52:11.024054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b03aca7a-21d6-4ad0-8761-732b3488c3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff554b710>]}
[0m15:52:11.024617 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:52:11.025178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b03aca7a-21d6-4ad0-8761-732b3488c3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff554ae40>]}
[0m15:52:11.027086 [info ] [MainThread]: 
[0m15:52:11.027645 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:52:11.028148 [info ] [MainThread]: 
[0m15:52:11.028826 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:52:11.033459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:52:11.068320 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:52:11.068815 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:52:11.069268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:11.072977 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:52:11.073725 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:52:11.074518 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:52:11.077540 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m15:52:11.079649 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:52:11.080207 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:52:11.087581 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:11.088081 [debug] [MainThread]: On master: BEGIN
[0m15:52:11.088523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:52:11.092317 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:52:11.092788 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:11.093316 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:52:11.106594 [debug] [MainThread]: SQL status: SELECT 4 in 0.013 seconds
[0m15:52:11.108737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b03aca7a-21d6-4ad0-8761-732b3488c3db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff650dfa0>]}
[0m15:52:11.109265 [debug] [MainThread]: On master: ROLLBACK
[0m15:52:11.109800 [debug] [MainThread]: On master: Close
[0m15:52:11.112614 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:52:11.113272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:52:11.113790 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:52:11.122020 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:52:11.122830 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:52:11.130304 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:52:11.130846 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  
  SELECT 
    COALESCE(order_id, 'NULL') as order_id, 
    COUNT(*) as entry_count,
    COUNT(DISTINCT product_id) as unique_products
FROM "raw"."raw"."order_delivery_metrics"
GROUP BY COALESCE(order_id, 'NULL')
HAVING COALESCE(order_id, 'NULL') = 'NULL' OR COUNT(*) > 1
  
  limit 5

[0m15:52:11.131355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:11.136425 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m15:52:11.138806 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:52:11.139948 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:52:11.141634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:11.142079 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:52:11.142896 [debug] [MainThread]: Command end result
[0m15:52:11.184917 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:52:11.186583 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:52:11.192953 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:52:11.193525 [info ] [MainThread]: Previewing node 'your_model':
| order_id     | entry_count | unique_products |
| ------------ | ----------- | --------------- |
|              |           2 |               2 |
| FAP43503502  |           3 |               3 |
| FJUL77520203 |           2 |               2 |
| FJUN67320602 |           2 |               2 |
| FMY530903402 |           2 |               2 |

[0m15:52:11.194663 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.052336, "process_in_blocks": "0", "process_kernel_time": 0.315663, "process_mem_max_rss": "113132", "process_out_blocks": "4016", "process_user_time": 2.07379}
[0m15:52:11.195240 [debug] [MainThread]: Command `dbt show` succeeded at 15:52:11.195122 after 1.05 seconds
[0m15:52:11.195734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff84a7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff862c0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718ff7f2f1a0>]}
[0m15:52:11.196238 [debug] [MainThread]: Flushing usage events
[0m15:52:11.988214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:48.842115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74660aab7fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74660a984aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74660c572360>]}


============================== 15:52:48.845316 | 9a3d4281-9f1b-4f9d-a2f9-1e0cf6b432f4 ==============================
[0m15:52:48.845316 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:52:48.846092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select your_model', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:49.016662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a3d4281-9f1b-4f9d-a2f9-1e0cf6b432f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74660a11e2a0>]}
[0m15:52:49.079715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a3d4281-9f1b-4f9d-a2f9-1e0cf6b432f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74660b03fb30>]}
[0m15:52:49.080499 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:52:49.200610 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:52:49.371268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:52:49.372075 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/your_model.sql
[0m15:52:49.678971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a3d4281-9f1b-4f9d-a2f9-1e0cf6b432f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7466099f1a30>]}
[0m15:52:49.804486 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:52:49.807322 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:52:49.821950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a3d4281-9f1b-4f9d-a2f9-1e0cf6b432f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7466099e6150>]}
[0m15:52:49.822561 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:52:49.823124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a3d4281-9f1b-4f9d-a2f9-1e0cf6b432f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746609195ac0>]}
[0m15:52:49.825033 [info ] [MainThread]: 
[0m15:52:49.825593 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:52:49.826096 [info ] [MainThread]: 
[0m15:52:49.826813 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:52:49.827833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:52:49.866714 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:52:49.867523 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:52:49.868187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:49.873915 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.006 seconds
[0m15:52:49.876091 [debug] [ThreadPool]: On list_raw: Close
[0m15:52:49.886397 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:52:49.895314 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:52:49.896049 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:52:49.896734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:49.903843 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:52:49.904511 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:52:49.905166 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:52:49.909748 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.004 seconds
[0m15:52:49.912396 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:52:49.920843 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:52:49.947293 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:49.948099 [debug] [MainThread]: On master: BEGIN
[0m15:52:49.948860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:52:49.956738 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:52:49.957470 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:49.958367 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:52:49.979546 [debug] [MainThread]: SQL status: SELECT 4 in 0.020 seconds
[0m15:52:49.981714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a3d4281-9f1b-4f9d-a2f9-1e0cf6b432f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74660c2d8470>]}
[0m15:52:49.982371 [debug] [MainThread]: On master: ROLLBACK
[0m15:52:49.982948 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:49.983433 [debug] [MainThread]: On master: BEGIN
[0m15:52:49.984239 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:52:49.985269 [debug] [MainThread]: On master: COMMIT
[0m15:52:49.986347 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:49.987050 [debug] [MainThread]: On master: COMMIT
[0m15:52:49.987586 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:52:49.988077 [debug] [MainThread]: On master: Close
[0m15:52:49.990805 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:52:49.991680 [info ] [Thread-1 (]: 1 of 1 START sql view model raw.your_model ..................................... [RUN]
[0m15:52:49.992424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:52:49.993279 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:52:50.001254 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:52:50.002031 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:52:50.037825 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.your_model"
[0m15:52:50.038656 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:52:50.039178 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: BEGIN
[0m15:52:50.039674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:50.042662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:52:50.043479 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:52:50.044342 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  create view "raw"."raw"."your_model__dbt_tmp"
    
    
  as (
    SELECT 
    order_id, 
    product_id,
    agreed_delivery_date,
    actual_delivery_date,
    order_qty,
    delivery_qty
FROM "raw"."raw"."order_delivery_metrics"
WHERE order_id IN ('FAP43503502', 'FJUL77520203', 'FJUN67320602', 'FMY530903402')
ORDER BY order_id, product_id
  );
[0m15:52:50.047213 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:52:50.054650 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:52:50.055194 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
alter table "raw"."raw"."your_model" rename to "your_model__dbt_backup"
[0m15:52:50.055954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:52:50.059182 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:52:50.059707 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
alter table "raw"."raw"."your_model__dbt_tmp" rename to "your_model"
[0m15:52:50.060438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:52:50.077356 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: COMMIT
[0m15:52:50.077905 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:52:50.078435 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: COMMIT
[0m15:52:50.080017 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:52:50.086662 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."your_model__dbt_backup"
[0m15:52:50.092589 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:52:50.093135 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */
drop view if exists "raw"."raw"."your_model__dbt_backup" cascade
[0m15:52:50.094748 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:52:50.097142 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:52:50.099445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a3d4281-9f1b-4f9d-a2f9-1e0cf6b432f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74660c22a420>]}
[0m15:52:50.100420 [info ] [Thread-1 (]: 1 of 1 OK created sql view model raw.your_model ................................ [[32mCREATE VIEW[0m in 0.11s]
[0m15:52:50.101226 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:52:50.102808 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:50.103292 [debug] [MainThread]: On master: BEGIN
[0m15:52:50.103744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:52:50.106756 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:52:50.107492 [debug] [MainThread]: On master: COMMIT
[0m15:52:50.108186 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:50.108935 [debug] [MainThread]: On master: COMMIT
[0m15:52:50.109755 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:52:50.110507 [debug] [MainThread]: On master: Close
[0m15:52:50.111400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:50.112278 [debug] [MainThread]: Connection 'list_raw' was properly closed.
[0m15:52:50.112938 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:52:50.113713 [info ] [MainThread]: 
[0m15:52:50.114437 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m15:52:50.115311 [debug] [MainThread]: Command end result
[0m15:52:50.208365 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:52:50.210094 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:52:50.215810 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:52:50.216273 [info ] [MainThread]: 
[0m15:52:50.216893 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:52:50.217396 [info ] [MainThread]: 
[0m15:52:50.217947 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:52:50.219051 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4611099, "process_in_blocks": "0", "process_kernel_time": 0.2514, "process_mem_max_rss": "115224", "process_out_blocks": "5984", "process_user_time": 2.537949}
[0m15:52:50.219614 [debug] [MainThread]: Command `dbt run` succeeded at 15:52:50.219497 after 1.46 seconds
[0m15:52:50.220111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74660a9bc2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74660b1aaf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7466081f7410>]}
[0m15:52:50.220623 [debug] [MainThread]: Flushing usage events
[0m15:52:51.036801 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:56.385014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c06205ea150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c061fcdeed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c06205eafc0>]}


============================== 15:52:56.390129 | cf3d9ae0-bfbf-4c39-b487-9d27eceea60b ==============================
[0m15:52:56.390129 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:52:56.393688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt show --select your_model', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:56.736729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf3d9ae0-bfbf-4c39-b487-9d27eceea60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c06204d8500>]}
[0m15:52:56.845602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf3d9ae0-bfbf-4c39-b487-9d27eceea60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c061fd07680>]}
[0m15:52:56.865818 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:52:57.098109 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:52:57.386729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:52:57.387612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:52:57.500037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf3d9ae0-bfbf-4c39-b487-9d27eceea60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c061ed79d00>]}
[0m15:52:57.723721 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:52:57.727457 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:52:57.735251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf3d9ae0-bfbf-4c39-b487-9d27eceea60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c061d567800>]}
[0m15:52:57.736154 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:52:57.736977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf3d9ae0-bfbf-4c39-b487-9d27eceea60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c061d566ed0>]}
[0m15:52:57.739989 [info ] [MainThread]: 
[0m15:52:57.740808 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:52:57.741715 [info ] [MainThread]: 
[0m15:52:57.742978 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:52:57.749620 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:52:57.808633 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:52:57.809468 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:52:57.810244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:57.815288 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:52:57.816113 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:52:57.816856 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:52:57.821636 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.004 seconds
[0m15:52:57.826456 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:52:57.827868 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:52:57.843744 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:57.844515 [debug] [MainThread]: On master: BEGIN
[0m15:52:57.845247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:52:57.849352 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:52:57.851437 [debug] [MainThread]: Using postgres connection "master"
[0m15:52:57.852343 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:52:57.874957 [debug] [MainThread]: SQL status: SELECT 4 in 0.022 seconds
[0m15:52:57.879029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf3d9ae0-bfbf-4c39-b487-9d27eceea60b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c061d5658b0>]}
[0m15:52:57.879920 [debug] [MainThread]: On master: ROLLBACK
[0m15:52:57.880743 [debug] [MainThread]: On master: Close
[0m15:52:57.886385 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.your_model
[0m15:52:57.887228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.your_model)
[0m15:52:57.888081 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.your_model
[0m15:52:57.902177 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.your_model"
[0m15:52:57.903508 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.your_model
[0m15:52:57.916330 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.your_model"
[0m15:52:57.917205 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.your_model"} */

  
  SELECT 
    order_id, 
    product_id,
    agreed_delivery_date,
    actual_delivery_date,
    order_qty,
    delivery_qty
FROM "raw"."raw"."order_delivery_metrics"
WHERE order_id IN ('FAP43503502', 'FJUL77520203', 'FJUN67320602', 'FMY530903402')
ORDER BY order_id, product_id
  
  limit 5

[0m15:52:57.918050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:57.923848 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m15:52:57.930164 [debug] [Thread-1 (]: On model.nexabrands_dbt.your_model: Close
[0m15:52:57.939562 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.your_model
[0m15:52:57.941257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:57.941925 [debug] [MainThread]: Connection 'model.nexabrands_dbt.your_model' was properly closed.
[0m15:52:57.943099 [debug] [MainThread]: Command end result
[0m15:52:58.020027 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:52:58.022732 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:52:58.032916 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:52:58.033849 [info ] [MainThread]: Previewing node 'your_model':
| order_id     | product_id | agreed_delivery_date | actual_delivery_date | order_qty | delivery_qty |
| ------------ | ---------- | -------------------- | -------------------- | --------- | ------------ |
| FAP43503502  | 258911020  |           2024-04-02 |           2024-04-02 |       427 |         3840 |
| FAP43503502  | 258914020  |           2024-04-02 |           2024-04-02 |       446 |         4460 |
| FAP43503502  | 258915010  |           2024-04-02 |           2024-04-02 |       120 |         1200 |
| FJUL77520203 | 258912010  |           2024-07-06 |           2024-07-07 |       140 |         1400 |
| FJUL77520203 | 258912030  |           2024-07-06 |           2024-07-07 |       491 |         4660 |

[0m15:52:58.035557 [debug] [MainThread]: Resource report: {"command_name": "show", "command_success": true, "command_wall_clock_time": 1.837291, "process_in_blocks": "0", "process_kernel_time": 0.296969, "process_mem_max_rss": "110964", "process_out_blocks": "4016", "process_user_time": 2.726716}
[0m15:52:58.036452 [debug] [MainThread]: Command `dbt show` succeeded at 15:52:58.036294 after 1.84 seconds
[0m15:52:58.037240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c06202b3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c06205e8e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c06205eafc0>]}
[0m15:52:58.038035 [debug] [MainThread]: Flushing usage events
[0m15:52:58.835140 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:58.108001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d9f183d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d9f877f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d9f183b00>]}


============================== 15:57:58.111323 | 14c6c841-a079-42d8-bc61-c8dc6959e201 ==============================
[0m15:57:58.111323 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:57:58.112417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'profiles_dir': '/home/codespace/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fct_order_fulfillment_lines', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:58.289815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14c6c841-a079-42d8-bc61-c8dc6959e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d9eb9c380>]}
[0m15:57:58.353580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14c6c841-a079-42d8-bc61-c8dc6959e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d9ee4bec0>]}
[0m15:57:58.354391 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:57:58.475338 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:57:58.637776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:58.638689 [debug] [MainThread]: Partial parsing: updated file: nexabrands_dbt://models/marts/fct_order_fulfillment_lines.sql
[0m15:57:59.290668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14c6c841-a079-42d8-bc61-c8dc6959e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d9c3562a0>]}
[0m15:57:59.457171 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:57:59.460769 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:57:59.542140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14c6c841-a079-42d8-bc61-c8dc6959e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d9ec137d0>]}
[0m15:57:59.542853 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:57:59.543445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14c6c841-a079-42d8-bc61-c8dc6959e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d9c41d0d0>]}
[0m15:57:59.545469 [info ] [MainThread]: 
[0m15:57:59.546027 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:57:59.546573 [info ] [MainThread]: 
[0m15:57:59.547254 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:57:59.548253 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw'
[0m15:57:59.581915 [debug] [ThreadPool]: Using postgres connection "list_raw"
[0m15:57:59.582534 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:57:59.583003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:59.587113 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.004 seconds
[0m15:57:59.588419 [debug] [ThreadPool]: On list_raw: Close
[0m15:57:59.593554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_raw)
[0m15:57:59.599625 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:57:59.600096 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:57:59.600532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:59.603366 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m15:57:59.604320 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:57:59.605059 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:57:59.608701 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m15:57:59.610413 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:57:59.611263 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:57:59.618306 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:59.618783 [debug] [MainThread]: On master: BEGIN
[0m15:57:59.619220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:59.621960 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:57:59.622719 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:59.623619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:57:59.637931 [debug] [MainThread]: SQL status: SELECT 4 in 0.013 seconds
[0m15:57:59.640104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14c6c841-a079-42d8-bc61-c8dc6959e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d9c181610>]}
[0m15:57:59.640657 [debug] [MainThread]: On master: ROLLBACK
[0m15:57:59.641213 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:59.641689 [debug] [MainThread]: On master: BEGIN
[0m15:57:59.642442 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:57:59.643153 [debug] [MainThread]: On master: COMMIT
[0m15:57:59.643838 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:59.644532 [debug] [MainThread]: On master: COMMIT
[0m15:57:59.645213 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:57:59.645702 [debug] [MainThread]: On master: Close
[0m15:57:59.649436 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m15:57:59.650155 [info ] [Thread-1 (]: 1 of 1 START sql table model raw.fct_order_fulfillment_lines ................... [RUN]
[0m15:57:59.651079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.fct_order_fulfillment_lines)
[0m15:57:59.651598 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m15:57:59.665182 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:57:59.668280 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:57:59.671262 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:57:59.685768 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:57:59.686545 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m15:57:59.726325 [debug] [Thread-1 (]: Writing runtime sql for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:57:59.727134 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:57:59.727651 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: BEGIN
[0m15:57:59.728147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:59.731122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m15:57:59.731943 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:57:59.732966 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */

  
    

  create  table "raw"."raw"."fct_order_fulfillment_lines__dbt_tmp"
  
  
    as
  
  (
    

WITH  __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
),  __dbt__cte__stg_customer_targets as (
-- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM  "raw"."raw"."customer_targets"

)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
), aggregated_order_metrics AS (
    SELECT 
        order_id,
        product_id,
        MAX(agreed_delivery_date) as agreed_delivery_date,
        MAX(actual_delivery_date) as actual_delivery_date,
        SUM(order_qty) as order_qty,
        SUM(delivery_qty) as delivery_qty,
        MAX(is_on_time) as is_on_time,
        MAX(is_in_full) as is_in_full,
        MAX(is_otif) as is_otif
    FROM "raw"."raw"."order_delivery_metrics"
    GROUP BY order_id, product_id
)

SELECT
    md5(cast(coalesce(cast(om.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(om.product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o.order_placement_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(om.agreed_delivery_date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_fulfillment_id,
    om.order_id,
    om.product_id,
    o.customer_id,
    o.order_placement_date,
    om.agreed_delivery_date,
    om.actual_delivery_date,
    om.order_qty,
    om.delivery_qty,
    om.is_on_time as on_time,
    om.is_in_full as in_full,
    om.is_otif as otif,
    ct.ontime_target,
    ct.infull_target,
    ct.otif_target,
    (om.is_on_time * 100) - ct.ontime_target as ontime_variance,
    (om.is_in_full * 100) - ct.infull_target as infull_variance,
    (om.is_otif * 100) - ct.otif_target as otif_variance,
    current_timestamp as last_updated_at
FROM aggregated_order_metrics om
JOIN __dbt__cte__stg_orders o ON om.order_id = o.order_id
JOIN __dbt__cte__stg_customers c ON o.customer_id = c.customer_id
LEFT JOIN __dbt__cte__stg_customer_targets ct ON c.customer_id = ct.customer_id
  );
  
[0m15:57:59.759507 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.026 seconds
[0m15:57:59.767610 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:57:59.768148 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */
alter table "raw"."raw"."fct_order_fulfillment_lines" rename to "fct_order_fulfillment_lines__dbt_backup"
[0m15:57:59.768893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:57:59.772056 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:57:59.772644 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */
alter table "raw"."raw"."fct_order_fulfillment_lines__dbt_tmp" rename to "fct_order_fulfillment_lines"
[0m15:57:59.773348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:57:59.793661 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: COMMIT
[0m15:57:59.794232 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:57:59.794751 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: COMMIT
[0m15:57:59.797247 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:57:59.807651 [debug] [Thread-1 (]: Applying DROP to: "raw"."raw"."fct_order_fulfillment_lines__dbt_backup"
[0m15:57:59.814854 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:57:59.815454 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */
drop table if exists "raw"."raw"."fct_order_fulfillment_lines__dbt_backup" cascade
[0m15:57:59.817382 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m15:57:59.819864 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: Close
[0m15:57:59.822114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14c6c841-a079-42d8-bc61-c8dc6959e201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775da08da5a0>]}
[0m15:57:59.823216 [info ] [Thread-1 (]: 1 of 1 OK created sql table model raw.fct_order_fulfillment_lines .............. [[32mSELECT 0[0m in 0.17s]
[0m15:57:59.824126 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m15:57:59.825653 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:59.826132 [debug] [MainThread]: On master: BEGIN
[0m15:57:59.826726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:59.830296 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:57:59.832399 [debug] [MainThread]: On master: COMMIT
[0m15:57:59.832989 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:59.833451 [debug] [MainThread]: On master: COMMIT
[0m15:57:59.833981 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:57:59.834528 [debug] [MainThread]: On master: Close
[0m15:57:59.835343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:59.836531 [debug] [MainThread]: Connection 'model.nexabrands_dbt.fct_order_fulfillment_lines' was properly closed.
[0m15:57:59.837221 [info ] [MainThread]: 
[0m15:57:59.837917 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m15:57:59.838812 [debug] [MainThread]: Command end result
[0m15:57:59.884176 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:57:59.885855 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:57:59.891400 [debug] [MainThread]: Wrote artifact RunExecutionResult to /workspaces/pyspark_practice-/nexabrands_dbt/target/run_results.json
[0m15:57:59.891859 [info ] [MainThread]: 
[0m15:57:59.892455 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:59.892961 [info ] [MainThread]: 
[0m15:57:59.893516 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:57:59.894628 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8702819, "process_in_blocks": "0", "process_kernel_time": 0.282405, "process_mem_max_rss": "115288", "process_out_blocks": "6000", "process_user_time": 2.855875}
[0m15:57:59.895199 [debug] [MainThread]: Command `dbt run` succeeded at 15:57:59.895086 after 1.87 seconds
[0m15:57:59.895697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d9c33fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d9c33d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x775d9f221220>]}
[0m15:57:59.896202 [debug] [MainThread]: Flushing usage events
[0m15:58:00.722026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:14.533386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c8e6695e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c8ee1c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c8ea62900>]}


============================== 15:58:14.536573 | 56cb547f-bf34-42b4-a15a-db656991084f ==============================
[0m15:58:14.536573 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:58:14.537340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/workspaces/pyspark_practice-/nexabrands_dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/codespace/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt show --select fct_order_fulfillment_lines', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:58:14.750264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56cb547f-bf34-42b4-a15a-db656991084f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c8df17b90>]}
[0m15:58:14.813827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56cb547f-bf34-42b4-a15a-db656991084f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c903f80e0>]}
[0m15:58:14.827138 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:58:14.947433 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:58:15.112915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:15.113448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:15.176578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56cb547f-bf34-42b4-a15a-db656991084f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c8df997c0>]}
[0m15:58:15.304080 [debug] [MainThread]: Wrote artifact WritableManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/manifest.json
[0m15:58:15.306439 [debug] [MainThread]: Wrote artifact SemanticManifest to /workspaces/pyspark_practice-/nexabrands_dbt/target/semantic_manifest.json
[0m15:58:15.311046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56cb547f-bf34-42b4-a15a-db656991084f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c8bf5fcb0>]}
[0m15:58:15.311619 [info ] [MainThread]: Found 11 models, 2 snapshots, 36 data tests, 6 sources, 814 macros
[0m15:58:15.312180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56cb547f-bf34-42b4-a15a-db656991084f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c8db3f7a0>]}
[0m15:58:15.314638 [info ] [MainThread]: 
[0m15:58:15.315375 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:58:15.316266 [info ] [MainThread]: 
[0m15:58:15.317242 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:58:15.323979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_raw_raw'
[0m15:58:15.360528 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:58:15.361034 [debug] [ThreadPool]: On list_raw_raw: BEGIN
[0m15:58:15.361505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:15.366540 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:58:15.367218 [debug] [ThreadPool]: Using postgres connection "list_raw_raw"
[0m15:58:15.367771 [debug] [ThreadPool]: On list_raw_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "list_raw_raw"} */
select
      'raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw'
    union all
    select
      'raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw'
  
[0m15:58:15.370403 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m15:58:15.372085 [debug] [ThreadPool]: On list_raw_raw: ROLLBACK
[0m15:58:15.373021 [debug] [ThreadPool]: On list_raw_raw: Close
[0m15:58:15.380477 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:15.381217 [debug] [MainThread]: On master: BEGIN
[0m15:58:15.381951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:15.386238 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:58:15.386957 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:15.387922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:58:15.402860 [debug] [MainThread]: SQL status: SELECT 4 in 0.014 seconds
[0m15:58:15.404935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56cb547f-bf34-42b4-a15a-db656991084f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c6c8d776d50>]}
[0m15:58:15.405480 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:15.406034 [debug] [MainThread]: On master: Close
[0m15:58:15.408850 [debug] [Thread-1 (]: Began running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m15:58:15.409604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_raw, now model.nexabrands_dbt.fct_order_fulfillment_lines)
[0m15:58:15.410133 [debug] [Thread-1 (]: Began compiling node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m15:58:15.435425 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:58:15.438443 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:58:15.441463 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:58:15.455804 [debug] [Thread-1 (]: Writing injected SQL for node "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:58:15.456557 [debug] [Thread-1 (]: Began executing node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m15:58:15.464787 [debug] [Thread-1 (]: Using postgres connection "model.nexabrands_dbt.fct_order_fulfillment_lines"
[0m15:58:15.465444 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "model.nexabrands_dbt.fct_order_fulfillment_lines"} */

  
  

WITH  __dbt__cte__stg_orders as (
-- models/staging/stg_orders.sql
WITH orders AS (
    SELECT * 
    
    FROM  "raw"."raw"."orders" 

)

SELECT
    order_id,
    customer_id ,
    order_placement_date 
   
FROM orders
),  __dbt__cte__stg_customers as (
-- models/staging/stg_customers.sql
WITH customers   AS (
    SELECT *
     FROM   "raw"."raw"."customers" 

)

SELECT
    customer_id,
    customer_name,
    city
FROM customers
),  __dbt__cte__stg_customer_targets as (
-- models/staging/stg_customer_targets.sql
WITH customer_targets AS (
    SELECT * 
    FROM  "raw"."raw"."customer_targets"

)

SELECT
    customer_id,
    "ontime_target%" as ontime_target,
    "infull_target%" as infull_target,
    "otif_target%" as otif_target
FROM customer_targets
), aggregated_order_metrics AS (
    SELECT 
        order_id,
        product_id,
        MAX(agreed_delivery_date) as agreed_delivery_date,
        MAX(actual_delivery_date) as actual_delivery_date,
        SUM(order_qty) as order_qty,
        SUM(delivery_qty) as delivery_qty,
        MAX(is_on_time) as is_on_time,
        MAX(is_in_full) as is_in_full,
        MAX(is_otif) as is_otif
    FROM "raw"."raw"."order_delivery_metrics"
    GROUP BY order_id, product_id
)

SELECT
    md5(cast(coalesce(cast(om.order_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(om.product_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o.customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(o.order_placement_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(om.agreed_delivery_date as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as order_fulfillment_id,
    om.order_id,
    om.product_id,
    o.customer_id,
    o.order_placement_date,
    om.agreed_delivery_date,
    om.actual_delivery_date,
    om.order_qty,
    om.delivery_qty,
    om.is_on_time as on_time,
    om.is_in_full as in_full,
    om.is_otif as otif,
    ct.ontime_target,
    ct.infull_target,
    ct.otif_target,
    (om.is_on_time * 100) - ct.ontime_target as ontime_variance,
    (om.is_in_full * 100) - ct.infull_target as infull_variance,
    (om.is_otif * 100) - ct.otif_target as otif_variance,
    current_timestamp as last_updated_at
FROM aggregated_order_metrics om
JOIN __dbt__cte__stg_orders o ON om.order_id = o.order_id
JOIN __dbt__cte__stg_customers c ON o.customer_id = c.customer_id
LEFT JOIN __dbt__cte__stg_customer_targets ct ON c.customer_id = ct.customer_id
  
  limit 5

[0m15:58:15.466054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:15.541241 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.075 seconds
[0m15:58:15.543537 [debug] [Thread-1 (]: On model.nexabrands_dbt.fct_order_fulfillment_lines: Close
[0m15:58:15.544660 [debug] [Thread-1 (]: Finished running node model.nexabrands_dbt.fct_order_fulfillment_lines
[0m15:58:15.546403 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993
[0m15:58:15.547014 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed
[0m15:58:15.547574 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64
[0m15:58:15.548156 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993'
[0m15:58:15.548725 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e
[0m15:58:15.549373 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed'
[0m15:58:15.550001 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64'
[0m15:58:15.550582 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993
[0m15:58:15.551161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nexabrands_dbt.fct_order_fulfillment_lines, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e)
[0m15:58:15.551713 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed
[0m15:58:15.552249 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64
[0m15:58:15.564585 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993"
[0m15:58:15.565103 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e
[0m15:58:15.569267 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed"
[0m15:58:15.573540 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64"
[0m15:58:15.593733 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64
[0m15:58:15.592877 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e"
[0m15:58:15.574419 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993
[0m15:58:15.598055 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64"
[0m15:58:15.598720 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed
[0m15:58:15.602522 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993"
[0m15:58:15.603190 [debug] [Thread-2 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64"} */

  
  
    
    

with all_values as (

    select
        otif as value_field,
        count(*) as n_records

    from "raw"."raw"."fct_order_fulfillment_lines"
    group by otif

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  limit 5

[0m15:58:15.603819 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e
[0m15:58:15.608267 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed"
[0m15:58:15.608860 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993"} */

  
  
    
    

with all_values as (

    select
        in_full as value_field,
        count(*) as n_records

    from "raw"."raw"."fct_order_fulfillment_lines"
    group by in_full

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  limit 5

[0m15:58:15.609430 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:58:15.613073 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e"
[0m15:58:15.615297 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e"} */

  
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and actual_delivery_date >= '2020-01-01' and actual_delivery_date <= current_date + interval '30 days'
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  limit 5

[0m15:58:15.614272 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:58:15.613678 [debug] [Thread-4 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed"} */

  
  
    
    

with all_values as (

    select
        on_time as value_field,
        count(*) as n_records

    from "raw"."raw"."fct_order_fulfillment_lines"
    group by on_time

)

select *
from all_values
where value_field not in (
    '0','1'
)



  
  limit 5

[0m15:58:15.617449 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:58:15.616193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:15.622005 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.012 seconds
[0m15:58:15.624177 [debug] [Thread-2 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64: Close
[0m15:58:15.625031 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.011 seconds
[0m15:58:15.626401 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64
[0m15:58:15.628300 [debug] [Thread-3 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993: Close
[0m15:58:15.629149 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae
[0m15:58:15.630006 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.014 seconds
[0m15:58:15.630535 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.013 seconds
[0m15:58:15.631700 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993
[0m15:58:15.632428 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_otif__0__1.7a241c5d64, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae)
[0m15:58:15.634112 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e: Close
[0m15:58:15.635380 [debug] [Thread-4 (]: On test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed: Close
[0m15:58:15.637777 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed
[0m15:58:15.636579 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae
[0m15:58:15.635986 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4
[0m15:58:15.638679 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932
[0m15:58:15.640041 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e
[0m15:58:15.645731 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae"
[0m15:58:15.646391 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_in_full__0__1.540a357993, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4)
[0m15:58:15.646980 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.accepted_values_fct_order_fulfillment_lines_on_time__0__1.9fac0c74ed, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932)
[0m15:58:15.647577 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e
[0m15:58:15.648410 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae
[0m15:58:15.648958 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4
[0m15:58:15.649497 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932
[0m15:58:15.650089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_actual_delivery_date__current_date_interval_30_days____2020_01_01_.697408ec5e, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e)
[0m15:58:15.653946 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae"
[0m15:58:15.658750 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4"
[0m15:58:15.663554 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932"
[0m15:58:15.664131 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e
[0m15:58:15.664723 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae"} */

  
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and delivery_qty >= 0
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  limit 5

[0m15:58:15.665558 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4
[0m15:58:15.670509 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e"
[0m15:58:15.671159 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:15.675909 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4"
[0m15:58:15.677589 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4"} */

  
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and infull_target >= 0 and infull_target <= 100
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  limit 5

[0m15:58:15.678510 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:58:15.679825 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e
[0m15:58:15.676403 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932
[0m15:58:15.685088 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e"
[0m15:58:15.685750 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.015 seconds
[0m15:58:15.689842 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932"
[0m15:58:15.690367 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.012 seconds
[0m15:58:15.690944 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e"} */

  
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and ontime_target >= 0 and ontime_target <= 100
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  limit 5

[0m15:58:15.692245 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae: Close
[0m15:58:15.695831 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae
[0m15:58:15.696634 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31
[0m15:58:15.692870 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932"} */

  
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and infull_variance >= -100 and infull_variance <= 100
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  limit 5

[0m15:58:15.694179 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4: Close
[0m15:58:15.699164 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4
[0m15:58:15.697452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_delivery_qty__0__False.4cddc9e6ae, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31)
[0m15:58:15.699974 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b
[0m15:58:15.694788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:15.698091 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:58:15.700745 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31
[0m15:58:15.701407 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_target__100__0__False.008668eca4, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b)
[0m15:58:15.709512 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b
[0m15:58:15.708799 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31"
[0m15:58:15.716461 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b"
[0m15:58:15.717244 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.019 seconds
[0m15:58:15.717881 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.023 seconds
[0m15:58:15.718471 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31
[0m15:58:15.719847 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932: Close
[0m15:58:15.726625 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932
[0m15:58:15.727437 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3
[0m15:58:15.721714 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e: Close
[0m15:58:15.720549 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b
[0m15:58:15.725529 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31"
[0m15:58:15.728232 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_infull_variance__100___100__False.2c863f5932, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3)
[0m15:58:15.777458 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e
[0m15:58:15.779370 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b"
[0m15:58:15.780023 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31"} */

  
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and ontime_variance >= -100 and ontime_variance <= 100
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  limit 5

[0m15:58:15.780616 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3
[0m15:58:15.781228 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7
[0m15:58:15.781867 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b"} */

  
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and order_placement_date >= '2024-01-01' and order_placement_date <= current_date
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  limit 5

[0m15:58:15.782491 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:15.787420 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3"
[0m15:58:15.789966 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3
[0m15:58:15.788051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_target__100__0__False.16378b3d2e, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7)
[0m15:58:15.788636 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:58:15.794869 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3"
[0m15:58:15.796929 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3"} */

  
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and order_qty > 0
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  limit 5

[0m15:58:15.795594 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7
[0m15:58:15.797768 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:58:15.798563 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.016 seconds
[0m15:58:15.803778 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7"
[0m15:58:15.805998 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31: Close
[0m15:58:15.808261 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31
[0m15:58:15.809053 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b
[0m15:58:15.806805 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.018 seconds
[0m15:58:15.809900 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7
[0m15:58:15.810754 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_ontime_variance__100___100__False.c96e64bc31, now test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b)
[0m15:58:15.812680 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b: Close
[0m15:58:15.813188 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.015 seconds
[0m15:58:15.819592 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3: Close
[0m15:58:15.817055 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7"
[0m15:58:15.821961 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b
[0m15:58:15.820894 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3
[0m15:58:15.817647 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b
[0m15:58:15.822942 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7"} */

  
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and otif_target >= 0 and otif_target <= 100
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  limit 5

[0m15:58:15.823586 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9
[0m15:58:15.824213 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953
[0m15:58:15.828974 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b"
[0m15:58:15.829569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:15.830160 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_placement_date__current_date___2024_01_01_.2ac1b9581b, now test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9)
[0m15:58:15.832626 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9
[0m15:58:15.831646 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b
[0m15:58:15.830804 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_order_qty__0__True.c9d537cda3, now test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953)
[0m15:58:15.849550 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b"
[0m15:58:15.850087 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.021 seconds
[0m15:58:15.855787 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953
[0m15:58:15.857792 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9"
[0m15:58:15.858482 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b"} */

  
  






    with grouped_expression as (
    select
        
        
    
  
( 1=1 and otif_variance >= -100 and otif_variance <= 100
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors








  
  limit 5

[0m15:58:15.859769 [debug] [Thread-1 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7: Close
[0m15:58:15.868306 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953"
[0m15:58:15.869065 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:15.870946 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9
[0m15:58:15.871907 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953
[0m15:58:15.876903 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9"
[0m15:58:15.877827 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7
[0m15:58:15.882288 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9"} */

  
  



with validation_errors as (

    select
        order_id,product_id,customer_id,order_placement_date,agreed_delivery_date,
        count(*) as "n_records"
    from "raw"."raw"."fct_order_fulfillment_lines"
    where
        1=1
        and 
    not (
        order_id is null and 
        product_id is null and 
        customer_id is null and 
        order_placement_date is null and 
        agreed_delivery_date is null
        
    )


    
    group by
        order_id,product_id,customer_id,order_placement_date,agreed_delivery_date
    having count(*) > 1

)
select * from validation_errors

  
  limit 5

[0m15:58:15.881407 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953"
[0m15:58:15.883231 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be
[0m15:58:15.883792 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.015 seconds
[0m15:58:15.884350 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:58:15.884941 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953"} */

  
  



    with grouped_expression as (
    select
        
        
    
  
( 1=1 and count(*) <= 10000
)
 as expression


    from "raw"."raw"."fct_order_fulfillment_lines"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors






  
  limit 5

[0m15:58:15.885548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_target__100__0__False.e56fc77de7, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be)
[0m15:58:15.888682 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be
[0m15:58:15.887871 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:58:15.886863 [debug] [Thread-2 (]: On test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b: Close
[0m15:58:15.900577 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b
[0m15:58:15.901406 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b
[0m15:58:15.902231 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_fct_order_fulfillment_lines_otif_variance__100___100__False.2f2159593b, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b)
[0m15:58:15.902993 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b
[0m15:58:15.899390 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.015 seconds
[0m15:58:15.898774 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be"
[0m15:58:15.908028 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b"
[0m15:58:15.909775 [debug] [Thread-3 (]: On test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9: Close
[0m15:58:15.912322 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9
[0m15:58:15.911104 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be
[0m15:58:15.910315 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.022 seconds
[0m15:58:15.913137 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2
[0m15:58:15.918589 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be"
[0m15:58:15.919197 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b
[0m15:58:15.920405 [debug] [Thread-4 (]: On test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953: Close
[0m15:58:15.921000 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_fct_order_fulfillment_lines_order_id__product_id__customer_id__order_placement_date__agreed_delivery_date.6bd63d25c9, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2)
[0m15:58:15.927220 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2
[0m15:58:15.921590 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be"} */

  
  
    
    



select agreed_delivery_date
from "raw"."raw"."fct_order_fulfillment_lines"
where agreed_delivery_date is null



  
  limit 5

[0m15:58:15.926465 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953
[0m15:58:15.925309 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b"
[0m15:58:15.931650 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2"
[0m15:58:15.932242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:15.932829 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183
[0m15:58:15.933420 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b"} */

  
  
    
    



select customer_id
from "raw"."raw"."fct_order_fulfillment_lines"
where customer_id is null



  
  limit 5

[0m15:58:15.936125 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:15.935269 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_fct_order_fulfillment_lines_10000__None.aefa464953, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183)
[0m15:58:15.937451 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183
[0m15:58:15.934288 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2
[0m15:58:15.942784 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183"
[0m15:58:15.946875 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2"
[0m15:58:15.947405 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.015 seconds
[0m15:58:15.948290 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2"} */

  
  
    
    



select delivery_qty
from "raw"."raw"."fct_order_fulfillment_lines"
where delivery_qty is null



  
  limit 5

[0m15:58:15.949180 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.013 seconds
[0m15:58:15.950402 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be: Close
[0m15:58:15.951018 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183
[0m15:58:15.951493 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:58:15.952712 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b: Close
[0m15:58:15.959643 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b
[0m15:58:15.958170 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be
[0m15:58:15.961289 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371
[0m15:58:15.960472 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf
[0m15:58:15.962991 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_customer_id.f87ee5a17b, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf)
[0m15:58:15.957413 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183"
[0m15:58:15.962113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_agreed_delivery_date.7e04b1b6be, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371)
[0m15:58:15.963818 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf
[0m15:58:15.964583 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183"} */

  
  
    
    



select in_full
from "raw"."raw"."fct_order_fulfillment_lines"
where in_full is null



  
  limit 5

[0m15:58:15.965272 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.014 seconds
[0m15:58:15.965818 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371
[0m15:58:15.970822 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf"
[0m15:58:15.971408 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:58:15.972672 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2: Close
[0m15:58:15.976907 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371"
[0m15:58:15.979399 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371
[0m15:58:15.977775 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf
[0m15:58:15.984733 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371"
[0m15:58:15.985656 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2
[0m15:58:15.989553 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf"
[0m15:58:15.990180 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.019 seconds
[0m15:58:15.990721 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371"} */

  
  
    
    



select infull_variance
from "raw"."raw"."fct_order_fulfillment_lines"
where infull_variance is null



  
  limit 5

[0m15:58:15.991304 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2
[0m15:58:15.991903 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf"} */

  
  
    
    



select infull_target
from "raw"."raw"."fct_order_fulfillment_lines"
where infull_target is null



  
  limit 5

[0m15:58:15.993165 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183: Close
[0m15:58:15.993736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:15.994347 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_delivery_qty.2ac8c03ad2, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2)
[0m15:58:15.994910 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:15.999429 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183
[0m15:58:15.996132 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2
[0m15:58:16.000372 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83
[0m15:58:16.001200 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.006 seconds
[0m15:58:16.005836 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2"
[0m15:58:16.006364 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.013 seconds
[0m15:58:16.006937 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_in_full.faf6442183, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83)
[0m15:58:16.008200 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf: Close
[0m15:58:16.009042 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2
[0m15:58:16.010232 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371: Close
[0m15:58:16.010787 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83
[0m15:58:16.015729 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2"
[0m15:58:16.016607 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf
[0m15:58:16.017623 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371
[0m15:58:16.022561 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83"
[0m15:58:16.023159 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2"} */

  
  
    
    



select last_updated_at
from "raw"."raw"."fct_order_fulfillment_lines"
where last_updated_at is null



  
  limit 5

[0m15:58:16.023774 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1
[0m15:58:16.024418 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1
[0m15:58:16.025264 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83
[0m15:58:16.025777 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:58:16.026383 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_target.afcf24f2cf, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1)
[0m15:58:16.026957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_infull_variance.5a058ac371, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1)
[0m15:58:16.033661 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1
[0m15:58:16.032845 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1
[0m15:58:16.031823 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83"
[0m15:58:16.038452 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1"
[0m15:58:16.043010 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1"
[0m15:58:16.043611 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.018 seconds
[0m15:58:16.044101 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83"} */

  
  
    
    



select on_time
from "raw"."raw"."fct_order_fulfillment_lines"
where on_time is null



  
  limit 5

[0m15:58:16.044919 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1
[0m15:58:16.046435 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2: Close
[0m15:58:16.052362 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2
[0m15:58:16.050838 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1"
[0m15:58:16.053178 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090
[0m15:58:16.047082 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:58:16.051320 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1
[0m15:58:16.053988 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1"} */

  
  
    
    



select ontime_variance
from "raw"."raw"."fct_order_fulfillment_lines"
where ontime_variance is null



  
  limit 5

[0m15:58:16.054671 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_last_updated_at.02969a5ad2, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090)
[0m15:58:16.059780 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1"
[0m15:58:16.060481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:16.061232 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.014 seconds
[0m15:58:16.061710 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090
[0m15:58:16.064531 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83: Close
[0m15:58:16.070245 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83
[0m15:58:16.069092 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090"
[0m15:58:16.062334 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1"} */

  
  
    
    



select ontime_target
from "raw"."raw"."fct_order_fulfillment_lines"
where ontime_target is null



  
  limit 5

[0m15:58:16.071054 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd
[0m15:58:16.072007 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:16.072774 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.012 seconds
[0m15:58:16.073436 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090
[0m15:58:16.073953 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_on_time.4b516afc83, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd)
[0m15:58:16.076151 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1: Close
[0m15:58:16.081284 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090"
[0m15:58:16.084491 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090"} */

  
  
    
    



select order_fulfillment_id
from "raw"."raw"."fct_order_fulfillment_lines"
where order_fulfillment_id is null



  
  limit 5

[0m15:58:16.082753 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.011 seconds
[0m15:58:16.083748 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1
[0m15:58:16.081973 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd
[0m15:58:16.085222 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:58:16.086582 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1: Close
[0m15:58:16.087167 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8
[0m15:58:16.091349 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd"
[0m15:58:16.092333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_variance.3ab0c04cb1, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8)
[0m15:58:16.094904 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8
[0m15:58:16.093981 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1
[0m15:58:16.100774 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8"
[0m15:58:16.101677 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd
[0m15:58:16.102388 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b
[0m15:58:16.102905 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.018 seconds
[0m15:58:16.103744 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8
[0m15:58:16.107413 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd"
[0m15:58:16.108013 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_ontime_target.6ded97e2e1, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b)
[0m15:58:16.109284 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090: Close
[0m15:58:16.112991 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8"
[0m15:58:16.115034 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8"} */

  
  
    
    



select order_placement_date
from "raw"."raw"."fct_order_fulfillment_lines"
where order_placement_date is null



  
  limit 5

[0m15:58:16.114157 [debug] [Thread-2 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b
[0m15:58:16.115859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:16.113586 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd"} */

  
  
    
    



select order_id
from "raw"."raw"."fct_order_fulfillment_lines"
where order_id is null



  
  limit 5

[0m15:58:16.122049 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:58:16.121087 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090
[0m15:58:16.123090 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d
[0m15:58:16.123954 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_fulfillment_id.6907a4f090, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d)
[0m15:58:16.124795 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d
[0m15:58:16.120333 [debug] [Thread-2 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b"
[0m15:58:16.130388 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d"
[0m15:58:16.130929 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.015 seconds
[0m15:58:16.132262 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.010 seconds
[0m15:58:16.133599 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8: Close
[0m15:58:16.134275 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d
[0m15:58:16.134778 [debug] [Thread-2 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b
[0m15:58:16.136005 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd: Close
[0m15:58:16.137088 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8
[0m15:58:16.148188 [debug] [Thread-1 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e
[0m15:58:16.142593 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d"
[0m15:58:16.147392 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd
[0m15:58:16.146280 [debug] [Thread-2 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b"
[0m15:58:16.149005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_placement_date.576d9c05c8, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e)
[0m15:58:16.149588 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d"} */

  
  
    
    



select otif
from "raw"."raw"."fct_order_fulfillment_lines"
where otif is null



  
  limit 5

[0m15:58:16.150182 [debug] [Thread-4 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b
[0m15:58:16.150803 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b"} */

  
  
    
    



select order_qty
from "raw"."raw"."fct_order_fulfillment_lines"
where order_qty is null



  
  limit 5

[0m15:58:16.151353 [debug] [Thread-1 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e
[0m15:58:16.151892 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:58:16.152459 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_id.b7058f5bcd, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b)
[0m15:58:16.157913 [debug] [Thread-4 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b
[0m15:58:16.153011 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:16.157098 [debug] [Thread-1 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e"
[0m15:58:16.163188 [debug] [Thread-4 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b"
[0m15:58:16.165032 [debug] [Thread-4 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b
[0m15:58:16.165924 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.014 seconds
[0m15:58:16.167006 [debug] [Thread-1 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e
[0m15:58:16.170922 [debug] [Thread-4 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b"
[0m15:58:16.171517 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.018 seconds
[0m15:58:16.172686 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d: Close
[0m15:58:16.179326 [debug] [Thread-3 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d
[0m15:58:16.180144 [debug] [Thread-3 (]: Began running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe
[0m15:58:16.178279 [debug] [Thread-2 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b: Close
[0m15:58:16.176380 [debug] [Thread-1 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e"
[0m15:58:16.181683 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e"} */

  
  
    
    



select otif_target
from "raw"."raw"."fct_order_fulfillment_lines"
where otif_target is null



  
  limit 5

[0m15:58:16.182496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:16.176985 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", "node_id": "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b"} */

  
  
    
    



select otif_variance
from "raw"."raw"."fct_order_fulfillment_lines"
where otif_variance is null



  
  limit 5

[0m15:58:16.183603 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:58:16.180901 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif.592560901d, now test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe)
[0m15:58:16.184904 [debug] [Thread-3 (]: Began compiling node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe
[0m15:58:16.191455 [debug] [Thread-3 (]: Writing injected SQL for node "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe"
[0m15:58:16.192592 [debug] [Thread-2 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b
[0m15:58:16.193223 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.010 seconds
[0m15:58:16.193948 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.011 seconds
[0m15:58:16.194690 [debug] [Thread-2 (]: Began running node test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae
[0m15:58:16.196008 [debug] [Thread-4 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b: Close
[0m15:58:16.199525 [debug] [Thread-4 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_variance.bd7e2b8a1b
[0m15:58:16.197915 [debug] [Thread-3 (]: Began executing node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe
[0m15:58:16.197313 [debug] [Thread-1 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e: Close
[0m15:58:16.205097 [debug] [Thread-1 (]: Finished running node test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_otif_target.5f68b73b2e
[0m15:58:16.203999 [debug] [Thread-3 (]: Using postgres connection "test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe"
[0m15:58:16.198454 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_order_qty.d9c904505b, now test.nexabrands_dbt.unique_fct_order_fulfillment_lines_order_fulfillment_id.027de373ae)
[0m15:58:16.206088 [debug] [Thread-3 (]: On test.nexabrands_dbt.not_null_fct_order_fulfillment_lines_product_id.61c3e2f9fe: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nexabrands_dbt", "target_name": "dev", 