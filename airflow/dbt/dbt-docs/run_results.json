{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.3", "generated_at": "2025-03-21T12:20:35.104894Z", "invocation_id": "2281b46c-0102-4555-9e69-2b88d1cd05a0", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:29.788492Z", "completed_at": "2025-03-21T12:20:29.866040Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:29.867078Z", "completed_at": "2025-03-21T12:20:29.867113Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0888981819152832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.data_monitoring_metrics", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n    \n    select * from (\n            select\n            \n                \n        cast('dummy_string' as varchar(4096)) as id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as full_table_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as column_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as metric_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as metric_type\n\n,\n                \n        cast(123456789.99 as float) as metric_value\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as source_value\n\n,\n                cast('2091-02-17' as timestamp) as bucket_start\n\n,\n                cast('2091-02-17' as timestamp) as bucket_end\n\n,\n                \n        cast(123456789 as integer) as bucket_duration_hours\n\n,\n                cast('2091-02-17' as timestamp) as updated_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as dimension\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as dimension_value\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as metric_properties\n\n,\n                cast('2091-02-17' as timestamp) as created_at\n\n\n        ) as empty_table\n        where 1 = 0\n", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"data_monitoring_metrics\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:29.877587Z", "completed_at": "2025-03-21T12:20:29.928722Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:29.935915Z", "completed_at": "2025-03-21T12:20:29.935940Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06067824363708496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.dbt_columns", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as varchar(4096)) as unique_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as parent_unique_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as data_type\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as meta\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as database_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as schema_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as table_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as description\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as resource_type\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as generated_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as metadata_hash\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"dbt_columns\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:29.950024Z", "completed_at": "2025-03-21T12:20:30.010603Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.014670Z", "completed_at": "2025-03-21T12:20:30.014691Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07013702392578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.dbt_exposures", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as varchar(4096)) as unique_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as maturity\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as type\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as owner_email\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as owner_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as url\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as depends_on_macros\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as depends_on_nodes\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as depends_on_columns\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as description\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as meta\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as package_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as original_path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as generated_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as metadata_hash\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as label\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as raw_queries\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"dbt_exposures\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.022657Z", "completed_at": "2025-03-21T12:20:30.054549Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.055706Z", "completed_at": "2025-03-21T12:20:30.055724Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0354459285736084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.dbt_invocations", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as invocation_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as job_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as job_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as job_run_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as run_started_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as run_completed_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as generated_at\n\n,\n                cast('2091-02-17' as timestamp) as created_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as command\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as dbt_version\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as elementary_version\n\n,\n                \n        cast (True as boolean) as full_refresh\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as invocation_vars\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as vars\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as target_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as target_database\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as target_schema\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as target_profile_name\n\n,\n                \n        cast(123456789 as integer) as threads\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as selected\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as yaml_selector\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as project_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as project_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as env\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as env_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as cause_category\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as cause\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as pull_request_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as git_sha\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as orchestrator\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as dbt_user\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as job_url\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as job_run_url\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as account_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as target_adapter_specific_fields\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"dbt_invocations\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.061052Z", "completed_at": "2025-03-21T12:20:30.104111Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.105045Z", "completed_at": "2025-03-21T12:20:30.105062Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04922127723693848, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.dbt_metrics", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as varchar(4096)) as unique_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as label\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as model\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as type\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as sql\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as timestamp\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as filters\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as time_grains\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as dimensions\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as depends_on_macros\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as depends_on_nodes\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as description\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as meta\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as package_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as original_path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as generated_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as metadata_hash\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"dbt_metrics\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.114976Z", "completed_at": "2025-03-21T12:20:30.146522Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.150580Z", "completed_at": "2025-03-21T12:20:30.150603Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03771233558654785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.dbt_models", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as varchar(4096)) as unique_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as alias\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as checksum\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as materialization\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as meta\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as owner\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as database_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as schema_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as depends_on_macros\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as depends_on_nodes\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as description\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as package_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as original_path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as patch_path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as generated_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as metadata_hash\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as unique_key\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as incremental_strategy\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"dbt_models\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.158377Z", "completed_at": "2025-03-21T12:20:30.202900Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.204056Z", "completed_at": "2025-03-21T12:20:30.204073Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.047811269760131836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.dbt_run_results", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as model_execution_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as unique_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as invocation_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as generated_at\n\n,\n                cast('2091-02-17' as timestamp) as created_at\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as message\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as status\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as resource_type\n\n,\n                \n        cast(123456789.99 as float) as execution_time\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as execute_started_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as execute_completed_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as compile_started_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as compile_completed_at\n\n,\n                \n        cast(31474836478 as bigint) as rows_affected\n\n,\n                \n        cast (True as boolean) as full_refresh\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as compiled_code\n\n,\n                \n        cast(31474836478 as bigint) as failures\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as query_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as thread_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as materialization\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as adapter_response\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"dbt_run_results\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.211500Z", "completed_at": "2025-03-21T12:20:30.243377Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.245244Z", "completed_at": "2025-03-21T12:20:30.245265Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03585243225097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.dbt_seeds", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as varchar(4096)) as unique_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as alias\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as checksum\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as meta\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as owner\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as database_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as schema_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as description\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as package_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as original_path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as generated_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as metadata_hash\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"dbt_seeds\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.253466Z", "completed_at": "2025-03-21T12:20:30.291494Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.292498Z", "completed_at": "2025-03-21T12:20:30.292516Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04128575325012207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.dbt_snapshots", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as varchar(4096)) as unique_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as alias\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as checksum\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as materialization\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as meta\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as owner\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as database_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as schema_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as depends_on_macros\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as depends_on_nodes\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as description\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as package_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as original_path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as patch_path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as generated_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as metadata_hash\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as unique_key\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as incremental_strategy\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"dbt_snapshots\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.300530Z", "completed_at": "2025-03-21T12:20:30.333801Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.334907Z", "completed_at": "2025-03-21T12:20:30.334926Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03653097152709961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.dbt_source_freshness_results", "compiled": true, "compiled_code": "\n\n\n    select * from (\n            select\n            \n                \n        cast('dummy_string' as varchar(4096)) as source_freshness_execution_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as unique_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as max_loaded_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as snapshotted_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as generated_at\n\n,\n                cast('2091-02-17' as timestamp) as created_at\n\n,\n                \n        cast(123456789.99 as float) as max_loaded_at_time_ago_in_s\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as status\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as error\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as compile_started_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as compile_completed_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as execute_started_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as execute_completed_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as invocation_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as warn_after\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as error_after\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as filter\n\n\n        ) as empty_table\n        where 1 = 0\n", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"dbt_source_freshness_results\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.345471Z", "completed_at": "2025-03-21T12:20:30.374580Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.377863Z", "completed_at": "2025-03-21T12:20:30.377882Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03463578224182129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.dbt_sources", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as varchar(4096)) as unique_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as database_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as schema_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as source_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as identifier\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as loaded_at_field\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as freshness_warn_after\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as freshness_error_after\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as freshness_filter\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as freshness_description\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as relation_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as meta\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as owner\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as package_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as original_path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as path\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as source_description\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as description\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as generated_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as metadata_hash\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"dbt_sources\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.385734Z", "completed_at": "2025-03-21T12:20:30.432673Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.436807Z", "completed_at": "2025-03-21T12:20:30.436827Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.053314924240112305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.dbt_tests", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as varchar(4096)) as unique_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as database_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as schema_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as short_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as alias\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as test_column_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as severity\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as warn_if\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as error_if\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as test_params\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as test_namespace\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as test_original_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as model_tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as model_owners\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as meta\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as depends_on_macros\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as depends_on_nodes\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as parent_model_unique_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as description\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as package_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as type\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as original_path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as path\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as generated_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as metadata_hash\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as quality_dimension\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"dbt_tests\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.444652Z", "completed_at": "2025-03-21T12:20:30.489408Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.493517Z", "completed_at": "2025-03-21T12:20:30.493538Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.051172733306884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.elementary_test_results", "compiled": true, "compiled_code": "\n\n\n    select * from (\n            select\n            \n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as data_issue_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as test_execution_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as test_unique_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as model_unique_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as invocation_id\n\n,\n                cast('2091-02-17' as timestamp) as detected_at\n\n,\n                cast('2091-02-17' as timestamp) as created_at\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as database_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as schema_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as table_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as column_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as test_type\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as test_sub_type\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as test_results_description\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as owners\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as test_results_query\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as other\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as test_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as test_params\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as severity\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as status\n\n,\n                \n        cast(31474836478 as bigint) as failures\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as test_short_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as test_alias\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as result_rows\n\n,\n                \n        cast(31474836478 as bigint) as failed_row_count\n\n\n        ) as empty_table\n        where 1 = 0\n", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"elementary_test_results\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.499353Z", "completed_at": "2025-03-21T12:20:30.519780Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.520750Z", "completed_at": "2025-03-21T12:20:30.520767Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023586511611938477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.metadata", "compiled": true, "compiled_code": "\n\nSELECT\n    '0.18.1' as dbt_pkg_version", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"metadata\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.531371Z", "completed_at": "2025-03-21T12:20:30.555962Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.557086Z", "completed_at": "2025-03-21T12:20:30.557103Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027835607528686523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.schema_columns_snapshot", "compiled": true, "compiled_code": "\n\n\n    select * from (\n            select\n            \n                \n        cast('dummy_string' as varchar(4096)) as column_state_id\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as full_column_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as full_table_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as column_name\n\n,\n                \n        cast('dummy_string' as varchar(4096)) as data_type\n\n,\n                \n        cast (True as boolean) as is_new\n\n,\n                cast('2091-02-17' as timestamp) as detected_at\n\n,\n                cast('2091-02-17' as timestamp) as created_at\n\n\n        ) as empty_table\n        where 1 = 0\n", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"schema_columns_snapshot\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.562022Z", "completed_at": "2025-03-21T12:20:30.573387Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.575592Z", "completed_at": "2025-03-21T12:20:30.575612Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01596975326538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nexabrands_dbt.check_current_date", "compiled": true, "compiled_code": "select\n    current_date as current_date_value,\n    current_timestamp as current_timestamp_value,\n    current_timestamp::timestamp at time zone 'UTC' as current_utc_timestamp", "relation_name": "\"nexabrands_datawarehouse\".\"nexabrands_dbt\".\"check_current_date\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.582304Z", "completed_at": "2025-03-21T12:20:30.888552Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.895564Z", "completed_at": "2025-03-21T12:20:30.895596Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3217015266418457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nexabrands_dbt.dim_date", "compiled": true, "compiled_code": "-- models/dim_date.sql\nWITH date_spine AS (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1095\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    dateadd(\n        day,\n        row_number() over (order by 1) - 1,\n        cast('2023-01-01' as date)\n        )\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2025-12-31' as date)\n\n)\n\nselect * from filtered\n\n\n),\nenriched_dates AS (\n    SELECT\n        date_day as date,\n        EXTRACT(YEAR FROM date_day) as year,\n        EXTRACT(QUARTER FROM date_day) as quarter,\n        'Q' || EXTRACT(QUARTER FROM date_day) || '-' || EXTRACT(YEAR FROM date_day) as quarter_year,\n        EXTRACT(MONTH FROM date_day) as month_number,\n        TO_CHAR(date_day, 'Month') as month_name,\n        TO_CHAR(date_day, 'Mon-YYYY') as month_year,\n        EXTRACT(WEEK FROM date_day) as week_number,\n        DATE_TRUNC('week', date_day) as week_start_date,\n        DATE_TRUNC('week', date_day) + INTERVAL '6 days' as week_end_date,\n        EXTRACT(DAY FROM date_day) as day_of_month,\n        EXTRACT(DOW FROM date_day) as day_of_week_number,\n        TO_CHAR(date_day, 'Day') as day_name,\n        CASE\n            WHEN EXTRACT(MONTH FROM date_day) >= 4 THEN EXTRACT(YEAR FROM date_day)\n            ELSE EXTRACT(YEAR FROM date_day) - 1\n        END as fiscal_year,\n        CASE\n            WHEN EXTRACT(DOW FROM date_day) IN (0, 6) THEN 0\n            ELSE 1\n        END as is_weekday,\n        TO_CHAR(date_day, 'YYYYMMDD')::INTEGER as date_key\n    FROM date_spine\n)\nSELECT * FROM enriched_dates", "relation_name": "\"nexabrands_datawarehouse\".\"marts\".\"dim_date\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.911689Z", "completed_at": "2025-03-21T12:20:30.926484Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.927462Z", "completed_at": "2025-03-21T12:20:30.927481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02111077308654785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nexabrands_dbt.stg_customer_targets", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT *\n    FROM \"nexabrands_datawarehouse\".\"nexabrands_external\".\"customer_targets\"\n),\nstaged AS (\n    SELECT\n        customer_id,\n        \"ontime_target\",\n        \"infull_target\",\n        \"otif_target\"\n    FROM source\n)\nSELECT *\nFROM staged", "relation_name": "\"nexabrands_datawarehouse\".\"staging\".\"stg_customer_targets\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.932045Z", "completed_at": "2025-03-21T12:20:30.945527Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:30.946483Z", "completed_at": "2025-03-21T12:20:30.946501Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016701221466064453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nexabrands_dbt.stg_customers", "compiled": true, "compiled_code": "-- models/staging/stg_customers.sql\nWITH source AS (\n    SELECT * FROM \"nexabrands_datawarehouse\".\"nexabrands_external\".\"customers\"\n),\nstaged AS (\n    SELECT\n        customer_id,\n        customer_name,\n        city\n    FROM source\n)\nSELECT * FROM staged", "relation_name": "\"nexabrands_datawarehouse\".\"staging\".\"stg_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:30.954623Z", "completed_at": "2025-03-21T12:20:31.160478Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.161461Z", "completed_at": "2025-03-21T12:20:31.161480Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.21414685249328613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nexabrands_dbt.stg_dates", "compiled": true, "compiled_code": "-- models/marts/dim_date.sql\nWITH date_spine AS (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n     + \n    \n    p11.generated_number * power(2, 11)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n     cross join \n    \n    p as p11\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 2191\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    dateadd(\n        day,\n        row_number() over (order by 1) - 1,\n        cast('2020-01-01' as date)\n        )\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2025-12-31' as date)\n\n)\n\nselect * from filtered\n\n\n),\nenriched_dates AS (\n    SELECT\n        date_day as date,\n        -- Year\n        EXTRACT(YEAR FROM date_day) as year,\n        -- Quarter\n        EXTRACT(QUARTER FROM date_day) as quarter,\n        'Q' || EXTRACT(QUARTER FROM date_day) || '-' || EXTRACT(YEAR FROM date_day) as quarter_year,\n        -- Month\n        EXTRACT(MONTH FROM date_day) as month_number,\n        TO_CHAR(date_day, 'Month') as month_name,\n        TO_CHAR(date_day, 'Mon-YYYY') as month_year,\n        -- Week\n        EXTRACT(WEEK FROM date_day) as week_number,\n        DATE_TRUNC('week', date_day) as week_start_date,\n        DATE_TRUNC('week', date_day) + INTERVAL '6 days' as week_end_date,\n        -- Day\n        EXTRACT(DAY FROM date_day) as day_of_month,\n        EXTRACT(DOW FROM date_day) as day_of_week_number,\n        TO_CHAR(date_day, 'Day') as day_name,\n        -- Fiscal year (assuming starts in April)\n        CASE\n            WHEN EXTRACT(MONTH FROM date_day) >= 4\n            THEN EXTRACT(YEAR FROM date_day)\n            ELSE EXTRACT(YEAR FROM date_day) - 1\n        END as fiscal_year,\n        -- Is this a weekday?\n        CASE\n            WHEN EXTRACT(DOW FROM date_day) IN (0, 6) THEN 0\n            ELSE 1\n        END as is_weekday,\n        -- Create date key for joining\n        TO_CHAR(date_day, 'YYYYMMDD')::INTEGER as date_key\n    FROM date_spine\n)\nSELECT * FROM enriched_dates", "relation_name": "\"nexabrands_datawarehouse\".\"staging\".\"stg_dates\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.171344Z", "completed_at": "2025-03-21T12:20:31.180181Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.181114Z", "completed_at": "2025-03-21T12:20:31.181131Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011722087860107422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nexabrands_dbt.stg_order_fulfillment", "compiled": true, "compiled_code": "-- models/staging/stg_order_fulfillment.sql\nWITH source AS (\n    SELECT * FROM \"nexabrands_datawarehouse\".\"nexabrands_external\".\"order_fulfillment\"\n),\nstaged AS (\n    SELECT\n        order_id,\n        on_time,\n        in_full,\n        otif as ontime_in_full\n    FROM source\n)\nSELECT * FROM staged", "relation_name": "\"nexabrands_datawarehouse\".\"staging\".\"stg_order_fulfillment\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.185679Z", "completed_at": "2025-03-21T12:20:31.198294Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.199268Z", "completed_at": "2025-03-21T12:20:31.199285Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015561819076538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nexabrands_dbt.stg_order_lines", "compiled": true, "compiled_code": "-- models/staging/stg_order_lines.sql\nWITH source AS (\n    SELECT * FROM \"nexabrands_datawarehouse\".\"nexabrands_external\".\"order_lines\"\n),\nstaged AS (\n    SELECT\n        order_id,\n        product_id,\n        order_qty,\n        agreed_delivery_date,\n        actual_delivery_date,\n        delivery_qty,\n        \n    md5(cast(coalesce(cast(order_id as TEXT), '') || coalesce(cast(product_id as TEXT), '') as TEXT))\n as order_line_id\n    FROM source\n)\nSELECT * FROM staged", "relation_name": "\"nexabrands_datawarehouse\".\"staging\".\"stg_order_lines\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.203430Z", "completed_at": "2025-03-21T12:20:31.211735Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.212682Z", "completed_at": "2025-03-21T12:20:31.212698Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011164426803588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nexabrands_dbt.stg_orders", "compiled": true, "compiled_code": "-- models/staging/stg_orders.sql\nWITH source AS (\n    SELECT * FROM \"nexabrands_datawarehouse\".\"nexabrands_external\".\"orders\"\n),\nstaged AS (\n    SELECT\n        order_id,\n        customer_id,\n        order_placement_date\n    FROM source\n)\nSELECT * FROM staged", "relation_name": "\"nexabrands_datawarehouse\".\"staging\".\"stg_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.217790Z", "completed_at": "2025-03-21T12:20:31.225905Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.226796Z", "completed_at": "2025-03-21T12:20:31.226813Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011095762252807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nexabrands_dbt.stg_products", "compiled": true, "compiled_code": "-- models/staging/stg_products.sql\nWITH source AS (\n    SELECT * FROM \"nexabrands_datawarehouse\".\"nexabrands_external\".\"products\"\n),\nstaged AS (\n    SELECT\n        product_id,\n        product_name,\n        category\n    FROM source\n)\nSELECT * FROM staged", "relation_name": "\"nexabrands_datawarehouse\".\"staging\".\"stg_products\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.445911Z", "completed_at": "2025-03-21T12:20:31.457423Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.458420Z", "completed_at": "2025-03-21T12:20:31.458437Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01447606086730957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.elementary.elementary-on-run-end-0", "compiled": true, "compiled_code": "\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.462667Z", "completed_at": "2025-03-21T12:20:31.514409Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.515378Z", "completed_at": "2025-03-21T12:20:31.515394Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.054688215255737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.elementary.elementary-on-run-start-0", "compiled": true, "compiled_code": "\n  \n  \n\n  \n  \n  \n\n  \n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.520931Z", "completed_at": "2025-03-21T12:20:31.530282Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.531369Z", "completed_at": "2025-03-21T12:20:31.531387Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01363372802734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.nexabrands_dbt.scd_customers", "compiled": true, "compiled_code": "\n\n\nselect *\nFROM  \"nexabrands_datawarehouse\".\"nexabrands_external\".\"customers\"\n", "relation_name": "\"nexabrands_datawarehouse\".\"nexabrands_external\".\"scd_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.535703Z", "completed_at": "2025-03-21T12:20:31.544025Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.545063Z", "completed_at": "2025-03-21T12:20:31.545079Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011341333389282227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.nexabrands_dbt.scd_orders", "compiled": true, "compiled_code": "\n\n\nselect *\nFROM  \"nexabrands_datawarehouse\".\"nexabrands_external\".\"orders\"\n", "relation_name": "\"nexabrands_datawarehouse\".\"nexabrands_external\".\"scd_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.549439Z", "completed_at": "2025-03-21T12:20:31.556267Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.557174Z", "completed_at": "2025-03-21T12:20:31.557192Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009735822677612305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.test_delivery_dates_consistency", "compiled": true, "compiled_code": "", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.562427Z", "completed_at": "2025-03-21T12:20:31.571972Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.572921Z", "completed_at": "2025-03-21T12:20:31.572938Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012787103652954102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.test_delivery_quantities_consistency", "compiled": true, "compiled_code": "", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.580040Z", "completed_at": "2025-03-21T12:20:31.737397Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.738392Z", "completed_at": "2025-03-21T12:20:31.738410Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.16241788864135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.metrics_anomaly_score", "compiled": true, "compiled_code": "\n\nwith data_monitoring_metrics as (\n\n    select * from \"nexabrands_datawarehouse\".\"elementary\".\"data_monitoring_metrics\"\n\n),\n\ntime_window_aggregation as (\n\n    select\n        id,\n        full_table_name,\n        column_name,\n        dimension,\n        dimension_value,\n        metric_name,\n        metric_value,\n        source_value,\n        bucket_start,\n        bucket_end,\n        bucket_duration_hours,\n        updated_at,\n        avg(metric_value) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_avg,\n        stddev(metric_value) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_stddev,\n        count(metric_value) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_set_size,\n        last_value(bucket_end) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) training_end,\n        first_value(bucket_end) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_start\n    from data_monitoring_metrics\n    group by 1,2,3,4,5,6,7,8,9,10,11,12\n),\n\nmetrics_anomaly_score as (\n\n    select\n        id,\n        full_table_name,\n        column_name,\n        dimension,\n        dimension_value,\n        metric_name,\n        case\n            when training_stddev is null then null\n            when training_stddev = 0 then 0\n            else (metric_value - training_avg) / (training_stddev)\n        end as anomaly_score,\n        metric_value as latest_metric_value,\n        bucket_start,\n        bucket_end,\n        training_avg,\n        training_stddev,\n        training_start,\n        training_end,\n        training_set_size,\n        max(updated_at) as updated_at\n    from time_window_aggregation\n        where\n            metric_value is not null\n            and training_avg is not null\n            and bucket_end >= \n    dateadd(day, cast(-7 as integer), cast(date_trunc('day', getdate()) as timestamp))\n\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15\n    order by bucket_end desc\n\n\n),\n\nfinal as (\n\n    select\n        id,\n        full_table_name,\n        column_name,\n        dimension,\n        dimension_value,\n        metric_name,\n        anomaly_score,\n        latest_metric_value,\n        bucket_start,\n        bucket_end,\n        training_avg,\n        training_stddev,\n        training_start,\n        training_end,\n        training_set_size,\n        updated_at,\n        case\n            when abs(anomaly_score) > 3 then true\n            else false end\n        as is_anomaly\n    from metrics_anomaly_score\n)\n\nselect * from final", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"metrics_anomaly_score\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.742778Z", "completed_at": "2025-03-21T12:20:31.752667Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.753584Z", "completed_at": "2025-03-21T12:20:31.753601Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01275777816772461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.monitors_runs", "compiled": true, "compiled_code": "\n\nwith data_monitoring_metrics as (\n\n    select * from \"nexabrands_datawarehouse\".\"elementary\".\"data_monitoring_metrics\"\n\n),\n\nmax_bucket_end as (\n\n    select full_table_name,\n           column_name,\n           metric_name,\n           metric_properties,\n           max(bucket_end) as last_bucket_end,\n           min(bucket_end) as first_bucket_end\n    from data_monitoring_metrics\n    group by 1,2,3,4\n\n)\n\nselect * from max_bucket_end", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"monitors_runs\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.757731Z", "completed_at": "2025-03-21T12:20:31.771621Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.772722Z", "completed_at": "2025-03-21T12:20:31.772739Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01703953742980957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.job_run_results", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith jobs as (\n  select\n    job_name,\n    job_id,\n    job_run_id,\n    \nmin(cast(run_started_at as timestamp))\n as job_run_started_at,\n    \nmax(cast(run_completed_at as timestamp))\n as job_run_completed_at,\n    \n    datediff(\n        second,\n        \nmin(cast(run_started_at as timestamp))\n,\n        \nmax(cast(run_completed_at as timestamp))\n\n        )\n as job_run_execution_time\n  from \"nexabrands_datawarehouse\".\"elementary\".\"dbt_invocations\"\n  where job_id is not null\n  group by job_name, job_id, job_run_id\n)\n\nselect\n  job_name as name,\n  job_id as id,\n  job_run_id as run_id,\n  job_run_started_at as run_started_at,\n  job_run_completed_at as run_completed_at,\n  job_run_execution_time as run_execution_time\nfrom jobs", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"job_run_results\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.776963Z", "completed_at": "2025-03-21T12:20:31.792372Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.793306Z", "completed_at": "2025-03-21T12:20:31.793322Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0182950496673584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.model_run_results", "compiled": true, "compiled_code": "\n\nwith dbt_run_results as (\n    select * from \"nexabrands_datawarehouse\".\"elementary\".\"dbt_run_results\"\n),\n\ndbt_models as (\n    select * from \"nexabrands_datawarehouse\".\"elementary\".\"dbt_models\"\n)\n\nSELECT\n    run_results.model_execution_id,\n    run_results.unique_id,\n    run_results.invocation_id,\n    run_results.query_id,\n    run_results.name,\n    run_results.generated_at,\n    run_results.status,\n    run_results.full_refresh,\n    run_results.message,\n    run_results.execution_time,\n    run_results.execute_started_at,\n    run_results.execute_completed_at,\n    run_results.compile_started_at,\n    run_results.compile_completed_at,\n    run_results.compiled_code,\n    run_results.adapter_response,\n    run_results.thread_id,\n    models.database_name,\n    models.schema_name,\n    coalesce(run_results.materialization, models.materialization) as materialization,\n    models.tags,\n    models.package_name,\n    models.path,\n    models.original_path,\n    models.owner,\n    models.alias,\n    ROW_NUMBER() OVER (PARTITION BY run_results.unique_id ORDER BY run_results.generated_at DESC) AS model_invocation_reverse_index,\n    CASE WHEN FIRST_VALUE(invocation_id) OVER (PARTITION BY \n    date_trunc('day', cast(run_results.generated_at as timestamp))\n ORDER BY run_results.generated_at ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING ) = invocation_id\n              THEN TRUE\n              ELSE FALSE \n         END                                                               AS is_the_first_invocation_of_the_day,\n    CASE WHEN LAST_VALUE(invocation_id) OVER (PARTITION BY \n    date_trunc('day', cast(run_results.generated_at as timestamp))\n ORDER BY run_results.generated_at ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING ) = invocation_id\n              THEN TRUE\n              ELSE FALSE \n         END                                                               AS is_the_last_invocation_of_the_day\n    \nFROM dbt_run_results run_results\nJOIN dbt_models models ON run_results.unique_id = models.unique_id", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"model_run_results\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.797423Z", "completed_at": "2025-03-21T12:20:31.807710Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.808658Z", "completed_at": "2025-03-21T12:20:31.808676Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013149499893188477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.seed_run_results", "compiled": true, "compiled_code": "\n\nwith dbt_run_results as (\n    select * from \"nexabrands_datawarehouse\".\"elementary\".\"dbt_run_results\"\n),\n\ndbt_seeds as (\n    select * from \"nexabrands_datawarehouse\".\"elementary\".\"dbt_seeds\"\n)\n\nSELECT\n    run_results.model_execution_id,\n    run_results.unique_id,\n    run_results.invocation_id,\n    run_results.query_id,\n    run_results.name,\n    run_results.generated_at,\n    run_results.status,\n    run_results.full_refresh,\n    run_results.message,\n    run_results.execution_time,\n    run_results.execute_started_at,\n    run_results.execute_completed_at,\n    run_results.compile_started_at,\n    run_results.compile_completed_at,\n    run_results.compiled_code,\n    run_results.adapter_response,\n    run_results.thread_id,\n    seeds.database_name,\n    seeds.schema_name,\n    run_results.materialization,\n    seeds.tags,\n    seeds.package_name,\n    seeds.path,\n    seeds.original_path,\n    seeds.owner,\n    seeds.alias\nFROM dbt_run_results run_results\nJOIN dbt_seeds seeds ON run_results.unique_id = seeds.unique_id", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"seed_run_results\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.813139Z", "completed_at": "2025-03-21T12:20:31.823868Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.824822Z", "completed_at": "2025-03-21T12:20:31.824842Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013908624649047852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.snapshot_run_results", "compiled": true, "compiled_code": "\n\nwith dbt_run_results as (\n    select * from \"nexabrands_datawarehouse\".\"elementary\".\"dbt_run_results\"\n),\n\ndbt_snapshots as (\n    select * from \"nexabrands_datawarehouse\".\"elementary\".\"dbt_snapshots\"\n)\n\nSELECT\n    run_results.model_execution_id,\n    run_results.unique_id,\n    run_results.invocation_id,\n    run_results.query_id,\n    run_results.name,\n    run_results.generated_at,\n    run_results.status,\n    run_results.full_refresh,\n    run_results.message,\n    run_results.execution_time,\n    run_results.execute_started_at,\n    run_results.execute_completed_at,\n    run_results.compile_started_at,\n    run_results.compile_completed_at,\n    run_results.compiled_code,\n    run_results.adapter_response,\n    run_results.thread_id,\n    snapshots.database_name,\n    snapshots.schema_name,\n    coalesce(run_results.materialization, snapshots.materialization) as materialization,\n    snapshots.tags,\n    snapshots.package_name,\n    snapshots.path,\n    snapshots.original_path,\n    snapshots.owner,\n    snapshots.alias\nFROM dbt_run_results run_results\nJOIN dbt_snapshots snapshots ON run_results.unique_id = snapshots.unique_id", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"snapshot_run_results\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.829239Z", "completed_at": "2025-03-21T12:20:31.842409Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.843325Z", "completed_at": "2025-03-21T12:20:31.843341Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016039133071899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.alerts_dbt_source_freshness", "compiled": true, "compiled_code": "\n\nwith results as (\n  select * from \"nexabrands_datawarehouse\".\"elementary\".\"dbt_source_freshness_results\"\n),\n\nsources as (\n  select * from \"nexabrands_datawarehouse\".\"elementary\".\"dbt_sources\"\n)\n\nselect\n  results.source_freshness_execution_id as alert_id,\n  results.max_loaded_at,\n  results.snapshotted_at,\n  cast(results.generated_at as timestamp) as detected_at,\n  results.max_loaded_at_time_ago_in_s,\n  results.status,\n  results.error,\n  results.warn_after,\n  results.error_after,\n  results.filter,\n  sources.unique_id,\n  sources.database_name,\n  sources.schema_name,\n  sources.source_name,\n  sources.identifier,\n  sources.tags,\n  sources.meta,\n  sources.owner,\n  sources.package_name,\n  sources.path,\n  -- These columns below are deprecated. We add them since this view\n  -- was used to be loaded into an incremental model with those columns, their names were later changed\n  -- and Databricks doesn't respect `on_schema_change = 'append_new_columns'` properly, as described here -\n  -- https://docs.databricks.com/en/delta/update-schema.html#automatic-schema-evolution-for-delta-lake-merge\n  results.error_after as freshness_error_after,\n  results.warn_after as freshness_warn_after,\n  results.filter as freshness_filter\nfrom results\njoin sources on results.unique_id = sources.unique_id\nwhere True and lower(status) != 'pass'", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"alerts_dbt_source_freshness\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.847628Z", "completed_at": "2025-03-21T12:20:31.860905Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.861827Z", "completed_at": "2025-03-21T12:20:31.861844Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01629948616027832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.dbt_artifacts_hashes", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n  'dbt_models' as artifacts_model,\n   metadata_hash\nfrom \"nexabrands_datawarehouse\".\"elementary\".\"dbt_models\"\n union all \n\nselect\n  'dbt_tests' as artifacts_model,\n   metadata_hash\nfrom \"nexabrands_datawarehouse\".\"elementary\".\"dbt_tests\"\n union all \n\nselect\n  'dbt_sources' as artifacts_model,\n   metadata_hash\nfrom \"nexabrands_datawarehouse\".\"elementary\".\"dbt_sources\"\n union all \n\nselect\n  'dbt_snapshots' as artifacts_model,\n   metadata_hash\nfrom \"nexabrands_datawarehouse\".\"elementary\".\"dbt_snapshots\"\n union all \n\nselect\n  'dbt_metrics' as artifacts_model,\n   metadata_hash\nfrom \"nexabrands_datawarehouse\".\"elementary\".\"dbt_metrics\"\n union all \n\nselect\n  'dbt_exposures' as artifacts_model,\n   metadata_hash\nfrom \"nexabrands_datawarehouse\".\"elementary\".\"dbt_exposures\"\n union all \n\nselect\n  'dbt_seeds' as artifacts_model,\n   metadata_hash\nfrom \"nexabrands_datawarehouse\".\"elementary\".\"dbt_seeds\"\n union all \n\nselect\n  'dbt_columns' as artifacts_model,\n   metadata_hash\nfrom \"nexabrands_datawarehouse\".\"elementary\".\"dbt_columns\"\n\n\norder by metadata_hash", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"dbt_artifacts_hashes\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.865867Z", "completed_at": "2025-03-21T12:20:31.881691Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.882682Z", "completed_at": "2025-03-21T12:20:31.882698Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018693208694458008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.alerts_anomaly_detection", "compiled": true, "compiled_code": "\n\nwith elementary_test_results as (\n    select * from \"nexabrands_datawarehouse\".\"elementary\".\"elementary_test_results\"\n),\n\nalerts_anomaly_detection as (\n    select id as alert_id,\n           data_issue_id,\n           test_execution_id,\n           test_unique_id,\n           model_unique_id,\n           detected_at,\n           database_name,\n           schema_name,\n           table_name,\n           column_name,\n           test_type as alert_type,\n           test_sub_type as sub_type,\n           test_results_description as alert_description,\n           owners,\n           tags,\n           test_results_query as alert_results_query,\n           other,\n           test_name,\n           test_short_name,\n           test_params,\n           severity,\n           status,\n           result_rows\n        from elementary_test_results\n        where True and lower(status) != 'pass'and lower(status) != 'skipped'and test_type = 'anomaly_detection'\n)\n\nselect * from alerts_anomaly_detection", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"alerts_anomaly_detection\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.886846Z", "completed_at": "2025-03-21T12:20:31.900821Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.901749Z", "completed_at": "2025-03-21T12:20:31.901765Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016843080520629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.alerts_dbt_tests", "compiled": true, "compiled_code": "\n\nwith elementary_test_results as (\n    select * from \"nexabrands_datawarehouse\".\"elementary\".\"elementary_test_results\"\n),\n\nalerts_dbt_tests as (\n    select id as alert_id,\n           data_issue_id,\n           test_execution_id,\n           test_unique_id,\n           model_unique_id,\n           detected_at,\n           database_name,\n           schema_name,\n           table_name,\n           column_name,\n           test_type as alert_type,\n           test_sub_type as sub_type,\n           test_results_description as alert_description,\n           owners,\n           tags,\n           test_results_query as alert_results_query,\n           other,\n           test_name,\n           test_short_name,\n           test_params,\n           severity,\n           status,\n           result_rows\n        from elementary_test_results\n        where True and lower(status) != 'pass'   and lower(status) != 'skipped'  and test_type = 'dbt_test'\n)\n\nselect * from alerts_dbt_tests", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"alerts_dbt_tests\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.908765Z", "completed_at": "2025-03-21T12:20:31.924922Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.925773Z", "completed_at": "2025-03-21T12:20:31.925785Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018981218338012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.alerts_schema_changes", "compiled": true, "compiled_code": "\n\n\nwith elementary_test_results as (\n    select * from \"nexabrands_datawarehouse\".\"elementary\".\"elementary_test_results\"\n),\n\nalerts_schema_changes as (\n    select id as alert_id,\n           data_issue_id,\n           test_execution_id,\n           test_unique_id,\n           model_unique_id,\n           detected_at,\n           database_name,\n           schema_name,\n           table_name,\n           column_name,\n           test_type as alert_type,\n           test_sub_type as sub_type,\n           test_results_description as alert_description,\n           owners,\n           tags,\n           test_results_query as alert_results_query,\n           other,\n           test_name,\n           test_short_name,\n           test_params,\n           severity,\n           status,\n           result_rows\n        from elementary_test_results\n        where True and lower(status) != 'pass'and lower(status) != 'skipped'and test_type = 'schema_change'\n)\n\nselect * from alerts_schema_changes", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"alerts_schema_changes\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.929922Z", "completed_at": "2025-03-21T12:20:31.956592Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.957525Z", "completed_at": "2025-03-21T12:20:31.957541Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.029439926147460938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.test_result_rows", "compiled": true, "compiled_code": "-- indexes are not supported in all warehouses, relevant to postgres only\n\n\n-- depends_on: \"nexabrands_datawarehouse\".\"elementary\".\"elementary_test_results\"\nselect * from (\n            select\n            \n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as elementary_test_results_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as varchar(65535)) as result_row\n\n,\n                cast('2091-02-17' as timestamp) as detected_at\n\n,\n                cast('2091-02-17' as timestamp) as created_at\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"test_result_rows\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.961716Z", "completed_at": "2025-03-21T12:20:31.973650Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.974604Z", "completed_at": "2025-03-21T12:20:31.974621Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014859914779663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_infull_target__otif_target__True.5277415478", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  infull_target >= otif_target as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_customer_targets\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.978773Z", "completed_at": "2025-03-21T12:20:31.989961Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:31.990874Z", "completed_at": "2025-03-21T12:20:31.990891Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014029979705810547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_pair_values_A_to_be_greater_than_B_stg_customer_targets_ontime_target__otif_target__True.e07a51facc", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  ontime_target >= otif_target as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_customer_targets\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:31.994972Z", "completed_at": "2025-03-21T12:20:32.006374Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.007306Z", "completed_at": "2025-03-21T12:20:32.007323Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0143890380859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_infull_target__100__0.d5824578f5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and infull_target >= 0 and infull_target <= 100\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_customer_targets\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.011545Z", "completed_at": "2025-03-21T12:20:32.023481Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.024426Z", "completed_at": "2025-03-21T12:20:32.024442Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014863252639770508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_ontime_target__100__0.41469dcdf6", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and ontime_target >= 0 and ontime_target <= 100\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_customer_targets\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.028666Z", "completed_at": "2025-03-21T12:20:32.043186Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.044131Z", "completed_at": "2025-03-21T12:20:32.044147Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017476558685302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_customer_targets_otif_target__100__0.20c157cf69", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and otif_target >= 0 and otif_target <= 100\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_customer_targets\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.048278Z", "completed_at": "2025-03-21T12:20:32.068107Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.069052Z", "completed_at": "2025-03-21T12:20:32.069068Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022732019424438477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_customer_targets_customer_id.528be64241", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_customer_targets\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.073330Z", "completed_at": "2025-03-21T12:20:32.083806Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.084799Z", "completed_at": "2025-03-21T12:20:32.084816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013509273529052734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_customer_targets_infull_target.848a26f728", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect infull_target\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_customer_targets\"\nwhere infull_target is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.089748Z", "completed_at": "2025-03-21T12:20:32.101029Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.102133Z", "completed_at": "2025-03-21T12:20:32.102151Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01455998420715332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_customer_targets_ontime_target.5042478108", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ontime_target\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_customer_targets\"\nwhere ontime_target is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.106523Z", "completed_at": "2025-03-21T12:20:32.120779Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.121689Z", "completed_at": "2025-03-21T12:20:32.121705Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017162561416625977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_customer_targets_otif_target.74d072ca2a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect otif_target\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_customer_targets\"\nwhere otif_target is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.125998Z", "completed_at": "2025-03-21T12:20:32.142551Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.143860Z", "completed_at": "2025-03-21T12:20:32.143879Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019814252853393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.unique_stg_customer_targets_customer_id.eada6988f9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_customer_targets\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.148225Z", "completed_at": "2025-03-21T12:20:32.157063Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.158020Z", "completed_at": "2025-03-21T12:20:32.158041Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01183629035949707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nexabrands_dbt.dim_customer", "compiled": true, "compiled_code": "-- models/dim_customers.sql\nWITH customers AS (\n    SELECT *\n    FROM \"nexabrands_datawarehouse\".\"staging\".\"stg_customers\"\n),\ncustomer_targets AS (\n    SELECT *\n    FROM \"nexabrands_datawarehouse\".\"staging\".\"stg_customer_targets\"\n)\nSELECT\n    c.customer_id,\n    c.customer_name,\n    c.city,\n    ct.ontime_target,\n    ct.infull_target,\n    ct.otif_target\nFROM customers c\nLEFT JOIN customer_targets ct\n    ON c.customer_id = ct.customer_id", "relation_name": "\"nexabrands_datawarehouse\".\"marts\".\"dim_customer\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.162615Z", "completed_at": "2025-03-21T12:20:32.174518Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.175514Z", "completed_at": "2025-03-21T12:20:32.175531Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015012025833129883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.accepted_values_stg_customers_city__True__Klerksdorp__Polokwane__Stellenbosch__Paarl__East_London__Grahamstown__George__Upington__Bloemfontein__Worcester__Pietermaritzburg__Pretoria__Nelspruit__Kimberley__Johannesburg__Cape_Town.e541883a0e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        city as value_field,\n        count(*) as n_records\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_customers\"\n    group by city\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Klerksdorp','Polokwane','Stellenbosch','Paarl','East London','Grahamstown','George','Upington','Bloemfontein','Worcester','Pietermaritzburg','Pretoria','Nelspruit','Kimberley','Johannesburg','Cape Town'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.180157Z", "completed_at": "2025-03-21T12:20:32.195564Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.196519Z", "completed_at": "2025-03-21T12:20:32.196546Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018472909927368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_city__50__2.75f73ba182", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and len(\n        city\n    ) >= 2 and len(\n        city\n    ) <= 50\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_customers\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.200979Z", "completed_at": "2025-03-21T12:20:32.213152Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.214139Z", "completed_at": "2025-03-21T12:20:32.214158Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01523137092590332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_customers_customer_name__100__2.862ed945bf", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and len(\n        customer_name\n    ) >= 2 and len(\n        customer_name\n    ) <= 100\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_customers\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.218589Z", "completed_at": "2025-03-21T12:20:32.519405Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.520406Z", "completed_at": "2025-03-21T12:20:32.520426Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3121328353881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_customers_customer_id__customer_name__city.68cf07e70d", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n    ),\n    input_columns as (\n\n        \n        select cast('CUSTOMER_ID' as TEXT) as input_column\n        union all\n        \n        select cast('CUSTOMER_NAME' as TEXT) as input_column\n        union all\n        \n        select cast('CITY' as TEXT) as input_column\n        \n        \n    )\n    select *\n    from\n        relation_columns r\n        full outer join\n        input_columns i on r.relation_column = i.input_column\n    where\n        -- catch any column in input list that is not in the list of table columns\n        -- or any table column that is not in the input list\n        r.relation_column is null or\n        i.input_column is null", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.533652Z", "completed_at": "2025-03-21T12:20:32.548392Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.549389Z", "completed_at": "2025-03-21T12:20:32.549407Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017899513244628906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_customers_100__1.532da0c1f4", "compiled": true, "compiled_code": "\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and count(*) >= 1 and count(*) <= 100\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_customers\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.556379Z", "completed_at": "2025-03-21T12:20:32.570974Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.571937Z", "completed_at": "2025-03-21T12:20:32.571955Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017794370651245117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_customers_city.54fe47bfb8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect city\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_customers\"\nwhere city is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.579323Z", "completed_at": "2025-03-21T12:20:32.590464Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.591420Z", "completed_at": "2025-03-21T12:20:32.591437Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01415705680847168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.595826Z", "completed_at": "2025-03-21T12:20:32.610352Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.611269Z", "completed_at": "2025-03-21T12:20:32.611285Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017485380172729492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_customers_customer_name.5c92a78a60", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_name\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_customers\"\nwhere customer_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.615597Z", "completed_at": "2025-03-21T12:20:32.626474Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.627462Z", "completed_at": "2025-03-21T12:20:32.627478Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013922929763793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.631779Z", "completed_at": "2025-03-21T12:20:32.643676Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.644671Z", "completed_at": "2025-03-21T12:20:32.644688Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01499176025390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_equal_stg_dates_date__10.ddb94d6f63", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n    len(\n        date\n    ) = 10 as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_dates\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.649013Z", "completed_at": "2025-03-21T12:20:32.911863Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.912826Z", "completed_at": "2025-03-21T12:20:32.912844Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.27246856689453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_dates_date.2d0c578b06", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n    ),\n    input_columns as (\n\n        \n        select cast('DATE' as TEXT) as input_column\n        \n        \n    )\n    select *\n    from\n        relation_columns r\n        full outer join\n        input_columns i on r.relation_column = i.input_column\n    where\n        -- catch any column in input list that is not in the list of table columns\n        -- or any table column that is not in the input list\n        r.relation_column is null or\n        i.input_column is null", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.924144Z", "completed_at": "2025-03-21T12:20:32.938475Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.939384Z", "completed_at": "2025-03-21T12:20:32.939402Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0173037052154541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_dates_1.719d3ad97a", "compiled": true, "compiled_code": "\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and count(*) >= 1\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_dates\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.943904Z", "completed_at": "2025-03-21T12:20:32.955375Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.956453Z", "completed_at": "2025-03-21T12:20:32.956471Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014745473861694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_dates_date.0b6295f5bd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_dates\"\nwhere date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.961346Z", "completed_at": "2025-03-21T12:20:32.974742Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.975948Z", "completed_at": "2025-03-21T12:20:32.975965Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016893386840820312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_in_full__True__0__1.4b722af630", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        in_full as value_field,\n        count(*) as n_records\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_order_fulfillment\"\n    group by in_full\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '0','1'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:32.980975Z", "completed_at": "2025-03-21T12:20:32.995448Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:32.996353Z", "completed_at": "2025-03-21T12:20:32.996372Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017708539962768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_on_time__True__0__1.8bc1473d95", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        on_time as value_field,\n        count(*) as n_records\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_order_fulfillment\"\n    group by on_time\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '0','1'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.000510Z", "completed_at": "2025-03-21T12:20:33.011519Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:33.012429Z", "completed_at": "2025-03-21T12:20:33.012446Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013831853866577148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.accepted_values_stg_order_fulfillment_ontime_in_full__True__0__1.3b38ec7b73", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        ontime_in_full as value_field,\n        count(*) as n_records\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_order_fulfillment\"\n    group by ontime_in_full\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '0','1'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.016656Z", "completed_at": "2025-03-21T12:20:33.262762Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:33.263794Z", "completed_at": "2025-03-21T12:20:33.263814Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.25516438484191895, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_set_stg_order_fulfillment_order_id__on_time__in_full__ontime_in_full.4d470eb185", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n    ),\n    input_columns as (\n\n        \n        select cast('ORDER_ID' as TEXT) as input_column\n        union all\n        \n        select cast('ON_TIME' as TEXT) as input_column\n        union all\n        \n        select cast('IN_FULL' as TEXT) as input_column\n        union all\n        \n        select cast('ONTIME_IN_FULL' as TEXT) as input_column\n        \n        \n    )\n    select *\n    from\n        relation_columns r\n        full outer join\n        input_columns i on r.relation_column = i.input_column\n    where\n        -- catch any column in input list that is not in the list of table columns\n        -- or any table column that is not in the input list\n        r.relation_column is null or\n        i.input_column is null", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.273359Z", "completed_at": "2025-03-21T12:20:33.289395Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:33.290408Z", "completed_at": "2025-03-21T12:20:33.290425Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018480777740478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_order_fulfillment_1.0283bc6212", "compiled": true, "compiled_code": "\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and count(*) >= 1\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_order_fulfillment\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.294794Z", "completed_at": "2025-03-21T12:20:33.306473Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:33.307422Z", "completed_at": "2025-03-21T12:20:33.307441Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014688968658447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_order_fulfillment_in_full.7f52ec5fb8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect in_full\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_order_fulfillment\"\nwhere in_full is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.311728Z", "completed_at": "2025-03-21T12:20:33.323002Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:33.327881Z", "completed_at": "2025-03-21T12:20:33.327903Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018132686614990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_order_fulfillment_on_time.cb8d53a996", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect on_time\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_order_fulfillment\"\nwhere on_time is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.333697Z", "completed_at": "2025-03-21T12:20:33.346060Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:33.347026Z", "completed_at": "2025-03-21T12:20:33.347043Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01593756675720215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_order_fulfillment_ontime_in_full.d8e8bdce2a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ontime_in_full\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_order_fulfillment\"\nwhere ontime_in_full is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.351986Z", "completed_at": "2025-03-21T12:20:33.364368Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:33.365379Z", "completed_at": "2025-03-21T12:20:33.365398Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015610218048095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nexabrands_dbt.fact_order_line_performance", "compiled": true, "compiled_code": "-- models/fact_order_line_performance.sql\nWITH order_lines AS (\n    SELECT *\n    FROM \"nexabrands_datawarehouse\".\"staging\".\"stg_order_lines\"\n),\norders AS (\n    SELECT order_id, customer_id, order_placement_date\n    FROM \"nexabrands_datawarehouse\".\"staging\".\"stg_orders\"\n)\nSELECT\n    ol.order_line_id,\n    ol.order_id,\n    ol.product_id,\n    ol.order_qty,\n    ol.delivery_qty,\n    ol.agreed_delivery_date,\n    ol.actual_delivery_date,\n    -- Calculate Volume Fill Rate: delivered_qty / order_qty (as a decimal)\n    CASE\n        WHEN ol.order_qty > 0 THEN (ol.delivery_qty::numeric / ol.order_qty)\n        ELSE NULL\n    END AS volume_fill_rate,\n    -- Calculate Line Fill Rate: 1 if fully delivered, else 0\n    CASE\n        WHEN ol.delivery_qty = ol.order_qty THEN 1\n        ELSE 0\n    END AS line_fill_rate\nFROM order_lines ol\nJOIN orders o\n    ON ol.order_id = o.order_id", "relation_name": "\"nexabrands_datawarehouse\".\"marts\".\"fact_order_line_performance\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.370513Z", "completed_at": "2025-03-21T12:20:33.385404Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:33.386874Z", "completed_at": "2025-03-21T12:20:33.386892Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018915176391601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nexabrands_dbt.fact_order_performance", "compiled": true, "compiled_code": "WITH orders AS (\n    SELECT *\n    FROM \"nexabrands_datawarehouse\".\"staging\".\"stg_orders\"\n),\n\norder_fulfillment AS (\n    SELECT *\n    FROM \"nexabrands_datawarehouse\".\"staging\".\"stg_order_fulfillment\"\n),\n\ncustomers AS (\n    SELECT *\n    FROM \"nexabrands_datawarehouse\".\"staging\".\"stg_customers\"\n),\n\n-- First get the base order data with fulfillment metrics\nbase_orders AS (\n    SELECT\n        o.order_id,\n        o.customer_id,\n        COALESCE(c.customer_name, 'Unknown') as customer_name,\n        COALESCE(c.city, 'Unknown') as city,\n        DATE_TRUNC('day', o.order_placement_date) AS order_date,\n        ofu.on_time,\n        ofu.in_full,\n        ofu.ontime_in_full AS otif\n    FROM orders o\n    JOIN order_fulfillment ofu\n        ON o.order_id = ofu.order_id\n    LEFT JOIN customers c\n        ON o.customer_id = c.customer_id\n),\n\n-- Calculate daily aggregates by city and customer\ndaily_metrics AS (\n    SELECT\n        order_date,\n        city,\n        customer_name,\n        COUNT(*) AS total_orders,\n        ROUND(100.0 * AVG(on_time), 2) AS on_time_percentage,\n        ROUND(100.0 * AVG(in_full), 2) AS in_full_percentage,\n        ROUND(100.0 * AVG(otif), 2) AS otif_percentage\n    FROM base_orders\n    GROUP BY order_date, city, customer_name\n),\n\n-- Calculate rolling 7-day averages\nrolling_metrics AS (\n    SELECT\n        order_date,\n        city,\n        customer_name,\n        total_orders,\n        on_time_percentage,\n        in_full_percentage,\n        otif_percentage,\n        ROUND(AVG(on_time_percentage) OVER (\n            PARTITION BY city, customer_name\n            ORDER BY order_date\n            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW\n        ), 2) AS seven_day_avg_on_time,\n        ROUND(AVG(in_full_percentage) OVER (\n            PARTITION BY city, customer_name\n            ORDER BY order_date\n            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW\n        ), 2) AS seven_day_avg_in_full,\n        ROUND(AVG(otif_percentage) OVER (\n            PARTITION BY city, customer_name\n            ORDER BY order_date\n            ROWS BETWEEN 6 PRECEDING AND CURRENT ROW\n        ), 2) AS seven_day_avg_otif\n    FROM daily_metrics\n)\n\nSELECT * FROM rolling_metrics\nORDER BY order_date DESC, city, customer_name", "relation_name": "\"nexabrands_datawarehouse\".\"marts\".\"fact_order_performance\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.392597Z", "completed_at": "2025-03-21T12:20:33.410940Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:33.412123Z", "completed_at": "2025-03-21T12:20:33.412142Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02190542221069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nexabrands_dbt.fact_order_performance_percentage", "compiled": true, "compiled_code": "WITH orders AS (\n    SELECT *\n    FROM \"nexabrands_datawarehouse\".\"staging\".\"stg_orders\"\n),\norder_fulfillment AS (\n    SELECT *\n    FROM \"nexabrands_datawarehouse\".\"staging\".\"stg_order_fulfillment\"\n),\njoined_data AS (\n    SELECT\n        o.order_id,\n        o.customer_id,\n        o.order_placement_date AS order_date,  -- to join with dim_date if needed\n        ofu.on_time,\n        ofu.in_full,\n        ofu.ontime_in_full AS otif\n    FROM orders o\n    JOIN order_fulfillment ofu\n        ON o.order_id = ofu.order_id\n)\nSELECT\n    ROUND((SUM(on_time::numeric) / COUNT(*)) * 100, 2) AS on_time_percentage,\n    ROUND((SUM(in_full::numeric) / COUNT(*)) * 100, 2) AS in_full_percentage,\n    ROUND((SUM(otif::numeric) / COUNT(*)) * 100, 2) AS otif_percentage\nFROM joined_data", "relation_name": "\"nexabrands_datawarehouse\".\"marts\".\"fact_order_performance_percentage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.424269Z", "completed_at": "2025-03-21T12:20:33.444950Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:33.446591Z", "completed_at": "2025-03-21T12:20:33.446654Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03086066246032715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_customer_id__50__1.4bd54d8012", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and len(\n        customer_id\n    ) >= 1 and len(\n        customer_id\n    ) <= 50\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_orders\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.452971Z", "completed_at": "2025-03-21T12:20:33.472907Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:33.474321Z", "completed_at": "2025-03-21T12:20:33.474343Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024007081985473633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_orders_order_id__50__1.0ecb6709db", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and len(\n        order_id\n    ) >= 1 and len(\n        order_id\n    ) <= 50\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_orders\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.480044Z", "completed_at": "2025-03-21T12:20:33.503295Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:33.504290Z", "completed_at": "2025-03-21T12:20:33.504308Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026936054229736328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_orders_order_placement_date__current_date___2024_01_01_.9a31a15386", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and order_placement_date >= '2024-01-01' and order_placement_date <= current_date\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_orders\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.514006Z", "completed_at": "2025-03-21T12:20:33.870766Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:33.877075Z", "completed_at": "2025-03-21T12:20:33.877095Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3781280517578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_of_type_stg_orders_order_placement_date__date.518b599ba0", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'ORDER_PLACEMENT_DATE'\n            and\n            relation_column_type not in ('DATE')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.893470Z", "completed_at": "2025-03-21T12:20:33.907899Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:33.908904Z", "completed_at": "2025-03-21T12:20:33.908920Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017450809478759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_orders_customer_id__order_placement_date__order_id.c72b454e6a", "compiled": true, "compiled_code": "\n\n\n\nwith validation_errors as (\n\n    select\n        customer_id,order_placement_date,order_id,\n        count(*) as \"n_records\"\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_orders\"\n    where\n        1=1\n        and \n    not (\n        customer_id is null and \n        order_placement_date is null and \n        order_id is null\n        \n    )\n\n\n    \n    group by\n        customer_id,order_placement_date,order_id\n    having count(*) > 1\n\n)\nselect * from validation_errors\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:33.915061Z", "completed_at": "2025-03-21T12:20:34.219629Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.220647Z", "completed_at": "2025-03-21T12:20:34.220665Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3140707015991211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_orders_order_id__customer_id__order_placement_date.26d5dbb404", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n    ),\n    input_columns as (\n\n        \n        select\n            1 as input_column_idx,\n            cast('ORDER_ID' as TEXT) as input_column\n        union all\n        \n        select\n            2 as input_column_idx,\n            cast('CUSTOMER_ID' as TEXT) as input_column\n        union all\n        \n        select\n            3 as input_column_idx,\n            cast('ORDER_PLACEMENT_DATE' as TEXT) as input_column\n        \n        \n    )\n    select *\n    from\n        relation_columns r\n        full outer join\n        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx\n    where\n        -- catch any column in input list that is not in the sequence of table columns\n        -- or any table column that is not in the input sequence\n        r.relation_column is null or\n        i.input_column is null", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.231568Z", "completed_at": "2025-03-21T12:20:34.248451Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.249420Z", "completed_at": "2025-03-21T12:20:34.249436Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020570993423461914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_orders_10000000__1.d2cd7717b3", "compiled": true, "compiled_code": "\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and count(*) >= 1 and count(*) <= 10000000\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_orders\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.253743Z", "completed_at": "2025-03-21T12:20:34.264785Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.265678Z", "completed_at": "2025-03-21T12:20:34.265695Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013915300369262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_orders_customer_id.af79d5e4b5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_orders\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.270077Z", "completed_at": "2025-03-21T12:20:34.281004Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.281936Z", "completed_at": "2025-03-21T12:20:34.281952Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01393747329711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_orders_order_id.81cfe2fe64", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_orders\"\nwhere order_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.286444Z", "completed_at": "2025-03-21T12:20:34.297132Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.298055Z", "completed_at": "2025-03-21T12:20:34.298073Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013623952865600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_orders_order_placement_date.b80fa199d8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_placement_date\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_orders\"\nwhere order_placement_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.301313Z", "completed_at": "2025-03-21T12:20:34.317187Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.318165Z", "completed_at": "2025-03-21T12:20:34.318183Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01822805404663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.unique_stg_orders_order_id.e3b841c71a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_orders\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.322076Z", "completed_at": "2025-03-21T12:20:34.328946Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.329556Z", "completed_at": "2025-03-21T12:20:34.329568Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008792638778686523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.nexabrands_dbt.dim_product", "compiled": true, "compiled_code": "-- models/dim_products.sql\nWITH source AS (\n    SELECT *\n    FROM \"nexabrands_datawarehouse\".\"staging\".\"stg_products\"\n)\nSELECT\n    product_id,\n    product_name,\n    category\nFROM source", "relation_name": "\"nexabrands_datawarehouse\".\"marts\".\"dim_product\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.332467Z", "completed_at": "2025-03-21T12:20:34.340785Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.341436Z", "completed_at": "2025-03-21T12:20:34.341449Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010314464569091797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.accepted_values_stg_products_category__Dairy__beverages__Food.9a74aea575", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        category as value_field,\n        count(*) as n_records\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_products\"\n    group by category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Dairy','beverages','Food'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.344687Z", "completed_at": "2025-03-21T12:20:34.352446Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.353128Z", "completed_at": "2025-03-21T12:20:34.353138Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009778738021850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_category__50__2.f036dd83e2", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and len(\n        category\n    ) >= 2 and len(\n        category\n    ) <= 50\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_products\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.356033Z", "completed_at": "2025-03-21T12:20:34.365093Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.365727Z", "completed_at": "2025-03-21T12:20:34.365739Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011104106903076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_value_lengths_to_be_between_stg_products_product_name__100__1.2a82c98710", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and len(\n        product_name\n    ) >= 1 and len(\n        product_name\n    ) <= 100\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_products\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.368616Z", "completed_at": "2025-03-21T12:20:34.484353Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.484968Z", "completed_at": "2025-03-21T12:20:34.484984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11767816543579102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_between_stg_products_product_id__1__product_id_IS_NOT_NULL__True.0e54fce5ed", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and product_id > 1\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_products\"\n    where\n        product_id IS NOT NULL\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.488290Z", "completed_at": "2025-03-21T12:20:34.495749Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.496380Z", "completed_at": "2025-03-21T12:20:34.496392Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009810447692871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_be_in_set_stg_products_category__Dairy__beverages__Food.af6390bd10", "compiled": true, "compiled_code": "\n\nwith all_values as (\n\n    select\n        category as value_field\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_products\"\n    \n\n),\nset_values as (\n\n    select\n        cast('Dairy' as TEXT) as value_field\n    union all\n    select\n        cast('beverages' as TEXT) as value_field\n    union all\n    select\n        cast('Food' as TEXT) as value_field\n    \n    \n),\nvalidation_errors as (\n    -- values from the model that are not in the set\n    select\n        v.value_field\n    from\n        all_values v\n        left join\n        set_values s on v.value_field = s.value_field\n    where\n        s.value_field is null\n\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.499253Z", "completed_at": "2025-03-21T12:20:34.506901Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.507529Z", "completed_at": "2025-03-21T12:20:34.507541Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009744882583618164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_column_values_to_not_match_regex_stg_products_product_name___s_.11c7940908", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \n\nregexp_instr(product_name, '^\\\\s*$', 1, 1, 0, '')\n\n\n = 0\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_products\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.510372Z", "completed_at": "2025-03-21T12:20:34.517743Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.518340Z", "completed_at": "2025-03-21T12:20:34.518352Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00922393798828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_compound_columns_to_be_unique_stg_products_product_name__category.e804075419", "compiled": true, "compiled_code": "\n\n\n\nwith validation_errors as (\n\n    select\n        product_name,category,\n        count(*) as \"n_records\"\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_products\"\n    where\n        1=1\n        and \n    not (\n        product_name is null and \n        category is null\n        \n    )\n\n\n    \n    group by\n        product_name,category\n    having count(*) > 1\n\n)\nselect * from validation_errors\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.521092Z", "completed_at": "2025-03-21T12:20:34.752119Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.753101Z", "completed_at": "2025-03-21T12:20:34.753121Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.23999929428100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_table_columns_to_match_ordered_list_stg_products_product_id__product_name__category.393dada602", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n    ),\n    input_columns as (\n\n        \n        select\n            1 as input_column_idx,\n            cast('PRODUCT_ID' as TEXT) as input_column\n        union all\n        \n        select\n            2 as input_column_idx,\n            cast('PRODUCT_NAME' as TEXT) as input_column\n        union all\n        \n        select\n            3 as input_column_idx,\n            cast('CATEGORY' as TEXT) as input_column\n        \n        \n    )\n    select *\n    from\n        relation_columns r\n        full outer join\n        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx\n    where\n        -- catch any column in input list that is not in the sequence of table columns\n        -- or any table column that is not in the input sequence\n        r.relation_column is null or\n        i.input_column is null", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.767250Z", "completed_at": "2025-03-21T12:20:34.782478Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.783519Z", "completed_at": "2025-03-21T12:20:34.783536Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018322229385375977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.dbt_expectations_expect_table_row_count_to_be_between_stg_products_100__1.bd6a3a0191", "compiled": true, "compiled_code": "\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and count(*) >= 1 and count(*) <= 100\n)\n as expression\n\n\n    from \"nexabrands_datawarehouse\".\"staging\".\"stg_products\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.789245Z", "completed_at": "2025-03-21T12:20:34.815583Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.816548Z", "completed_at": "2025-03-21T12:20:34.816566Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02937173843383789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_products_category.6007d8b2d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_products\"\nwhere category is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.821029Z", "completed_at": "2025-03-21T12:20:34.832920Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.833901Z", "completed_at": "2025-03-21T12:20:34.833918Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014881372451782227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_products_product_id.6373b0acf3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_products\"\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.838310Z", "completed_at": "2025-03-21T12:20:34.848974Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.849901Z", "completed_at": "2025-03-21T12:20:34.849918Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01361393928527832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.not_null_stg_products_product_name.0b59e4b939", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_name\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_products\"\nwhere product_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.854397Z", "completed_at": "2025-03-21T12:20:34.865196Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.866120Z", "completed_at": "2025-03-21T12:20:34.866138Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014012575149536133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.nexabrands_dbt.unique_stg_products_product_id.7d950a1467", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom \"nexabrands_datawarehouse\".\"staging\".\"stg_products\"\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.870443Z", "completed_at": "2025-03-21T12:20:34.894031Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.895008Z", "completed_at": "2025-03-21T12:20:34.895027Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026503562927246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.redshift.redshift_admin_dependencies", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__pg_class as (\nselect\n  oid\n, relname\n, relnamespace\n, reltype\n, relowner\n, relam\n, relfilenode\n, reltablespace\n, relpages\n, reltuples\n, reltoastrelid\n, reltoastidxid\n, relhasindex\n, relisshared\n, relkind\n, relnatts\n, relexternid\n, relisreplicated\n, relispinned\n, reldiststyle\n, relprojbaseid\n, relchecks\n, reltriggers\n, relukeys\n, relfkeys\n, relrefs\n, relhasoids\n, relhaspkey\n, relhasrules\n, relhassubclass\n, relacl\nfrom pg_catalog.pg_class\n),  __dbt__cte__pg_depend as (\nselect\n  classid\n, objid\n, objsubid\n, refclassid\n, refobjid\n, refobjsubid\n, deptype\nfrom pg_catalog.pg_depend\n),  __dbt__cte__pg_namespace as (\nselect\n  oid\n, nspname\n, nspowner\n, nspacl\nfrom pg_catalog.pg_namespace\n) select distinct\n  srcobj.oid as source_oid\n  , srcnsp.nspname as source_schemaname\n  , srcobj.relname as source_objectname\n  , tgtobj.oid as dependent_oid\n  , tgtnsp.nspname as dependent_schemaname\n  , tgtobj.relname as dependent_objectname\n\nfrom\n\n  __dbt__cte__pg_class as srcobj\n  join __dbt__cte__pg_depend as srcdep on srcobj.oid = srcdep.refobjid\n  join __dbt__cte__pg_depend as tgtdep on srcdep.objid = tgtdep.objid\n  join __dbt__cte__pg_class as tgtobj\n    on tgtdep.refobjid = tgtobj.oid\n    and srcobj.oid <> tgtobj.oid\n  left join __dbt__cte__pg_namespace as srcnsp\n    on srcobj.relnamespace = srcnsp.oid\n  left join __dbt__cte__pg_namespace tgtnsp on tgtobj.relnamespace = tgtnsp.oid\n\nwhere\n  tgtdep.deptype = 'i' --dependency_internal\n  and tgtobj.relkind = 'v' --i=index, v=view, s=sequence", "relation_name": "\"nexabrands_datawarehouse\".\"nexabrands_external\".\"redshift_admin_dependencies\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.898969Z", "completed_at": "2025-03-21T12:20:34.921025Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.922057Z", "completed_at": "2025-03-21T12:20:34.922076Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025244474411010742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.redshift.redshift_admin_users_schema_privileges", "compiled": true, "compiled_code": "with  __dbt__cte__pg_tables as (\nselect\n  schemaname as schema_name\n, tablename as table_name\n, tableowner as table_owner\n, tablespace as table_space\n, hasindexes as has_indexes\n, hasrules as has_rules\n, hastriggers as has_triggers\nfrom pg_catalog.pg_tables\n),  __dbt__cte__pg_views as (\nselect\n  schemaname as schema_name\n, viewname as view_name\n, viewowner as view_owner\nfrom pg_catalog.pg_views\n),  __dbt__cte__pg_user as (\nselect\n\n  usesysid as user_id\n, usename as username\n\nfrom pg_catalog.pg_user\n), tables as (\n\n  select * from __dbt__cte__pg_tables\n\n), views as (\n\n  select * from __dbt__cte__pg_views\n\n), users as (\n\n  select * from __dbt__cte__pg_user\n  \n), schemas as (\n  \n  select\n  distinct(schema_name)\n  from tables\n  where schema_name not in ('pg_catalog', 'information_schema')\n        \n  union\n        \n  select\n  distinct(schema_name)\n  from views\n        \n  where schema_name not in ('pg_catalog', 'information_schema')\n  \n)\n\n\nselect \n  schemas.schema_name\n, users.username\n, has_schema_privilege(users.username, schemas.schema_name, 'usage') AS has_usage_privilege\n, has_schema_privilege(users.username, schemas.schema_name, 'create') AS has_create_privilege\nfrom schemas\ncross join users\norder by schemas.schema_name, users.username", "relation_name": "\"nexabrands_datawarehouse\".\"nexabrands_external\".\"redshift_admin_users_schema_privileges\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.926386Z", "completed_at": "2025-03-21T12:20:34.946668Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:34.947655Z", "completed_at": "2025-03-21T12:20:34.947673Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02312183380126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.redshift.redshift_admin_users_table_view_privileges", "compiled": true, "compiled_code": "with  __dbt__cte__pg_tables as (\nselect\n  schemaname as schema_name\n, tablename as table_name\n, tableowner as table_owner\n, tablespace as table_space\n, hasindexes as has_indexes\n, hasrules as has_rules\n, hastriggers as has_triggers\nfrom pg_catalog.pg_tables\n),  __dbt__cte__pg_views as (\nselect\n  schemaname as schema_name\n, viewname as view_name\n, viewowner as view_owner\nfrom pg_catalog.pg_views\n),  __dbt__cte__pg_user as (\nselect\n\n  usesysid as user_id\n, usename as username\n\nfrom pg_catalog.pg_user\n), tables as (\n\n  select * from __dbt__cte__pg_tables\n\n), views as (\n\n  select * from __dbt__cte__pg_views\n\n), users as (\n\n  select * from __dbt__cte__pg_user\n\n), objects as (\n  \n  select\n    schema_name\n  , 'table' as object_type\n  , table_name as object_name\n  , '\"' || schema_name || '\".\"' || table_name || '\"' as full_object_name\n  from tables\n  where schema_name not in ('pg_catalog', 'information_schema')\n  \n  union\n  \n  select\n    schema_name\n  , 'view' as object_type\n  , view_name as object_name\n  , '\"' || schema_name || '\".\"' || view_name || '\"' as full_object_name\n  from views\n  where schema_name not in ('pg_catalog', 'information_schema')\n  \n)\n\nselect \n  objects.schema_name\n, objects.object_name\n, users.username\n, has_table_privilege(users.username, objects.full_object_name, 'select') as has_select_privilege\n, has_table_privilege(users.username, objects.full_object_name, 'insert') as has_insert_privilege\n, has_table_privilege(users.username, objects.full_object_name, 'update') as has_update_privilege\n, has_table_privilege(users.username, objects.full_object_name, 'delete') as has_delete_privilege\n, has_table_privilege(users.username, objects.full_object_name, 'references') as has_references_privilege\nfrom objects\ncross join users\norder by objects.full_object_name, users.username", "relation_name": "\"nexabrands_datawarehouse\".\"nexabrands_external\".\"redshift_admin_users_table_view_privileges\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:34.976965Z", "completed_at": "2025-03-21T12:20:35.033735Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:35.034361Z", "completed_at": "2025-03-21T12:20:35.034374Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05940961837768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.redshift.redshift_admin_table_stats", "compiled": true, "compiled_code": "with  __dbt__cte__stv_tbl_perm as (\nselect\n  slice\n, id -- table id\n, name -- table name\n, rows\n, sorted_rows\n, (rows - sorted_rows) as unsorted_rows\n, temp\n, db_id\n, backup\nfrom pg_catalog.stv_tbl_perm\n),  __dbt__cte__pg_class as (\nselect\n  oid\n, relname\n, relnamespace\n, reltype\n, relowner\n, relam\n, relfilenode\n, reltablespace\n, relpages\n, reltuples\n, reltoastrelid\n, reltoastidxid\n, relhasindex\n, relisshared\n, relkind\n, relnatts\n, relexternid\n, relisreplicated\n, relispinned\n, reldiststyle\n, relprojbaseid\n, relchecks\n, reltriggers\n, relukeys\n, relfkeys\n, relrefs\n, relhasoids\n, relhaspkey\n, relhasrules\n, relhassubclass\n, relacl\nfrom pg_catalog.pg_class\n),  __dbt__cte__pg_namespace as (\nselect\n  oid\n, nspname\n, nspowner\n, nspacl\nfrom pg_catalog.pg_namespace\n),  __dbt__cte__stv_blocklist as (\nselect\n  slice\n, col\n, tbl\n, blocknum\n, num_values\n, extended_limits\n, minvalue\n, maxvalue\n, sb_pos\n, pinned\n, on_disk\n, backed_up\n, modified\n, hdr_modified\n, unsorted\n, tombstone\n, preferred_diskno\n, temporary\n, newblock\n, num_readers\n, id\n, flags\nfrom pg_catalog.stv_blocklist\n),  __dbt__cte__pg_attribute as (\nselect\n  attrelid\n, attname\n, atttypid\n, attstattarget\n, attlen\n, attnum\n, attndims\n, attcacheoff\n, atttypmod\n, attbyval\n, attstorage\n, attalign\n, attnotnull\n, atthasdef\n, attisdropped\n, attislocal\n, attinhcount\n, attisdistkey\n, attispreloaded\n, attsortkeyord\n, attencodingtype\n, attencrypttype\n, (case attisdistkey\n        when 't' then attname\n        else null end) as dist_key\n, (case attsortkeyord\n        when 1 then attname\n        else null end) as sort_key\nfrom pg_catalog.pg_attribute\n),  __dbt__cte__svv_diskusage as (\nselect\n  db_id\n, name\n, slice\n, col\n, tbl\n, blocknum\n, num_values\n, extended_limits\n, minvalue\n, maxvalue\n, sb_pos\n, pinned\n, on_disk\n, backed_up\n, modified\n, hdr_modified\n, unsorted\n, tombstone\n, preferred_diskno\n, temporary\n, newblock\n, num_readers\n, id\n, flags\nfrom pg_catalog.svv_diskusage\n),  __dbt__cte__stv_partitions as (\nselect\n\n  owner\n, host\n, diskno\n, part_begin\n, part_end\n, used\n, tossed\n, capacity\n, \"reads\"\n, writes\n, seek_forward\n, seek_back\n, is_san\n, failed\n, mbps\n, mount\n\nfrom pg_catalog.stv_partitions\n), unsorted_by_table as (\n\n  select\n    db_id\n  , id as table_id\n  , name as table_name\n  , sum(rows) as rows\n  , sum(unsorted_rows) as unsorted_rows\n  from __dbt__cte__stv_tbl_perm\n  group by 1, 2, 3\n\n), pg_class as (\n\n  select * from __dbt__cte__pg_class\n\n), pg_namespace as (\n\n  select * from __dbt__cte__pg_namespace\n\n), table_sizes as (\n\n  select\n    tbl as table_id\n  , count(*) as size_in_megabytes\n  from __dbt__cte__stv_blocklist\n  group by 1\n\n), table_attributes as (\n\n  select\n    attrelid as table_id\n  , min(dist_key) as dist_key\n  , min(sort_key) as sort_key\n  , max(attsortkeyord) as num_sort_keys\n  , (max(attencodingtype) > 0) as is_encoded\n  , max(attnum) as num_columns\n  from __dbt__cte__pg_attribute\n  group by 1\n\n), slice_distribution as (\n\n  select\n    tbl as table_id\n  , trim(name) as name\n  , slice\n  , count(*) as size_in_megabytes\n\n  from __dbt__cte__svv_diskusage\n  group by 1, 2, 3\n\n), capacity as (\n\n  select\n    sum(capacity) as total_megabytes\n  from __dbt__cte__stv_partitions\n  where part_begin=0\n\n), table_distribution_ratio as (\n\n  select\n    table_id\n  , (max(size_in_megabytes)::float / min(size_in_megabytes)::float)\n      as ratio\n  from slice_distribution\n  group by 1\n\n)\n\nselect\n\n  trim(pg_namespace.nspname) as schema\n, trim(unsorted_by_table.table_name) as table\n, unsorted_by_table.rows\n, unsorted_by_table.unsorted_rows\n, (case unsorted_by_table.rows\n        when 0 then 0\n        else (unsorted_by_table.unsorted_rows::float / unsorted_by_table.rows::float) * 100.0 end)\n    as percent_rows_unsorted\n, unsorted_by_table.table_id\n\n, decode(pg_class.reldiststyle, 0, 'even',\n                              1, table_attributes.dist_key,\n                              'all') as dist_style\n, table_distribution_ratio.ratio as dist_skew\n\n, (table_attributes.sort_key is not null) as is_sorted\n, table_attributes.sort_key\n, table_attributes.num_sort_keys\n, table_attributes.num_columns\n\n, table_sizes.size_in_megabytes\n, (case capacity.total_megabytes\n        when 0 then 0\n        else (table_sizes.size_in_megabytes::float / capacity.total_megabytes::float) * 100.0 end)\n    as disk_used_percent_of_total\n, table_attributes.is_encoded\n\nfrom unsorted_by_table\n\nleft join pg_class\n  on pg_class.oid = unsorted_by_table.table_id\n\nleft join pg_namespace\n  on pg_namespace.oid = pg_class.relnamespace\n\nleft join capacity\n  on 1=1\n\nleft join table_sizes\n  on unsorted_by_table.table_id = table_sizes.table_id\n\nleft join table_attributes\n  on table_attributes.table_id = unsorted_by_table.table_id\n\nleft join table_distribution_ratio\n  on table_distribution_ratio.table_id = unsorted_by_table.table_id", "relation_name": "\"nexabrands_datawarehouse\".\"nexabrands_external\".\"redshift_admin_table_stats\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:35.038046Z", "completed_at": "2025-03-21T12:20:35.047783Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:35.048589Z", "completed_at": "2025-03-21T12:20:35.048601Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012753486633300781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.anomaly_threshold_sensitivity", "compiled": true, "compiled_code": "\n\nwith metrics_anomaly_score as (\n\n    select * from \"nexabrands_datawarehouse\".\"elementary\".\"metrics_anomaly_score\"\n\n),\n\nscore_sensitivity as (\n\n    select\n        full_table_name,\n        column_name,\n        metric_name,\n        latest_metric_value,\n        training_avg as metric_avg,\n        training_stddev as metric_stddev,\n        anomaly_score,\n        case when abs(anomaly_score) >= 1.5 then true else false end as \"is_anomaly_1_5\",\n        case when abs(anomaly_score) >= 2 then true else false end as \"is_anomaly_2\",\n        case when abs(anomaly_score) >= 2.5 then true else false end as \"is_anomaly_2_5\",\n        case when abs(anomaly_score) >= 3 then true else false end as \"is_anomaly_3\",\n        case when abs(anomaly_score) >= 3.5 then true else false end as \"is_anomaly_3_5\",\n        case when abs(anomaly_score) >= 4 then true else false end as \"is_anomaly_4\",\n        case when abs(anomaly_score) >= 4.5 then true else false end as \"is_anomaly_4_5\"\n    from metrics_anomaly_score\n    where abs(anomaly_score) >= 1.5\n\n)\n\nselect * from score_sensitivity", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"anomaly_threshold_sensitivity\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:35.051520Z", "completed_at": "2025-03-21T12:20:35.061016Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:35.061918Z", "completed_at": "2025-03-21T12:20:35.061933Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011762619018554688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.elementary.alerts_dbt_models", "compiled": true, "compiled_code": "\n\nwith error_models as (\n  \n    select  model_execution_id,\n            unique_id,\n            invocation_id,\n            name,\n            generated_at,\n            status,\n            full_refresh,\n            message,\n            execution_time,\n            execute_started_at,\n            execute_completed_at,\n            compile_started_at,\n            compile_completed_at,\n            compiled_code,\n            database_name,\n            schema_name,\n            materialization,\n            tags,\n            package_name,\n            path,\n            original_path,\n            owner,\n            alias \n    from \"nexabrands_datawarehouse\".\"elementary\".\"model_run_results\"\n  \n    union all\n  \n    select  model_execution_id,\n            unique_id,\n            invocation_id,\n            name,\n            generated_at,\n            status,\n            full_refresh,\n            message,\n            execution_time,\n            execute_started_at,\n            execute_completed_at,\n            compile_started_at,\n            compile_completed_at,\n            compiled_code,\n            database_name,\n            schema_name,\n            materialization,\n            tags,\n            package_name,\n            path,\n            original_path,\n            owner,\n            alias  \n  from \"nexabrands_datawarehouse\".\"elementary\".\"snapshot_run_results\"\n)\n\n\nselect model_execution_id as alert_id,\n       unique_id,\n       cast(generated_at as timestamp) as detected_at,\n       database_name,\n       materialization,\n       path,\n       original_path,\n       schema_name,\n       message,\n       owner as owners,\n       tags,\n       alias,\n       status,\n       full_refresh\nfrom error_models\nwhere True and lower(status) != 'success'and lower(status) != 'skipped'", "relation_name": "\"nexabrands_datawarehouse\".\"elementary\".\"alerts_dbt_models\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-21T12:20:35.066009Z", "completed_at": "2025-03-21T12:20:35.094450Z"}, {"name": "execute", "started_at": "2025-03-21T12:20:35.095353Z", "completed_at": "2025-03-21T12:20:35.095368Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.031327247619628906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.redshift.redshift_admin_queries", "compiled": true, "compiled_code": "with  __dbt__cte__stl_query as (\nselect\n\n  userid as user_id\n, query as query_id\n, xid as transaction_id\n, label\n, pid\n, database\n, starttime as started_at\n, endtime as finished_at\n, aborted\n\nfrom pg_catalog.stl_query\n),  __dbt__cte__pg_user as (\nselect\n\n  usesysid as user_id\n, usename as username\n\nfrom pg_catalog.pg_user\n),  __dbt__cte__stl_explain as (\nselect\n\n  userid as user_id\n, query as query_id\n, nodeid\n, parentid\n, plannode\n, info\n\nfrom pg_catalog.stl_explain\n),  __dbt__cte__redshift_cost as (\nwith stl_explain as (\n\n  select query_id, plannode from __dbt__cte__stl_explain\n  where nodeid = 1\n\n), parse_step_one as (\n\n  -- plannode (which contains cost) is formatted like:\n  --   XN Seq Scan on nyc_last_update  (cost=0.00..0.03 rows=2 width=40)\n  -- we want to rip out the cost part (0.00, 0.03) and make it usable.\n  -- cost_string after this step is \"0.00..0.03 ...\"\n  select\n    query_id\n  , split_part(plannode, 'cost=', 2) as cost_string\n\n  from stl_explain\n\n), parse_step_two as (\n\n  select\n    query_id\n  , split_part(cost_string, '..', 1) as starting_cost\n  , substring(\n      split_part(cost_string, '..', 2)\n      from 1\n      for strpos(split_part(cost_string, '..', 2), ' ')) as total_cost\n\n  from parse_step_one\n\n)\n\n\nselect\n\n  query_id\n, starting_cost::float as starting_cost\n, total_cost::float as total_cost\n\nfrom parse_step_two\n),  __dbt__cte__stl_wlm_query as (\nselect\n\n  userid as user_id\n, query as query_id\n, xid\n, task\n, service_class\n, slot_count\n, service_class_start_time\n, queue_start_time\n, queue_end_time\n, total_queue_time\n, exec_start_time\n, exec_end_time\n, total_exec_time\n, service_class_end_time\n, final_state\n\nfrom pg_catalog.stl_wlm_query\n), queries as (\n\n  select * from __dbt__cte__stl_query\n\n), users as (\n\n  select * from __dbt__cte__pg_user\n\n), cost as (\n\n  select * from __dbt__cte__redshift_cost\n\n), timings as (\n\n  select * from __dbt__cte__stl_wlm_query\n\n)\n\n\n\nselect\n\n  queries.query_id\n, queries.transaction_id\n, users.username::varchar\n\n, cost.starting_cost\n, cost.total_cost\n\n, queries.started_at\n, queries.finished_at\n\n, timings.queue_start_time\n, timings.queue_end_time\n, (timings.total_queue_time::float / 1000000.0) as total_queue_time_seconds\n\n, timings.exec_start_time\n, timings.exec_end_time\n, (timings.total_exec_time::float / 1000000.0) as total_exec_time_seconds\n\nfrom queries\n\nleft join users\n  on queries.user_id = users.user_id\n\nleft join cost\n  on queries.query_id = cost.query_id\n\nleft join timings\n  on queries.query_id = timings.query_id", "relation_name": "\"nexabrands_datawarehouse\".\"nexabrands_external\".\"redshift_admin_queries\""}], "elapsed_time": 7.3480143547058105, "args": {"cache_selected_only": false, "enable_legacy_logger": false, "defer": false, "empty_catalog": false, "static": false, "which": "generate", "log_format_file": "debug", "profiles_dir": "/tmp/cosmos/profile/25232e57f4a1d721c61a7ea63016e37106df548c9df5a5118ca7dfc410f1ab47", "log_file_max_bytes": 10485760, "favor_state": false, "show_resource_report": false, "introspect": true, "use_colors_file": true, "exclude": [], "print": true, "send_anonymous_usage_stats": true, "target": "dev", "invocation_command": "dbt docs generate --project-dir /tmp/tmpot2yl0u4 --profiles-dir /tmp/cosmos/profile/25232e57f4a1d721c61a7ea63016e37106df548c9df5a5118ca7dfc410f1ab47 --profile default --target dev", "populate_cache": true, "log_format": "default", "select": [], "use_colors": true, "require_resource_names_without_spaces": false, "strict_mode": false, "quiet": false, "log_path": "/tmp/tmpot2yl0u4/logs", "source_freshness_run_project_hooks": false, "partial_parse_file_diff": true, "compile": true, "log_level": "info", "profile": "default", "project_dir": "/tmp/tmpot2yl0u4", "static_parser": true, "vars": {}, "macro_debugging": false, "write_json": true, "require_explicit_package_overrides_for_builtin_materializations": false, "partial_parse": true, "warn_error_options": {"include": [], "exclude": []}, "printer_width": 80, "version_check": true, "log_level_file": "debug", "indirect_selection": "eager"}}