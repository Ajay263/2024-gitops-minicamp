{"uid":"38123b0d5aeff7a6","name":"test_clean_products_data","fullName":"test_products#test_clean_products_data","historyId":"480670bc339f1a6931ef043382bf1910","time":{"start":1737695251507,"stop":1737695252602,"duration":1095},"description":"Test cleaning products data.","descriptionHtml":"<p>Test cleaning products data.</p>\n","status":"broken","statusMessage":"NameError: name 'col' is not defined","statusTrace":"spark_session = <pyspark.sql.session.SparkSession object at 0x7fdfeb05aca0>\n\n    def test_clean_products_data(spark_session):\n        \"\"\"Test cleaning products data.\"\"\"\n        schema = StructType(\n            [\n                StructField(\"PRODUCT_ID\", StringType(), True),\n                StructField(\"product.name\", StringType(), True),\n                StructField(\"category\", StringType(), True),\n            ]\n        )\n        data = [\n            (\"123 units\", \"Product A\", \"Category 1\"),\n            (\"456 units\", \"N/A\", \"Unknown\"),\n            (\"789 units\", \"Product C\", \"NULL\"),\n        ]\n        df = spark_session.createDataFrame(data, schema)\n    \n        # Clean data using the function\n        cleaned_df = clean_products_data(df)\n    \n        # Assertions\n        assert cleaned_df.count() == 1  # Only one row should remain after cleaning\n        assert cleaned_df.columns == [\"product_id\", \"product_name\", \"category\"]\n>       assert cleaned_df.filter(col(\"product_id\") == 123).count() == 1\nE       NameError: name 'col' is not defined\n\ntest_products.py:67: NameError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"spark_session","time":{"start":1737695245005,"stop":1737695247628,"duration":2623},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"afterStages":[{"name":"spark_session::0","time":{"start":1737695253492,"stop":1737695254437,"duration":945},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"suite","value":"test_products"},{"name":"host","value":"fv-az1369-136"},{"name":"thread","value":"2409-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"test_products"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"38123b0d5aeff7a6.json","parameterValues":[]}