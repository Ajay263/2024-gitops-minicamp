{"uid":"78722e79fa83b3e9","name":"test_load_order_lines_data","fullName":"test_order_lines#test_load_order_lines_data","historyId":"1b6526412c0ec5dc3bafdb8f3b25e55c","time":{"start":1737727470383,"stop":1737727471657,"duration":1274},"description":"Test loading order lines data.","descriptionHtml":"<p>Test loading order lines data.</p>\n","status":"broken","statusMessage":"ModuleNotFoundError: No module named 'order_lines.glue_context'; 'order_lines' is not a package","statusTrace":"spark_session = <pyspark.sql.session.SparkSession object at 0x7f7ea88ce460>\n\n    def test_load_order_lines_data(spark_session):\n        \"\"\"Test loading order lines data.\"\"\"\n        mock_df = spark_session.createDataFrame(\n            [(\"ORD123\", \"PROD456\", 10.0, \"2023-01-01\", \"2023-01-05\", \"5\")],\n            schema=[\n                \"ORDER_ID\",\n                \"PRODUCT_ID\",\n                \"ORDER_QTY\",\n                \"AGREED_DELIVERY_DATE\",\n                \"ACTUAL_DELIVERY_DATE\",\n                \"DELIVERY_QTY\",\n            ],\n        )\n>       with patch(\n            \"order_lines.glue_context.spark_session.read.format.return_value.option.return_value.schema.return_value.load\",\n            return_value=mock_df,\n        ):\n\ntest_order_lines.py:58: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.21/x64/lib/python3.9/unittest/mock.py:1388: in __enter__\n    self.target = self.getter()\n/opt/hostedtoolcache/Python/3.9.21/x64/lib/python3.9/unittest/mock.py:1563: in <lambda>\n    getter = lambda: _importer(target)\n/opt/hostedtoolcache/Python/3.9.21/x64/lib/python3.9/unittest/mock.py:1239: in _importer\n    thing = _dot_lookup(thing, comp, import_path)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nthing = <module 'order_lines' from '/home/runner/work/2024-gitops-minicamp/2024-gitops-minicamp/terraform/modules/scripts/order_lines.py'>\ncomp = 'glue_context', import_path = 'order_lines.glue_context'\n\n    def _dot_lookup(thing, comp, import_path):\n        try:\n            return getattr(thing, comp)\n        except AttributeError:\n>           __import__(import_path)\nE           ModuleNotFoundError: No module named 'order_lines.glue_context'; 'order_lines' is not a package\n\n/opt/hostedtoolcache/Python/3.9.21/x64/lib/python3.9/unittest/mock.py:1228: ModuleNotFoundError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"spark_session","time":{"start":1737727466732,"stop":1737727470381,"duration":3649},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Test loading order lines data.","status":"broken","statusMessage":"ModuleNotFoundError: No module named 'order_lines.glue_context'; 'order_lines' is not a package","statusTrace":"spark_session = <pyspark.sql.session.SparkSession object at 0x7f7ea88ce460>\n\n    def test_load_order_lines_data(spark_session):\n        \"\"\"Test loading order lines data.\"\"\"\n        mock_df = spark_session.createDataFrame(\n            [(\"ORD123\", \"PROD456\", 10.0, \"2023-01-01\", \"2023-01-05\", \"5\")],\n            schema=[\n                \"ORDER_ID\",\n                \"PRODUCT_ID\",\n                \"ORDER_QTY\",\n                \"AGREED_DELIVERY_DATE\",\n                \"ACTUAL_DELIVERY_DATE\",\n                \"DELIVERY_QTY\",\n            ],\n        )\n>       with patch(\n            \"order_lines.glue_context.spark_session.read.format.return_value.option.return_value.schema.return_value.load\",\n            return_value=mock_df,\n        ):\n\ntest_order_lines.py:58: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/opt/hostedtoolcache/Python/3.9.21/x64/lib/python3.9/unittest/mock.py:1388: in __enter__\n    self.target = self.getter()\n/opt/hostedtoolcache/Python/3.9.21/x64/lib/python3.9/unittest/mock.py:1563: in <lambda>\n    getter = lambda: _importer(target)\n/opt/hostedtoolcache/Python/3.9.21/x64/lib/python3.9/unittest/mock.py:1239: in _importer\n    thing = _dot_lookup(thing, comp, import_path)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nthing = <module 'order_lines' from '/home/runner/work/2024-gitops-minicamp/2024-gitops-minicamp/terraform/modules/scripts/order_lines.py'>\ncomp = 'glue_context', import_path = 'order_lines.glue_context'\n\n    def _dot_lookup(thing, comp, import_path):\n        try:\n            return getattr(thing, comp)\n        except AttributeError:\n>           __import__(import_path)\nE           ModuleNotFoundError: No module named 'order_lines.glue_context'; 'order_lines' is not a package\n\n/opt/hostedtoolcache/Python/3.9.21/x64/lib/python3.9/unittest/mock.py:1228: ModuleNotFoundError","steps":[],"attachments":[{"uid":"8de58102a2dd2d45","name":"stderr","source":"8de58102a2dd2d45.txt","type":"text/plain","size":273}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"spark_session::0","time":{"start":1737727476535,"stop":1737727477500,"duration":965},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"suite","value":"test_order_lines"},{"name":"host","value":"fv-az1110-863"},{"name":"thread","value":"2417-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"test_order_lines"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":[]},"source":"78722e79fa83b3e9.json","parameterValues":[]}